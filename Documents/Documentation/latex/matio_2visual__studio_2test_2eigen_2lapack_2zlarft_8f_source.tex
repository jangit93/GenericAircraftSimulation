\hypertarget{matio_2visual__studio_2test_2eigen_2lapack_2zlarft_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/lapack/zlarft.f}
\label{matio_2visual__studio_2test_2eigen_2lapack_2zlarft_8f_source}\index{zlarft.\+f@{zlarft.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b ZLARFT}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download ZLARFT + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/zlarft.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/zlarft.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/zlarft.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE ZLARFT( DIRECT, STOREV, N, K, V, LDV, TAU, T, LDT )}
00022 \textcolor{comment}{* }
00023 \textcolor{comment}{*       .. Scalar Arguments ..}
00024 \textcolor{comment}{*       CHARACTER          DIRECT, STOREV}
00025 \textcolor{comment}{*       INTEGER            K, LDT, LDV, N}
00026 \textcolor{comment}{*       ..}
00027 \textcolor{comment}{*       .. Array Arguments ..}
00028 \textcolor{comment}{*       COMPLEX*16         T( LDT, * ), TAU( * ), V( LDV, * )}
00029 \textcolor{comment}{*       ..}
00030 \textcolor{comment}{*  }
00031 \textcolor{comment}{*}
00032 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00033 \textcolor{comment}{*  =============}
00034 \textcolor{comment}{*>}
00035 \textcolor{comment}{*> \(\backslash\)verbatim}
00036 \textcolor{comment}{*>}
00037 \textcolor{comment}{*> ZLARFT forms the triangular factor T of a complex block reflector H}
00038 \textcolor{comment}{*> of order n, which is defined as a product of k elementary reflectors.}
00039 \textcolor{comment}{*>}
00040 \textcolor{comment}{*> If DIRECT = 'F', H = H(1) H(2) . . . H(k) and T is upper triangular;}
00041 \textcolor{comment}{*>}
00042 \textcolor{comment}{*> If DIRECT = 'B', H = H(k) . . . H(2) H(1) and T is lower triangular.}
00043 \textcolor{comment}{*>}
00044 \textcolor{comment}{*> If STOREV = 'C', the vector which defines the elementary reflector}
00045 \textcolor{comment}{*> H(i) is stored in the i-th column of the array V, and}
00046 \textcolor{comment}{*>}
00047 \textcolor{comment}{*>    H  =  I - V * T * V**H}
00048 \textcolor{comment}{*>}
00049 \textcolor{comment}{*> If STOREV = 'R', the vector which defines the elementary reflector}
00050 \textcolor{comment}{*> H(i) is stored in the i-th row of the array V, and}
00051 \textcolor{comment}{*>}
00052 \textcolor{comment}{*>    H  =  I - V**H * T * V}
00053 \textcolor{comment}{*> \(\backslash\)endverbatim}
00054 \textcolor{comment}{*}
00055 \textcolor{comment}{*  Arguments:}
00056 \textcolor{comment}{*  ==========}
00057 \textcolor{comment}{*}
00058 \textcolor{comment}{*> \(\backslash\)param[in] DIRECT}
00059 \textcolor{comment}{*> \(\backslash\)verbatim}
00060 \textcolor{comment}{*>          DIRECT is CHARACTER*1}
00061 \textcolor{comment}{*>          Specifies the order in which the elementary reflectors are}
00062 \textcolor{comment}{*>          multiplied to form the block reflector:}
00063 \textcolor{comment}{*>          = 'F': H = H(1) H(2) . . . H(k) (Forward)}
00064 \textcolor{comment}{*>          = 'B': H = H(k) . . . H(2) H(1) (Backward)}
00065 \textcolor{comment}{*> \(\backslash\)endverbatim}
00066 \textcolor{comment}{*>}
00067 \textcolor{comment}{*> \(\backslash\)param[in] STOREV}
00068 \textcolor{comment}{*> \(\backslash\)verbatim}
00069 \textcolor{comment}{*>          STOREV is CHARACTER*1}
00070 \textcolor{comment}{*>          Specifies how the vectors which define the elementary}
00071 \textcolor{comment}{*>          reflectors are stored (see also Further Details):}
00072 \textcolor{comment}{*>          = 'C': columnwise}
00073 \textcolor{comment}{*>          = 'R': rowwise}
00074 \textcolor{comment}{*> \(\backslash\)endverbatim}
00075 \textcolor{comment}{*>}
00076 \textcolor{comment}{*> \(\backslash\)param[in] N}
00077 \textcolor{comment}{*> \(\backslash\)verbatim}
00078 \textcolor{comment}{*>          N is INTEGER}
00079 \textcolor{comment}{*>          The order of the block reflector H. N >= 0.}
00080 \textcolor{comment}{*> \(\backslash\)endverbatim}
00081 \textcolor{comment}{*>}
00082 \textcolor{comment}{*> \(\backslash\)param[in] K}
00083 \textcolor{comment}{*> \(\backslash\)verbatim}
00084 \textcolor{comment}{*>          K is INTEGER}
00085 \textcolor{comment}{*>          The order of the triangular factor T (= the number of}
00086 \textcolor{comment}{*>          elementary reflectors). K >= 1.}
00087 \textcolor{comment}{*> \(\backslash\)endverbatim}
00088 \textcolor{comment}{*>}
00089 \textcolor{comment}{*> \(\backslash\)param[in] V}
00090 \textcolor{comment}{*> \(\backslash\)verbatim}
00091 \textcolor{comment}{*>          V is COMPLEX*16 array, dimension}
00092 \textcolor{comment}{*>                               (LDV,K) if STOREV = 'C'}
00093 \textcolor{comment}{*>                               (LDV,N) if STOREV = 'R'}
00094 \textcolor{comment}{*>          The matrix V. See further details.}
00095 \textcolor{comment}{*> \(\backslash\)endverbatim}
00096 \textcolor{comment}{*>}
00097 \textcolor{comment}{*> \(\backslash\)param[in] LDV}
00098 \textcolor{comment}{*> \(\backslash\)verbatim}
00099 \textcolor{comment}{*>          LDV is INTEGER}
00100 \textcolor{comment}{*>          The leading dimension of the array V.}
00101 \textcolor{comment}{*>          If STOREV = 'C', LDV >= max(1,N); if STOREV = 'R', LDV >= K.}
00102 \textcolor{comment}{*> \(\backslash\)endverbatim}
00103 \textcolor{comment}{*>}
00104 \textcolor{comment}{*> \(\backslash\)param[in] TAU}
00105 \textcolor{comment}{*> \(\backslash\)verbatim}
00106 \textcolor{comment}{*>          TAU is COMPLEX*16 array, dimension (K)}
00107 \textcolor{comment}{*>          TAU(i) must contain the scalar factor of the elementary}
00108 \textcolor{comment}{*>          reflector H(i).}
00109 \textcolor{comment}{*> \(\backslash\)endverbatim}
00110 \textcolor{comment}{*>}
00111 \textcolor{comment}{*> \(\backslash\)param[out] T}
00112 \textcolor{comment}{*> \(\backslash\)verbatim}
00113 \textcolor{comment}{*>          T is COMPLEX*16 array, dimension (LDT,K)}
00114 \textcolor{comment}{*>          The k by k triangular factor T of the block reflector.}
00115 \textcolor{comment}{*>          If DIRECT = 'F', T is upper triangular; if DIRECT = 'B', T is}
00116 \textcolor{comment}{*>          lower triangular. The rest of the array is not used.}
00117 \textcolor{comment}{*> \(\backslash\)endverbatim}
00118 \textcolor{comment}{*>}
00119 \textcolor{comment}{*> \(\backslash\)param[in] LDT}
00120 \textcolor{comment}{*> \(\backslash\)verbatim}
00121 \textcolor{comment}{*>          LDT is INTEGER}
00122 \textcolor{comment}{*>          The leading dimension of the array T. LDT >= K.}
00123 \textcolor{comment}{*> \(\backslash\)endverbatim}
00124 \textcolor{comment}{*}
00125 \textcolor{comment}{*  Authors:}
00126 \textcolor{comment}{*  ========}
00127 \textcolor{comment}{*}
00128 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00129 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00130 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00131 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00132 \textcolor{comment}{*}
00133 \textcolor{comment}{*> \(\backslash\)date April 2012}
00134 \textcolor{comment}{*}
00135 \textcolor{comment}{*> \(\backslash\)ingroup complex16OTHERauxiliary}
00136 \textcolor{comment}{*}
00137 \textcolor{comment}{*> \(\backslash\)par Further Details:}
00138 \textcolor{comment}{*  =====================}
00139 \textcolor{comment}{*>}
00140 \textcolor{comment}{*> \(\backslash\)verbatim}
00141 \textcolor{comment}{*>}
00142 \textcolor{comment}{*>  The shape of the matrix V and the storage of the vectors which define}
00143 \textcolor{comment}{*>  the H(i) is best illustrated by the following example with n = 5 and}
00144 \textcolor{comment}{*>  k = 3. The elements equal to 1 are not stored.}
00145 \textcolor{comment}{*>}
00146 \textcolor{comment}{*>  DIRECT = 'F' and STOREV = 'C':         DIRECT = 'F' and STOREV = 'R':}
00147 \textcolor{comment}{*>}
00148 \textcolor{comment}{*>               V = (  1       )                 V = (  1 v1 v1 v1 v1 )}
00149 \textcolor{comment}{*>                   ( v1  1    )                     (     1 v2 v2 v2 )}
00150 \textcolor{comment}{*>                   ( v1 v2  1 )                     (        1 v3 v3 )}
00151 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00152 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00153 \textcolor{comment}{*>}
00154 \textcolor{comment}{*>  DIRECT = 'B' and STOREV = 'C':         DIRECT = 'B' and STOREV = 'R':}
00155 \textcolor{comment}{*>}
00156 \textcolor{comment}{*>               V = ( v1 v2 v3 )                 V = ( v1 v1  1       )}
00157 \textcolor{comment}{*>                   ( v1 v2 v3 )                     ( v2 v2 v2  1    )}
00158 \textcolor{comment}{*>                   (  1 v2 v3 )                     ( v3 v3 v3 v3  1 )}
00159 \textcolor{comment}{*>                   (     1 v3 )}
00160 \textcolor{comment}{*>                   (        1 )}
00161 \textcolor{comment}{*> \(\backslash\)endverbatim}
00162 \textcolor{comment}{*>}
00163 \textcolor{comment}{*  =====================================================================}
00164 \textcolor{keyword}{      SUBROUTINE }zlarft( DIRECT, STOREV, N, K, V, LDV, TAU, T, LDT )
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.1) --}
00167 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00168 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00169 \textcolor{comment}{*     April 2012}
00170 \textcolor{comment}{*}
00171 \textcolor{comment}{*     .. Scalar Arguments ..}
00172       \textcolor{keywordtype}{CHARACTER}          direct, storev
00173       \textcolor{keywordtype}{INTEGER}            k, ldt, ldv, n
00174 \textcolor{comment}{*     ..}
00175 \textcolor{comment}{*     .. Array Arguments ..}
00176       \textcolor{keywordtype}{COMPLEX*16}         t( ldt, * ), tau( * ), v( ldv, * )
00177 \textcolor{comment}{*     ..}
00178 \textcolor{comment}{*}
00179 \textcolor{comment}{*  =====================================================================}
00180 \textcolor{comment}{*}
00181 \textcolor{comment}{*     .. Parameters ..}
00182       \textcolor{keywordtype}{COMPLEX*16}         one, zero
00183       parameter( one = ( 1.0d+0, 0.0d+0 ),
00184      $                   zero = ( 0.0d+0, 0.0d+0 ) )
00185 \textcolor{comment}{*     ..}
00186 \textcolor{comment}{*     .. Local Scalars ..}
00187       \textcolor{keywordtype}{INTEGER}            i, j, prevlastv, lastv
00188 \textcolor{comment}{*     ..}
00189 \textcolor{comment}{*     .. External Subroutines ..}
00190       \textcolor{keywordtype}{EXTERNAL}           zgemv, zlacgv, ztrmv
00191 \textcolor{comment}{*     ..}
00192 \textcolor{comment}{*     .. External Functions ..}
00193       \textcolor{keywordtype}{LOGICAL}            lsame
00194       \textcolor{keywordtype}{EXTERNAL}           lsame
00195 \textcolor{comment}{*     ..}
00196 \textcolor{comment}{*     .. Executable Statements ..}
00197 \textcolor{comment}{*}
00198 \textcolor{comment}{*     Quick return if possible}
00199 \textcolor{comment}{*}
00200       \textcolor{keywordflow}{IF}( n.EQ.0 )
00201      $   \textcolor{keywordflow}{RETURN}
00202 \textcolor{comment}{*}
00203       \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00204          prevlastv = n
00205          \textcolor{keywordflow}{DO} i = 1, k
00206             prevlastv = max( prevlastv, i )
00207             \textcolor{keywordflow}{IF}( tau( i ).EQ.zero ) \textcolor{keywordflow}{THEN}
00208 \textcolor{comment}{*}
00209 \textcolor{comment}{*              H(i)  =  I}
00210 \textcolor{comment}{*}
00211                \textcolor{keywordflow}{DO} j = 1, i
00212                   t( j, i ) = zero
00213 \textcolor{keywordflow}{               END DO}
00214             \textcolor{keywordflow}{ELSE}
00215 \textcolor{comment}{*}
00216 \textcolor{comment}{*              general case}
00217 \textcolor{comment}{*}
00218                \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00219 \textcolor{comment}{*                 Skip any trailing zeros.}
00220                   \textcolor{keywordflow}{DO} lastv = n, i+1, -1
00221                      \textcolor{keywordflow}{IF}( v( lastv, i ).NE.zero ) \textcolor{keywordflow}{EXIT}
00222 \textcolor{keywordflow}{                  END DO}
00223                   \textcolor{keywordflow}{DO} j = 1, i-1
00224                      t( j, i ) = -tau( i ) * conjg( v( i , j ) )
00225 \textcolor{keywordflow}{                  END DO}                     
00226                   j = min( lastv, prevlastv )
00227 \textcolor{comment}{*}
00228 \textcolor{comment}{*                 T(1:i-1,i) := - tau(i) * V(i:j,1:i-1)**H * V(i:j,i)}
00229 \textcolor{comment}{*}
00230                   \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'Conjugate transpose'}, j-i, i-1,
00231      $                        -tau( i ), v( i+1, 1 ), ldv, 
00232      $                        v( i+1, i ), 1, one, t( 1, i ), 1 )
00233                \textcolor{keywordflow}{ELSE}
00234 \textcolor{comment}{*                 Skip any trailing zeros.}
00235                   \textcolor{keywordflow}{DO} lastv = n, i+1, -1
00236                      \textcolor{keywordflow}{IF}( v( i, lastv ).NE.zero ) \textcolor{keywordflow}{EXIT}
00237 \textcolor{keywordflow}{                  END DO}
00238                   \textcolor{keywordflow}{DO} j = 1, i-1
00239                      t( j, i ) = -tau( i ) * v( j , i )
00240 \textcolor{keywordflow}{                  END DO}                     
00241                   j = min( lastv, prevlastv )
00242 \textcolor{comment}{*}
00243 \textcolor{comment}{*                 T(1:i-1,i) := - tau(i) * V(1:i-1,i:j) * V(i,i:j)**H}
00244 \textcolor{comment}{*}
00245                   \textcolor{keyword}{CALL }zgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'C'}, i-1, 1, j-i, -tau( i ),
00246      $                        v( 1, i+1 ), ldv, v( i, i+1 ), ldv,
00247      $                        one, t( 1, i ), ldt )                  
00248 \textcolor{keywordflow}{               END IF}
00249 \textcolor{comment}{*}
00250 \textcolor{comment}{*              T(1:i-1,i) := T(1:i-1,1:i-1) * T(1:i-1,i)}
00251 \textcolor{comment}{*}
00252                \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Non-unit'}, i-1, t,
00253      $                     ldt, t( 1, i ), 1 )
00254                t( i, i ) = tau( i )
00255                \textcolor{keywordflow}{IF}( i.GT.1 ) \textcolor{keywordflow}{THEN}
00256                   prevlastv = max( prevlastv, lastv )
00257                \textcolor{keywordflow}{ELSE}
00258                   prevlastv = lastv
00259 \textcolor{keywordflow}{               END IF}
00260 \textcolor{keywordflow}{             END IF}
00261 \textcolor{keywordflow}{         END DO}
00262       \textcolor{keywordflow}{ELSE}
00263          prevlastv = 1
00264          \textcolor{keywordflow}{DO} i = k, 1, -1
00265             \textcolor{keywordflow}{IF}( tau( i ).EQ.zero ) \textcolor{keywordflow}{THEN}
00266 \textcolor{comment}{*}
00267 \textcolor{comment}{*              H(i)  =  I}
00268 \textcolor{comment}{*}
00269                \textcolor{keywordflow}{DO} j = i, k
00270                   t( j, i ) = zero
00271 \textcolor{keywordflow}{               END DO}
00272             \textcolor{keywordflow}{ELSE}
00273 \textcolor{comment}{*}
00274 \textcolor{comment}{*              general case}
00275 \textcolor{comment}{*}
00276                \textcolor{keywordflow}{IF}( i.LT.k ) \textcolor{keywordflow}{THEN}
00277                   \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00278 \textcolor{comment}{*                    Skip any leading zeros.}
00279                      \textcolor{keywordflow}{DO} lastv = 1, i-1
00280                         \textcolor{keywordflow}{IF}( v( lastv, i ).NE.zero ) \textcolor{keywordflow}{EXIT}
00281 \textcolor{keywordflow}{                     END DO}
00282                      \textcolor{keywordflow}{DO} j = i+1, k
00283                         t( j, i ) = -tau( i ) * conjg( v( n-k+i , j ) )
00284 \textcolor{keywordflow}{                     END DO}                        
00285                      j = max( lastv, prevlastv )
00286 \textcolor{comment}{*}
00287 \textcolor{comment}{*                    T(i+1:k,i) = -tau(i) * V(j:n-k+i,i+1:k)**H * V(j:n-k+i,i)}
00288 \textcolor{comment}{*}
00289                      \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'Conjugate transpose'}, n-k+i-j, k-i,
00290      $                           -tau( i ), v( j, i+1 ), ldv, v( j, i ),
00291      $                           1, one, t( i+1, i ), 1 )
00292                   \textcolor{keywordflow}{ELSE}
00293 \textcolor{comment}{*                    Skip any leading zeros.}
00294                      \textcolor{keywordflow}{DO} lastv = 1, i-1
00295                         \textcolor{keywordflow}{IF}( v( i, lastv ).NE.zero ) \textcolor{keywordflow}{EXIT}
00296 \textcolor{keywordflow}{                     END DO}
00297                      \textcolor{keywordflow}{DO} j = i+1, k
00298                         t( j, i ) = -tau( i ) * v( j, n-k+i )
00299 \textcolor{keywordflow}{                     END DO}                                           
00300                      j = max( lastv, prevlastv )
00301 \textcolor{comment}{*}
00302 \textcolor{comment}{*                    T(i+1:k,i) = -tau(i) * V(i+1:k,j:n-k+i) * V(i,j:n-k+i)**H}
00303 \textcolor{comment}{*}
00304                      \textcolor{keyword}{CALL }zgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'C'}, k-i, 1, n-k+i-j, -tau( i ),
00305      $                           v( i+1, j ), ldv, v( i, j ), ldv,
00306      $                           one, t( i+1, i ), ldt )                \textcolor{comment}{     }
00307 \textcolor{comment}{}\textcolor{keywordflow}{                  END IF}
00308 \textcolor{comment}{*}
00309 \textcolor{comment}{*                 T(i+1:k,i) := T(i+1:k,i+1:k) * T(i+1:k,i)}
00310 \textcolor{comment}{*}
00311                   \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Non-unit'}, k-i,
00312      $                        t( i+1, i+1 ), ldt, t( i+1, i ), 1 )
00313                   \textcolor{keywordflow}{IF}( i.GT.1 ) \textcolor{keywordflow}{THEN}
00314                      prevlastv = min( prevlastv, lastv )
00315                   \textcolor{keywordflow}{ELSE}
00316                      prevlastv = lastv
00317 \textcolor{keywordflow}{                  END IF}
00318 \textcolor{keywordflow}{               END IF}
00319                t( i, i ) = tau( i )
00320 \textcolor{keywordflow}{            END IF}
00321 \textcolor{keywordflow}{         END DO}
00322 \textcolor{keywordflow}{      END IF}
00323       \textcolor{keywordflow}{RETURN}
00324 \textcolor{comment}{*}
00325 \textcolor{comment}{*     End of ZLARFT}
00326 \textcolor{comment}{*}
00327 \textcolor{keyword}{      END}
\end{DoxyCode}
