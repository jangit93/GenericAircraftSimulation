\hypertarget{eigen_2blas_2testing_2zblat2_8f_source}{}\section{eigen/blas/testing/zblat2.f}
\label{eigen_2blas_2testing_2zblat2_8f_source}\index{zblat2.\+f@{zblat2.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b ZBLAT2}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM ZBLAT2}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*> Test program for the COMPLEX*16       Level 2 Blas.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*> The program must be driven by a short data file. The first 18 records}
00022 \textcolor{comment}{*> of the file are read using list-directed input, the last 17 records}
00023 \textcolor{comment}{*> are read using the format ( A6, L2 ). An annotated example of a data}
00024 \textcolor{comment}{*> file can be obtained by deleting the first 3 characters from the}
00025 \textcolor{comment}{*> following 35 lines:}
00026 \textcolor{comment}{*> 'zblat2.out'      NAME OF SUMMARY OUTPUT FILE}
00027 \textcolor{comment}{*> 6                 UNIT NUMBER OF SUMMARY FILE}
00028 \textcolor{comment}{*> 'CBLA2T.SNAP'     NAME OF SNAPSHOT OUTPUT FILE}
00029 \textcolor{comment}{*> -1                UNIT NUMBER OF SNAPSHOT FILE (NOT USED IF .LT. 0)}
00030 \textcolor{comment}{*> F        LOGICAL FLAG, T TO REWIND SNAPSHOT FILE AFTER EACH RECORD.}
00031 \textcolor{comment}{*> F        LOGICAL FLAG, T TO STOP ON FAILURES.}
00032 \textcolor{comment}{*> T        LOGICAL FLAG, T TO TEST ERROR EXITS.}
00033 \textcolor{comment}{*> 16.0     THRESHOLD VALUE OF TEST RATIO}
00034 \textcolor{comment}{*> 6                 NUMBER OF VALUES OF N}
00035 \textcolor{comment}{*> 0 1 2 3 5 9       VALUES OF N}
00036 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF K}
00037 \textcolor{comment}{*> 0 1 2 4           VALUES OF K}
00038 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF INCX AND INCY}
00039 \textcolor{comment}{*> 1 2 -1 -2         VALUES OF INCX AND INCY}
00040 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF ALPHA}
00041 \textcolor{comment}{*> (0.0,0.0) (1.0,0.0) (0.7,-0.9)       VALUES OF ALPHA}
00042 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF BETA}
00043 \textcolor{comment}{*> (0.0,0.0) (1.0,0.0) (1.3,-1.1)       VALUES OF BETA}
00044 \textcolor{comment}{*> ZGEMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00045 \textcolor{comment}{*> ZGBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00046 \textcolor{comment}{*> ZHEMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00047 \textcolor{comment}{*> ZHBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00048 \textcolor{comment}{*> ZHPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00049 \textcolor{comment}{*> ZTRMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00050 \textcolor{comment}{*> ZTBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00051 \textcolor{comment}{*> ZTPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00052 \textcolor{comment}{*> ZTRSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00053 \textcolor{comment}{*> ZTBSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00054 \textcolor{comment}{*> ZTPSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00055 \textcolor{comment}{*> ZGERC  T PUT F FOR NO TEST. SAME COLUMNS.}
00056 \textcolor{comment}{*> ZGERU  T PUT F FOR NO TEST. SAME COLUMNS.}
00057 \textcolor{comment}{*> ZHER   T PUT F FOR NO TEST. SAME COLUMNS.}
00058 \textcolor{comment}{*> ZHPR   T PUT F FOR NO TEST. SAME COLUMNS.}
00059 \textcolor{comment}{*> ZHER2  T PUT F FOR NO TEST. SAME COLUMNS.}
00060 \textcolor{comment}{*> ZHPR2  T PUT F FOR NO TEST. SAME COLUMNS.}
00061 \textcolor{comment}{*>}
00062 \textcolor{comment}{*> Further Details}
00063 \textcolor{comment}{*> ===============}
00064 \textcolor{comment}{*>}
00065 \textcolor{comment}{*>    See:}
00066 \textcolor{comment}{*>}
00067 \textcolor{comment}{*>       Dongarra J. J., Du Croz J. J., Hammarling S.  and Hanson R. J..}
00068 \textcolor{comment}{*>       An  extended  set of Fortran  Basic Linear Algebra Subprograms.}
00069 \textcolor{comment}{*>}
00070 \textcolor{comment}{*>       Technical  Memoranda  Nos. 41 (revision 3) and 81,  Mathematics}
00071 \textcolor{comment}{*>       and  Computer Science  Division,  Argonne  National Laboratory,}
00072 \textcolor{comment}{*>       9700 South Cass Avenue, Argonne, Illinois 60439, US.}
00073 \textcolor{comment}{*>}
00074 \textcolor{comment}{*>       Or}
00075 \textcolor{comment}{*>}
00076 \textcolor{comment}{*>       NAG  Technical Reports TR3/87 and TR4/87,  Numerical Algorithms}
00077 \textcolor{comment}{*>       Group  Ltd.,  NAG  Central  Office,  256  Banbury  Road, Oxford}
00078 \textcolor{comment}{*>       OX2 7DE, UK,  and  Numerical Algorithms Group Inc.,  1101  31st}
00079 \textcolor{comment}{*>       Street,  Suite 100,  Downers Grove,  Illinois 60515-1263,  USA.}
00080 \textcolor{comment}{*>}
00081 \textcolor{comment}{*>}
00082 \textcolor{comment}{*> -- Written on 10-August-1987.}
00083 \textcolor{comment}{*>    Richard Hanson, Sandia National Labs.}
00084 \textcolor{comment}{*>    Jeremy Du Croz, NAG Central Office.}
00085 \textcolor{comment}{*>}
00086 \textcolor{comment}{*>    10-9-00:  Change STATUS='NEW' to 'UNKNOWN' so that the testers}
00087 \textcolor{comment}{*>              can be run multiple times without deleting generated}
00088 \textcolor{comment}{*>              output files (susan)}
00089 \textcolor{comment}{*> \(\backslash\)endverbatim}
00090 \textcolor{comment}{*}
00091 \textcolor{comment}{*  Authors:}
00092 \textcolor{comment}{*  ========}
00093 \textcolor{comment}{*}
00094 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00095 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00096 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00097 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00098 \textcolor{comment}{*}
00099 \textcolor{comment}{*> \(\backslash\)date April 2012}
00100 \textcolor{comment}{*}
00101 \textcolor{comment}{*> \(\backslash\)ingroup complex16\_blas\_testing}
00102 \textcolor{comment}{*}
00103 \textcolor{comment}{*  =====================================================================}
00104       \textcolor{keyword}{PROGRAM} zblat2
00105 \textcolor{comment}{*}
00106 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00107 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00108 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00109 \textcolor{comment}{*     April 2012}
00110 \textcolor{comment}{*}
00111 \textcolor{comment}{*  =====================================================================}
00112 \textcolor{comment}{*}
00113 \textcolor{comment}{*     .. Parameters ..}
00114       \textcolor{keywordtype}{INTEGER}            nin
00115       parameter( nin = 5 )
00116       \textcolor{keywordtype}{INTEGER}            nsubs
00117       parameter( nsubs = 17 )
00118       \textcolor{keywordtype}{COMPLEX*16}         zero, one
00119       parameter( zero = ( 0.0d0, 0.0d0 ),
00120      $                   one = ( 1.0d0, 0.0d0 ) )
00121       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
00122       parameter( rzero = 0.0d0 )
00123       \textcolor{keywordtype}{INTEGER}            nmax, incmax
00124       parameter( nmax = 65, incmax = 2 )
00125       \textcolor{keywordtype}{INTEGER}            ninmax, nidmax, nkbmax, nalmax, nbemax
00126       parameter( ninmax = 7, nidmax = 9, nkbmax = 7,
00127      $                   nalmax = 7, nbemax = 7 )
00128 \textcolor{comment}{*     .. Local Scalars ..}
00129       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, err, thresh
00130       \textcolor{keywordtype}{INTEGER}            i, isnum, j, n, nalf, nbet, nidim, ninc, nkb,
00131      $                   nout, ntra
00132       \textcolor{keywordtype}{LOGICAL}            fatal, ltestt, rewi, same, sfatal, trace,
00133      $                   tsterr
00134       \textcolor{keywordtype}{CHARACTER*1}        trans
00135       \textcolor{keywordtype}{CHARACTER*6}        snamet
00136       \textcolor{keywordtype}{CHARACTER*32}       snaps, summry
00137 \textcolor{comment}{*     .. Local Arrays ..}
00138       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ),
00139      $                   alf( nalmax ), as( nmax*nmax ), bet( nbemax ),
00140      $                   x( nmax ), xs( nmax*incmax ),
00141      $                   xx( nmax*incmax ), y( nmax ),
00142      $                   ys( nmax*incmax ), yt( nmax ),
00143      $                   yy( nmax*incmax ), z( 2*nmax )
00144       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
00145       \textcolor{keywordtype}{INTEGER}            idim( nidmax ), inc( ninmax ), kb( nkbmax )
00146       \textcolor{keywordtype}{LOGICAL}            ltest( nsubs )
00147       \textcolor{keywordtype}{CHARACTER*6}        snames( nsubs )
00148 \textcolor{comment}{*     .. External Functions ..}
00149       \textcolor{keywordtype}{DOUBLE PRECISION}   ddiff
00150       \textcolor{keywordtype}{LOGICAL}            lze
00151       \textcolor{keywordtype}{EXTERNAL}           ddiff, lze
00152 \textcolor{comment}{*     .. External Subroutines ..}
00153       \textcolor{keywordtype}{EXTERNAL}           zchk1, zchk2, zchk3, zchk4, zchk5, zchk6,
00154      $                   zchke, zmvch
00155 \textcolor{comment}{*     .. Intrinsic Functions ..}
00156       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00157 \textcolor{comment}{*     .. Scalars in Common ..}
00158       \textcolor{keywordtype}{INTEGER}            infot, noutc
00159       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00160       \textcolor{keywordtype}{CHARACTER*6}        srnamt
00161 \textcolor{comment}{*     .. Common blocks ..}
00162       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00163       \textcolor{keyword}{COMMON}             /srnamc/srnamt
00164 \textcolor{comment}{*     .. Data statements ..}
00165       \textcolor{keyword}{DATA}               snames/\textcolor{stringliteral}{'ZGEMV '}, \textcolor{stringliteral}{'ZGBMV '}, \textcolor{stringliteral}{'ZHEMV '}, \textcolor{stringliteral}{'ZHBMV '},
00166      $                   \textcolor{stringliteral}{'ZHPMV '}, \textcolor{stringliteral}{'ZTRMV '}, \textcolor{stringliteral}{'ZTBMV '}, \textcolor{stringliteral}{'ZTPMV '},
00167      $                   \textcolor{stringliteral}{'ZTRSV '}, \textcolor{stringliteral}{'ZTBSV '}, \textcolor{stringliteral}{'ZTPSV '}, \textcolor{stringliteral}{'ZGERC '},
00168      $                   \textcolor{stringliteral}{'ZGERU '}, \textcolor{stringliteral}{'ZHER  '}, \textcolor{stringliteral}{'ZHPR  '}, \textcolor{stringliteral}{'ZHER2 '},
00169      $                   \textcolor{stringliteral}{'ZHPR2 '}/
00170 \textcolor{comment}{*     .. Executable Statements ..}
00171 \textcolor{comment}{*}
00172 \textcolor{comment}{*     Read name and unit number for summary output file and open file.}
00173 \textcolor{comment}{*}
00174       \textcolor{keyword}{READ}( nin, fmt = * )summry
00175       \textcolor{keyword}{READ}( nin, fmt = * )nout
00176       \textcolor{keyword}{OPEN}( nout, \hyperlink{structfile}{file} = summry, status = \textcolor{stringliteral}{'UNKNOWN'} )
00177       noutc = nout
00178 \textcolor{comment}{*}
00179 \textcolor{comment}{*     Read name and unit number for snapshot output file and open file.}
00180 \textcolor{comment}{*}
00181       \textcolor{keyword}{READ}( nin, fmt = * )snaps
00182       \textcolor{keyword}{READ}( nin, fmt = * )ntra
00183       trace = ntra.GE.0
00184       \textcolor{keywordflow}{IF}( trace )\textcolor{keywordflow}{THEN}
00185          \textcolor{keyword}{OPEN}( ntra, \hyperlink{structfile}{file} = snaps, status = \textcolor{stringliteral}{'UNKNOWN'} )
00186 \textcolor{keywordflow}{      END IF}
00187 \textcolor{comment}{*     Read the flag that directs rewinding of the snapshot file.}
00188       \textcolor{keyword}{READ}( nin, fmt = * )rewi
00189       rewi = rewi.AND.trace
00190 \textcolor{comment}{*     Read the flag that directs stopping on any failure.}
00191       \textcolor{keyword}{READ}( nin, fmt = * )sfatal
00192 \textcolor{comment}{*     Read the flag that indicates whether error exits are to be tested.}
00193       \textcolor{keyword}{READ}( nin, fmt = * )tsterr
00194 \textcolor{comment}{*     Read the threshold value of the test ratio}
00195       \textcolor{keyword}{READ}( nin, fmt = * )thresh
00196 \textcolor{comment}{*}
00197 \textcolor{comment}{*     Read and check the parameter values for the tests.}
00198 \textcolor{comment}{*}
00199 \textcolor{comment}{*     Values of N}
00200       \textcolor{keyword}{READ}( nin, fmt = * )nidim
00201       \textcolor{keywordflow}{IF}( nidim.LT.1.OR.nidim.GT.nidmax )\textcolor{keywordflow}{THEN}
00202          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'N'}, nidmax
00203          \textcolor{keywordflow}{GO TO} 230
00204 \textcolor{keywordflow}{      END IF}
00205       \textcolor{keyword}{READ}( nin, fmt = * )( idim( i ), i = 1, nidim )
00206       \textcolor{keywordflow}{DO} 10 i = 1, nidim
00207          \textcolor{keywordflow}{IF}( idim( i ).LT.0.OR.idim( i ).GT.nmax )\textcolor{keywordflow}{THEN}
00208             \textcolor{keyword}{WRITE}( nout, fmt = 9996 )nmax
00209             \textcolor{keywordflow}{GO TO} 230
00210 \textcolor{keywordflow}{         END IF}
00211    10 \textcolor{keywordflow}{CONTINUE}
00212 \textcolor{comment}{*     Values of K}
00213       \textcolor{keyword}{READ}( nin, fmt = * )nkb
00214       \textcolor{keywordflow}{IF}( nkb.LT.1.OR.nkb.GT.nkbmax )\textcolor{keywordflow}{THEN}
00215          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'K'}, nkbmax
00216          \textcolor{keywordflow}{GO TO} 230
00217 \textcolor{keywordflow}{      END IF}
00218       \textcolor{keyword}{READ}( nin, fmt = * )( kb( i ), i = 1, nkb )
00219       \textcolor{keywordflow}{DO} 20 i = 1, nkb
00220          \textcolor{keywordflow}{IF}( kb( i ).LT.0 )\textcolor{keywordflow}{THEN}
00221             \textcolor{keyword}{WRITE}( nout, fmt = 9995 )
00222             \textcolor{keywordflow}{GO TO} 230
00223 \textcolor{keywordflow}{         END IF}
00224    20 \textcolor{keywordflow}{CONTINUE}
00225 \textcolor{comment}{*     Values of INCX and INCY}
00226       \textcolor{keyword}{READ}( nin, fmt = * )ninc
00227       \textcolor{keywordflow}{IF}( ninc.LT.1.OR.ninc.GT.ninmax )\textcolor{keywordflow}{THEN}
00228          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'INCX AND INCY'}, ninmax
00229          \textcolor{keywordflow}{GO TO} 230
00230 \textcolor{keywordflow}{      END IF}
00231       \textcolor{keyword}{READ}( nin, fmt = * )( inc( i ), i = 1, ninc )
00232       \textcolor{keywordflow}{DO} 30 i = 1, ninc
00233          \textcolor{keywordflow}{IF}( inc( i ).EQ.0.OR.abs( inc( i ) ).GT.incmax )\textcolor{keywordflow}{THEN}
00234             \textcolor{keyword}{WRITE}( nout, fmt = 9994 )incmax
00235             \textcolor{keywordflow}{GO TO} 230
00236 \textcolor{keywordflow}{         END IF}
00237    30 \textcolor{keywordflow}{CONTINUE}
00238 \textcolor{comment}{*     Values of ALPHA}
00239       \textcolor{keyword}{READ}( nin, fmt = * )nalf
00240       \textcolor{keywordflow}{IF}( nalf.LT.1.OR.nalf.GT.nalmax )\textcolor{keywordflow}{THEN}
00241          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'ALPHA'}, nalmax
00242          \textcolor{keywordflow}{GO TO} 230
00243 \textcolor{keywordflow}{      END IF}
00244       \textcolor{keyword}{READ}( nin, fmt = * )( alf( i ), i = 1, nalf )
00245 \textcolor{comment}{*     Values of BETA}
00246       \textcolor{keyword}{READ}( nin, fmt = * )nbet
00247       \textcolor{keywordflow}{IF}( nbet.LT.1.OR.nbet.GT.nbemax )\textcolor{keywordflow}{THEN}
00248          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'BETA'}, nbemax
00249          \textcolor{keywordflow}{GO TO} 230
00250 \textcolor{keywordflow}{      END IF}
00251       \textcolor{keyword}{READ}( nin, fmt = * )( bet( i ), i = 1, nbet )
00252 \textcolor{comment}{*}
00253 \textcolor{comment}{*     Report values of parameters.}
00254 \textcolor{comment}{*}
00255       \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00256       \textcolor{keyword}{WRITE}( nout, fmt = 9992 )( idim( i ), i = 1, nidim )
00257       \textcolor{keyword}{WRITE}( nout, fmt = 9991 )( kb( i ), i = 1, nkb )
00258       \textcolor{keyword}{WRITE}( nout, fmt = 9990 )( inc( i ), i = 1, ninc )
00259       \textcolor{keyword}{WRITE}( nout, fmt = 9989 )( alf( i ), i = 1, nalf )
00260       \textcolor{keyword}{WRITE}( nout, fmt = 9988 )( bet( i ), i = 1, nbet )
00261       \textcolor{keywordflow}{IF}( .NOT.tsterr )\textcolor{keywordflow}{THEN}
00262          \textcolor{keyword}{WRITE}( nout, fmt = * )
00263          \textcolor{keyword}{WRITE}( nout, fmt = 9980 )
00264 \textcolor{keywordflow}{      END IF}
00265       \textcolor{keyword}{WRITE}( nout, fmt = * )
00266       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )thresh
00267       \textcolor{keyword}{WRITE}( nout, fmt = * )
00268 \textcolor{comment}{*}
00269 \textcolor{comment}{*     Read names of subroutines and flags which indicate}
00270 \textcolor{comment}{*     whether they are to be tested.}
00271 \textcolor{comment}{*}
00272       \textcolor{keywordflow}{DO} 40 i = 1, nsubs
00273          ltest( i ) = .false.
00274    40 \textcolor{keywordflow}{CONTINUE}
00275    50 \textcolor{keyword}{READ}( nin, fmt = 9984, end = 80 )snamet, ltestt
00276       \textcolor{keywordflow}{DO} 60 i = 1, nsubs
00277          \textcolor{keywordflow}{IF}( snamet.EQ.snames( i ) )
00278      $      \textcolor{keywordflow}{GO TO} 70
00279    60 \textcolor{keywordflow}{CONTINUE}
00280       \textcolor{keyword}{WRITE}( nout, fmt = 9986 )snamet
00281       stop
00282    70 ltest( i ) = ltestt
00283       \textcolor{keywordflow}{GO TO} 50
00284 \textcolor{comment}{*}
00285    80 \textcolor{keywordflow}{CONTINUE}
00286       \textcolor{keyword}{CLOSE} ( nin )
00287 \textcolor{comment}{*}
00288 \textcolor{comment}{*     Compute EPS (the machine precision).}
00289 \textcolor{comment}{*}
00290       eps = epsilon(rzero)
00291       \textcolor{keyword}{WRITE}( nout, fmt = 9998 )eps
00292 \textcolor{comment}{*}
00293 \textcolor{comment}{*     Check the reliability of ZMVCH using exact data.}
00294 \textcolor{comment}{*}
00295       n = min( 32, nmax )
00296       \textcolor{keywordflow}{DO} 120 j = 1, n
00297          \textcolor{keywordflow}{DO} 110 i = 1, n
00298             a( i, j ) = max( i - j + 1, 0 )
00299   110    \textcolor{keywordflow}{CONTINUE}
00300          x( j ) = j
00301          y( j ) = zero
00302   120 \textcolor{keywordflow}{CONTINUE}
00303       \textcolor{keywordflow}{DO} 130 j = 1, n
00304          yy( j ) = j*( ( j + 1 )*j )/2 - ( ( j + 1 )*j*( j - 1 ) )/3
00305   130 \textcolor{keywordflow}{CONTINUE}
00306 \textcolor{comment}{*     YY holds the exact result. On exit from ZMVCH YT holds}
00307 \textcolor{comment}{*     the result computed by ZMVCH.}
00308       trans = \textcolor{stringliteral}{'N'}
00309       \textcolor{keyword}{CALL }zmvch( trans, n, n, one, a, nmax, x, 1, zero, y, 1, yt, g,
00310      $            yy, eps, err, fatal, nout, .true. )
00311       same = lze( yy, yt, n )
00312       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.rzero )\textcolor{keywordflow}{THEN}
00313          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00314          stop
00315 \textcolor{keywordflow}{      END IF}
00316       trans = \textcolor{stringliteral}{'T'}
00317       \textcolor{keyword}{CALL }zmvch( trans, n, n, one, a, nmax, x, -1, zero, y, -1, yt, g,
00318      $            yy, eps, err, fatal, nout, .true. )
00319       same = lze( yy, yt, n )
00320       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.rzero )\textcolor{keywordflow}{THEN}
00321          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00322          stop
00323 \textcolor{keywordflow}{      END IF}
00324 \textcolor{comment}{*}
00325 \textcolor{comment}{*     Test each subroutine in turn.}
00326 \textcolor{comment}{*}
00327       \textcolor{keywordflow}{DO} 210 isnum = 1, nsubs
00328          \textcolor{keyword}{WRITE}( nout, fmt = * )
00329          \textcolor{keywordflow}{IF}( .NOT.ltest( isnum ) )\textcolor{keywordflow}{THEN}
00330 \textcolor{comment}{*           Subprogram is not to be tested.}
00331             \textcolor{keyword}{WRITE}( nout, fmt = 9983 )snames( isnum )
00332          \textcolor{keywordflow}{ELSE}
00333             srnamt = snames( isnum )
00334 \textcolor{comment}{*           Test error exits.}
00335             \textcolor{keywordflow}{IF}( tsterr )\textcolor{keywordflow}{THEN}
00336                \textcolor{keyword}{CALL }zchke( isnum, snames( isnum ), nout )
00337                \textcolor{keyword}{WRITE}( nout, fmt = * )
00338 \textcolor{keywordflow}{            END IF}
00339 \textcolor{comment}{*           Test computations.}
00340             infot = 0
00341             ok = .true.
00342             fatal = .false.
00343             \textcolor{keywordflow}{GO TO} ( 140, 140, 150, 150, 150, 160, 160,
00344      $              160, 160, 160, 160, 170, 170, 180,
00345      $              180, 190, 190 )isnum
00346 \textcolor{comment}{*           Test ZGEMV, 01, and ZGBMV, 02.}
00347   140       \textcolor{keyword}{CALL }zchk1( snames( isnum ), eps, thresh, nout, ntra, trace,
00348      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00349      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00350      $                  x, xx, xs, y, yy, ys, yt, g )
00351             \textcolor{keywordflow}{GO TO} 200
00352 \textcolor{comment}{*           Test ZHEMV, 03, ZHBMV, 04, and ZHPMV, 05.}
00353   150       \textcolor{keyword}{CALL }zchk2( snames( isnum ), eps, thresh, nout, ntra, trace,
00354      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00355      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00356      $                  x, xx, xs, y, yy, ys, yt, g )
00357             \textcolor{keywordflow}{GO TO} 200
00358 \textcolor{comment}{*           Test ZTRMV, 06, ZTBMV, 07, ZTPMV, 08,}
00359 \textcolor{comment}{*           ZTRSV, 09, ZTBSV, 10, and ZTPSV, 11.}
00360   160       \textcolor{keyword}{CALL }zchk3( snames( isnum ), eps, thresh, nout, ntra, trace,
00361      $                  rewi, fatal, nidim, idim, nkb, kb, ninc, inc,
00362      $                  nmax, incmax, a, aa, as, y, yy, ys, yt, g, z )
00363             \textcolor{keywordflow}{GO TO} 200
00364 \textcolor{comment}{*           Test ZGERC, 12, ZGERU, 13.}
00365   170       \textcolor{keyword}{CALL }zchk4( snames( isnum ), eps, thresh, nout, ntra, trace,
00366      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00367      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00368      $                  yt, g, z )
00369             \textcolor{keywordflow}{GO TO} 200
00370 \textcolor{comment}{*           Test ZHER, 14, and ZHPR, 15.}
00371   180       \textcolor{keyword}{CALL }zchk5( snames( isnum ), eps, thresh, nout, ntra, trace,
00372      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00373      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00374      $                  yt, g, z )
00375             \textcolor{keywordflow}{GO TO} 200
00376 \textcolor{comment}{*           Test ZHER2, 16, and ZHPR2, 17.}
00377   190       \textcolor{keyword}{CALL }zchk6( snames( isnum ), eps, thresh, nout, ntra, trace,
00378      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00379      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00380      $                  yt, g, z )
00381 \textcolor{comment}{*}
00382   200       \textcolor{keywordflow}{IF}( fatal.AND.sfatal )
00383      $         \textcolor{keywordflow}{GO TO} 220
00384 \textcolor{keywordflow}{         END IF}
00385   210 \textcolor{keywordflow}{CONTINUE}
00386       \textcolor{keyword}{WRITE}( nout, fmt = 9982 )
00387       \textcolor{keywordflow}{GO TO} 240
00388 \textcolor{comment}{*}
00389   220 \textcolor{keywordflow}{CONTINUE}
00390       \textcolor{keyword}{WRITE}( nout, fmt = 9981 )
00391       \textcolor{keywordflow}{GO TO} 240
00392 \textcolor{comment}{*}
00393   230 \textcolor{keywordflow}{CONTINUE}
00394       \textcolor{keyword}{WRITE}( nout, fmt = 9987 )
00395 \textcolor{comment}{*}
00396   240 \textcolor{keywordflow}{CONTINUE}
00397       \textcolor{keywordflow}{IF}( trace )
00398      $   \textcolor{keyword}{CLOSE} ( ntra )
00399       \textcolor{keyword}{CLOSE} ( nout )
00400       stop
00401 \textcolor{comment}{*}
00402  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ROUTINES PASS COMPUTATIONAL TESTS IF TEST RATIO IS LES'},
00403      $      \textcolor{stringliteral}{'S THAN'}, f8.2 )
00404  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' RELATIVE MACHINE PRECISION IS TAKEN TO BE'}, 1p, d9.1 )
00405  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' NUMBER OF VALUES OF '}, a, \textcolor{stringliteral}{' IS LESS THAN 1 OR GREATER '},
00406      $      \textcolor{stringliteral}{'THAN '}, i2 )
00407  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF N IS LESS THAN 0 OR GREATER THAN '}, i2 )
00408  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF K IS LESS THAN 0'} )
00409  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ABSOLUTE VALUE OF INCX OR INCY IS 0 OR GREATER THAN '},
00410      $      i2 )
00411  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' TESTS OF THE COMPLEX*16       LEVEL 2 BLAS'}, //\textcolor{stringliteral}{' THE F'},
00412      $      \textcolor{stringliteral}{'OLLOWING PARAMETER VALUES WILL BE USED:'} )
00413  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR N              '}, 9i6 )
00414  9991 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR K              '}, 7i6 )
00415  9990 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR INCX AND INCY  '}, 7i6 )
00416  9989 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR ALPHA          '},
00417      $      7( \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{')  '}, : ) )
00418  9988 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR BETA           '},
00419      $      7( \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{')  '}, : ) )
00420  9987 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' AMEND DATA FILE OR INCREASE ARRAY SIZES IN PROGRAM'},
00421      $      /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00422  9986 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' SUBPROGRAM NAME '}, a6, \textcolor{stringliteral}{' NOT RECOGNIZED'}, /\textcolor{stringliteral}{' ******* T'},
00423      $      \textcolor{stringliteral}{'ESTS ABANDONED *******'} )
00424  9985 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR IN ZMVCH -  IN-LINE DOT PRODUCTS ARE BEING EVALU'},
00425      $      \textcolor{stringliteral}{'ATED WRONGLY.'}, /\textcolor{stringliteral}{' ZMVCH WAS CALLED WITH TRANS = '}, a1,
00426      $      \textcolor{stringliteral}{' AND RETURNED SAME = '}, l1, \textcolor{stringliteral}{' AND ERR = '}, f12.3, \textcolor{stringliteral}{'.'}, /
00427      $   \textcolor{stringliteral}{' THIS MAY BE DUE TO FAULTS IN THE ARITHMETIC OR THE COMPILER.'}
00428      $      , /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00429  9984 \textcolor{keyword}{FORMAT}( a6, l2 )
00430  9983 \textcolor{keyword}{FORMAT}( 1x, a6, \textcolor{stringliteral}{' WAS NOT TESTED'} )
00431  9982 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' END OF TESTS'} )
00432  9981 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' ******* FATAL ERROR - TESTS ABANDONED *******'} )
00433  9980 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR-EXITS WILL NOT BE TESTED'} )
00434 \textcolor{comment}{*}
00435 \textcolor{comment}{*     End of ZBLAT2.}
00436 \textcolor{comment}{*}
00437 \textcolor{keyword}{      END}
00438 \textcolor{keyword}{      SUBROUTINE }zchk1( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00439      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00440      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00441      $                  XS, Y, YY, YS, YT, G )
00442 \textcolor{comment}{*}
00443 \textcolor{comment}{*  Tests ZGEMV and ZGBMV.}
00444 \textcolor{comment}{*}
00445 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00446 \textcolor{comment}{*}
00447 \textcolor{comment}{*  -- Written on 10-August-1987.}
00448 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00449 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00450 \textcolor{comment}{*}
00451 \textcolor{comment}{*     .. Parameters ..}
00452       \textcolor{keywordtype}{COMPLEX*16}         zero, half
00453       parameter( zero = ( 0.0d0, 0.0d0 ),
00454      $                   half = ( 0.5d0, 0.0d0 ) )
00455       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
00456       parameter( rzero = 0.0d0 )
00457 \textcolor{comment}{*     .. Scalar Arguments ..}
00458       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00459       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00460      $                   nout, ntra
00461       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00462       \textcolor{keywordtype}{CHARACTER*6}        sname
00463 \textcolor{comment}{*     .. Array Arguments ..}
00464       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00465      $                   as( nmax*nmax ), bet( nbet ), x( nmax ),
00466      $                   xs( nmax*incmax ), xx( nmax*incmax ),
00467      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
00468      $                   yy( nmax*incmax )
00469       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
00470       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00471 \textcolor{comment}{*     .. Local Scalars ..}
00472       \textcolor{keywordtype}{COMPLEX*16}         alpha, als, beta, bls, transl
00473       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax
00474       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, iku, im, in, incx, incxs, incy,
00475      $                   incys, ix, iy, kl, kls, ku, kus, laa, lda,
00476      $                   ldas, lx, ly, m, ml, ms, n, nargs, nc, nd, nk,
00477      $                   nl, ns
00478       \textcolor{keywordtype}{LOGICAL}            banded, full, null, reset, same, tran
00479       \textcolor{keywordtype}{CHARACTER*1}        trans, transs
00480       \textcolor{keywordtype}{CHARACTER*3}        ich
00481 \textcolor{comment}{*     .. Local Arrays ..}
00482       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00483 \textcolor{comment}{*     .. External Functions ..}
00484       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
00485       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
00486 \textcolor{comment}{*     .. External Subroutines ..}
00487       \textcolor{keywordtype}{EXTERNAL}           zgbmv, zgemv, zmake, zmvch
00488 \textcolor{comment}{*     .. Intrinsic Functions ..}
00489       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00490 \textcolor{comment}{*     .. Scalars in Common ..}
00491       \textcolor{keywordtype}{INTEGER}            infot, noutc
00492       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00493 \textcolor{comment}{*     .. Common blocks ..}
00494       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00495 \textcolor{comment}{*     .. Data statements ..}
00496       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'NTC'}/
00497 \textcolor{comment}{*     .. Executable Statements ..}
00498       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
00499       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00500 \textcolor{comment}{*     Define the number of arguments.}
00501       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00502          nargs = 11
00503       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00504          nargs = 13
00505 \textcolor{keywordflow}{      END IF}
00506 \textcolor{comment}{*}
00507       nc = 0
00508       reset = .true.
00509       errmax = rzero
00510 \textcolor{comment}{*}
00511       \textcolor{keywordflow}{DO} 120 in = 1, nidim
00512          n = idim( in )
00513          nd = n/2 + 1
00514 \textcolor{comment}{*}
00515          \textcolor{keywordflow}{DO} 110 im = 1, 2
00516             \textcolor{keywordflow}{IF}( im.EQ.1 )
00517      $         m = max( n - nd, 0 )
00518             \textcolor{keywordflow}{IF}( im.EQ.2 )
00519      $         m = min( n + nd, nmax )
00520 \textcolor{comment}{*}
00521             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00522                nk = nkb
00523             \textcolor{keywordflow}{ELSE}
00524                nk = 1
00525 \textcolor{keywordflow}{            END IF}
00526             \textcolor{keywordflow}{DO} 100 iku = 1, nk
00527                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00528                   ku = kb( iku )
00529                   kl = max( ku - 1, 0 )
00530                \textcolor{keywordflow}{ELSE}
00531                   ku = n - 1
00532                   kl = m - 1
00533 \textcolor{keywordflow}{               END IF}
00534 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
00535                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00536                   lda = kl + ku + 1
00537                \textcolor{keywordflow}{ELSE}
00538                   lda = m
00539 \textcolor{keywordflow}{               END IF}
00540                \textcolor{keywordflow}{IF}( lda.LT.nmax )
00541      $            lda = lda + 1
00542 \textcolor{comment}{*              Skip tests if not enough room.}
00543                \textcolor{keywordflow}{IF}( lda.GT.nmax )
00544      $            \textcolor{keywordflow}{GO TO} 100
00545                laa = lda*n
00546                null = n.LE.0.OR.m.LE.0
00547 \textcolor{comment}{*}
00548 \textcolor{comment}{*              Generate the matrix A.}
00549 \textcolor{comment}{*}
00550                transl = zero
00551                \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax, aa,
00552      $                     lda, kl, ku, reset, transl )
00553 \textcolor{comment}{*}
00554                \textcolor{keywordflow}{DO} 90 ic = 1, 3
00555                   trans = ich( ic: ic )
00556                   tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
00557 \textcolor{comment}{*}
00558                   \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
00559                      ml = n
00560                      nl = m
00561                   \textcolor{keywordflow}{ELSE}
00562                      ml = m
00563                      nl = n
00564 \textcolor{keywordflow}{                  END IF}
00565 \textcolor{comment}{*}
00566                   \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00567                      incx = inc( ix )
00568                      lx = abs( incx )*nl
00569 \textcolor{comment}{*}
00570 \textcolor{comment}{*                    Generate the vector X.}
00571 \textcolor{comment}{*}
00572                      transl = half
00573                      \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, nl, x, 1, xx,
00574      $                           abs( incx ), 0, nl - 1, reset, transl )
00575                      \textcolor{keywordflow}{IF}( nl.GT.1 )\textcolor{keywordflow}{THEN}
00576                         x( nl/2 ) = zero
00577                         xx( 1 + abs( incx )*( nl/2 - 1 ) ) = zero
00578 \textcolor{keywordflow}{                     END IF}
00579 \textcolor{comment}{*}
00580                      \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00581                         incy = inc( iy )
00582                         ly = abs( incy )*ml
00583 \textcolor{comment}{*}
00584                         \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00585                            alpha = alf( ia )
00586 \textcolor{comment}{*}
00587                            \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00588                               beta = bet( ib )
00589 \textcolor{comment}{*}
00590 \textcolor{comment}{*                             Generate the vector Y.}
00591 \textcolor{comment}{*}
00592                               transl = zero
00593                               \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, ml, y, 1,
00594      $                                    yy, abs( incy ), 0, ml - 1,
00595      $                                    reset, transl )
00596 \textcolor{comment}{*}
00597                               nc = nc + 1
00598 \textcolor{comment}{*}
00599 \textcolor{comment}{*                             Save every datum before calling the}
00600 \textcolor{comment}{*                             subroutine.}
00601 \textcolor{comment}{*}
00602                               transs = trans
00603                               ms = m
00604                               ns = n
00605                               kls = kl
00606                               kus = ku
00607                               als = alpha
00608                               \textcolor{keywordflow}{DO} 10 i = 1, laa
00609                                  as( i ) = aa( i )
00610    10                         \textcolor{keywordflow}{CONTINUE}
00611                               ldas = lda
00612                               \textcolor{keywordflow}{DO} 20 i = 1, lx
00613                                  xs( i ) = xx( i )
00614    20                         \textcolor{keywordflow}{CONTINUE}
00615                               incxs = incx
00616                               bls = beta
00617                               \textcolor{keywordflow}{DO} 30 i = 1, ly
00618                                  ys( i ) = yy( i )
00619    30                         \textcolor{keywordflow}{CONTINUE}
00620                               incys = incy
00621 \textcolor{comment}{*}
00622 \textcolor{comment}{*                             Call the subroutine.}
00623 \textcolor{comment}{*}
00624                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00625                                  \textcolor{keywordflow}{IF}( trace )
00626      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00627      $                              trans, m, n, alpha, lda, incx, beta,
00628      $                              incy
00629                                  \textcolor{keywordflow}{IF}( rewi )
00630      $                              rewind ntra
00631                                  \textcolor{keyword}{CALL }zgemv( trans, m, n, alpha, aa,
00632      $                                       lda, xx, incx, beta, yy,
00633      $                                       incy )
00634                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00635                                  \textcolor{keywordflow}{IF}( trace )
00636      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00637      $                              trans, m, n, kl, ku, alpha, lda,
00638      $                              incx, beta, incy
00639                                  \textcolor{keywordflow}{IF}( rewi )
00640      $                              rewind ntra
00641                                  \textcolor{keyword}{CALL }zgbmv( trans, m, n, kl, ku, alpha,
00642      $                                       aa, lda, xx, incx, beta,
00643      $                                       yy, incy )
00644 \textcolor{keywordflow}{                              END IF}
00645 \textcolor{comment}{*}
00646 \textcolor{comment}{*                             Check if error-exit was taken incorrectly.}
00647 \textcolor{comment}{*}
00648                               \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00649                                  \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00650                                  fatal = .true.
00651                                  \textcolor{keywordflow}{GO TO} 130
00652 \textcolor{keywordflow}{                              END IF}
00653 \textcolor{comment}{*}
00654 \textcolor{comment}{*                             See what data changed inside subroutines.}
00655 \textcolor{comment}{*}
00656                               isame( 1 ) = trans.EQ.transs
00657                               isame( 2 ) = ms.EQ.m
00658                               isame( 3 ) = ns.EQ.n
00659                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00660                                  isame( 4 ) = als.EQ.alpha
00661                                  isame( 5 ) = lze( as, aa, laa )
00662                                  isame( 6 ) = ldas.EQ.lda
00663                                  isame( 7 ) = lze( xs, xx, lx )
00664                                  isame( 8 ) = incxs.EQ.incx
00665                                  isame( 9 ) = bls.EQ.beta
00666                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00667                                     isame( 10 ) = lze( ys, yy, ly )
00668                                  \textcolor{keywordflow}{ELSE}
00669                                     isame( 10 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00670      $                                            ml, ys, yy,
00671      $                                            abs( incy ) )
00672 \textcolor{keywordflow}{                                 END IF}
00673                                  isame( 11 ) = incys.EQ.incy
00674                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00675                                  isame( 4 ) = kls.EQ.kl
00676                                  isame( 5 ) = kus.EQ.ku
00677                                  isame( 6 ) = als.EQ.alpha
00678                                  isame( 7 ) = lze( as, aa, laa )
00679                                  isame( 8 ) = ldas.EQ.lda
00680                                  isame( 9 ) = lze( xs, xx, lx )
00681                                  isame( 10 ) = incxs.EQ.incx
00682                                  isame( 11 ) = bls.EQ.beta
00683                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00684                                     isame( 12 ) = lze( ys, yy, ly )
00685                                  \textcolor{keywordflow}{ELSE}
00686                                     isame( 12 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00687      $                                            ml, ys, yy,
00688      $                                            abs( incy ) )
00689 \textcolor{keywordflow}{                                 END IF}
00690                                  isame( 13 ) = incys.EQ.incy
00691 \textcolor{keywordflow}{                              END IF}
00692 \textcolor{comment}{*}
00693 \textcolor{comment}{*                             If data was incorrectly changed, report}
00694 \textcolor{comment}{*                             and return.}
00695 \textcolor{comment}{*}
00696                               same = .true.
00697                               \textcolor{keywordflow}{DO} 40 i = 1, nargs
00698                                  same = same.AND.isame( i )
00699                                  \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
00700      $                              \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
00701    40                         \textcolor{keywordflow}{CONTINUE}
00702                               \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
00703                                  fatal = .true.
00704                                  \textcolor{keywordflow}{GO TO} 130
00705 \textcolor{keywordflow}{                              END IF}
00706 \textcolor{comment}{*}
00707                               \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
00708 \textcolor{comment}{*}
00709 \textcolor{comment}{*                                Check the result.}
00710 \textcolor{comment}{*}
00711                                  \textcolor{keyword}{CALL }zmvch( trans, m, n, alpha, a,
00712      $                                       nmax, x, incx, beta, y,
00713      $                                       incy, yt, g, yy, eps, err,
00714      $                                       fatal, nout, .true. )
00715                                  errmax = max( errmax, err )
00716 \textcolor{comment}{*                                If got really bad answer, report and}
00717 \textcolor{comment}{*                                return.}
00718                                  \textcolor{keywordflow}{IF}( fatal )
00719      $                              \textcolor{keywordflow}{GO TO} 130
00720                               \textcolor{keywordflow}{ELSE}
00721 \textcolor{comment}{*                                Avoid repeating tests with M.le.0 or}
00722 \textcolor{comment}{*                                N.le.0.}
00723                                  \textcolor{keywordflow}{GO TO} 110
00724 \textcolor{keywordflow}{                              END IF}
00725 \textcolor{comment}{*}
00726    50                      \textcolor{keywordflow}{CONTINUE}
00727 \textcolor{comment}{*}
00728    60                   \textcolor{keywordflow}{CONTINUE}
00729 \textcolor{comment}{*}
00730    70                \textcolor{keywordflow}{CONTINUE}
00731 \textcolor{comment}{*}
00732    80             \textcolor{keywordflow}{CONTINUE}
00733 \textcolor{comment}{*}
00734    90          \textcolor{keywordflow}{CONTINUE}
00735 \textcolor{comment}{*}
00736   100       \textcolor{keywordflow}{CONTINUE}
00737 \textcolor{comment}{*}
00738   110    \textcolor{keywordflow}{CONTINUE}
00739 \textcolor{comment}{*}
00740   120 \textcolor{keywordflow}{CONTINUE}
00741 \textcolor{comment}{*}
00742 \textcolor{comment}{*     Report result.}
00743 \textcolor{comment}{*}
00744       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
00745          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
00746       \textcolor{keywordflow}{ELSE}
00747          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
00748 \textcolor{keywordflow}{      END IF}
00749       \textcolor{keywordflow}{GO TO} 140
00750 \textcolor{comment}{*}
00751   130 \textcolor{keywordflow}{CONTINUE}
00752       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
00753       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00754          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, trans, m, n, alpha, lda,
00755      $      incx, beta, incy
00756       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00757          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, trans, m, n, kl, ku,
00758      $      alpha, lda, incx, beta, incy
00759 \textcolor{keywordflow}{      END IF}
00760 \textcolor{comment}{*}
00761   140 \textcolor{keywordflow}{CONTINUE}
00762       \textcolor{keywordflow}{RETURN}
00763 \textcolor{comment}{*}
00764  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
00765      $      \textcolor{stringliteral}{'S)'} )
00766  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
00767      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
00768  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
00769      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
00770      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
00771  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
00772  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 4( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
00773      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
00774      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{') .'} )
00775  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
00776      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
00777      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{')         .'} )
00778  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
00779      $      \textcolor{stringliteral}{'******'} )
00780 \textcolor{comment}{*}
00781 \textcolor{comment}{*     End of ZCHK1.}
00782 \textcolor{comment}{*}
00783 \textcolor{keyword}{      END}
00784 \textcolor{keyword}{      SUBROUTINE }zchk2( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00785      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00786      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00787      $                  XS, Y, YY, YS, YT, G )
00788 \textcolor{comment}{*}
00789 \textcolor{comment}{*  Tests ZHEMV, ZHBMV and ZHPMV.}
00790 \textcolor{comment}{*}
00791 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00792 \textcolor{comment}{*}
00793 \textcolor{comment}{*  -- Written on 10-August-1987.}
00794 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00795 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00796 \textcolor{comment}{*}
00797 \textcolor{comment}{*     .. Parameters ..}
00798       \textcolor{keywordtype}{COMPLEX*16}         zero, half
00799       parameter( zero = ( 0.0d0, 0.0d0 ),
00800      $                   half = ( 0.5d0, 0.0d0 ) )
00801       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
00802       parameter( rzero = 0.0d0 )
00803 \textcolor{comment}{*     .. Scalar Arguments ..}
00804       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00805       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00806      $                   nout, ntra
00807       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00808       \textcolor{keywordtype}{CHARACTER*6}        sname
00809 \textcolor{comment}{*     .. Array Arguments ..}
00810       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00811      $                   as( nmax*nmax ), bet( nbet ), x( nmax ),
00812      $                   xs( nmax*incmax ), xx( nmax*incmax ),
00813      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
00814      $                   yy( nmax*incmax )
00815       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
00816       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00817 \textcolor{comment}{*     .. Local Scalars ..}
00818       \textcolor{keywordtype}{COMPLEX*16}         alpha, als, beta, bls, transl
00819       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax
00820       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, ik, in, incx, incxs, incy,
00821      $                   incys, ix, iy, k, ks, laa, lda, ldas, lx, ly,
00822      $                   n, nargs, nc, nk, ns
00823       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
00824       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
00825       \textcolor{keywordtype}{CHARACTER*2}        ich
00826 \textcolor{comment}{*     .. Local Arrays ..}
00827       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00828 \textcolor{comment}{*     .. External Functions ..}
00829       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
00830       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
00831 \textcolor{comment}{*     .. External Subroutines ..}
00832       \textcolor{keywordtype}{EXTERNAL}           zhbmv, zhemv, zhpmv, zmake, zmvch
00833 \textcolor{comment}{*     .. Intrinsic Functions ..}
00834       \textcolor{keywordtype}{INTRINSIC}          abs, max
00835 \textcolor{comment}{*     .. Scalars in Common ..}
00836       \textcolor{keywordtype}{INTEGER}            infot, noutc
00837       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00838 \textcolor{comment}{*     .. Common blocks ..}
00839       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00840 \textcolor{comment}{*     .. Data statements ..}
00841       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
00842 \textcolor{comment}{*     .. Executable Statements ..}
00843       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
00844       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00845       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
00846 \textcolor{comment}{*     Define the number of arguments.}
00847       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00848          nargs = 10
00849       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00850          nargs = 11
00851       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00852          nargs = 9
00853 \textcolor{keywordflow}{      END IF}
00854 \textcolor{comment}{*}
00855       nc = 0
00856       reset = .true.
00857       errmax = rzero
00858 \textcolor{comment}{*}
00859       \textcolor{keywordflow}{DO} 110 in = 1, nidim
00860          n = idim( in )
00861 \textcolor{comment}{*}
00862          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00863             nk = nkb
00864          \textcolor{keywordflow}{ELSE}
00865             nk = 1
00866 \textcolor{keywordflow}{         END IF}
00867          \textcolor{keywordflow}{DO} 100 ik = 1, nk
00868             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00869                k = kb( ik )
00870             \textcolor{keywordflow}{ELSE}
00871                k = n - 1
00872 \textcolor{keywordflow}{            END IF}
00873 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
00874             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00875                lda = k + 1
00876             \textcolor{keywordflow}{ELSE}
00877                lda = n
00878 \textcolor{keywordflow}{            END IF}
00879             \textcolor{keywordflow}{IF}( lda.LT.nmax )
00880      $         lda = lda + 1
00881 \textcolor{comment}{*           Skip tests if not enough room.}
00882             \textcolor{keywordflow}{IF}( lda.GT.nmax )
00883      $         \textcolor{keywordflow}{GO TO} 100
00884             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00885                laa = ( n*( n + 1 ) )/2
00886             \textcolor{keywordflow}{ELSE}
00887                laa = lda*n
00888 \textcolor{keywordflow}{            END IF}
00889             null = n.LE.0
00890 \textcolor{comment}{*}
00891             \textcolor{keywordflow}{DO} 90 ic = 1, 2
00892                uplo = ich( ic: ic )
00893 \textcolor{comment}{*}
00894 \textcolor{comment}{*              Generate the matrix A.}
00895 \textcolor{comment}{*}
00896                transl = zero
00897                \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax, aa,
00898      $                     lda, k, k, reset, transl )
00899 \textcolor{comment}{*}
00900                \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00901                   incx = inc( ix )
00902                   lx = abs( incx )*n
00903 \textcolor{comment}{*}
00904 \textcolor{comment}{*                 Generate the vector X.}
00905 \textcolor{comment}{*}
00906                   transl = half
00907                   \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
00908      $                        abs( incx ), 0, n - 1, reset, transl )
00909                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
00910                      x( n/2 ) = zero
00911                      xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
00912 \textcolor{keywordflow}{                  END IF}
00913 \textcolor{comment}{*}
00914                   \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00915                      incy = inc( iy )
00916                      ly = abs( incy )*n
00917 \textcolor{comment}{*}
00918                      \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00919                         alpha = alf( ia )
00920 \textcolor{comment}{*}
00921                         \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00922                            beta = bet( ib )
00923 \textcolor{comment}{*}
00924 \textcolor{comment}{*                          Generate the vector Y.}
00925 \textcolor{comment}{*}
00926                            transl = zero
00927                            \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
00928      $                                 abs( incy ), 0, n - 1, reset,
00929      $                                 transl )
00930 \textcolor{comment}{*}
00931                            nc = nc + 1
00932 \textcolor{comment}{*}
00933 \textcolor{comment}{*                          Save every datum before calling the}
00934 \textcolor{comment}{*                          subroutine.}
00935 \textcolor{comment}{*}
00936                            uplos = uplo
00937                            ns = n
00938                            ks = k
00939                            als = alpha
00940                            \textcolor{keywordflow}{DO} 10 i = 1, laa
00941                               as( i ) = aa( i )
00942    10                      \textcolor{keywordflow}{CONTINUE}
00943                            ldas = lda
00944                            \textcolor{keywordflow}{DO} 20 i = 1, lx
00945                               xs( i ) = xx( i )
00946    20                      \textcolor{keywordflow}{CONTINUE}
00947                            incxs = incx
00948                            bls = beta
00949                            \textcolor{keywordflow}{DO} 30 i = 1, ly
00950                               ys( i ) = yy( i )
00951    30                      \textcolor{keywordflow}{CONTINUE}
00952                            incys = incy
00953 \textcolor{comment}{*}
00954 \textcolor{comment}{*                          Call the subroutine.}
00955 \textcolor{comment}{*}
00956                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00957                               \textcolor{keywordflow}{IF}( trace )
00958      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
00959      $                           uplo, n, alpha, lda, incx, beta, incy
00960                               \textcolor{keywordflow}{IF}( rewi )
00961      $                           rewind ntra
00962                               \textcolor{keyword}{CALL }zhemv( uplo, n, alpha, aa, lda, xx,
00963      $                                    incx, beta, yy, incy )
00964                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00965                               \textcolor{keywordflow}{IF}( trace )
00966      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00967      $                           uplo, n, k, alpha, lda, incx, beta,
00968      $                           incy
00969                               \textcolor{keywordflow}{IF}( rewi )
00970      $                           rewind ntra
00971                               \textcolor{keyword}{CALL }zhbmv( uplo, n, k, alpha, aa, lda,
00972      $                                    xx, incx, beta, yy, incy )
00973                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00974                               \textcolor{keywordflow}{IF}( trace )
00975      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00976      $                           uplo, n, alpha, incx, beta, incy
00977                               \textcolor{keywordflow}{IF}( rewi )
00978      $                           rewind ntra
00979                               \textcolor{keyword}{CALL }zhpmv( uplo, n, alpha, aa, xx, incx,
00980      $                                    beta, yy, incy )
00981 \textcolor{keywordflow}{                           END IF}
00982 \textcolor{comment}{*}
00983 \textcolor{comment}{*                          Check if error-exit was taken incorrectly.}
00984 \textcolor{comment}{*}
00985                            \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00986                               \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
00987                               fatal = .true.
00988                               \textcolor{keywordflow}{GO TO} 120
00989 \textcolor{keywordflow}{                           END IF}
00990 \textcolor{comment}{*}
00991 \textcolor{comment}{*                          See what data changed inside subroutines.}
00992 \textcolor{comment}{*}
00993                            isame( 1 ) = uplo.EQ.uplos
00994                            isame( 2 ) = ns.EQ.n
00995                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00996                               isame( 3 ) = als.EQ.alpha
00997                               isame( 4 ) = lze( as, aa, laa )
00998                               isame( 5 ) = ldas.EQ.lda
00999                               isame( 6 ) = lze( xs, xx, lx )
01000                               isame( 7 ) = incxs.EQ.incx
01001                               isame( 8 ) = bls.EQ.beta
01002                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01003                                  isame( 9 ) = lze( ys, yy, ly )
01004                               \textcolor{keywordflow}{ELSE}
01005                                  isame( 9 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01006      $                                        ys, yy, abs( incy ) )
01007 \textcolor{keywordflow}{                              END IF}
01008                               isame( 10 ) = incys.EQ.incy
01009                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01010                               isame( 3 ) = ks.EQ.k
01011                               isame( 4 ) = als.EQ.alpha
01012                               isame( 5 ) = lze( as, aa, laa )
01013                               isame( 6 ) = ldas.EQ.lda
01014                               isame( 7 ) = lze( xs, xx, lx )
01015                               isame( 8 ) = incxs.EQ.incx
01016                               isame( 9 ) = bls.EQ.beta
01017                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01018                                  isame( 10 ) = lze( ys, yy, ly )
01019                               \textcolor{keywordflow}{ELSE}
01020                                  isame( 10 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01021      $                                         ys, yy, abs( incy ) )
01022 \textcolor{keywordflow}{                              END IF}
01023                               isame( 11 ) = incys.EQ.incy
01024                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01025                               isame( 3 ) = als.EQ.alpha
01026                               isame( 4 ) = lze( as, aa, laa )
01027                               isame( 5 ) = lze( xs, xx, lx )
01028                               isame( 6 ) = incxs.EQ.incx
01029                               isame( 7 ) = bls.EQ.beta
01030                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01031                                  isame( 8 ) = lze( ys, yy, ly )
01032                               \textcolor{keywordflow}{ELSE}
01033                                  isame( 8 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01034      $                                        ys, yy, abs( incy ) )
01035 \textcolor{keywordflow}{                              END IF}
01036                               isame( 9 ) = incys.EQ.incy
01037 \textcolor{keywordflow}{                           END IF}
01038 \textcolor{comment}{*}
01039 \textcolor{comment}{*                          If data was incorrectly changed, report and}
01040 \textcolor{comment}{*                          return.}
01041 \textcolor{comment}{*}
01042                            same = .true.
01043                            \textcolor{keywordflow}{DO} 40 i = 1, nargs
01044                               same = same.AND.isame( i )
01045                               \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01046      $                           \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01047    40                      \textcolor{keywordflow}{CONTINUE}
01048                            \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01049                               fatal = .true.
01050                               \textcolor{keywordflow}{GO TO} 120
01051 \textcolor{keywordflow}{                           END IF}
01052 \textcolor{comment}{*}
01053                            \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01054 \textcolor{comment}{*}
01055 \textcolor{comment}{*                             Check the result.}
01056 \textcolor{comment}{*}
01057                               \textcolor{keyword}{CALL }zmvch( \textcolor{stringliteral}{'N'}, n, n, alpha, a, nmax, x,
01058      $                                    incx, beta, y, incy, yt, g,
01059      $                                    yy, eps, err, fatal, nout,
01060      $                                    .true. )
01061                               errmax = max( errmax, err )
01062 \textcolor{comment}{*                             If got really bad answer, report and}
01063 \textcolor{comment}{*                             return.}
01064                               \textcolor{keywordflow}{IF}( fatal )
01065      $                           \textcolor{keywordflow}{GO TO} 120
01066                            \textcolor{keywordflow}{ELSE}
01067 \textcolor{comment}{*                             Avoid repeating tests with N.le.0}
01068                               \textcolor{keywordflow}{GO TO} 110
01069 \textcolor{keywordflow}{                           END IF}
01070 \textcolor{comment}{*}
01071    50                   \textcolor{keywordflow}{CONTINUE}
01072 \textcolor{comment}{*}
01073    60                \textcolor{keywordflow}{CONTINUE}
01074 \textcolor{comment}{*}
01075    70             \textcolor{keywordflow}{CONTINUE}
01076 \textcolor{comment}{*}
01077    80          \textcolor{keywordflow}{CONTINUE}
01078 \textcolor{comment}{*}
01079    90       \textcolor{keywordflow}{CONTINUE}
01080 \textcolor{comment}{*}
01081   100    \textcolor{keywordflow}{CONTINUE}
01082 \textcolor{comment}{*}
01083   110 \textcolor{keywordflow}{CONTINUE}
01084 \textcolor{comment}{*}
01085 \textcolor{comment}{*     Report result.}
01086 \textcolor{comment}{*}
01087       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01088          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01089       \textcolor{keywordflow}{ELSE}
01090          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01091 \textcolor{keywordflow}{      END IF}
01092       \textcolor{keywordflow}{GO TO} 130
01093 \textcolor{comment}{*}
01094   120 \textcolor{keywordflow}{CONTINUE}
01095       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01096       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01097          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, lda, incx,
01098      $      beta, incy
01099       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01100          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, k, alpha, lda,
01101      $      incx, beta, incy
01102       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01103          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, n, alpha, incx,
01104      $      beta, incy
01105 \textcolor{keywordflow}{      END IF}
01106 \textcolor{comment}{*}
01107   130 \textcolor{keywordflow}{CONTINUE}
01108       \textcolor{keywordflow}{RETURN}
01109 \textcolor{comment}{*}
01110  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01111      $      \textcolor{stringliteral}{'S)'} )
01112  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01113      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01114  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01115      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01116      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01117  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01118  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01119      $      f4.1, \textcolor{stringliteral}{'), AP, X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), Y,'}, i2,
01120      $      \textcolor{stringliteral}{')                .'} )
01121  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
01122      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01123      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{')         .'} )
01124  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01125      $      f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), '},
01126      $      \textcolor{stringliteral}{'Y,'}, i2, \textcolor{stringliteral}{')             .'} )
01127  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01128      $      \textcolor{stringliteral}{'******'} )
01129 \textcolor{comment}{*}
01130 \textcolor{comment}{*     End of ZCHK2.}
01131 \textcolor{comment}{*}
01132 \textcolor{keyword}{      END}
01133 \textcolor{keyword}{      SUBROUTINE }zchk3( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01134      $                  FATAL, NIDIM, IDIM, NKB, KB, NINC, INC, NMAX,
01135      $                  INCMAX, A, AA, AS, X, XX, XS, XT, G, Z )
01136 \textcolor{comment}{*}
01137 \textcolor{comment}{*  Tests ZTRMV, ZTBMV, ZTPMV, ZTRSV, ZTBSV and ZTPSV.}
01138 \textcolor{comment}{*}
01139 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01140 \textcolor{comment}{*}
01141 \textcolor{comment}{*  -- Written on 10-August-1987.}
01142 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01143 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01144 \textcolor{comment}{*}
01145 \textcolor{comment}{*     .. Parameters ..}
01146       \textcolor{keywordtype}{COMPLEX*16}         zero, half, one
01147       parameter( zero = ( 0.0d0, 0.0d0 ),
01148      $                   half = ( 0.5d0, 0.0d0 ),
01149      $                   one = ( 1.0d0, 0.0d0 ) )
01150       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
01151       parameter( rzero = 0.0d0 )
01152 \textcolor{comment}{*     .. Scalar Arguments ..}
01153       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01154       \textcolor{keywordtype}{INTEGER}            incmax, nidim, ninc, nkb, nmax, nout, ntra
01155       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01156       \textcolor{keywordtype}{CHARACTER*6}        sname
01157 \textcolor{comment}{*     .. Array Arguments ..}
01158       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ),
01159      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01160      $                   xt( nmax ), xx( nmax*incmax ), z( nmax )
01161       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
01162       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
01163 \textcolor{comment}{*     .. Local Scalars ..}
01164       \textcolor{keywordtype}{COMPLEX*16}         transl
01165       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax
01166       \textcolor{keywordtype}{INTEGER}            i, icd, ict, icu, ik, in, incx, incxs, ix, k,
01167      $                   ks, laa, lda, ldas, lx, n, nargs, nc, nk, ns
01168       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
01169       \textcolor{keywordtype}{CHARACTER*1}        diag, diags, trans, transs, uplo, uplos
01170       \textcolor{keywordtype}{CHARACTER*2}        ichd, ichu
01171       \textcolor{keywordtype}{CHARACTER*3}        icht
01172 \textcolor{comment}{*     .. Local Arrays ..}
01173       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01174 \textcolor{comment}{*     .. External Functions ..}
01175       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
01176       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
01177 \textcolor{comment}{*     .. External Subroutines ..}
01178       \textcolor{keywordtype}{EXTERNAL}           zmake, zmvch, ztbmv, ztbsv, ztpmv, ztpsv,
01179      $                   ztrmv, ztrsv
01180 \textcolor{comment}{*     .. Intrinsic Functions ..}
01181       \textcolor{keywordtype}{INTRINSIC}          abs, max
01182 \textcolor{comment}{*     .. Scalars in Common ..}
01183       \textcolor{keywordtype}{INTEGER}            infot, noutc
01184       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01185 \textcolor{comment}{*     .. Common blocks ..}
01186       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01187 \textcolor{comment}{*     .. Data statements ..}
01188       \textcolor{keyword}{DATA}               ichu/\textcolor{stringliteral}{'UL'}/, icht/\textcolor{stringliteral}{'NTC'}/, ichd/\textcolor{stringliteral}{'UN'}/
01189 \textcolor{comment}{*     .. Executable Statements ..}
01190       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'R'}
01191       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
01192       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01193 \textcolor{comment}{*     Define the number of arguments.}
01194       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01195          nargs = 8
01196       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01197          nargs = 9
01198       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01199          nargs = 7
01200 \textcolor{keywordflow}{      END IF}
01201 \textcolor{comment}{*}
01202       nc = 0
01203       reset = .true.
01204       errmax = rzero
01205 \textcolor{comment}{*     Set up zero vector for ZMVCH.}
01206       \textcolor{keywordflow}{DO} 10 i = 1, nmax
01207          z( i ) = zero
01208    10 \textcolor{keywordflow}{CONTINUE}
01209 \textcolor{comment}{*}
01210       \textcolor{keywordflow}{DO} 110 in = 1, nidim
01211          n = idim( in )
01212 \textcolor{comment}{*}
01213          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01214             nk = nkb
01215          \textcolor{keywordflow}{ELSE}
01216             nk = 1
01217 \textcolor{keywordflow}{         END IF}
01218          \textcolor{keywordflow}{DO} 100 ik = 1, nk
01219             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01220                k = kb( ik )
01221             \textcolor{keywordflow}{ELSE}
01222                k = n - 1
01223 \textcolor{keywordflow}{            END IF}
01224 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01225             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01226                lda = k + 1
01227             \textcolor{keywordflow}{ELSE}
01228                lda = n
01229 \textcolor{keywordflow}{            END IF}
01230             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01231      $         lda = lda + 1
01232 \textcolor{comment}{*           Skip tests if not enough room.}
01233             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01234      $         \textcolor{keywordflow}{GO TO} 100
01235             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01236                laa = ( n*( n + 1 ) )/2
01237             \textcolor{keywordflow}{ELSE}
01238                laa = lda*n
01239 \textcolor{keywordflow}{            END IF}
01240             null = n.LE.0
01241 \textcolor{comment}{*}
01242             \textcolor{keywordflow}{DO} 90 icu = 1, 2
01243                uplo = ichu( icu: icu )
01244 \textcolor{comment}{*}
01245                \textcolor{keywordflow}{DO} 80 ict = 1, 3
01246                   trans = icht( ict: ict )
01247 \textcolor{comment}{*}
01248                   \textcolor{keywordflow}{DO} 70 icd = 1, 2
01249                      diag = ichd( icd: icd )
01250 \textcolor{comment}{*}
01251 \textcolor{comment}{*                    Generate the matrix A.}
01252 \textcolor{comment}{*}
01253                      transl = zero
01254                      \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), uplo, diag, n, n, a,
01255      $                           nmax, aa, lda, k, k, reset, transl )
01256 \textcolor{comment}{*}
01257                      \textcolor{keywordflow}{DO} 60 ix = 1, ninc
01258                         incx = inc( ix )
01259                         lx = abs( incx )*n
01260 \textcolor{comment}{*}
01261 \textcolor{comment}{*                       Generate the vector X.}
01262 \textcolor{comment}{*}
01263                         transl = half
01264                         \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
01265      $                              abs( incx ), 0, n - 1, reset,
01266      $                              transl )
01267                         \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01268                            x( n/2 ) = zero
01269                            xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01270 \textcolor{keywordflow}{                        END IF}
01271 \textcolor{comment}{*}
01272                         nc = nc + 1
01273 \textcolor{comment}{*}
01274 \textcolor{comment}{*                       Save every datum before calling the subroutine.}
01275 \textcolor{comment}{*}
01276                         uplos = uplo
01277                         transs = trans
01278                         diags = diag
01279                         ns = n
01280                         ks = k
01281                         \textcolor{keywordflow}{DO} 20 i = 1, laa
01282                            as( i ) = aa( i )
01283    20                   \textcolor{keywordflow}{CONTINUE}
01284                         ldas = lda
01285                         \textcolor{keywordflow}{DO} 30 i = 1, lx
01286                            xs( i ) = xx( i )
01287    30                   \textcolor{keywordflow}{CONTINUE}
01288                         incxs = incx
01289 \textcolor{comment}{*}
01290 \textcolor{comment}{*                       Call the subroutine.}
01291 \textcolor{comment}{*}
01292                         \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01293                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01294                               \textcolor{keywordflow}{IF}( trace )
01295      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01296      $                           uplo, trans, diag, n, lda, incx
01297                               \textcolor{keywordflow}{IF}( rewi )
01298      $                           rewind ntra
01299                               \textcolor{keyword}{CALL }ztrmv( uplo, trans, diag, n, aa, lda,
01300      $                                    xx, incx )
01301                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01302                               \textcolor{keywordflow}{IF}( trace )
01303      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01304      $                           uplo, trans, diag, n, k, lda, incx
01305                               \textcolor{keywordflow}{IF}( rewi )
01306      $                           rewind ntra
01307                               \textcolor{keyword}{CALL }ztbmv( uplo, trans, diag, n, k, aa,
01308      $                                    lda, xx, incx )
01309                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01310                               \textcolor{keywordflow}{IF}( trace )
01311      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01312      $                           uplo, trans, diag, n, incx
01313                               \textcolor{keywordflow}{IF}( rewi )
01314      $                           rewind ntra
01315                               \textcolor{keyword}{CALL }ztpmv( uplo, trans, diag, n, aa, xx,
01316      $                                    incx )
01317 \textcolor{keywordflow}{                           END IF}
01318                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01319                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01320                               \textcolor{keywordflow}{IF}( trace )
01321      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01322      $                           uplo, trans, diag, n, lda, incx
01323                               \textcolor{keywordflow}{IF}( rewi )
01324      $                           rewind ntra
01325                               \textcolor{keyword}{CALL }ztrsv( uplo, trans, diag, n, aa, lda,
01326      $                                    xx, incx )
01327                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01328                               \textcolor{keywordflow}{IF}( trace )
01329      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01330      $                           uplo, trans, diag, n, k, lda, incx
01331                               \textcolor{keywordflow}{IF}( rewi )
01332      $                           rewind ntra
01333                               \textcolor{keyword}{CALL }ztbsv( uplo, trans, diag, n, k, aa,
01334      $                                    lda, xx, incx )
01335                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01336                               \textcolor{keywordflow}{IF}( trace )
01337      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01338      $                           uplo, trans, diag, n, incx
01339                               \textcolor{keywordflow}{IF}( rewi )
01340      $                           rewind ntra
01341                               \textcolor{keyword}{CALL }ztpsv( uplo, trans, diag, n, aa, xx,
01342      $                                    incx )
01343 \textcolor{keywordflow}{                           END IF}
01344 \textcolor{keywordflow}{                        END IF}
01345 \textcolor{comment}{*}
01346 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
01347 \textcolor{comment}{*}
01348                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01349                            \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01350                            fatal = .true.
01351                            \textcolor{keywordflow}{GO TO} 120
01352 \textcolor{keywordflow}{                        END IF}
01353 \textcolor{comment}{*}
01354 \textcolor{comment}{*                       See what data changed inside subroutines.}
01355 \textcolor{comment}{*}
01356                         isame( 1 ) = uplo.EQ.uplos
01357                         isame( 2 ) = trans.EQ.transs
01358                         isame( 3 ) = diag.EQ.diags
01359                         isame( 4 ) = ns.EQ.n
01360                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01361                            isame( 5 ) = lze( as, aa, laa )
01362                            isame( 6 ) = ldas.EQ.lda
01363                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01364                               isame( 7 ) = lze( xs, xx, lx )
01365                            \textcolor{keywordflow}{ELSE}
01366                               isame( 7 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01367      $                                     xx, abs( incx ) )
01368 \textcolor{keywordflow}{                           END IF}
01369                            isame( 8 ) = incxs.EQ.incx
01370                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01371                            isame( 5 ) = ks.EQ.k
01372                            isame( 6 ) = lze( as, aa, laa )
01373                            isame( 7 ) = ldas.EQ.lda
01374                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01375                               isame( 8 ) = lze( xs, xx, lx )
01376                            \textcolor{keywordflow}{ELSE}
01377                               isame( 8 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01378      $                                     xx, abs( incx ) )
01379 \textcolor{keywordflow}{                           END IF}
01380                            isame( 9 ) = incxs.EQ.incx
01381                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01382                            isame( 5 ) = lze( as, aa, laa )
01383                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01384                               isame( 6 ) = lze( xs, xx, lx )
01385                            \textcolor{keywordflow}{ELSE}
01386                               isame( 6 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01387      $                                     xx, abs( incx ) )
01388 \textcolor{keywordflow}{                           END IF}
01389                            isame( 7 ) = incxs.EQ.incx
01390 \textcolor{keywordflow}{                        END IF}
01391 \textcolor{comment}{*}
01392 \textcolor{comment}{*                       If data was incorrectly changed, report and}
01393 \textcolor{comment}{*                       return.}
01394 \textcolor{comment}{*}
01395                         same = .true.
01396                         \textcolor{keywordflow}{DO} 40 i = 1, nargs
01397                            same = same.AND.isame( i )
01398                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01399      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01400    40                   \textcolor{keywordflow}{CONTINUE}
01401                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01402                            fatal = .true.
01403                            \textcolor{keywordflow}{GO TO} 120
01404 \textcolor{keywordflow}{                        END IF}
01405 \textcolor{comment}{*}
01406                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01407                            \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01408 \textcolor{comment}{*}
01409 \textcolor{comment}{*                             Check the result.}
01410 \textcolor{comment}{*}
01411                               \textcolor{keyword}{CALL }zmvch( trans, n, n, one, a, nmax, x,
01412      $                                    incx, zero, z, incx, xt, g,
01413      $                                    xx, eps, err, fatal, nout,
01414      $                                    .true. )
01415                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01416 \textcolor{comment}{*}
01417 \textcolor{comment}{*                             Compute approximation to original vector.}
01418 \textcolor{comment}{*}
01419                               \textcolor{keywordflow}{DO} 50 i = 1, n
01420                                  z( i ) = xx( 1 + ( i - 1 )*
01421      $                                    abs( incx ) )
01422                                  xx( 1 + ( i - 1 )*abs( incx ) )
01423      $                              = x( i )
01424    50                         \textcolor{keywordflow}{CONTINUE}
01425                               \textcolor{keyword}{CALL }zmvch( trans, n, n, one, a, nmax, z,
01426      $                                    incx, zero, x, incx, xt, g,
01427      $                                    xx, eps, err, fatal, nout,
01428      $                                    .false. )
01429 \textcolor{keywordflow}{                           END IF}
01430                            errmax = max( errmax, err )
01431 \textcolor{comment}{*                          If got really bad answer, report and return.}
01432                            \textcolor{keywordflow}{IF}( fatal )
01433      $                        \textcolor{keywordflow}{GO TO} 120
01434                         \textcolor{keywordflow}{ELSE}
01435 \textcolor{comment}{*                          Avoid repeating tests with N.le.0.}
01436                            \textcolor{keywordflow}{GO TO} 110
01437 \textcolor{keywordflow}{                        END IF}
01438 \textcolor{comment}{*}
01439    60                \textcolor{keywordflow}{CONTINUE}
01440 \textcolor{comment}{*}
01441    70             \textcolor{keywordflow}{CONTINUE}
01442 \textcolor{comment}{*}
01443    80          \textcolor{keywordflow}{CONTINUE}
01444 \textcolor{comment}{*}
01445    90       \textcolor{keywordflow}{CONTINUE}
01446 \textcolor{comment}{*}
01447   100    \textcolor{keywordflow}{CONTINUE}
01448 \textcolor{comment}{*}
01449   110 \textcolor{keywordflow}{CONTINUE}
01450 \textcolor{comment}{*}
01451 \textcolor{comment}{*     Report result.}
01452 \textcolor{comment}{*}
01453       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01454          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01455       \textcolor{keywordflow}{ELSE}
01456          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01457 \textcolor{keywordflow}{      END IF}
01458       \textcolor{keywordflow}{GO TO} 130
01459 \textcolor{comment}{*}
01460   120 \textcolor{keywordflow}{CONTINUE}
01461       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01462       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01463          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, trans, diag, n, lda,
01464      $      incx
01465       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01466          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, trans, diag, n, k,
01467      $      lda, incx
01468       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01469          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, trans, diag, n, incx
01470 \textcolor{keywordflow}{      END IF}
01471 \textcolor{comment}{*}
01472   130 \textcolor{keywordflow}{CONTINUE}
01473       \textcolor{keywordflow}{RETURN}
01474 \textcolor{comment}{*}
01475  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01476      $      \textcolor{stringliteral}{'S)'} )
01477  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01478      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01479  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01480      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01481      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01482  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01483  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', AP, '},
01484      $      \textcolor{stringliteral}{'X,'}, i2, \textcolor{stringliteral}{')                                      .'} )
01485  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01486      $      \textcolor{stringliteral}{' A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                               .'} )
01487  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', A,'},
01488      $      i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                                   .'} )
01489  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01490      $      \textcolor{stringliteral}{'******'} )
01491 \textcolor{comment}{*}
01492 \textcolor{comment}{*     End of ZCHK3.}
01493 \textcolor{comment}{*}
01494 \textcolor{keyword}{      END}
01495 \textcolor{keyword}{      SUBROUTINE }zchk4( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01496      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01497      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01498      $                  Z )
01499 \textcolor{comment}{*}
01500 \textcolor{comment}{*  Tests ZGERC and ZGERU.}
01501 \textcolor{comment}{*}
01502 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01503 \textcolor{comment}{*}
01504 \textcolor{comment}{*  -- Written on 10-August-1987.}
01505 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01506 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01507 \textcolor{comment}{*}
01508 \textcolor{comment}{*     .. Parameters ..}
01509       \textcolor{keywordtype}{COMPLEX*16}         zero, half, one
01510       parameter( zero = ( 0.0d0, 0.0d0 ),
01511      $                   half = ( 0.5d0, 0.0d0 ),
01512      $                   one = ( 1.0d0, 0.0d0 ) )
01513       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
01514       parameter( rzero = 0.0d0 )
01515 \textcolor{comment}{*     .. Scalar Arguments ..}
01516       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01517       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01518       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01519       \textcolor{keywordtype}{CHARACTER*6}        sname
01520 \textcolor{comment}{*     .. Array Arguments ..}
01521       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01522      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01523      $                   xx( nmax*incmax ), y( nmax ),
01524      $                   ys( nmax*incmax ), yt( nmax ),
01525      $                   yy( nmax*incmax ), z( nmax )
01526       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
01527       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01528 \textcolor{comment}{*     .. Local Scalars ..}
01529       \textcolor{keywordtype}{COMPLEX*16}         alpha, als, transl
01530       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax
01531       \textcolor{keywordtype}{INTEGER}            i, ia, im, in, incx, incxs, incy, incys, ix,
01532      $                   iy, j, laa, lda, ldas, lx, ly, m, ms, n, nargs,
01533      $                   nc, nd, ns
01534       \textcolor{keywordtype}{LOGICAL}            conj, null, reset, same
01535 \textcolor{comment}{*     .. Local Arrays ..}
01536       \textcolor{keywordtype}{COMPLEX*16}         w( 1 )
01537       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01538 \textcolor{comment}{*     .. External Functions ..}
01539       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
01540       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
01541 \textcolor{comment}{*     .. External Subroutines ..}
01542       \textcolor{keywordtype}{EXTERNAL}           zgerc, zgeru, zmake, zmvch
01543 \textcolor{comment}{*     .. Intrinsic Functions ..}
01544       \textcolor{keywordtype}{INTRINSIC}          abs, dconjg, max, min
01545 \textcolor{comment}{*     .. Scalars in Common ..}
01546       \textcolor{keywordtype}{INTEGER}            infot, noutc
01547       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01548 \textcolor{comment}{*     .. Common blocks ..}
01549       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01550 \textcolor{comment}{*     .. Executable Statements ..}
01551       conj = sname( 5: 5 ).EQ.\textcolor{stringliteral}{'C'}
01552 \textcolor{comment}{*     Define the number of arguments.}
01553       nargs = 9
01554 \textcolor{comment}{*}
01555       nc = 0
01556       reset = .true.
01557       errmax = rzero
01558 \textcolor{comment}{*}
01559       \textcolor{keywordflow}{DO} 120 in = 1, nidim
01560          n = idim( in )
01561          nd = n/2 + 1
01562 \textcolor{comment}{*}
01563          \textcolor{keywordflow}{DO} 110 im = 1, 2
01564             \textcolor{keywordflow}{IF}( im.EQ.1 )
01565      $         m = max( n - nd, 0 )
01566             \textcolor{keywordflow}{IF}( im.EQ.2 )
01567      $         m = min( n + nd, nmax )
01568 \textcolor{comment}{*}
01569 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01570             lda = m
01571             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01572      $         lda = lda + 1
01573 \textcolor{comment}{*           Skip tests if not enough room.}
01574             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01575      $         \textcolor{keywordflow}{GO TO} 110
01576             laa = lda*n
01577             null = n.LE.0.OR.m.LE.0
01578 \textcolor{comment}{*}
01579             \textcolor{keywordflow}{DO} 100 ix = 1, ninc
01580                incx = inc( ix )
01581                lx = abs( incx )*m
01582 \textcolor{comment}{*}
01583 \textcolor{comment}{*              Generate the vector X.}
01584 \textcolor{comment}{*}
01585                transl = half
01586                \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, m, x, 1, xx, abs( incx ),
01587      $                     0, m - 1, reset, transl )
01588                \textcolor{keywordflow}{IF}( m.GT.1 )\textcolor{keywordflow}{THEN}
01589                   x( m/2 ) = zero
01590                   xx( 1 + abs( incx )*( m/2 - 1 ) ) = zero
01591 \textcolor{keywordflow}{               END IF}
01592 \textcolor{comment}{*}
01593                \textcolor{keywordflow}{DO} 90 iy = 1, ninc
01594                   incy = inc( iy )
01595                   ly = abs( incy )*n
01596 \textcolor{comment}{*}
01597 \textcolor{comment}{*                 Generate the vector Y.}
01598 \textcolor{comment}{*}
01599                   transl = zero
01600                   \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
01601      $                        abs( incy ), 0, n - 1, reset, transl )
01602                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01603                      y( n/2 ) = zero
01604                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
01605 \textcolor{keywordflow}{                  END IF}
01606 \textcolor{comment}{*}
01607                   \textcolor{keywordflow}{DO} 80 ia = 1, nalf
01608                      alpha = alf( ia )
01609 \textcolor{comment}{*}
01610 \textcolor{comment}{*                    Generate the matrix A.}
01611 \textcolor{comment}{*}
01612                      transl = zero
01613                      \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax,
01614      $                           aa, lda, m - 1, n - 1, reset, transl )
01615 \textcolor{comment}{*}
01616                      nc = nc + 1
01617 \textcolor{comment}{*}
01618 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
01619 \textcolor{comment}{*}
01620                      ms = m
01621                      ns = n
01622                      als = alpha
01623                      \textcolor{keywordflow}{DO} 10 i = 1, laa
01624                         as( i ) = aa( i )
01625    10                \textcolor{keywordflow}{CONTINUE}
01626                      ldas = lda
01627                      \textcolor{keywordflow}{DO} 20 i = 1, lx
01628                         xs( i ) = xx( i )
01629    20                \textcolor{keywordflow}{CONTINUE}
01630                      incxs = incx
01631                      \textcolor{keywordflow}{DO} 30 i = 1, ly
01632                         ys( i ) = yy( i )
01633    30                \textcolor{keywordflow}{CONTINUE}
01634                      incys = incy
01635 \textcolor{comment}{*}
01636 \textcolor{comment}{*                    Call the subroutine.}
01637 \textcolor{comment}{*}
01638                      \textcolor{keywordflow}{IF}( trace )
01639      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, m, n,
01640      $                  alpha, incx, incy, lda
01641                      \textcolor{keywordflow}{IF}( conj )\textcolor{keywordflow}{THEN}
01642                         \textcolor{keywordflow}{IF}( rewi )
01643      $                     rewind ntra
01644                         \textcolor{keyword}{CALL }zgerc( m, n, alpha, xx, incx, yy, incy, aa,
01645      $                              lda )
01646                      \textcolor{keywordflow}{ELSE}
01647                         \textcolor{keywordflow}{IF}( rewi )
01648      $                     rewind ntra
01649                         \textcolor{keyword}{CALL }zgeru( m, n, alpha, xx, incx, yy, incy, aa,
01650      $                              lda )
01651 \textcolor{keywordflow}{                     END IF}
01652 \textcolor{comment}{*}
01653 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
01654 \textcolor{comment}{*}
01655                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01656                         \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
01657                         fatal = .true.
01658                         \textcolor{keywordflow}{GO TO} 140
01659 \textcolor{keywordflow}{                     END IF}
01660 \textcolor{comment}{*}
01661 \textcolor{comment}{*                    See what data changed inside subroutine.}
01662 \textcolor{comment}{*}
01663                      isame( 1 ) = ms.EQ.m
01664                      isame( 2 ) = ns.EQ.n
01665                      isame( 3 ) = als.EQ.alpha
01666                      isame( 4 ) = lze( xs, xx, lx )
01667                      isame( 5 ) = incxs.EQ.incx
01668                      isame( 6 ) = lze( ys, yy, ly )
01669                      isame( 7 ) = incys.EQ.incy
01670                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01671                         isame( 8 ) = lze( as, aa, laa )
01672                      \textcolor{keywordflow}{ELSE}
01673                         isame( 8 ) = lzeres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, as, aa,
01674      $                               lda )
01675 \textcolor{keywordflow}{                     END IF}
01676                      isame( 9 ) = ldas.EQ.lda
01677 \textcolor{comment}{*}
01678 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
01679 \textcolor{comment}{*}
01680                      same = .true.
01681                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
01682                         same = same.AND.isame( i )
01683                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01684      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01685    40                \textcolor{keywordflow}{CONTINUE}
01686                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01687                         fatal = .true.
01688                         \textcolor{keywordflow}{GO TO} 140
01689 \textcolor{keywordflow}{                     END IF}
01690 \textcolor{comment}{*}
01691                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01692 \textcolor{comment}{*}
01693 \textcolor{comment}{*                       Check the result column by column.}
01694 \textcolor{comment}{*}
01695                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01696                            \textcolor{keywordflow}{DO} 50 i = 1, m
01697                               z( i ) = x( i )
01698    50                      \textcolor{keywordflow}{CONTINUE}
01699                         \textcolor{keywordflow}{ELSE}
01700                            \textcolor{keywordflow}{DO} 60 i = 1, m
01701                               z( i ) = x( m - i + 1 )
01702    60                      \textcolor{keywordflow}{CONTINUE}
01703 \textcolor{keywordflow}{                        END IF}
01704                         \textcolor{keywordflow}{DO} 70 j = 1, n
01705                            \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
01706                               w( 1 ) = y( j )
01707                            \textcolor{keywordflow}{ELSE}
01708                               w( 1 ) = y( n - j + 1 )
01709 \textcolor{keywordflow}{                           END IF}
01710                            \textcolor{keywordflow}{IF}( conj )
01711      $                        w( 1 ) = dconjg( w( 1 ) )
01712                            \textcolor{keyword}{CALL }zmvch( \textcolor{stringliteral}{'N'}, m, 1, alpha, z, nmax, w, 1,
01713      $                                 one, a( 1, j ), 1, yt, g,
01714      $                                 aa( 1 + ( j - 1 )*lda ), eps,
01715      $                                 err, fatal, nout, .true. )
01716                            errmax = max( errmax, err )
01717 \textcolor{comment}{*                          If got really bad answer, report and return.}
01718                            \textcolor{keywordflow}{IF}( fatal )
01719      $                        \textcolor{keywordflow}{GO TO} 130
01720    70                   \textcolor{keywordflow}{CONTINUE}
01721                      \textcolor{keywordflow}{ELSE}
01722 \textcolor{comment}{*                       Avoid repeating tests with M.le.0 or N.le.0.}
01723                         \textcolor{keywordflow}{GO TO} 110
01724 \textcolor{keywordflow}{                     END IF}
01725 \textcolor{comment}{*}
01726    80             \textcolor{keywordflow}{CONTINUE}
01727 \textcolor{comment}{*}
01728    90          \textcolor{keywordflow}{CONTINUE}
01729 \textcolor{comment}{*}
01730   100       \textcolor{keywordflow}{CONTINUE}
01731 \textcolor{comment}{*}
01732   110    \textcolor{keywordflow}{CONTINUE}
01733 \textcolor{comment}{*}
01734   120 \textcolor{keywordflow}{CONTINUE}
01735 \textcolor{comment}{*}
01736 \textcolor{comment}{*     Report result.}
01737 \textcolor{comment}{*}
01738       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01739          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01740       \textcolor{keywordflow}{ELSE}
01741          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01742 \textcolor{keywordflow}{      END IF}
01743       \textcolor{keywordflow}{GO TO} 150
01744 \textcolor{comment}{*}
01745   130 \textcolor{keywordflow}{CONTINUE}
01746       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01747 \textcolor{comment}{*}
01748   140 \textcolor{keywordflow}{CONTINUE}
01749       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01750       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, m, n, alpha, incx, incy, lda
01751 \textcolor{comment}{*}
01752   150 \textcolor{keywordflow}{CONTINUE}
01753       \textcolor{keywordflow}{RETURN}
01754 \textcolor{comment}{*}
01755  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01756      $      \textcolor{stringliteral}{'S)'} )
01757  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01758      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01759  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01760      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01761      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01762  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01763  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
01764  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1,
01765      $      \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                   '},
01766      $      \textcolor{stringliteral}{'      .'} )
01767  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01768      $      \textcolor{stringliteral}{'******'} )
01769 \textcolor{comment}{*}
01770 \textcolor{comment}{*     End of ZCHK4.}
01771 \textcolor{comment}{*}
01772 \textcolor{keyword}{      END}
01773 \textcolor{keyword}{      SUBROUTINE }zchk5( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01774      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01775      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01776      $                  Z )
01777 \textcolor{comment}{*}
01778 \textcolor{comment}{*  Tests ZHER and ZHPR.}
01779 \textcolor{comment}{*}
01780 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01781 \textcolor{comment}{*}
01782 \textcolor{comment}{*  -- Written on 10-August-1987.}
01783 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01784 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01785 \textcolor{comment}{*}
01786 \textcolor{comment}{*     .. Parameters ..}
01787       \textcolor{keywordtype}{COMPLEX*16}         zero, half, one
01788       parameter( zero = ( 0.0d0, 0.0d0 ),
01789      $                   half = ( 0.5d0, 0.0d0 ),
01790      $                   one = ( 1.0d0, 0.0d0 ) )
01791       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
01792       parameter( rzero = 0.0d0 )
01793 \textcolor{comment}{*     .. Scalar Arguments ..}
01794       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01795       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01796       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01797       \textcolor{keywordtype}{CHARACTER*6}        sname
01798 \textcolor{comment}{*     .. Array Arguments ..}
01799       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01800      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01801      $                   xx( nmax*incmax ), y( nmax ),
01802      $                   ys( nmax*incmax ), yt( nmax ),
01803      $                   yy( nmax*incmax ), z( nmax )
01804       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
01805       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01806 \textcolor{comment}{*     .. Local Scalars ..}
01807       \textcolor{keywordtype}{COMPLEX*16}         alpha, transl
01808       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax, ralpha, rals
01809       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, ix, j, ja, jj, laa,
01810      $                   lda, ldas, lj, lx, n, nargs, nc, ns
01811       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
01812       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
01813       \textcolor{keywordtype}{CHARACTER*2}        ich
01814 \textcolor{comment}{*     .. Local Arrays ..}
01815       \textcolor{keywordtype}{COMPLEX*16}         w( 1 )
01816       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01817 \textcolor{comment}{*     .. External Functions ..}
01818       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
01819       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
01820 \textcolor{comment}{*     .. External Subroutines ..}
01821       \textcolor{keywordtype}{EXTERNAL}           zher, zhpr, zmake, zmvch
01822 \textcolor{comment}{*     .. Intrinsic Functions ..}
01823       \textcolor{keywordtype}{INTRINSIC}          abs, dble, dcmplx, dconjg, max
01824 \textcolor{comment}{*     .. Scalars in Common ..}
01825       \textcolor{keywordtype}{INTEGER}            infot, noutc
01826       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01827 \textcolor{comment}{*     .. Common blocks ..}
01828       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01829 \textcolor{comment}{*     .. Data statements ..}
01830       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
01831 \textcolor{comment}{*     .. Executable Statements ..}
01832       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
01833       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01834 \textcolor{comment}{*     Define the number of arguments.}
01835       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01836          nargs = 7
01837       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01838          nargs = 6
01839 \textcolor{keywordflow}{      END IF}
01840 \textcolor{comment}{*}
01841       nc = 0
01842       reset = .true.
01843       errmax = rzero
01844 \textcolor{comment}{*}
01845       \textcolor{keywordflow}{DO} 100 in = 1, nidim
01846          n = idim( in )
01847 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
01848          lda = n
01849          \textcolor{keywordflow}{IF}( lda.LT.nmax )
01850      $      lda = lda + 1
01851 \textcolor{comment}{*        Skip tests if not enough room.}
01852          \textcolor{keywordflow}{IF}( lda.GT.nmax )
01853      $      \textcolor{keywordflow}{GO TO} 100
01854          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01855             laa = ( n*( n + 1 ) )/2
01856          \textcolor{keywordflow}{ELSE}
01857             laa = lda*n
01858 \textcolor{keywordflow}{         END IF}
01859 \textcolor{comment}{*}
01860          \textcolor{keywordflow}{DO} 90 ic = 1, 2
01861             uplo = ich( ic: ic )
01862             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
01863 \textcolor{comment}{*}
01864             \textcolor{keywordflow}{DO} 80 ix = 1, ninc
01865                incx = inc( ix )
01866                lx = abs( incx )*n
01867 \textcolor{comment}{*}
01868 \textcolor{comment}{*              Generate the vector X.}
01869 \textcolor{comment}{*}
01870                transl = half
01871                \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
01872      $                     0, n - 1, reset, transl )
01873                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01874                   x( n/2 ) = zero
01875                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01876 \textcolor{keywordflow}{               END IF}
01877 \textcolor{comment}{*}
01878                \textcolor{keywordflow}{DO} 70 ia = 1, nalf
01879                   ralpha = dble( alf( ia ) )
01880                   alpha = dcmplx( ralpha, rzero )
01881                   null = n.LE.0.OR.ralpha.EQ.rzero
01882 \textcolor{comment}{*}
01883 \textcolor{comment}{*                 Generate the matrix A.}
01884 \textcolor{comment}{*}
01885                   transl = zero
01886                   \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax,
01887      $                        aa, lda, n - 1, n - 1, reset, transl )
01888 \textcolor{comment}{*}
01889                   nc = nc + 1
01890 \textcolor{comment}{*}
01891 \textcolor{comment}{*                 Save every datum before calling the subroutine.}
01892 \textcolor{comment}{*}
01893                   uplos = uplo
01894                   ns = n
01895                   rals = ralpha
01896                   \textcolor{keywordflow}{DO} 10 i = 1, laa
01897                      as( i ) = aa( i )
01898    10             \textcolor{keywordflow}{CONTINUE}
01899                   ldas = lda
01900                   \textcolor{keywordflow}{DO} 20 i = 1, lx
01901                      xs( i ) = xx( i )
01902    20             \textcolor{keywordflow}{CONTINUE}
01903                   incxs = incx
01904 \textcolor{comment}{*}
01905 \textcolor{comment}{*                 Call the subroutine.}
01906 \textcolor{comment}{*}
01907                   \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01908                      \textcolor{keywordflow}{IF}( trace )
01909      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
01910      $                  ralpha, incx, lda
01911                      \textcolor{keywordflow}{IF}( rewi )
01912      $                  rewind ntra
01913                      \textcolor{keyword}{CALL }zher( uplo, n, ralpha, xx, incx, aa, lda )
01914                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01915                      \textcolor{keywordflow}{IF}( trace )
01916      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
01917      $                  ralpha, incx
01918                      \textcolor{keywordflow}{IF}( rewi )
01919      $                  rewind ntra
01920                      \textcolor{keyword}{CALL }zhpr( uplo, n, ralpha, xx, incx, aa )
01921 \textcolor{keywordflow}{                  END IF}
01922 \textcolor{comment}{*}
01923 \textcolor{comment}{*                 Check if error-exit was taken incorrectly.}
01924 \textcolor{comment}{*}
01925                   \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01926                      \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01927                      fatal = .true.
01928                      \textcolor{keywordflow}{GO TO} 120
01929 \textcolor{keywordflow}{                  END IF}
01930 \textcolor{comment}{*}
01931 \textcolor{comment}{*                 See what data changed inside subroutines.}
01932 \textcolor{comment}{*}
01933                   isame( 1 ) = uplo.EQ.uplos
01934                   isame( 2 ) = ns.EQ.n
01935                   isame( 3 ) = rals.EQ.ralpha
01936                   isame( 4 ) = lze( xs, xx, lx )
01937                   isame( 5 ) = incxs.EQ.incx
01938                   \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01939                      isame( 6 ) = lze( as, aa, laa )
01940                   \textcolor{keywordflow}{ELSE}
01941                      isame( 6 ) = lzeres( sname( 2: 3 ), uplo, n, n, as,
01942      $                            aa, lda )
01943 \textcolor{keywordflow}{                  END IF}
01944                   \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
01945                      isame( 7 ) = ldas.EQ.lda
01946 \textcolor{keywordflow}{                  END IF}
01947 \textcolor{comment}{*}
01948 \textcolor{comment}{*                 If data was incorrectly changed, report and return.}
01949 \textcolor{comment}{*}
01950                   same = .true.
01951                   \textcolor{keywordflow}{DO} 30 i = 1, nargs
01952                      same = same.AND.isame( i )
01953                      \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01954      $                  \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01955    30             \textcolor{keywordflow}{CONTINUE}
01956                   \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01957                      fatal = .true.
01958                      \textcolor{keywordflow}{GO TO} 120
01959 \textcolor{keywordflow}{                  END IF}
01960 \textcolor{comment}{*}
01961                   \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01962 \textcolor{comment}{*}
01963 \textcolor{comment}{*                    Check the result column by column.}
01964 \textcolor{comment}{*}
01965                      \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01966                         \textcolor{keywordflow}{DO} 40 i = 1, n
01967                            z( i ) = x( i )
01968    40                   \textcolor{keywordflow}{CONTINUE}
01969                      \textcolor{keywordflow}{ELSE}
01970                         \textcolor{keywordflow}{DO} 50 i = 1, n
01971                            z( i ) = x( n - i + 1 )
01972    50                   \textcolor{keywordflow}{CONTINUE}
01973 \textcolor{keywordflow}{                     END IF}
01974                      ja = 1
01975                      \textcolor{keywordflow}{DO} 60 j = 1, n
01976                         w( 1 ) = dconjg( z( j ) )
01977                         \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01978                            jj = 1
01979                            lj = j
01980                         \textcolor{keywordflow}{ELSE}
01981                            jj = j
01982                            lj = n - j + 1
01983 \textcolor{keywordflow}{                        END IF}
01984                         \textcolor{keyword}{CALL }zmvch( \textcolor{stringliteral}{'N'}, lj, 1, alpha, z( jj ), lj, w,
01985      $                              1, one, a( jj, j ), 1, yt, g,
01986      $                              aa( ja ), eps, err, fatal, nout,
01987      $                              .true. )
01988                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01989                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01990                               ja = ja + lda
01991                            \textcolor{keywordflow}{ELSE}
01992                               ja = ja + lda + 1
01993 \textcolor{keywordflow}{                           END IF}
01994                         \textcolor{keywordflow}{ELSE}
01995                            ja = ja + lj
01996 \textcolor{keywordflow}{                        END IF}
01997                         errmax = max( errmax, err )
01998 \textcolor{comment}{*                       If got really bad answer, report and return.}
01999                         \textcolor{keywordflow}{IF}( fatal )
02000      $                     \textcolor{keywordflow}{GO TO} 110
02001    60                \textcolor{keywordflow}{CONTINUE}
02002                   \textcolor{keywordflow}{ELSE}
02003 \textcolor{comment}{*                    Avoid repeating tests if N.le.0.}
02004                      \textcolor{keywordflow}{IF}( n.LE.0 )
02005      $                  \textcolor{keywordflow}{GO TO} 100
02006 \textcolor{keywordflow}{                  END IF}
02007 \textcolor{comment}{*}
02008    70          \textcolor{keywordflow}{CONTINUE}
02009 \textcolor{comment}{*}
02010    80       \textcolor{keywordflow}{CONTINUE}
02011 \textcolor{comment}{*}
02012    90    \textcolor{keywordflow}{CONTINUE}
02013 \textcolor{comment}{*}
02014   100 \textcolor{keywordflow}{CONTINUE}
02015 \textcolor{comment}{*}
02016 \textcolor{comment}{*     Report result.}
02017 \textcolor{comment}{*}
02018       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
02019          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
02020       \textcolor{keywordflow}{ELSE}
02021          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
02022 \textcolor{keywordflow}{      END IF}
02023       \textcolor{keywordflow}{GO TO} 130
02024 \textcolor{comment}{*}
02025   110 \textcolor{keywordflow}{CONTINUE}
02026       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
02027 \textcolor{comment}{*}
02028   120 \textcolor{keywordflow}{CONTINUE}
02029       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
02030       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02031          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, ralpha, incx, lda
02032       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02033          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, ralpha, incx
02034 \textcolor{keywordflow}{      END IF}
02035 \textcolor{comment}{*}
02036   130 \textcolor{keywordflow}{CONTINUE}
02037       \textcolor{keywordflow}{RETURN}
02038 \textcolor{comment}{*}
02039  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
02040      $      \textcolor{stringliteral}{'S)'} )
02041  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
02042      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
02043  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
02044      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
02045      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
02046  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
02047  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02048  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02049      $      i2, \textcolor{stringliteral}{', AP)                                         .'} )
02050  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02051      $      i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                                      .'} )
02052  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02053      $      \textcolor{stringliteral}{'******'} )
02054 \textcolor{comment}{*}
02055 \textcolor{comment}{*     End of ZCHK5.}
02056 \textcolor{comment}{*}
02057 \textcolor{keyword}{      END}
02058 \textcolor{keyword}{      SUBROUTINE }zchk6( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
02059      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
02060      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
02061      $                  Z )
02062 \textcolor{comment}{*}
02063 \textcolor{comment}{*  Tests ZHER2 and ZHPR2.}
02064 \textcolor{comment}{*}
02065 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02066 \textcolor{comment}{*}
02067 \textcolor{comment}{*  -- Written on 10-August-1987.}
02068 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02069 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02070 \textcolor{comment}{*}
02071 \textcolor{comment}{*     .. Parameters ..}
02072       \textcolor{keywordtype}{COMPLEX*16}         zero, half, one
02073       parameter( zero = ( 0.0d0, 0.0d0 ),
02074      $                   half = ( 0.5d0, 0.0d0 ),
02075      $                   one = ( 1.0d0, 0.0d0 ) )
02076       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
02077       parameter( rzero = 0.0d0 )
02078 \textcolor{comment}{*     .. Scalar Arguments ..}
02079       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
02080       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
02081       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
02082       \textcolor{keywordtype}{CHARACTER*6}        sname
02083 \textcolor{comment}{*     .. Array Arguments ..}
02084       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
02085      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
02086      $                   xx( nmax*incmax ), y( nmax ),
02087      $                   ys( nmax*incmax ), yt( nmax ),
02088      $                   yy( nmax*incmax ), z( nmax, 2 )
02089       \textcolor{keywordtype}{DOUBLE PRECISION}   g( nmax )
02090       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
02091 \textcolor{comment}{*     .. Local Scalars ..}
02092       \textcolor{keywordtype}{COMPLEX*16}         alpha, als, transl
02093       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax
02094       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, incy, incys, ix,
02095      $                   iy, j, ja, jj, laa, lda, ldas, lj, lx, ly, n,
02096      $                   nargs, nc, ns
02097       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
02098       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
02099       \textcolor{keywordtype}{CHARACTER*2}        ich
02100 \textcolor{comment}{*     .. Local Arrays ..}
02101       \textcolor{keywordtype}{COMPLEX*16}         w( 2 )
02102       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
02103 \textcolor{comment}{*     .. External Functions ..}
02104       \textcolor{keywordtype}{LOGICAL}            lze, lzeres
02105       \textcolor{keywordtype}{EXTERNAL}           lze, lzeres
02106 \textcolor{comment}{*     .. External Subroutines ..}
02107       \textcolor{keywordtype}{EXTERNAL}           zher2, zhpr2, zmake, zmvch
02108 \textcolor{comment}{*     .. Intrinsic Functions ..}
02109       \textcolor{keywordtype}{INTRINSIC}          abs, dconjg, max
02110 \textcolor{comment}{*     .. Scalars in Common ..}
02111       \textcolor{keywordtype}{INTEGER}            infot, noutc
02112       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02113 \textcolor{comment}{*     .. Common blocks ..}
02114       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02115 \textcolor{comment}{*     .. Data statements ..}
02116       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
02117 \textcolor{comment}{*     .. Executable Statements ..}
02118       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
02119       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
02120 \textcolor{comment}{*     Define the number of arguments.}
02121       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02122          nargs = 9
02123       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02124          nargs = 8
02125 \textcolor{keywordflow}{      END IF}
02126 \textcolor{comment}{*}
02127       nc = 0
02128       reset = .true.
02129       errmax = rzero
02130 \textcolor{comment}{*}
02131       \textcolor{keywordflow}{DO} 140 in = 1, nidim
02132          n = idim( in )
02133 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
02134          lda = n
02135          \textcolor{keywordflow}{IF}( lda.LT.nmax )
02136      $      lda = lda + 1
02137 \textcolor{comment}{*        Skip tests if not enough room.}
02138          \textcolor{keywordflow}{IF}( lda.GT.nmax )
02139      $      \textcolor{keywordflow}{GO TO} 140
02140          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02141             laa = ( n*( n + 1 ) )/2
02142          \textcolor{keywordflow}{ELSE}
02143             laa = lda*n
02144 \textcolor{keywordflow}{         END IF}
02145 \textcolor{comment}{*}
02146          \textcolor{keywordflow}{DO} 130 ic = 1, 2
02147             uplo = ich( ic: ic )
02148             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
02149 \textcolor{comment}{*}
02150             \textcolor{keywordflow}{DO} 120 ix = 1, ninc
02151                incx = inc( ix )
02152                lx = abs( incx )*n
02153 \textcolor{comment}{*}
02154 \textcolor{comment}{*              Generate the vector X.}
02155 \textcolor{comment}{*}
02156                transl = half
02157                \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
02158      $                     0, n - 1, reset, transl )
02159                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02160                   x( n/2 ) = zero
02161                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
02162 \textcolor{keywordflow}{               END IF}
02163 \textcolor{comment}{*}
02164                \textcolor{keywordflow}{DO} 110 iy = 1, ninc
02165                   incy = inc( iy )
02166                   ly = abs( incy )*n
02167 \textcolor{comment}{*}
02168 \textcolor{comment}{*                 Generate the vector Y.}
02169 \textcolor{comment}{*}
02170                   transl = zero
02171                   \textcolor{keyword}{CALL }zmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
02172      $                        abs( incy ), 0, n - 1, reset, transl )
02173                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02174                      y( n/2 ) = zero
02175                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
02176 \textcolor{keywordflow}{                  END IF}
02177 \textcolor{comment}{*}
02178                   \textcolor{keywordflow}{DO} 100 ia = 1, nalf
02179                      alpha = alf( ia )
02180                      null = n.LE.0.OR.alpha.EQ.zero
02181 \textcolor{comment}{*}
02182 \textcolor{comment}{*                    Generate the matrix A.}
02183 \textcolor{comment}{*}
02184                      transl = zero
02185                      \textcolor{keyword}{CALL }zmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a,
02186      $                           nmax, aa, lda, n - 1, n - 1, reset,
02187      $                           transl )
02188 \textcolor{comment}{*}
02189                      nc = nc + 1
02190 \textcolor{comment}{*}
02191 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
02192 \textcolor{comment}{*}
02193                      uplos = uplo
02194                      ns = n
02195                      als = alpha
02196                      \textcolor{keywordflow}{DO} 10 i = 1, laa
02197                         as( i ) = aa( i )
02198    10                \textcolor{keywordflow}{CONTINUE}
02199                      ldas = lda
02200                      \textcolor{keywordflow}{DO} 20 i = 1, lx
02201                         xs( i ) = xx( i )
02202    20                \textcolor{keywordflow}{CONTINUE}
02203                      incxs = incx
02204                      \textcolor{keywordflow}{DO} 30 i = 1, ly
02205                         ys( i ) = yy( i )
02206    30                \textcolor{keywordflow}{CONTINUE}
02207                      incys = incy
02208 \textcolor{comment}{*}
02209 \textcolor{comment}{*                    Call the subroutine.}
02210 \textcolor{comment}{*}
02211                      \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02212                         \textcolor{keywordflow}{IF}( trace )
02213      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
02214      $                     alpha, incx, incy, lda
02215                         \textcolor{keywordflow}{IF}( rewi )
02216      $                     rewind ntra
02217                         \textcolor{keyword}{CALL }zher2( uplo, n, alpha, xx, incx, yy, incy,
02218      $                              aa, lda )
02219                      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02220                         \textcolor{keywordflow}{IF}( trace )
02221      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
02222      $                     alpha, incx, incy
02223                         \textcolor{keywordflow}{IF}( rewi )
02224      $                     rewind ntra
02225                         \textcolor{keyword}{CALL }zhpr2( uplo, n, alpha, xx, incx, yy, incy,
02226      $                              aa )
02227 \textcolor{keywordflow}{                     END IF}
02228 \textcolor{comment}{*}
02229 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
02230 \textcolor{comment}{*}
02231                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
02232                         \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
02233                         fatal = .true.
02234                         \textcolor{keywordflow}{GO TO} 160
02235 \textcolor{keywordflow}{                     END IF}
02236 \textcolor{comment}{*}
02237 \textcolor{comment}{*                    See what data changed inside subroutines.}
02238 \textcolor{comment}{*}
02239                      isame( 1 ) = uplo.EQ.uplos
02240                      isame( 2 ) = ns.EQ.n
02241                      isame( 3 ) = als.EQ.alpha
02242                      isame( 4 ) = lze( xs, xx, lx )
02243                      isame( 5 ) = incxs.EQ.incx
02244                      isame( 6 ) = lze( ys, yy, ly )
02245                      isame( 7 ) = incys.EQ.incy
02246                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
02247                         isame( 8 ) = lze( as, aa, laa )
02248                      \textcolor{keywordflow}{ELSE}
02249                         isame( 8 ) = lzeres( sname( 2: 3 ), uplo, n, n,
02250      $                               as, aa, lda )
02251 \textcolor{keywordflow}{                     END IF}
02252                      \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
02253                         isame( 9 ) = ldas.EQ.lda
02254 \textcolor{keywordflow}{                     END IF}
02255 \textcolor{comment}{*}
02256 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
02257 \textcolor{comment}{*}
02258                      same = .true.
02259                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
02260                         same = same.AND.isame( i )
02261                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
02262      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
02263    40                \textcolor{keywordflow}{CONTINUE}
02264                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
02265                         fatal = .true.
02266                         \textcolor{keywordflow}{GO TO} 160
02267 \textcolor{keywordflow}{                     END IF}
02268 \textcolor{comment}{*}
02269                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
02270 \textcolor{comment}{*}
02271 \textcolor{comment}{*                       Check the result column by column.}
02272 \textcolor{comment}{*}
02273                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
02274                            \textcolor{keywordflow}{DO} 50 i = 1, n
02275                               z( i, 1 ) = x( i )
02276    50                      \textcolor{keywordflow}{CONTINUE}
02277                         \textcolor{keywordflow}{ELSE}
02278                            \textcolor{keywordflow}{DO} 60 i = 1, n
02279                               z( i, 1 ) = x( n - i + 1 )
02280    60                      \textcolor{keywordflow}{CONTINUE}
02281 \textcolor{keywordflow}{                        END IF}
02282                         \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
02283                            \textcolor{keywordflow}{DO} 70 i = 1, n
02284                               z( i, 2 ) = y( i )
02285    70                      \textcolor{keywordflow}{CONTINUE}
02286                         \textcolor{keywordflow}{ELSE}
02287                            \textcolor{keywordflow}{DO} 80 i = 1, n
02288                               z( i, 2 ) = y( n - i + 1 )
02289    80                      \textcolor{keywordflow}{CONTINUE}
02290 \textcolor{keywordflow}{                        END IF}
02291                         ja = 1
02292                         \textcolor{keywordflow}{DO} 90 j = 1, n
02293                            w( 1 ) = alpha*dconjg( z( j, 2 ) )
02294                            w( 2 ) = dconjg( alpha )*dconjg( z( j, 1 ) )
02295                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02296                               jj = 1
02297                               lj = j
02298                            \textcolor{keywordflow}{ELSE}
02299                               jj = j
02300                               lj = n - j + 1
02301 \textcolor{keywordflow}{                           END IF}
02302                            \textcolor{keyword}{CALL }zmvch( \textcolor{stringliteral}{'N'}, lj, 2, one, z( jj, 1 ),
02303      $                                 nmax, w, 1, one, a( jj, j ), 1,
02304      $                                 yt, g, aa( ja ), eps, err, fatal,
02305      $                                 nout, .true. )
02306                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02307                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02308                                  ja = ja + lda
02309                               \textcolor{keywordflow}{ELSE}
02310                                  ja = ja + lda + 1
02311 \textcolor{keywordflow}{                              END IF}
02312                            \textcolor{keywordflow}{ELSE}
02313                               ja = ja + lj
02314 \textcolor{keywordflow}{                           END IF}
02315                            errmax = max( errmax, err )
02316 \textcolor{comment}{*                          If got really bad answer, report and return.}
02317                            \textcolor{keywordflow}{IF}( fatal )
02318      $                        \textcolor{keywordflow}{GO TO} 150
02319    90                   \textcolor{keywordflow}{CONTINUE}
02320                      \textcolor{keywordflow}{ELSE}
02321 \textcolor{comment}{*                       Avoid repeating tests with N.le.0.}
02322                         \textcolor{keywordflow}{IF}( n.LE.0 )
02323      $                     \textcolor{keywordflow}{GO TO} 140
02324 \textcolor{keywordflow}{                     END IF}
02325 \textcolor{comment}{*}
02326   100             \textcolor{keywordflow}{CONTINUE}
02327 \textcolor{comment}{*}
02328   110          \textcolor{keywordflow}{CONTINUE}
02329 \textcolor{comment}{*}
02330   120       \textcolor{keywordflow}{CONTINUE}
02331 \textcolor{comment}{*}
02332   130    \textcolor{keywordflow}{CONTINUE}
02333 \textcolor{comment}{*}
02334   140 \textcolor{keywordflow}{CONTINUE}
02335 \textcolor{comment}{*}
02336 \textcolor{comment}{*     Report result.}
02337 \textcolor{comment}{*}
02338       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
02339          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
02340       \textcolor{keywordflow}{ELSE}
02341          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
02342 \textcolor{keywordflow}{      END IF}
02343       \textcolor{keywordflow}{GO TO} 170
02344 \textcolor{comment}{*}
02345   150 \textcolor{keywordflow}{CONTINUE}
02346       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
02347 \textcolor{comment}{*}
02348   160 \textcolor{keywordflow}{CONTINUE}
02349       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
02350       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02351          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, incx,
02352      $      incy, lda
02353       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02354          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, alpha, incx, incy
02355 \textcolor{keywordflow}{      END IF}
02356 \textcolor{comment}{*}
02357   170 \textcolor{keywordflow}{CONTINUE}
02358       \textcolor{keywordflow}{RETURN}
02359 \textcolor{comment}{*}
02360  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
02361      $      \textcolor{stringliteral}{'S)'} )
02362  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
02363      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
02364  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
02365      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
02366      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
02367  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
02368  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02369  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
02370      $      f4.1, \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', AP)                     '},
02371      $      \textcolor{stringliteral}{'       .'} )
02372  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
02373      $      f4.1, \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')             '},
02374      $      \textcolor{stringliteral}{'            .'} )
02375  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02376      $      \textcolor{stringliteral}{'******'} )
02377 \textcolor{comment}{*}
02378 \textcolor{comment}{*     End of ZCHK6.}
02379 \textcolor{comment}{*}
02380 \textcolor{keyword}{      END}
02381 \textcolor{keyword}{      SUBROUTINE }zchke( ISNUM, SRNAMT, NOUT )
02382 \textcolor{comment}{*}
02383 \textcolor{comment}{*  Tests the error exits from the Level 2 Blas.}
02384 \textcolor{comment}{*  Requires a special version of the error-handling routine XERBLA.}
02385 \textcolor{comment}{*  ALPHA, RALPHA, BETA, A, X and Y should not need to be defined.}
02386 \textcolor{comment}{*}
02387 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02388 \textcolor{comment}{*}
02389 \textcolor{comment}{*  -- Written on 10-August-1987.}
02390 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02391 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02392 \textcolor{comment}{*}
02393 \textcolor{comment}{*     .. Scalar Arguments ..}
02394       \textcolor{keywordtype}{INTEGER}            isnum, nout
02395       \textcolor{keywordtype}{CHARACTER*6}        srnamt
02396 \textcolor{comment}{*     .. Scalars in Common ..}
02397       \textcolor{keywordtype}{INTEGER}            infot, noutc
02398       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02399 \textcolor{comment}{*     .. Local Scalars ..}
02400       \textcolor{keywordtype}{COMPLEX*16}         alpha, beta
02401       \textcolor{keywordtype}{DOUBLE PRECISION}   ralpha
02402 \textcolor{comment}{*     .. Local Arrays ..}
02403       \textcolor{keywordtype}{COMPLEX*16}         a( 1, 1 ), x( 1 ), y( 1 )
02404 \textcolor{comment}{*     .. External Subroutines ..}
02405       \textcolor{keywordtype}{EXTERNAL}           chkxer, zgbmv, zgemv, zgerc, zgeru, zhbmv,
02406      $                   zhemv, zher, zher2, zhpmv, zhpr, zhpr2, ztbmv,
02407      $                   ztbsv, ztpmv, ztpsv, ztrmv, ztrsv
02408 \textcolor{comment}{*     .. Common blocks ..}
02409       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02410 \textcolor{comment}{*     .. Executable Statements ..}
02411 \textcolor{comment}{*     OK is set to .FALSE. by the special version of XERBLA or by CHKXER}
02412 \textcolor{comment}{*     if anything is wrong.}
02413       ok = .true.
02414 \textcolor{comment}{*     LERR is set to .TRUE. by the special version of XERBLA each time}
02415 \textcolor{comment}{*     it is called, and is then tested and re-set by CHKXER.}
02416       lerr = .false.
02417       \textcolor{keywordflow}{GO TO} ( 10, 20, 30, 40, 50, 60, 70, 80,
02418      $        90, 100, 110, 120, 130, 140, 150, 160,
02419      $        170 )isnum
02420    10 infot = 1
02421       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02422       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02423       infot = 2
02424       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02425       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02426       infot = 3
02427       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02428       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02429       infot = 6
02430       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, x, 1, beta, y, 1 )
02431       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02432       infot = 8
02433       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02434       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02435       infot = 11
02436       \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02437       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02438       \textcolor{keywordflow}{GO TO} 180
02439    20 infot = 1
02440       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'/'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02441       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02442       infot = 2
02443       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, -1, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02444       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02445       infot = 3
02446       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 0, -1, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02447       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02448       infot = 4
02449       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 0, 0, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02450       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02451       infot = 5
02452       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 2, 0, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02453       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02454       infot = 8
02455       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02456       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02457       infot = 10
02458       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02459       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02460       infot = 13
02461       \textcolor{keyword}{CALL }zgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02462       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02463       \textcolor{keywordflow}{GO TO} 180
02464    30 infot = 1
02465       \textcolor{keyword}{CALL }zhemv( \textcolor{stringliteral}{'/'}, 0, alpha, a, 1, x, 1, beta, y, 1 )
02466       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02467       infot = 2
02468       \textcolor{keyword}{CALL }zhemv( \textcolor{stringliteral}{'U'}, -1, alpha, a, 1, x, 1, beta, y, 1 )
02469       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02470       infot = 5
02471       \textcolor{keyword}{CALL }zhemv( \textcolor{stringliteral}{'U'}, 2, alpha, a, 1, x, 1, beta, y, 1 )
02472       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02473       infot = 7
02474       \textcolor{keyword}{CALL }zhemv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 0, beta, y, 1 )
02475       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02476       infot = 10
02477       \textcolor{keyword}{CALL }zhemv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 1, beta, y, 0 )
02478       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02479       \textcolor{keywordflow}{GO TO} 180
02480    40 infot = 1
02481       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02482       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02483       infot = 2
02484       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'U'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02485       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02486       infot = 3
02487       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'U'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02488       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02489       infot = 6
02490       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'U'}, 0, 1, alpha, a, 1, x, 1, beta, y, 1 )
02491       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02492       infot = 8
02493       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02494       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02495       infot = 11
02496       \textcolor{keyword}{CALL }zhbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02497       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02498       \textcolor{keywordflow}{GO TO} 180
02499    50 infot = 1
02500       \textcolor{keyword}{CALL }zhpmv( \textcolor{stringliteral}{'/'}, 0, alpha, a, x, 1, beta, y, 1 )
02501       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02502       infot = 2
02503       \textcolor{keyword}{CALL }zhpmv( \textcolor{stringliteral}{'U'}, -1, alpha, a, x, 1, beta, y, 1 )
02504       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02505       infot = 6
02506       \textcolor{keyword}{CALL }zhpmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 0, beta, y, 1 )
02507       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02508       infot = 9
02509       \textcolor{keyword}{CALL }zhpmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 1, beta, y, 0 )
02510       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02511       \textcolor{keywordflow}{GO TO} 180
02512    60 infot = 1
02513       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02514       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02515       infot = 2
02516       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02517       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02518       infot = 3
02519       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02520       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02521       infot = 4
02522       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02523       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02524       infot = 6
02525       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02526       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02527       infot = 8
02528       \textcolor{keyword}{CALL }ztrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02529       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02530       \textcolor{keywordflow}{GO TO} 180
02531    70 infot = 1
02532       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02533       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02534       infot = 2
02535       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02536       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02537       infot = 3
02538       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02539       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02540       infot = 4
02541       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02542       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02543       infot = 5
02544       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02545       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02546       infot = 7
02547       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02548       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02549       infot = 9
02550       \textcolor{keyword}{CALL }ztbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02551       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02552       \textcolor{keywordflow}{GO TO} 180
02553    80 infot = 1
02554       \textcolor{keyword}{CALL }ztpmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02555       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02556       infot = 2
02557       \textcolor{keyword}{CALL }ztpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02558       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02559       infot = 3
02560       \textcolor{keyword}{CALL }ztpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02561       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02562       infot = 4
02563       \textcolor{keyword}{CALL }ztpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02564       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02565       infot = 7
02566       \textcolor{keyword}{CALL }ztpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02567       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02568       \textcolor{keywordflow}{GO TO} 180
02569    90 infot = 1
02570       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02571       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02572       infot = 2
02573       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02574       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02575       infot = 3
02576       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02577       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02578       infot = 4
02579       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02580       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02581       infot = 6
02582       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02583       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02584       infot = 8
02585       \textcolor{keyword}{CALL }ztrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02586       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02587       \textcolor{keywordflow}{GO TO} 180
02588   100 infot = 1
02589       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02590       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02591       infot = 2
02592       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02593       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02594       infot = 3
02595       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02596       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02597       infot = 4
02598       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02599       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02600       infot = 5
02601       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02602       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02603       infot = 7
02604       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02605       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02606       infot = 9
02607       \textcolor{keyword}{CALL }ztbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02608       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02609       \textcolor{keywordflow}{GO TO} 180
02610   110 infot = 1
02611       \textcolor{keyword}{CALL }ztpsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02612       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02613       infot = 2
02614       \textcolor{keyword}{CALL }ztpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02615       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02616       infot = 3
02617       \textcolor{keyword}{CALL }ztpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02618       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02619       infot = 4
02620       \textcolor{keyword}{CALL }ztpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02621       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02622       infot = 7
02623       \textcolor{keyword}{CALL }ztpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02624       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02625       \textcolor{keywordflow}{GO TO} 180
02626   120 infot = 1
02627       \textcolor{keyword}{CALL }zgerc( -1, 0, alpha, x, 1, y, 1, a, 1 )
02628       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02629       infot = 2
02630       \textcolor{keyword}{CALL }zgerc( 0, -1, alpha, x, 1, y, 1, a, 1 )
02631       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02632       infot = 5
02633       \textcolor{keyword}{CALL }zgerc( 0, 0, alpha, x, 0, y, 1, a, 1 )
02634       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02635       infot = 7
02636       \textcolor{keyword}{CALL }zgerc( 0, 0, alpha, x, 1, y, 0, a, 1 )
02637       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02638       infot = 9
02639       \textcolor{keyword}{CALL }zgerc( 2, 0, alpha, x, 1, y, 1, a, 1 )
02640       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02641       \textcolor{keywordflow}{GO TO} 180
02642   130 infot = 1
02643       \textcolor{keyword}{CALL }zgeru( -1, 0, alpha, x, 1, y, 1, a, 1 )
02644       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02645       infot = 2
02646       \textcolor{keyword}{CALL }zgeru( 0, -1, alpha, x, 1, y, 1, a, 1 )
02647       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02648       infot = 5
02649       \textcolor{keyword}{CALL }zgeru( 0, 0, alpha, x, 0, y, 1, a, 1 )
02650       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02651       infot = 7
02652       \textcolor{keyword}{CALL }zgeru( 0, 0, alpha, x, 1, y, 0, a, 1 )
02653       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02654       infot = 9
02655       \textcolor{keyword}{CALL }zgeru( 2, 0, alpha, x, 1, y, 1, a, 1 )
02656       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02657       \textcolor{keywordflow}{GO TO} 180
02658   140 infot = 1
02659       \textcolor{keyword}{CALL }zher( \textcolor{stringliteral}{'/'}, 0, ralpha, x, 1, a, 1 )
02660       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02661       infot = 2
02662       \textcolor{keyword}{CALL }zher( \textcolor{stringliteral}{'U'}, -1, ralpha, x, 1, a, 1 )
02663       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02664       infot = 5
02665       \textcolor{keyword}{CALL }zher( \textcolor{stringliteral}{'U'}, 0, ralpha, x, 0, a, 1 )
02666       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02667       infot = 7
02668       \textcolor{keyword}{CALL }zher( \textcolor{stringliteral}{'U'}, 2, ralpha, x, 1, a, 1 )
02669       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02670       \textcolor{keywordflow}{GO TO} 180
02671   150 infot = 1
02672       \textcolor{keyword}{CALL }zhpr( \textcolor{stringliteral}{'/'}, 0, ralpha, x, 1, a )
02673       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02674       infot = 2
02675       \textcolor{keyword}{CALL }zhpr( \textcolor{stringliteral}{'U'}, -1, ralpha, x, 1, a )
02676       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02677       infot = 5
02678       \textcolor{keyword}{CALL }zhpr( \textcolor{stringliteral}{'U'}, 0, ralpha, x, 0, a )
02679       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02680       \textcolor{keywordflow}{GO TO} 180
02681   160 infot = 1
02682       \textcolor{keyword}{CALL }zher2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a, 1 )
02683       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02684       infot = 2
02685       \textcolor{keyword}{CALL }zher2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a, 1 )
02686       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02687       infot = 5
02688       \textcolor{keyword}{CALL }zher2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a, 1 )
02689       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02690       infot = 7
02691       \textcolor{keyword}{CALL }zher2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a, 1 )
02692       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02693       infot = 9
02694       \textcolor{keyword}{CALL }zher2( \textcolor{stringliteral}{'U'}, 2, alpha, x, 1, y, 1, a, 1 )
02695       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02696       \textcolor{keywordflow}{GO TO} 180
02697   170 infot = 1
02698       \textcolor{keyword}{CALL }zhpr2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a )
02699       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02700       infot = 2
02701       \textcolor{keyword}{CALL }zhpr2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a )
02702       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02703       infot = 5
02704       \textcolor{keyword}{CALL }zhpr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a )
02705       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02706       infot = 7
02707       \textcolor{keyword}{CALL }zhpr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a )
02708       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02709 \textcolor{comment}{*}
02710   180 \textcolor{keywordflow}{IF}( ok )\textcolor{keywordflow}{THEN}
02711          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )srnamt
02712       \textcolor{keywordflow}{ELSE}
02713          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srnamt
02714 \textcolor{keywordflow}{      END IF}
02715       \textcolor{keywordflow}{RETURN}
02716 \textcolor{comment}{*}
02717  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE TESTS OF ERROR-EXITS'} )
02718  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED THE TESTS OF ERROR-EXITS *****'},
02719      $      \textcolor{stringliteral}{'**'} )
02720 \textcolor{comment}{*}
02721 \textcolor{comment}{*     End of ZCHKE.}
02722 \textcolor{comment}{*}
02723 \textcolor{keyword}{      END}
02724 \textcolor{keyword}{      SUBROUTINE }zmake( TYPE, UPLO, DIAG, M, N, A, NMAX, AA, LDA, KL,
02725      $                  KU, RESET, TRANSL )
02726 \textcolor{comment}{*}
02727 \textcolor{comment}{*  Generates values for an M by N matrix A within the bandwidth}
02728 \textcolor{comment}{*  defined by KL and KU.}
02729 \textcolor{comment}{*  Stores the values in the array AA in the data structure required}
02730 \textcolor{comment}{*  by the routine, with unwanted elements set to rogue value.}
02731 \textcolor{comment}{*}
02732 \textcolor{comment}{*  TYPE is 'GE', 'GB', 'HE', 'HB', 'HP', 'TR', 'TB' OR 'TP'.}
02733 \textcolor{comment}{*}
02734 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02735 \textcolor{comment}{*}
02736 \textcolor{comment}{*  -- Written on 10-August-1987.}
02737 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02738 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02739 \textcolor{comment}{*}
02740 \textcolor{comment}{*     .. Parameters ..}
02741       \textcolor{keywordtype}{COMPLEX*16}         zero, one
02742       parameter( zero = ( 0.0d0, 0.0d0 ),
02743      $                   one = ( 1.0d0, 0.0d0 ) )
02744       \textcolor{keywordtype}{COMPLEX*16}         rogue
02745       parameter( rogue = ( -1.0d10, 1.0d10 ) )
02746       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero
02747       parameter( rzero = 0.0d0 )
02748       \textcolor{keywordtype}{DOUBLE PRECISION}   rrogue
02749       parameter( rrogue = -1.0d10 )
02750 \textcolor{comment}{*     .. Scalar Arguments ..}
02751       \textcolor{keywordtype}{COMPLEX*16}         transl
02752       \textcolor{keywordtype}{INTEGER}            kl, ku, lda, m, n, nmax
02753       \textcolor{keywordtype}{LOGICAL}            reset
02754       \textcolor{keywordtype}{CHARACTER*1}        diag, uplo
02755       \textcolor{keywordtype}{CHARACTER*2}        type
02756 \textcolor{comment}{*     .. Array Arguments ..}
02757       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, * ), aa( * )
02758 \textcolor{comment}{*     .. Local Scalars ..}
02759       \textcolor{keywordtype}{INTEGER}            i, i1, i2, i3, ibeg, iend, ioff, j, jj, kk
02760       \textcolor{keywordtype}{LOGICAL}            gen, lower, sym, tri, unit, upper
02761 \textcolor{comment}{*     .. External Functions ..}
02762       \textcolor{keywordtype}{COMPLEX*16}         zbeg
02763       \textcolor{keywordtype}{EXTERNAL}           zbeg
02764 \textcolor{comment}{*     .. Intrinsic Functions ..}
02765       \textcolor{keywordtype}{INTRINSIC}          dble, dcmplx, dconjg, max, min
02766 \textcolor{comment}{*     .. Executable Statements ..}
02767       gen = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'G'}
02768       sym = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'H'}
02769       tri = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'T'}
02770       upper = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'U'}
02771       lower = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'L'}
02772       unit = tri.AND.diag.EQ.\textcolor{stringliteral}{'U'}
02773 \textcolor{comment}{*}
02774 \textcolor{comment}{*     Generate data in array A.}
02775 \textcolor{comment}{*}
02776       \textcolor{keywordflow}{DO} 20 j = 1, n
02777          \textcolor{keywordflow}{DO} 10 i = 1, m
02778             \textcolor{keywordflow}{IF}( gen.OR.( upper.AND.i.LE.j ).OR.( lower.AND.i.GE.j ) )
02779      $          \textcolor{keywordflow}{THEN}
02780                \textcolor{keywordflow}{IF}( ( i.LE.j.AND.j - i.LE.ku ).OR.
02781      $             ( i.GE.j.AND.i - j.LE.kl ) )\textcolor{keywordflow}{THEN}
02782                   a( i, j ) = zbeg( reset ) + transl
02783                \textcolor{keywordflow}{ELSE}
02784                   a( i, j ) = zero
02785 \textcolor{keywordflow}{               END IF}
02786                \textcolor{keywordflow}{IF}( i.NE.j )\textcolor{keywordflow}{THEN}
02787                   \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02788                      a( j, i ) = dconjg( a( i, j ) )
02789                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( tri )\textcolor{keywordflow}{THEN}
02790                      a( j, i ) = zero
02791 \textcolor{keywordflow}{                  END IF}
02792 \textcolor{keywordflow}{               END IF}
02793 \textcolor{keywordflow}{            END IF}
02794    10    \textcolor{keywordflow}{CONTINUE}
02795          \textcolor{keywordflow}{IF}( sym )
02796      $      a( j, j ) = dcmplx( dble( a( j, j ) ), rzero )
02797          \textcolor{keywordflow}{IF}( tri )
02798      $      a( j, j ) = a( j, j ) + one
02799          \textcolor{keywordflow}{IF}( unit )
02800      $      a( j, j ) = one
02801    20 \textcolor{keywordflow}{CONTINUE}
02802 \textcolor{comment}{*}
02803 \textcolor{comment}{*     Store elements in array AS in data structure required by routine.}
02804 \textcolor{comment}{*}
02805       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02806          \textcolor{keywordflow}{DO} 50 j = 1, n
02807             \textcolor{keywordflow}{DO} 30 i = 1, m
02808                aa( i + ( j - 1 )*lda ) = a( i, j )
02809    30       \textcolor{keywordflow}{CONTINUE}
02810             \textcolor{keywordflow}{DO} 40 i = m + 1, lda
02811                aa( i + ( j - 1 )*lda ) = rogue
02812    40       \textcolor{keywordflow}{CONTINUE}
02813    50    \textcolor{keywordflow}{CONTINUE}
02814       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GB'} )\textcolor{keywordflow}{THEN}
02815          \textcolor{keywordflow}{DO} 90 j = 1, n
02816             \textcolor{keywordflow}{DO} 60 i1 = 1, ku + 1 - j
02817                aa( i1 + ( j - 1 )*lda ) = rogue
02818    60       \textcolor{keywordflow}{CONTINUE}
02819             \textcolor{keywordflow}{DO} 70 i2 = i1, min( kl + ku + 1, ku + 1 + m - j )
02820                aa( i2 + ( j - 1 )*lda ) = a( i2 + j - ku - 1, j )
02821    70       \textcolor{keywordflow}{CONTINUE}
02822             \textcolor{keywordflow}{DO} 80 i3 = i2, lda
02823                aa( i3 + ( j - 1 )*lda ) = rogue
02824    80       \textcolor{keywordflow}{CONTINUE}
02825    90    \textcolor{keywordflow}{CONTINUE}
02826       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HE'}.OR.type.EQ.\textcolor{stringliteral}{'TR'} )\textcolor{keywordflow}{THEN}
02827          \textcolor{keywordflow}{DO} 130 j = 1, n
02828             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02829                ibeg = 1
02830                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02831                   iend = j - 1
02832                \textcolor{keywordflow}{ELSE}
02833                   iend = j
02834 \textcolor{keywordflow}{               END IF}
02835             \textcolor{keywordflow}{ELSE}
02836                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02837                   ibeg = j + 1
02838                \textcolor{keywordflow}{ELSE}
02839                   ibeg = j
02840 \textcolor{keywordflow}{               END IF}
02841                iend = n
02842 \textcolor{keywordflow}{            END IF}
02843             \textcolor{keywordflow}{DO} 100 i = 1, ibeg - 1
02844                aa( i + ( j - 1 )*lda ) = rogue
02845   100       \textcolor{keywordflow}{CONTINUE}
02846             \textcolor{keywordflow}{DO} 110 i = ibeg, iend
02847                aa( i + ( j - 1 )*lda ) = a( i, j )
02848   110       \textcolor{keywordflow}{CONTINUE}
02849             \textcolor{keywordflow}{DO} 120 i = iend + 1, lda
02850                aa( i + ( j - 1 )*lda ) = rogue
02851   120       \textcolor{keywordflow}{CONTINUE}
02852             \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02853                jj = j + ( j - 1 )*lda
02854                aa( jj ) = dcmplx( dble( aa( jj ) ), rrogue )
02855 \textcolor{keywordflow}{            END IF}
02856   130    \textcolor{keywordflow}{CONTINUE}
02857       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HB'}.OR.type.EQ.\textcolor{stringliteral}{'TB'} )\textcolor{keywordflow}{THEN}
02858          \textcolor{keywordflow}{DO} 170 j = 1, n
02859             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02860                kk = kl + 1
02861                ibeg = max( 1, kl + 2 - j )
02862                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02863                   iend = kl
02864                \textcolor{keywordflow}{ELSE}
02865                   iend = kl + 1
02866 \textcolor{keywordflow}{               END IF}
02867             \textcolor{keywordflow}{ELSE}
02868                kk = 1
02869                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02870                   ibeg = 2
02871                \textcolor{keywordflow}{ELSE}
02872                   ibeg = 1
02873 \textcolor{keywordflow}{               END IF}
02874                iend = min( kl + 1, 1 + m - j )
02875 \textcolor{keywordflow}{            END IF}
02876             \textcolor{keywordflow}{DO} 140 i = 1, ibeg - 1
02877                aa( i + ( j - 1 )*lda ) = rogue
02878   140       \textcolor{keywordflow}{CONTINUE}
02879             \textcolor{keywordflow}{DO} 150 i = ibeg, iend
02880                aa( i + ( j - 1 )*lda ) = a( i + j - kk, j )
02881   150       \textcolor{keywordflow}{CONTINUE}
02882             \textcolor{keywordflow}{DO} 160 i = iend + 1, lda
02883                aa( i + ( j - 1 )*lda ) = rogue
02884   160       \textcolor{keywordflow}{CONTINUE}
02885             \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02886                jj = kk + ( j - 1 )*lda
02887                aa( jj ) = dcmplx( dble( aa( jj ) ), rrogue )
02888 \textcolor{keywordflow}{            END IF}
02889   170    \textcolor{keywordflow}{CONTINUE}
02890       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HP'}.OR.type.EQ.\textcolor{stringliteral}{'TP'} )\textcolor{keywordflow}{THEN}
02891          ioff = 0
02892          \textcolor{keywordflow}{DO} 190 j = 1, n
02893             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02894                ibeg = 1
02895                iend = j
02896             \textcolor{keywordflow}{ELSE}
02897                ibeg = j
02898                iend = n
02899 \textcolor{keywordflow}{            END IF}
02900             \textcolor{keywordflow}{DO} 180 i = ibeg, iend
02901                ioff = ioff + 1
02902                aa( ioff ) = a( i, j )
02903                \textcolor{keywordflow}{IF}( i.EQ.j )\textcolor{keywordflow}{THEN}
02904                   \textcolor{keywordflow}{IF}( unit )
02905      $               aa( ioff ) = rogue
02906                   \textcolor{keywordflow}{IF}( sym )
02907      $               aa( ioff ) = dcmplx( dble( aa( ioff ) ), rrogue )
02908 \textcolor{keywordflow}{               END IF}
02909   180       \textcolor{keywordflow}{CONTINUE}
02910   190    \textcolor{keywordflow}{CONTINUE}
02911 \textcolor{keywordflow}{      END IF}
02912       \textcolor{keywordflow}{RETURN}
02913 \textcolor{comment}{*}
02914 \textcolor{comment}{*     End of ZMAKE.}
02915 \textcolor{comment}{*}
02916 \textcolor{keyword}{      END}
02917 \textcolor{keyword}{      SUBROUTINE }zmvch( TRANS, M, N, ALPHA, A, NMAX, X, INCX, BETA, Y,
02918      $                  INCY, YT, G, YY, EPS, ERR, FATAL, NOUT, MV )
02919 \textcolor{comment}{*}
02920 \textcolor{comment}{*  Checks the results of the computational tests.}
02921 \textcolor{comment}{*}
02922 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02923 \textcolor{comment}{*}
02924 \textcolor{comment}{*  -- Written on 10-August-1987.}
02925 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02926 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02927 \textcolor{comment}{*}
02928 \textcolor{comment}{*     .. Parameters ..}
02929       \textcolor{keywordtype}{COMPLEX*16}         zero
02930       parameter( zero = ( 0.0d0, 0.0d0 ) )
02931       \textcolor{keywordtype}{DOUBLE PRECISION}   rzero, rone
02932       parameter( rzero = 0.0d0, rone = 1.0d0 )
02933 \textcolor{comment}{*     .. Scalar Arguments ..}
02934       \textcolor{keywordtype}{COMPLEX*16}         alpha, beta
02935       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, err
02936       \textcolor{keywordtype}{INTEGER}            incx, incy, m, n, nmax, nout
02937       \textcolor{keywordtype}{LOGICAL}            fatal, mv
02938       \textcolor{keywordtype}{CHARACTER*1}        trans
02939 \textcolor{comment}{*     .. Array Arguments ..}
02940       \textcolor{keywordtype}{COMPLEX*16}         a( nmax, * ), x( * ), y( * ), yt( * ), yy( * )
02941       \textcolor{keywordtype}{DOUBLE PRECISION}   g( * )
02942 \textcolor{comment}{*     .. Local Scalars ..}
02943       \textcolor{keywordtype}{COMPLEX*16}         c
02944       \textcolor{keywordtype}{DOUBLE PRECISION}   erri
02945       \textcolor{keywordtype}{INTEGER}            i, incxl, incyl, iy, j, jx, kx, ky, ml, nl
02946       \textcolor{keywordtype}{LOGICAL}            ctran, tran
02947 \textcolor{comment}{*     .. Intrinsic Functions ..}
02948       \textcolor{keywordtype}{INTRINSIC}          abs, dble, dconjg, dimag, max, sqrt
02949 \textcolor{comment}{*     .. Statement Functions ..}
02950       \textcolor{keywordtype}{DOUBLE PRECISION}   abs1
02951 \textcolor{comment}{*     .. Statement Function definitions ..}
02952       abs1( c ) = abs( dble( c ) ) + abs( dimag( c ) )
02953 \textcolor{comment}{*     .. Executable Statements ..}
02954       tran = trans.EQ.\textcolor{stringliteral}{'T'}
02955       ctran = trans.EQ.\textcolor{stringliteral}{'C'}
02956       \textcolor{keywordflow}{IF}( tran.OR.ctran )\textcolor{keywordflow}{THEN}
02957          ml = n
02958          nl = m
02959       \textcolor{keywordflow}{ELSE}
02960          ml = m
02961          nl = n
02962 \textcolor{keywordflow}{      END IF}
02963       \textcolor{keywordflow}{IF}( incx.LT.0 )\textcolor{keywordflow}{THEN}
02964          kx = nl
02965          incxl = -1
02966       \textcolor{keywordflow}{ELSE}
02967          kx = 1
02968          incxl = 1
02969 \textcolor{keywordflow}{      END IF}
02970       \textcolor{keywordflow}{IF}( incy.LT.0 )\textcolor{keywordflow}{THEN}
02971          ky = ml
02972          incyl = -1
02973       \textcolor{keywordflow}{ELSE}
02974          ky = 1
02975          incyl = 1
02976 \textcolor{keywordflow}{      END IF}
02977 \textcolor{comment}{*}
02978 \textcolor{comment}{*     Compute expected result in YT using data in A, X and Y.}
02979 \textcolor{comment}{*     Compute gauges in G.}
02980 \textcolor{comment}{*}
02981       iy = ky
02982       \textcolor{keywordflow}{DO} 40 i = 1, ml
02983          yt( iy ) = zero
02984          g( iy ) = rzero
02985          jx = kx
02986          \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
02987             \textcolor{keywordflow}{DO} 10 j = 1, nl
02988                yt( iy ) = yt( iy ) + a( j, i )*x( jx )
02989                g( iy ) = g( iy ) + abs1( a( j, i ) )*abs1( x( jx ) )
02990                jx = jx + incxl
02991    10       \textcolor{keywordflow}{CONTINUE}
02992          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( ctran )\textcolor{keywordflow}{THEN}
02993             \textcolor{keywordflow}{DO} 20 j = 1, nl
02994                yt( iy ) = yt( iy ) + dconjg( a( j, i ) )*x( jx )
02995                g( iy ) = g( iy ) + abs1( a( j, i ) )*abs1( x( jx ) )
02996                jx = jx + incxl
02997    20       \textcolor{keywordflow}{CONTINUE}
02998          \textcolor{keywordflow}{ELSE}
02999             \textcolor{keywordflow}{DO} 30 j = 1, nl
03000                yt( iy ) = yt( iy ) + a( i, j )*x( jx )
03001                g( iy ) = g( iy ) + abs1( a( i, j ) )*abs1( x( jx ) )
03002                jx = jx + incxl
03003    30       \textcolor{keywordflow}{CONTINUE}
03004 \textcolor{keywordflow}{         END IF}
03005          yt( iy ) = alpha*yt( iy ) + beta*y( iy )
03006          g( iy ) = abs1( alpha )*g( iy ) + abs1( beta )*abs1( y( iy ) )
03007          iy = iy + incyl
03008    40 \textcolor{keywordflow}{CONTINUE}
03009 \textcolor{comment}{*}
03010 \textcolor{comment}{*     Compute the error ratio for this result.}
03011 \textcolor{comment}{*}
03012       err = zero
03013       \textcolor{keywordflow}{DO} 50 i = 1, ml
03014          erri = abs( yt( i ) - yy( 1 + ( i - 1 )*abs( incy ) ) )/eps
03015          \textcolor{keywordflow}{IF}( g( i ).NE.rzero )
03016      $      erri = erri/g( i )
03017          err = max( err, erri )
03018          \textcolor{keywordflow}{IF}( err*sqrt( eps ).GE.rone )
03019      $      \textcolor{keywordflow}{GO TO} 60
03020    50 \textcolor{keywordflow}{CONTINUE}
03021 \textcolor{comment}{*     If the loop completes, all results are at least half accurate.}
03022       \textcolor{keywordflow}{GO TO} 80
03023 \textcolor{comment}{*}
03024 \textcolor{comment}{*     Report fatal error.}
03025 \textcolor{comment}{*}
03026    60 fatal = .true.
03027       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )
03028       \textcolor{keywordflow}{DO} 70 i = 1, ml
03029          \textcolor{keywordflow}{IF}( mv )\textcolor{keywordflow}{THEN}
03030             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i, yt( i ),
03031      $         yy( 1 + ( i - 1 )*abs( incy ) )
03032          \textcolor{keywordflow}{ELSE}
03033             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i,
03034      $         yy( 1 + ( i - 1 )*abs( incy ) ), yt( i )
03035 \textcolor{keywordflow}{         END IF}
03036    70 \textcolor{keywordflow}{CONTINUE}
03037 \textcolor{comment}{*}
03038    80 \textcolor{keywordflow}{CONTINUE}
03039       \textcolor{keywordflow}{RETURN}
03040 \textcolor{comment}{*}
03041  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - COMPUTED RESULT IS LESS THAN HAL'},
03042      $      \textcolor{stringliteral}{'F ACCURATE *******'}, /\textcolor{stringliteral}{'                       EXPECTED RE'},
03043      $      \textcolor{stringliteral}{'SULT                    COMPUTED RESULT'} )
03044  9998 \textcolor{keyword}{FORMAT}( 1x, i7, 2( \textcolor{stringliteral}{'  ('}, g15.6, \textcolor{stringliteral}{','}, g15.6, \textcolor{stringliteral}{')'} ) )
03045 \textcolor{comment}{*}
03046 \textcolor{comment}{*     End of ZMVCH.}
03047 \textcolor{comment}{*}
03048 \textcolor{keyword}{      END}
03049 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lze( RI, RJ, LR )
03050 \textcolor{comment}{*}
03051 \textcolor{comment}{*  Tests if two arrays are identical.}
03052 \textcolor{comment}{*}
03053 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03054 \textcolor{comment}{*}
03055 \textcolor{comment}{*  -- Written on 10-August-1987.}
03056 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03057 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03058 \textcolor{comment}{*}
03059 \textcolor{comment}{*     .. Scalar Arguments ..}
03060       \textcolor{keywordtype}{INTEGER}            lr
03061 \textcolor{comment}{*     .. Array Arguments ..}
03062       \textcolor{keywordtype}{COMPLEX*16}         ri( * ), rj( * )
03063 \textcolor{comment}{*     .. Local Scalars ..}
03064       \textcolor{keywordtype}{INTEGER}            i
03065 \textcolor{comment}{*     .. Executable Statements ..}
03066       \textcolor{keywordflow}{DO} 10 i = 1, lr
03067          \textcolor{keywordflow}{IF}( ri( i ).NE.rj( i ) )
03068      $      \textcolor{keywordflow}{GO TO} 20
03069    10 \textcolor{keywordflow}{CONTINUE}
03070       lze = .true.
03071       \textcolor{keywordflow}{GO TO} 30
03072    20 \textcolor{keywordflow}{CONTINUE}
03073       lze = .false.
03074    30 \textcolor{keywordflow}{RETURN}
03075 \textcolor{comment}{*}
03076 \textcolor{comment}{*     End of LZE.}
03077 \textcolor{comment}{*}
03078 \textcolor{keyword}{      END}
03079 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lzeres( TYPE, UPLO, M, N, AA, AS, LDA )
03080 \textcolor{comment}{*}
03081 \textcolor{comment}{*  Tests if selected elements in two arrays are equal.}
03082 \textcolor{comment}{*}
03083 \textcolor{comment}{*  TYPE is 'GE', 'HE' or 'HP'.}
03084 \textcolor{comment}{*}
03085 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03086 \textcolor{comment}{*}
03087 \textcolor{comment}{*  -- Written on 10-August-1987.}
03088 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03089 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03090 \textcolor{comment}{*}
03091 \textcolor{comment}{*     .. Scalar Arguments ..}
03092       \textcolor{keywordtype}{INTEGER}            lda, m, n
03093       \textcolor{keywordtype}{CHARACTER*1}        uplo
03094       \textcolor{keywordtype}{CHARACTER*2}        type
03095 \textcolor{comment}{*     .. Array Arguments ..}
03096       \textcolor{keywordtype}{COMPLEX*16}         aa( lda, * ), as( lda, * )
03097 \textcolor{comment}{*     .. Local Scalars ..}
03098       \textcolor{keywordtype}{INTEGER}            i, ibeg, iend, j
03099       \textcolor{keywordtype}{LOGICAL}            upper
03100 \textcolor{comment}{*     .. Executable Statements ..}
03101       upper = uplo.EQ.\textcolor{stringliteral}{'U'}
03102       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
03103          \textcolor{keywordflow}{DO} 20 j = 1, n
03104             \textcolor{keywordflow}{DO} 10 i = m + 1, lda
03105                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03106      $            \textcolor{keywordflow}{GO TO} 70
03107    10       \textcolor{keywordflow}{CONTINUE}
03108    20    \textcolor{keywordflow}{CONTINUE}
03109       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HE'} )\textcolor{keywordflow}{THEN}
03110          \textcolor{keywordflow}{DO} 50 j = 1, n
03111             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
03112                ibeg = 1
03113                iend = j
03114             \textcolor{keywordflow}{ELSE}
03115                ibeg = j
03116                iend = n
03117 \textcolor{keywordflow}{            END IF}
03118             \textcolor{keywordflow}{DO} 30 i = 1, ibeg - 1
03119                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03120      $            \textcolor{keywordflow}{GO TO} 70
03121    30       \textcolor{keywordflow}{CONTINUE}
03122             \textcolor{keywordflow}{DO} 40 i = iend + 1, lda
03123                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03124      $            \textcolor{keywordflow}{GO TO} 70
03125    40       \textcolor{keywordflow}{CONTINUE}
03126    50    \textcolor{keywordflow}{CONTINUE}
03127 \textcolor{keywordflow}{      END IF}
03128 \textcolor{comment}{*}
03129       lzeres = .true.
03130       \textcolor{keywordflow}{GO TO} 80
03131    70 \textcolor{keywordflow}{CONTINUE}
03132       lzeres = .false.
03133    80 \textcolor{keywordflow}{RETURN}
03134 \textcolor{comment}{*}
03135 \textcolor{comment}{*     End of LZERES.}
03136 \textcolor{comment}{*}
03137 \textcolor{keyword}{      END}
03138 \textcolor{keyword}{      COMPLEX*16 }\textcolor{keyword}{FUNCTION }zbeg( RESET )
03139 \textcolor{comment}{*}
03140 \textcolor{comment}{*  Generates complex numbers as pairs of random numbers uniformly}
03141 \textcolor{comment}{*  distributed between -0.5 and 0.5.}
03142 \textcolor{comment}{*}
03143 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03144 \textcolor{comment}{*}
03145 \textcolor{comment}{*  -- Written on 10-August-1987.}
03146 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03147 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03148 \textcolor{comment}{*}
03149 \textcolor{comment}{*     .. Scalar Arguments ..}
03150       \textcolor{keywordtype}{LOGICAL}            reset
03151 \textcolor{comment}{*     .. Local Scalars ..}
03152       \textcolor{keywordtype}{INTEGER}            i, ic, j, mi, mj
03153 \textcolor{comment}{*     .. Save statement ..}
03154       \textcolor{keywordtype}{SAVE}               i, ic, j, mi, mj
03155 \textcolor{comment}{*     .. Intrinsic Functions ..}
03156       \textcolor{keywordtype}{INTRINSIC}          dcmplx
03157 \textcolor{comment}{*     .. Executable Statements ..}
03158       \textcolor{keywordflow}{IF}( reset )\textcolor{keywordflow}{THEN}
03159 \textcolor{comment}{*        Initialize local variables.}
03160          mi = 891
03161          mj = 457
03162          i = 7
03163          j = 7
03164          ic = 0
03165          reset = .false.
03166 \textcolor{keywordflow}{      END IF}
03167 \textcolor{comment}{*}
03168 \textcolor{comment}{*     The sequence of values of I or J is bounded between 1 and 999.}
03169 \textcolor{comment}{*     If initial I or J = 1,2,3,6,7 or 9, the period will be 50.}
03170 \textcolor{comment}{*     If initial I or J = 4 or 8, the period will be 25.}
03171 \textcolor{comment}{*     If initial I or J = 5, the period will be 10.}
03172 \textcolor{comment}{*     IC is used to break up the period by skipping 1 value of I or J}
03173 \textcolor{comment}{*     in 6.}
03174 \textcolor{comment}{*}
03175       ic = ic + 1
03176    10 i = i*mi
03177       j = j*mj
03178       i = i - 1000*( i/1000 )
03179       j = j - 1000*( j/1000 )
03180       \textcolor{keywordflow}{IF}( ic.GE.5 )\textcolor{keywordflow}{THEN}
03181          ic = 0
03182          \textcolor{keywordflow}{GO TO} 10
03183 \textcolor{keywordflow}{      END IF}
03184       zbeg = dcmplx( ( i - 500 )/1001.0d0, ( j - 500 )/1001.0d0 )
03185       \textcolor{keywordflow}{RETURN}
03186 \textcolor{comment}{*}
03187 \textcolor{comment}{*     End of ZBEG.}
03188 \textcolor{comment}{*}
03189 \textcolor{keyword}{      END}
03190 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }ddiff( X, Y )
03191 \textcolor{comment}{*}
03192 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03193 \textcolor{comment}{*}
03194 \textcolor{comment}{*  -- Written on 10-August-1987.}
03195 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03196 \textcolor{comment}{*}
03197 \textcolor{comment}{*     .. Scalar Arguments ..}
03198       \textcolor{keywordtype}{DOUBLE PRECISION}   x, y
03199 \textcolor{comment}{*     .. Executable Statements ..}
03200       ddiff = x - y
03201       \textcolor{keywordflow}{RETURN}
03202 \textcolor{comment}{*}
03203 \textcolor{comment}{*     End of DDIFF.}
03204 \textcolor{comment}{*}
03205 \textcolor{keyword}{      END}
03206 \textcolor{keyword}{      SUBROUTINE }chkxer( SRNAMT, INFOT, NOUT, LERR, OK )
03207 \textcolor{comment}{*}
03208 \textcolor{comment}{*  Tests whether XERBLA has detected an error when it should.}
03209 \textcolor{comment}{*}
03210 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03211 \textcolor{comment}{*}
03212 \textcolor{comment}{*  -- Written on 10-August-1987.}
03213 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03214 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03215 \textcolor{comment}{*}
03216 \textcolor{comment}{*     .. Scalar Arguments ..}
03217       \textcolor{keywordtype}{INTEGER}            infot, nout
03218       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03219       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03220 \textcolor{comment}{*     .. Executable Statements ..}
03221       \textcolor{keywordflow}{IF}( .NOT.lerr )\textcolor{keywordflow}{THEN}
03222          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )infot, srnamt
03223          ok = .false.
03224 \textcolor{keywordflow}{      END IF}
03225       lerr = .false.
03226       \textcolor{keywordflow}{RETURN}
03227 \textcolor{comment}{*}
03228  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ***** ILLEGAL VALUE OF PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' NOT D'},
03229      $      \textcolor{stringliteral}{'ETECTED BY '}, a6, \textcolor{stringliteral}{' *****'} )
03230 \textcolor{comment}{*}
03231 \textcolor{comment}{*     End of CHKXER.}
03232 \textcolor{comment}{*}
03233 \textcolor{keyword}{      END}
03234 \textcolor{keyword}{      SUBROUTINE }xerbla( SRNAME, INFO )
03235 \textcolor{comment}{*}
03236 \textcolor{comment}{*  This is a special version of XERBLA to be used only as part of}
03237 \textcolor{comment}{*  the test program for testing error exits from the Level 2 BLAS}
03238 \textcolor{comment}{*  routines.}
03239 \textcolor{comment}{*}
03240 \textcolor{comment}{*  XERBLA  is an error handler for the Level 2 BLAS routines.}
03241 \textcolor{comment}{*}
03242 \textcolor{comment}{*  It is called by the Level 2 BLAS routines if an input parameter is}
03243 \textcolor{comment}{*  invalid.}
03244 \textcolor{comment}{*}
03245 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03246 \textcolor{comment}{*}
03247 \textcolor{comment}{*  -- Written on 10-August-1987.}
03248 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03249 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03250 \textcolor{comment}{*}
03251 \textcolor{comment}{*     .. Scalar Arguments ..}
03252       \textcolor{keywordtype}{INTEGER}            info
03253       \textcolor{keywordtype}{CHARACTER*6}        srname
03254 \textcolor{comment}{*     .. Scalars in Common ..}
03255       \textcolor{keywordtype}{INTEGER}            infot, nout
03256       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03257       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03258 \textcolor{comment}{*     .. Common blocks ..}
03259       \textcolor{keyword}{COMMON}             /infoc/infot, nout, ok, lerr
03260       \textcolor{keyword}{COMMON}             /srnamc/srnamt
03261 \textcolor{comment}{*     .. Executable Statements ..}
03262       lerr = .true.
03263       \textcolor{keywordflow}{IF}( info.NE.infot )\textcolor{keywordflow}{THEN}
03264          \textcolor{keywordflow}{IF}( infot.NE.0 )\textcolor{keywordflow}{THEN}
03265             \textcolor{keyword}{WRITE}( nout, fmt = 9999 )info, infot
03266          \textcolor{keywordflow}{ELSE}
03267             \textcolor{keyword}{WRITE}( nout, fmt = 9997 )info
03268 \textcolor{keywordflow}{         END IF}
03269          ok = .false.
03270 \textcolor{keywordflow}{      END IF}
03271       \textcolor{keywordflow}{IF}( srname.NE.srnamt )\textcolor{keywordflow}{THEN}
03272          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srname, srnamt
03273          ok = .false.
03274 \textcolor{keywordflow}{      END IF}
03275       \textcolor{keywordflow}{RETURN}
03276 \textcolor{comment}{*}
03277  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6, \textcolor{stringliteral}{' INSTEAD'},
03278      $      \textcolor{stringliteral}{' OF '}, i2, \textcolor{stringliteral}{' *******'} )
03279  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH SRNAME = '}, a6, \textcolor{stringliteral}{' INSTE'},
03280      $      \textcolor{stringliteral}{'AD OF '}, a6, \textcolor{stringliteral}{' *******'} )
03281  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6,
03282      $      \textcolor{stringliteral}{' *******'} )
03283 \textcolor{comment}{*}
03284 \textcolor{comment}{*     End of XERBLA}
03285 \textcolor{comment}{*}
03286 \textcolor{keyword}{      END}
03287 
\end{DoxyCode}
