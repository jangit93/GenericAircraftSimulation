\hypertarget{eigen_2lapack_2zlarf_8f_source}{}\section{eigen/lapack/zlarf.f}
\label{eigen_2lapack_2zlarf_8f_source}\index{zlarf.\+f@{zlarf.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b ZLARF}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download ZLARF + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/zlarf.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/zlarf.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/zlarf.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE ZLARF( SIDE, M, N, V, INCV, TAU, C, LDC, WORK )}
00022 \textcolor{comment}{* }
00023 \textcolor{comment}{*       .. Scalar Arguments ..}
00024 \textcolor{comment}{*       CHARACTER          SIDE}
00025 \textcolor{comment}{*       INTEGER            INCV, LDC, M, N}
00026 \textcolor{comment}{*       COMPLEX*16         TAU}
00027 \textcolor{comment}{*       ..}
00028 \textcolor{comment}{*       .. Array Arguments ..}
00029 \textcolor{comment}{*       COMPLEX*16         C( LDC, * ), V( * ), WORK( * )}
00030 \textcolor{comment}{*       ..}
00031 \textcolor{comment}{*  }
00032 \textcolor{comment}{*}
00033 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00034 \textcolor{comment}{*  =============}
00035 \textcolor{comment}{*>}
00036 \textcolor{comment}{*> \(\backslash\)verbatim}
00037 \textcolor{comment}{*>}
00038 \textcolor{comment}{*> ZLARF applies a complex elementary reflector H to a complex M-by-N}
00039 \textcolor{comment}{*> matrix C, from either the left or the right. H is represented in the}
00040 \textcolor{comment}{*> form}
00041 \textcolor{comment}{*>}
00042 \textcolor{comment}{*>       H = I - tau * v * v**H}
00043 \textcolor{comment}{*>}
00044 \textcolor{comment}{*> where tau is a complex scalar and v is a complex vector.}
00045 \textcolor{comment}{*>}
00046 \textcolor{comment}{*> If tau = 0, then H is taken to be the unit matrix.}
00047 \textcolor{comment}{*>}
00048 \textcolor{comment}{*> To apply H**H, supply conjg(tau) instead}
00049 \textcolor{comment}{*> tau.}
00050 \textcolor{comment}{*> \(\backslash\)endverbatim}
00051 \textcolor{comment}{*}
00052 \textcolor{comment}{*  Arguments:}
00053 \textcolor{comment}{*  ==========}
00054 \textcolor{comment}{*}
00055 \textcolor{comment}{*> \(\backslash\)param[in] SIDE}
00056 \textcolor{comment}{*> \(\backslash\)verbatim}
00057 \textcolor{comment}{*>          SIDE is CHARACTER*1}
00058 \textcolor{comment}{*>          = 'L': form  H * C}
00059 \textcolor{comment}{*>          = 'R': form  C * H}
00060 \textcolor{comment}{*> \(\backslash\)endverbatim}
00061 \textcolor{comment}{*>}
00062 \textcolor{comment}{*> \(\backslash\)param[in] M}
00063 \textcolor{comment}{*> \(\backslash\)verbatim}
00064 \textcolor{comment}{*>          M is INTEGER}
00065 \textcolor{comment}{*>          The number of rows of the matrix C.}
00066 \textcolor{comment}{*> \(\backslash\)endverbatim}
00067 \textcolor{comment}{*>}
00068 \textcolor{comment}{*> \(\backslash\)param[in] N}
00069 \textcolor{comment}{*> \(\backslash\)verbatim}
00070 \textcolor{comment}{*>          N is INTEGER}
00071 \textcolor{comment}{*>          The number of columns of the matrix C.}
00072 \textcolor{comment}{*> \(\backslash\)endverbatim}
00073 \textcolor{comment}{*>}
00074 \textcolor{comment}{*> \(\backslash\)param[in] V}
00075 \textcolor{comment}{*> \(\backslash\)verbatim}
00076 \textcolor{comment}{*>          V is COMPLEX*16 array, dimension}
00077 \textcolor{comment}{*>                     (1 + (M-1)*abs(INCV)) if SIDE = 'L'}
00078 \textcolor{comment}{*>                  or (1 + (N-1)*abs(INCV)) if SIDE = 'R'}
00079 \textcolor{comment}{*>          The vector v in the representation of H. V is not used if}
00080 \textcolor{comment}{*>          TAU = 0.}
00081 \textcolor{comment}{*> \(\backslash\)endverbatim}
00082 \textcolor{comment}{*>}
00083 \textcolor{comment}{*> \(\backslash\)param[in] INCV}
00084 \textcolor{comment}{*> \(\backslash\)verbatim}
00085 \textcolor{comment}{*>          INCV is INTEGER}
00086 \textcolor{comment}{*>          The increment between elements of v. INCV <> 0.}
00087 \textcolor{comment}{*> \(\backslash\)endverbatim}
00088 \textcolor{comment}{*>}
00089 \textcolor{comment}{*> \(\backslash\)param[in] TAU}
00090 \textcolor{comment}{*> \(\backslash\)verbatim}
00091 \textcolor{comment}{*>          TAU is COMPLEX*16}
00092 \textcolor{comment}{*>          The value tau in the representation of H.}
00093 \textcolor{comment}{*> \(\backslash\)endverbatim}
00094 \textcolor{comment}{*>}
00095 \textcolor{comment}{*> \(\backslash\)param[in,out] C}
00096 \textcolor{comment}{*> \(\backslash\)verbatim}
00097 \textcolor{comment}{*>          C is COMPLEX*16 array, dimension (LDC,N)}
00098 \textcolor{comment}{*>          On entry, the M-by-N matrix C.}
00099 \textcolor{comment}{*>          On exit, C is overwritten by the matrix H * C if SIDE = 'L',}
00100 \textcolor{comment}{*>          or C * H if SIDE = 'R'.}
00101 \textcolor{comment}{*> \(\backslash\)endverbatim}
00102 \textcolor{comment}{*>}
00103 \textcolor{comment}{*> \(\backslash\)param[in] LDC}
00104 \textcolor{comment}{*> \(\backslash\)verbatim}
00105 \textcolor{comment}{*>          LDC is INTEGER}
00106 \textcolor{comment}{*>          The leading dimension of the array C. LDC >= max(1,M).}
00107 \textcolor{comment}{*> \(\backslash\)endverbatim}
00108 \textcolor{comment}{*>}
00109 \textcolor{comment}{*> \(\backslash\)param[out] WORK}
00110 \textcolor{comment}{*> \(\backslash\)verbatim}
00111 \textcolor{comment}{*>          WORK is COMPLEX*16 array, dimension}
00112 \textcolor{comment}{*>                         (N) if SIDE = 'L'}
00113 \textcolor{comment}{*>                      or (M) if SIDE = 'R'}
00114 \textcolor{comment}{*> \(\backslash\)endverbatim}
00115 \textcolor{comment}{*}
00116 \textcolor{comment}{*  Authors:}
00117 \textcolor{comment}{*  ========}
00118 \textcolor{comment}{*}
00119 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00120 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00121 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00122 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00123 \textcolor{comment}{*}
00124 \textcolor{comment}{*> \(\backslash\)date November 2011}
00125 \textcolor{comment}{*}
00126 \textcolor{comment}{*> \(\backslash\)ingroup complex16OTHERauxiliary}
00127 \textcolor{comment}{*}
00128 \textcolor{comment}{*  =====================================================================}
00129 \textcolor{keyword}{      SUBROUTINE }zlarf( SIDE, M, N, V, INCV, TAU, C, LDC, WORK )
00130 \textcolor{comment}{*}
00131 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.0) --}
00132 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00133 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00134 \textcolor{comment}{*     November 2011}
00135 \textcolor{comment}{*}
00136 \textcolor{comment}{*     .. Scalar Arguments ..}
00137       \textcolor{keywordtype}{CHARACTER}          side
00138       \textcolor{keywordtype}{INTEGER}            incv, ldc, m, n
00139       \textcolor{keywordtype}{COMPLEX*16}         tau
00140 \textcolor{comment}{*     ..}
00141 \textcolor{comment}{*     .. Array Arguments ..}
00142       \textcolor{keywordtype}{COMPLEX*16}         c( ldc, * ), v( * ), work( * )
00143 \textcolor{comment}{*     ..}
00144 \textcolor{comment}{*}
00145 \textcolor{comment}{*  =====================================================================}
00146 \textcolor{comment}{*}
00147 \textcolor{comment}{*     .. Parameters ..}
00148       \textcolor{keywordtype}{COMPLEX*16}         one, zero
00149       parameter( one = ( 1.0d+0, 0.0d+0 ),
00150      $                   zero = ( 0.0d+0, 0.0d+0 ) )
00151 \textcolor{comment}{*     ..}
00152 \textcolor{comment}{*     .. Local Scalars ..}
00153       \textcolor{keywordtype}{LOGICAL}            applyleft
00154       \textcolor{keywordtype}{INTEGER}            i, lastv, lastc
00155 \textcolor{comment}{*     ..}
00156 \textcolor{comment}{*     .. External Subroutines ..}
00157       \textcolor{keywordtype}{EXTERNAL}           zgemv, zgerc
00158 \textcolor{comment}{*     ..}
00159 \textcolor{comment}{*     .. External Functions ..}
00160       \textcolor{keywordtype}{LOGICAL}            lsame
00161       \textcolor{keywordtype}{INTEGER}            ilazlr, ilazlc
00162       \textcolor{keywordtype}{EXTERNAL}           lsame, ilazlr, ilazlc
00163 \textcolor{comment}{*     ..}
00164 \textcolor{comment}{*     .. Executable Statements ..}
00165 \textcolor{comment}{*}
00166       applyleft = lsame( side, \textcolor{stringliteral}{'L'} )
00167       lastv = 0
00168       lastc = 0
00169       \textcolor{keywordflow}{IF}( tau.NE.zero ) \textcolor{keywordflow}{THEN}
00170 \textcolor{comment}{*     Set up variables for scanning V.  LASTV begins pointing to the end}
00171 \textcolor{comment}{*     of V.}
00172          \textcolor{keywordflow}{IF}( applyleft ) \textcolor{keywordflow}{THEN}
00173             lastv = m
00174          \textcolor{keywordflow}{ELSE}
00175             lastv = n
00176 \textcolor{keywordflow}{         END IF}
00177          \textcolor{keywordflow}{IF}( incv.GT.0 ) \textcolor{keywordflow}{THEN}
00178             i = 1 + (lastv-1) * incv
00179          \textcolor{keywordflow}{ELSE}
00180             i = 1
00181 \textcolor{keywordflow}{         END IF}
00182 \textcolor{comment}{*     Look for the last non-zero row in V.}
00183          \textcolor{keywordflow}{DO} \textcolor{keywordflow}{WHILE}( lastv.GT.0 .AND. v( i ).EQ.zero )
00184             lastv = lastv - 1
00185             i = i - incv
00186 \textcolor{keywordflow}{         END DO}
00187          \textcolor{keywordflow}{IF}( applyleft ) \textcolor{keywordflow}{THEN}
00188 \textcolor{comment}{*     Scan for the last non-zero column in C(1:lastv,:).}
00189             lastc = ilazlc(lastv, n, c, ldc)
00190          \textcolor{keywordflow}{ELSE}
00191 \textcolor{comment}{*     Scan for the last non-zero row in C(:,1:lastv).}
00192             lastc = ilazlr(m, lastv, c, ldc)
00193 \textcolor{keywordflow}{         END IF}
00194 \textcolor{keywordflow}{      END IF}
00195 \textcolor{comment}{*     Note that lastc.eq.0 renders the BLAS operations null; no special}
00196 \textcolor{comment}{*     case is needed at this level.}
00197       \textcolor{keywordflow}{IF}( applyleft ) \textcolor{keywordflow}{THEN}
00198 \textcolor{comment}{*}
00199 \textcolor{comment}{*        Form  H * C}
00200 \textcolor{comment}{*}
00201          \textcolor{keywordflow}{IF}( lastv.GT.0 ) \textcolor{keywordflow}{THEN}
00202 \textcolor{comment}{*}
00203 \textcolor{comment}{*           w(1:lastc,1) := C(1:lastv,1:lastc)**H * v(1:lastv,1)}
00204 \textcolor{comment}{*}
00205             \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'Conjugate transpose'}, lastv, lastc, one,
00206      $           c, ldc, v, incv, zero, work, 1 )
00207 \textcolor{comment}{*}
00208 \textcolor{comment}{*           C(1:lastv,1:lastc) := C(...) - v(1:lastv,1) * w(1:lastc,1)**H}
00209 \textcolor{comment}{*}
00210             \textcolor{keyword}{CALL }zgerc( lastv, lastc, -tau, v, incv, work, 1, c, ldc )
00211 \textcolor{keywordflow}{         END IF}
00212       \textcolor{keywordflow}{ELSE}
00213 \textcolor{comment}{*}
00214 \textcolor{comment}{*        Form  C * H}
00215 \textcolor{comment}{*}
00216          \textcolor{keywordflow}{IF}( lastv.GT.0 ) \textcolor{keywordflow}{THEN}
00217 \textcolor{comment}{*}
00218 \textcolor{comment}{*           w(1:lastc,1) := C(1:lastc,1:lastv) * v(1:lastv,1)}
00219 \textcolor{comment}{*}
00220             \textcolor{keyword}{CALL }zgemv( \textcolor{stringliteral}{'No transpose'}, lastc, lastv, one, c, ldc,
00221      $           v, incv, zero, work, 1 )
00222 \textcolor{comment}{*}
00223 \textcolor{comment}{*           C(1:lastc,1:lastv) := C(...) - w(1:lastc,1) * v(1:lastv,1)**H}
00224 \textcolor{comment}{*}
00225             \textcolor{keyword}{CALL }zgerc( lastc, lastv, -tau, work, 1, v, incv, c, ldc )
00226 \textcolor{keywordflow}{         END IF}
00227 \textcolor{keywordflow}{      END IF}
00228       \textcolor{keywordflow}{RETURN}
00229 \textcolor{comment}{*}
00230 \textcolor{comment}{*     End of ZLARF}
00231 \textcolor{comment}{*}
00232 \textcolor{keyword}{      END}
\end{DoxyCode}
