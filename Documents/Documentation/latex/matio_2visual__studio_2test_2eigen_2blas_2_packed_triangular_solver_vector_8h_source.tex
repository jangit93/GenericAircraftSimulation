\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2_packed_triangular_solver_vector_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/\+Packed\+Triangular\+Solver\+Vector.h}
\label{matio_2visual__studio_2test_2eigen_2blas_2_packed_triangular_solver_vector_8h_source}\index{Packed\+Triangular\+Solver\+Vector.\+h@{Packed\+Triangular\+Solver\+Vector.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2012 Chen-Pang He <jdh8@ms63.hinet.net>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_PACKED\_TRIANGULAR\_SOLVER\_VECTOR\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_PACKED\_TRIANGULAR\_SOLVER\_VECTOR\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00014 
00015 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} S\textcolor{keywordtype}{id}e, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{int} St
      orageOrder>
00016 \textcolor{keyword}{struct }packed\_triangular\_solve\_vector;
00017 
00018 \textcolor{comment}{// forward and backward substitution, row-major, rhs is a vector}
00019 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate>
00020 \textcolor{keyword}{struct }packed\_triangular\_solve\_vector<LhsScalar, RhsScalar, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}, 
      \hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba129609b3bdf23b071f5f86cf2f995ec4}{OnTheLeft}, Mode, Conjugate, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}>
00021 \{
00022   \textcolor{keyword}{enum} \{
00023     IsLower = (Mode&\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}
00024   \};
00025   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, \textcolor{keyword}{const} LhsScalar* lhs, RhsScalar* rhs)
00026   \{
00027     internal::conj\_if<Conjugate> cj;
00028     \textcolor{keyword}{typedef} Map<const Matrix<LhsScalar,Dynamic,1> > LhsMap;
00029     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conj\_expr\_if<Conjugate,LhsMap>::type ConjLhsType;
00030 
00031     lhs += IsLower ? 0 : (size*(size+1)>>1)-1;
00032     \textcolor{keywordflow}{for}(Index pi=0; pi<size; ++pi)
00033     \{
00034       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = IsLower ? pi : size-pi-1;
00035       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} s = IsLower ? 0 : 1;
00036       \textcolor{keywordflow}{if} (pi>0)
00037     rhs[i] -= (ConjLhsType(LhsMap(lhs+s,pi))
00038         .cwiseProduct(Map<\textcolor{keyword}{const} Matrix<RhsScalar,Dynamic,1> >(rhs+(IsLower ? 0 : i+1),pi))).sum();
00039       \textcolor{keywordflow}{if} (!(Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag}))
00040     rhs[i] /= cj(lhs[IsLower ? i : 0]);
00041       IsLower ? lhs += pi+1 : lhs -= pi+2;
00042     \}
00043   \}
00044 \};
00045 
00046 \textcolor{comment}{// forward and backward substitution, column-major, rhs is a vector}
00047 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate>
00048 \textcolor{keyword}{struct }packed\_triangular\_solve\_vector<LhsScalar, RhsScalar, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}, 
      \hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba129609b3bdf23b071f5f86cf2f995ec4}{OnTheLeft}, Mode, Conjugate, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}>
00049 \{
00050   \textcolor{keyword}{enum} \{
00051     IsLower = (Mode&\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}
00052   \};
00053   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, \textcolor{keyword}{const} LhsScalar* lhs, RhsScalar* rhs)
00054   \{
00055     internal::conj\_if<Conjugate> cj;
00056     \textcolor{keyword}{typedef} Map<const Matrix<LhsScalar,Dynamic,1> > LhsMap;
00057     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conj\_expr\_if<Conjugate,LhsMap>::type ConjLhsType;
00058 
00059     lhs += IsLower ? 0 : size*(size-1)>>1;
00060     \textcolor{keywordflow}{for}(Index pi=0; pi<size; ++pi)
00061     \{
00062       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = IsLower ? pi : size-pi-1;
00063       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} r = size - pi - 1;
00064       \textcolor{keywordflow}{if} (!(Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag}))
00065     rhs[i] /= cj(lhs[IsLower ? 0 : i]);
00066       \textcolor{keywordflow}{if} (r>0)
00067     Map<Matrix<RhsScalar,Dynamic,1> >(rhs+(IsLower? i+1 : 0),r) -=
00068         rhs[i] * ConjLhsType(LhsMap(lhs+(IsLower? 1 : 0),r));
00069       IsLower ? lhs += size-pi : lhs -= r;
00070     \}
00071   \}
00072 \};
00073 
00074 \textcolor{keyword}{template}<\textcolor{keyword}{typename} LhsScalar, \textcolor{keyword}{typename} RhsScalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keywordtype}{bool} Conjugate, \textcolor{keywordtype}{int} StorageOrder
      >
00075 \textcolor{keyword}{struct }packed\_triangular\_solve\_vector<LhsScalar, RhsScalar, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}, 
      \hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba99dc75d8e00b6c3a5bdc31940f47492b}{OnTheRight}, Mode, Conjugate, StorageOrder>
00076 \{
00077   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, \textcolor{keyword}{const} LhsScalar* lhs, RhsScalar* rhs)
00078   \{
00079     packed\_triangular\_solve\_vector<LhsScalar,RhsScalar,\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},\hyperlink{group__enums_ggac22de43beeac7a78b384f99bed5cee0ba129609b3bdf23b071f5f86cf2f995ec4}{OnTheLeft},
00080     ((Mode&\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper} ? \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} : \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}) | (Mode&\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag}),
00081     Conjugate,StorageOrder==\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}?\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}:\hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}
00082       >::run(size, lhs, rhs);
00083   \}
00084 \};
00085 
00086 \} \textcolor{comment}{// end namespace internal}
00087 
00088 \textcolor{preprocessor}{#endif // EIGEN\_PACKED\_TRIANGULAR\_SOLVER\_VECTOR\_H}
\end{DoxyCode}
