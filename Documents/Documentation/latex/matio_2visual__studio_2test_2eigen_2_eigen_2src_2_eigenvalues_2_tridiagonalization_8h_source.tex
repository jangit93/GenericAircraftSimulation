\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Eigenvalues/\+Tridiagonalization.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source}\index{Tridiagonalization.\+h@{Tridiagonalization.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_TRIDIAGONALIZATION\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_TRIDIAGONALIZATION\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00017   
00018 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }TridiagonalizationMatrixTReturnType;
00019 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00020 \textcolor{keyword}{struct }traits<TridiagonalizationMatrixTReturnType<MatrixType> >
00021   : \textcolor{keyword}{public} traits<typename MatrixType::PlainObject>
00022 \{
00023   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::PlainObject ReturnType; \textcolor{comment}{// FIXME shall it be a BandMatrix?}
00024   \textcolor{keyword}{enum} \{ Flags = 0 \};
00025 \};
00026 
00027 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} CoeffVectorType>
00028 \textcolor{keywordtype}{void} tridiagonalization\_inplace(MatrixType& matA, CoeffVectorType& hCoeffs);
00029 \}
00030 
00063 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{class }Tridiagonalization
00064 \{
00065   \textcolor{keyword}{public}:
00066 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00068}\hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{00068}     \textcolor{keyword}{typedef} \_MatrixType \hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{MatrixType};
00069 
00070     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00071     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::Real} RealScalar;
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00072}\hyperlink{group___eigenvalues___module_a7bd1f9fccec1e93b77a2214b2d30aae9}{00072}     \textcolor{keyword}{typedef} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index} \hyperlink{group___eigenvalues___module_a7bd1f9fccec1e93b77a2214b2d30aae9}{Index}; 
00073 
00074     \textcolor{keyword}{enum} \{
00075       Size = MatrixType::RowsAtCompileTime,
00076       SizeMinusOne = Size == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : (Size > 1 ? Size - 1 : 1),
00077       Options = MatrixType::Options,
00078       MaxSize = MatrixType::MaxRowsAtCompileTime,
00079       MaxSizeMinusOne = MaxSize == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : (MaxSize > 1 ? MaxSize - 1 : 1)
00080     \};
00081 
00082     \textcolor{keyword}{typedef} 
      \hyperlink{group___core___module}{Matrix<Scalar, SizeMinusOne, 1, Options & ~RowMajor, MaxSizeMinusOne, 1>}
       \hyperlink{group___core___module}{CoeffVectorType};
00083     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_col\_type<MatrixType, RealScalar>::type}
       \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalType};
00084     \textcolor{keyword}{typedef} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<RealScalar, SizeMinusOne, 1, Options & ~RowMajor, MaxSizeMinusOne, 1>}
       \hyperlink{group___core___module_class_eigen_1_1_matrix}{SubDiagonalType};
00085     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} 
      \hyperlink{group___sparse_core___module}{internal::remove\_all<typename MatrixType::RealReturnType>::type}
       \hyperlink{group___sparse_core___module}{MatrixTypeRealView};
00086     \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_tridiagonalization_matrix_t_return_type}{internal::TridiagonalizationMatrixTReturnType<MatrixTypeRealView>}
       \hyperlink{struct_eigen_1_1internal_1_1_tridiagonalization_matrix_t_return_type}{MatrixTReturnType};
00087 
00088     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1conditional}{internal::conditional<NumTraits<Scalar>::IsComplex}
      ,
00089               \textcolor{keyword}{typename} 
      \hyperlink{struct_eigen_1_1internal_1_1add__const__on__value__type}{internal::add\_const\_on\_value\_type<typename Diagonal<const MatrixType>::RealReturnType}
      >::type,
00090               \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_diagonal}{Diagonal<const MatrixType>}
00091             >::type \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalReturnType};
00092 
00093     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::conditional<NumTraits<Scalar>::IsComplex,
00094               \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1add__const__on__value__type}{internal::add\_const\_on\_value\_type}<\textcolor{keyword}{typename} 
      \hyperlink{group___core___module_class_eigen_1_1_diagonal}{Diagonal}<\textcolor{keyword}{const} MatrixType, -1>\hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{::RealReturnType}>::type,
00095               \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_diagonal}{Diagonal}<\textcolor{keyword}{const} MatrixType, -1>
00096             >::type \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{SubDiagonalReturnType};
00097 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00099}\hyperlink{group___eigenvalues___module_af322315c8bea9990152c9d09bfa2a69f}{00099}     \textcolor{keyword}{typedef} 
      \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{HouseholderSequence<MatrixType,typename internal::remove\_all<typename
       CoeffVectorType::ConjugateReturnType>::type}
      > \hyperlink{group___eigenvalues___module_af322315c8bea9990152c9d09bfa2a69f}{HouseholderSequenceType};
00100 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00113}\hyperlink{group___eigenvalues___module_a9ea2e6154bf35494ee68e037f0867cbd}{00113}     \textcolor{keyword}{explicit} \hyperlink{group___eigenvalues___module_a9ea2e6154bf35494ee68e037f0867cbd}{Tridiagonalization}(Index size = Size==\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? 2 : Size)
00114       : m\_matrix(size,size),
00115         m\_hCoeffs(size > 1 ? size-1 : 1),
00116         m\_isInitialized(false)
00117     \{\}
00118 
00129     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00130}\hyperlink{group___eigenvalues___module_a05406b7df9a92fdcba72d31443f67a98}{00130}     \textcolor{keyword}{explicit} \hyperlink{group___eigenvalues___module_a05406b7df9a92fdcba72d31443f67a98}{Tridiagonalization}(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00131       : m\_matrix(matrix.derived()),
00132         m\_hCoeffs(matrix.cols() > 1 ? matrix.cols()-1 : 1),
00133         m\_isInitialized(false)
00134     \{
00135       internal::tridiagonalization\_inplace(m\_matrix, m\_hCoeffs);
00136       m\_isInitialized = \textcolor{keyword}{true};
00137     \}
00138 
00156     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00157}\hyperlink{group___eigenvalues___module_acd288abb081d3b40b87e4b98cd8f6ee9}{00157}     \hyperlink{group___eigenvalues___module_class_eigen_1_1_tridiagonalization}{Tridiagonalization}& \hyperlink{group___eigenvalues___module_acd288abb081d3b40b87e4b98cd8f6ee9}{compute}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00158     \{
00159       m\_matrix = matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}();
00160       m\_hCoeffs.resize(matrix.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()-1, 1);
00161       internal::tridiagonalization\_inplace(m\_matrix, m\_hCoeffs);
00162       m\_isInitialized = \textcolor{keyword}{true};
00163       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00164     \}
00165 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00182}\hyperlink{group___eigenvalues___module_ac95b4e43dcf6c3c5074b8bea4fc67887}{00182}     \textcolor{keyword}{inline} CoeffVectorType \hyperlink{group___eigenvalues___module_ac95b4e43dcf6c3c5074b8bea4fc67887}{householderCoefficients}()\textcolor{keyword}{ const}
00183 \textcolor{keyword}{    }\{
00184       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00185       \textcolor{keywordflow}{return} m\_hCoeffs;
00186     \}
00187 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00219}\hyperlink{group___eigenvalues___module_a47858b3895e64acafb1bb2e97f98a154}{00219}     \textcolor{keyword}{inline} \textcolor{keyword}{const} MatrixType& \hyperlink{group___eigenvalues___module_a47858b3895e64acafb1bb2e97f98a154}{packedMatrix}()\textcolor{keyword}{ const}
00220 \textcolor{keyword}{    }\{
00221       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00222       \textcolor{keywordflow}{return} m\_matrix;
00223     \}
00224 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00240}\hyperlink{group___eigenvalues___module_a000f7392eda930576ffd2af1fae54af2}{00240}     HouseholderSequenceType \hyperlink{group___eigenvalues___module_a000f7392eda930576ffd2af1fae54af2}{matrixQ}()\textcolor{keyword}{ const}
00241 \textcolor{keyword}{    }\{
00242       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00243       \textcolor{keywordflow}{return} HouseholderSequenceType(m\_matrix, m\_hCoeffs.conjugate())
00244              .setLength(m\_matrix.rows() - 1)
00245              .setShift(1);
00246     \}
00247 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00265}\hyperlink{group___eigenvalues___module_a6eb5ef94b8b9bb013c0e69b6df56d0df}{00265}     MatrixTReturnType \hyperlink{group___eigenvalues___module_a6eb5ef94b8b9bb013c0e69b6df56d0df}{matrixT}()\textcolor{keyword}{ const}
00266 \textcolor{keyword}{    }\{
00267       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00268       \textcolor{keywordflow}{return} MatrixTReturnType(m\_matrix.real());
00269     \}
00270 
00284     DiagonalReturnType diagonal() \textcolor{keyword}{const};
00285 
00296     SubDiagonalReturnType subDiagonal() \textcolor{keyword}{const};
00297 
00298   \textcolor{keyword}{protected}:
00299 
00300     MatrixType m\_matrix;
00301     CoeffVectorType m\_hCoeffs;
00302     \textcolor{keywordtype}{bool} m\_isInitialized;
00303 \};
00304 
00305 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00306 \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{Tridiagonalization<MatrixType>::DiagonalReturnType}
00307 \hyperlink{group___eigenvalues___module_a0b7ff4860aa6f7c0761b1059c012fd8e}{Tridiagonalization<MatrixType>::diagonal}()\textcolor{keyword}{ const}
00308 \textcolor{keyword}{}\{
00309   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00310   \textcolor{keywordflow}{return} m\_matrix.diagonal().real();
00311 \}
00312 
00313 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00314 \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{Tridiagonalization<MatrixType>::SubDiagonalReturnType}
00315 \hyperlink{group___eigenvalues___module_ac423dbb91157c159bdcb4b5a8371232e}{Tridiagonalization<MatrixType>::subDiagonal}()\textcolor{keyword}{ const}
00316 \textcolor{keyword}{}\{
00317   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Tridiagonalization is not initialized."});
00318   \textcolor{keywordflow}{return} m\_matrix.template diagonal<-1>().real();
00319 \}
00320 
00321 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00322 
00346 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} CoeffVectorType>
00347 \textcolor{keywordtype}{void} tridiagonalization\_inplace(\hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{MatrixType}& matA, \hyperlink{group___core___module}{CoeffVectorType}& hCoeffs)
00348 \{
00349   \textcolor{keyword}{using} numext::conj;
00350   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00351   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00352   \hyperlink{group___eigenvalues___module_a7bd1f9fccec1e93b77a2214b2d30aae9}{Index} n = matA.rows();
00353   eigen\_assert(n==matA.cols());
00354   eigen\_assert(n==hCoeffs.size()+1 || n==1);
00355   
00356   \textcolor{keywordflow}{for} (\hyperlink{group___eigenvalues___module_a7bd1f9fccec1e93b77a2214b2d30aae9}{Index} i = 0; i<n-1; ++i)
00357   \{
00358     \hyperlink{group___eigenvalues___module_a7bd1f9fccec1e93b77a2214b2d30aae9}{Index} remainingSize = n-i-1;
00359     RealScalar beta;
00360     Scalar h;
00361     matA.col(i).tail(remainingSize).makeHouseholderInPlace(h, beta);
00362 
00363     \textcolor{comment}{// Apply similarity transformation to remaining columns,}
00364     \textcolor{comment}{// i.e., A = H A H' where H = I - h v v' and v = matA.col(i).tail(n-i-1)}
00365     matA.col(i).coeffRef(i+1) = 1;
00366 
00367     hCoeffs.tail(n-i-1).noalias() = (matA.bottomRightCorner(remainingSize,remainingSize).template 
      selfadjointView<Lower>()
00368                                   * (conj(h) * matA.col(i).tail(remainingSize)));
00369 
00370     hCoeffs.tail(n-i-1) += (conj(h)*RealScalar(-0.5)*(hCoeffs.tail(remainingSize).dot(matA.col(i).tail(
      remainingSize)))) * matA.col(i).tail(n-i-1);
00371 
00372     matA.bottomRightCorner(remainingSize, remainingSize).template selfadjointView<Lower>()
00373       .rankUpdate(matA.col(i).tail(remainingSize), hCoeffs.tail(remainingSize), Scalar(-1));
00374 
00375     matA.col(i).\hyperlink{class_eigen_1_1_plain_object_base_a25626a55b26a4323565f79d1b7c48ea8}{coeffRef}(i+1) = beta;
00376     hCoeffs.\hyperlink{class_eigen_1_1_plain_object_base_a25626a55b26a4323565f79d1b7c48ea8}{coeffRef}(i) = h;
00377   \}
00378 \}
00379 
00380 \textcolor{comment}{// forward declaration, implementation at the end of this file}
00381 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{MatrixType},
00382          \textcolor{keywordtype}{int} Size=MatrixType::ColsAtCompileTime,
00383          \textcolor{keywordtype}{bool} IsComplex=\hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<typename MatrixType::Scalar>::IsComplex}
      >
00384 \textcolor{keyword}{struct }tridiagonalization\_inplace\_selector;
00385 
00426 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} DiagonalType, \textcolor{keyword}{typename} SubDiagonalType>
00427 \textcolor{keywordtype}{void} tridiagonalization\_inplace(\hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{MatrixType}& mat, \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalType}& diag, 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{SubDiagonalType}& subdiag, \textcolor{keywordtype}{bool} extractQ)
00428 \{
00429   eigen\_assert(mat.cols()==mat.rows() && diag.size()==mat.rows() && subdiag.size()==mat.rows()-1);
00430   tridiagonalization\_inplace\_selector<MatrixType>::run(mat, diag, subdiag, extractQ);
00431 \}
00432 
00436 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} Size, \textcolor{keywordtype}{bool} IsComplex>
00437 \textcolor{keyword}{struct }tridiagonalization\_inplace\_selector
00438 \{
00439   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___core___module}{Tridiagonalization<MatrixType>::CoeffVectorType}
       \hyperlink{group___core___module}{CoeffVectorType};
00440   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{Tridiagonalization<MatrixType>::HouseholderSequenceType}
       \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{HouseholderSequenceType};
00441   \textcolor{keyword}{template}<\textcolor{keyword}{typename} DiagonalType, \textcolor{keyword}{typename} SubDiagonalType>
00442   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(\hyperlink{group___eigenvalues___module_add0f4b2216d0ea8ee0f7d8525deaf0a9}{MatrixType}& mat, \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalType}& diag, 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{SubDiagonalType}& subdiag, \textcolor{keywordtype}{bool} extractQ)
00443   \{
00444     CoeffVectorType hCoeffs(mat.cols()-1);
00445     tridiagonalization\_inplace(mat,hCoeffs);
00446     diag = mat.diagonal().real();
00447     subdiag = mat.template diagonal<-1>().real();
00448     \textcolor{keywordflow}{if}(extractQ)
00449       mat = HouseholderSequenceType(mat, hCoeffs.conjugate())
00450             .setLength(mat.rows() - 1)
00451             .setShift(1);
00452   \}
00453 \};
00454 
00459 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00460 \textcolor{keyword}{struct }tridiagonalization\_inplace\_selector<MatrixType,3,false>
00461 \{
00462   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00463   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00464 
00465   \textcolor{keyword}{template}<\textcolor{keyword}{typename} DiagonalType, \textcolor{keyword}{typename} SubDiagonalType>
00466   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(MatrixType& mat, \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalType}& diag, 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{SubDiagonalType}& subdiag, \textcolor{keywordtype}{bool} extractQ)
00467   \{
00468     \textcolor{keyword}{using} std::sqrt;
00469     \textcolor{keyword}{const} RealScalar tol = (std::numeric\_limits<RealScalar>::min)();
00470     diag[0] = mat(0,0);
00471     RealScalar v1norm2 = numext::abs2(mat(2,0));
00472     \textcolor{keywordflow}{if}(v1norm2 <= tol)
00473     \{
00474       diag[1] = mat(1,1);
00475       diag[2] = mat(2,2);
00476       subdiag[0] = mat(1,0);
00477       subdiag[1] = mat(2,1);
00478       \textcolor{keywordflow}{if} (extractQ)
00479         mat.setIdentity();
00480     \}
00481     \textcolor{keywordflow}{else}
00482     \{
00483       RealScalar beta = sqrt(numext::abs2(mat(1,0)) + v1norm2);
00484       RealScalar invBeta = RealScalar(1)/beta;
00485       Scalar m01 = mat(1,0) * invBeta;
00486       Scalar m02 = mat(2,0) * invBeta;
00487       Scalar q = RealScalar(2)*m01*mat(2,1) + m02*(mat(2,2) - mat(1,1));
00488       diag[1] = mat(1,1) + m02*q;
00489       diag[2] = mat(2,2) - m02*q;
00490       subdiag[0] = beta;
00491       subdiag[1] = mat(2,1) - m01 * q;
00492       \textcolor{keywordflow}{if} (extractQ)
00493       \{
00494         mat << 1,   0,    0,
00495                0, m01,  m02,
00496                0, m02, -m01;
00497       \}
00498     \}
00499   \}
00500 \};
00501 
00505 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{bool} IsComplex>
00506 \textcolor{keyword}{struct }tridiagonalization\_inplace\_selector<MatrixType,1,IsComplex>
00507 \{
00508   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00509 
00510   \textcolor{keyword}{template}<\textcolor{keyword}{typename} DiagonalType, \textcolor{keyword}{typename} SubDiagonalType>
00511   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(MatrixType& mat, \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{DiagonalType}& diag, 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{SubDiagonalType}&, \textcolor{keywordtype}{bool} extractQ)
00512   \{
00513     diag(0,0) = numext::real(mat(0,0));
00514     \textcolor{keywordflow}{if}(extractQ)
00515       mat(0,0) = Scalar(1);
00516   \}
00517 \};
00518 
00526 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }TridiagonalizationMatrixTReturnType
00527 : \textcolor{keyword}{public} \hyperlink{group___core___module_class_eigen_1_1_return_by_value}{ReturnByValue}<TridiagonalizationMatrixTReturnType<MatrixType> >
00528 \{
00529   \textcolor{keyword}{public}:
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_tridiagonalization_8h_source_l00534}\hyperlink{struct_eigen_1_1internal_1_1_tridiagonalization_matrix_t_return_type_ac49f3c4df8b40dfa002c6e04e3d1b97f}{00534}     \hyperlink{struct_eigen_1_1internal_1_1_tridiagonalization_matrix_t_return_type_ac49f3c4df8b40dfa002c6e04e3d1b97f}{TridiagonalizationMatrixTReturnType}(\textcolor{keyword}{const} MatrixType& mat) : 
      m\_matrix(mat) \{ \}
00535 
00536     \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResultType>
00537     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} evalTo(ResultType& result)\textcolor{keyword}{ const}
00538 \textcolor{keyword}{    }\{
00539       result.setZero();
00540       result.template diagonal<1>() = m\_matrix.template diagonal<-1>().conjugate();
00541       result.diagonal() = m\_matrix.diagonal();
00542       result.template diagonal<-1>() = m\_matrix.template diagonal<-1>();
00543     \}
00544 
00545     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.rows(); \}
00546     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.cols(); \}
00547 
00548   \textcolor{keyword}{protected}:
00549     \textcolor{keyword}{typename} MatrixType::Nested m\_matrix;
00550 \};
00551 
00552 \} \textcolor{comment}{// end namespace internal}
00553 
00554 \} \textcolor{comment}{// end namespace Eigen}
00555 
00556 \textcolor{preprocessor}{#endif // EIGEN\_TRIDIAGONALIZATION\_H}
\end{DoxyCode}
