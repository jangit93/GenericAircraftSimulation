\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__inflation_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+inflation.cpp}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__inflation_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+inflation.\+cpp@{cxx11\+\_\+tensor\+\_\+inflation.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2015 Ke Yang <yangke@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 
00016 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} DataLayout>
00017 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_simple\_inflation()
00018 \{
00019   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} tensor(2,3,5,7);
00020   tensor.setRandom();
00021   array<ptrdiff\_t, 4> strides;
00022 
00023   strides[0] = 1;
00024   strides[1] = 1;
00025   strides[2] = 1;
00026   strides[3] = 1;
00027 
00028   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} no\_stride;
00029   no\_stride = tensor.inflate(strides);
00030 
00031   VERIFY\_IS\_EQUAL(no\_stride.dimension(0), 2);
00032   VERIFY\_IS\_EQUAL(no\_stride.dimension(1), 3);
00033   VERIFY\_IS\_EQUAL(no\_stride.dimension(2), 5);
00034   VERIFY\_IS\_EQUAL(no\_stride.dimension(3), 7);
00035 
00036   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00037     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00038       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 5; ++k) \{
00039         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00040           VERIFY\_IS\_EQUAL(tensor(i,j,k,l), no\_stride(i,j,k,l));
00041         \}
00042       \}
00043     \}
00044   \}
00045 
00046   strides[0] = 2;
00047   strides[1] = 4;
00048   strides[2] = 2;
00049   strides[3] = 3;
00050   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} inflated;
00051   inflated = tensor.inflate(strides);
00052 
00053   VERIFY\_IS\_EQUAL(inflated.dimension(0), 3);
00054   VERIFY\_IS\_EQUAL(inflated.dimension(1), 9);
00055   VERIFY\_IS\_EQUAL(inflated.dimension(2), 9);
00056   VERIFY\_IS\_EQUAL(inflated.dimension(3), 19);
00057 
00058   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 3; ++i) \{
00059     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 9; ++j) \{
00060       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 9; ++k) \{
00061         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 19; ++l) \{
00062           \textcolor{keywordflow}{if} (i % 2 == 0 &&
00063               j % 4 == 0 &&
00064               k % 2 == 0 &&
00065               l % 3 == 0) \{
00066             VERIFY\_IS\_EQUAL(inflated(i,j,k,l),
00067                             tensor(i/2, j/4, k/2, l/3));
00068           \} \textcolor{keywordflow}{else} \{
00069             VERIFY\_IS\_EQUAL(0, inflated(i,j,k,l));
00070           \}
00071         \}
00072       \}
00073     \}
00074   \}
00075 \}
00076 
00077 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_inflation()
00078 \{
00079   CALL\_SUBTEST(test\_simple\_inflation<ColMajor>());
00080   CALL\_SUBTEST(test\_simple\_inflation<RowMajor>());
00081 \}
\end{DoxyCode}
