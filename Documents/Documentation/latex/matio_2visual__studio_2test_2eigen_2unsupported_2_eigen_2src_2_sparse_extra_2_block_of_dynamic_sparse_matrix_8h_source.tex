\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_sparse_extra_2_block_of_dynamic_sparse_matrix_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/\+Eigen/src/\+Sparse\+Extra/\+Block\+Of\+Dynamic\+Sparse\+Matrix.h}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_sparse_extra_2_block_of_dynamic_sparse_matrix_8h_source}\index{Block\+Of\+Dynamic\+Sparse\+Matrix.\+h@{Block\+Of\+Dynamic\+Sparse\+Matrix.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_SPARSE\_BLOCKFORDYNAMICMATRIX\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_SPARSE\_BLOCKFORDYNAMICMATRIX\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00014 
00015 \textcolor{preprocessor}{#if 0}
00016 
00017 \textcolor{comment}{// NOTE Have to be reimplemented as a specialization of BlockImpl< DynamicSparseMatrix<\_Scalar, \_Options,
       \_Index>, ... >}
00018 \textcolor{comment}{// See SparseBlock.h for an example}
00019 
00020 
00021 \textcolor{comment}{/***************************************************************************}
00022 \textcolor{comment}{* specialisation for DynamicSparseMatrix}
00023 \textcolor{comment}{***************************************************************************/}
00024 
00025 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_Scalar, \textcolor{keywordtype}{int} \_Options, \textcolor{keyword}{typename} \_Index, \textcolor{keywordtype}{int} Size>
00026 \textcolor{keyword}{class }SparseInnerVectorSet<DynamicSparseMatrix<\_Scalar, \_Options, \_Index>, Size>
00027   : \textcolor{keyword}{public} SparseMatrixBase<SparseInnerVectorSet<DynamicSparseMatrix<\_Scalar, \_Options, \_Index>, Size> >
00028 \{
00029     \textcolor{keyword}{typedef} DynamicSparseMatrix<\_Scalar, \_Options, \_Index> MatrixType;
00030   \textcolor{keyword}{public}:
00031 
00032     \textcolor{keyword}{enum} \{ IsRowMajor = internal::traits<SparseInnerVectorSet>::IsRowMajor \};
00033 
00034     EIGEN\_SPARSE\_PUBLIC\_INTERFACE(SparseInnerVectorSet)
00035     \textcolor{keyword}{class }InnerIterator: \textcolor{keyword}{public} MatrixType::InnerIterator
00036     \{
00037       \textcolor{keyword}{public}:
00038         \textcolor{keyword}{inline} InnerIterator(\textcolor{keyword}{const} SparseInnerVectorSet& xpr, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outer)
00039           : MatrixType::InnerIterator(xpr.m\_matrix, xpr.m\_outerStart + outer), m\_outer(outer)
00040         \{\}
00041         \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} IsRowMajor ? m\_outer : this->index(); \}
00042         \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} col()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} IsRowMajor ? this->index() : m\_outer; \}
00043       \textcolor{keyword}{protected}:
00044         \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_outer;
00045     \};
00046 
00047     \textcolor{keyword}{inline} SparseInnerVectorSet(\textcolor{keyword}{const} MatrixType& matrix, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outerStart, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outerSize)
00048       : m\_matrix(matrix), m\_outerStart(outerStart), m\_outerSize(outerSize)
00049     \{
00050       eigen\_assert( (outerStart>=0) && ((outerStart+outerSize)<=matrix.outerSize()) );
00051     \}
00052 
00053     \textcolor{keyword}{inline} SparseInnerVectorSet(\textcolor{keyword}{const} MatrixType& matrix, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outer)
00054       : m\_matrix(matrix), m\_outerStart(outer), m\_outerSize(Size)
00055     \{
00056       eigen\_assert(Size!=\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic});
00057       eigen\_assert( (outer>=0) && (outer<matrix.outerSize()) );
00058     \}
00059 
00060     \textcolor{keyword}{template}<\textcolor{keyword}{typename} OtherDerived>
00061     \textcolor{keyword}{inline} SparseInnerVectorSet& operator=(\textcolor{keyword}{const} SparseMatrixBase<OtherDerived>& other)
00062     \{
00063       \textcolor{keywordflow}{if} (IsRowMajor != ((OtherDerived::Flags&\hyperlink{group__flags_gae4f56c2a60bbe4bd2e44c5b19cbe8762}{RowMajorBit})==RowMajorBit))
00064       \{
00065         \textcolor{comment}{// need to transpose => perform a block evaluation followed by a big swap}
00066         DynamicSparseMatrix<Scalar,IsRowMajor?RowMajorBit:0> aux(other);
00067         *\textcolor{keyword}{this} = aux.markAsRValue();
00068       \}
00069       \textcolor{keywordflow}{else}
00070       \{
00071         \textcolor{comment}{// evaluate/copy vector per vector}
00072         \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j=0; j<m\_outerSize.value(); ++j)
00073         \{
00074           SparseVector<Scalar,IsRowMajor ? RowMajorBit : 0> aux(other.innerVector(j));
00075           m\_matrix.const\_cast\_derived().\_data()[m\_outerStart+j].swap(aux.\_data());
00076         \}
00077       \}
00078       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00079     \}
00080 
00081     \textcolor{keyword}{inline} SparseInnerVectorSet& operator=(\textcolor{keyword}{const} SparseInnerVectorSet& other)
00082     \{
00083       \textcolor{keywordflow}{return} \textcolor{keyword}{operator}=<SparseInnerVectorSet>(other);
00084     \}
00085 
00086     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nonZeros()\textcolor{keyword}{ const}
00087 \textcolor{keyword}{    }\{
00088       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} count = 0;
00089       \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j=0; j<m\_outerSize.value(); ++j)
00090         count += m\_matrix.\_data()[m\_outerStart+j].size();
00091       \textcolor{keywordflow}{return} count;
00092     \}
00093 
00094     \textcolor{keyword}{const} Scalar& lastCoeff()\textcolor{keyword}{ const}
00095 \textcolor{keyword}{    }\{
00096       EIGEN\_STATIC\_ASSERT\_VECTOR\_ONLY(SparseInnerVectorSet);
00097       eigen\_assert(m\_matrix.data()[m\_outerStart].size()>0);
00098       \textcolor{keywordflow}{return} m\_matrix.data()[m\_outerStart].vale(m\_matrix.data()[m\_outerStart].size()-1);
00099     \}
00100 
00101 \textcolor{comment}{//     template<typename Sparse>}
00102 \textcolor{comment}{//     inline SparseInnerVectorSet& operator=(const SparseMatrixBase<OtherDerived>& other)}
00103 \textcolor{comment}{//     \{}
00104 \textcolor{comment}{//       return *this;}
00105 \textcolor{comment}{//     \}}
00106 
00107     EIGEN\_STRONG\_INLINE \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} IsRowMajor ? m\_outerSize.value() : m\_matrix.rows()
      ; \}
00108     EIGEN\_STRONG\_INLINE \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} IsRowMajor ? m\_matrix.cols() : m\_outerSize.value()
      ; \}
00109 
00110   \textcolor{keyword}{protected}:
00111 
00112     \textcolor{keyword}{const} \textcolor{keyword}{typename} MatrixType::Nested m\_matrix;
00113     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_outerStart;
00114     \textcolor{keyword}{const} internal::variable\_if\_dynamic<Index, Size> m\_outerSize;
00115 
00116 \};
00117 
00118 \textcolor{preprocessor}{#endif}
00119 
00120 \} \textcolor{comment}{// end namespace Eigen}
00121 
00122 \textcolor{preprocessor}{#endif // EIGEN\_SPARSE\_BLOCKFORDYNAMICMATRIX\_H}
\end{DoxyCode}
