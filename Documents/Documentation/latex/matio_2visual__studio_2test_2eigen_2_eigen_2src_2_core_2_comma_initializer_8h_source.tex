\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_core_2_comma_initializer_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Core/\+Comma\+Initializer.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_core_2_comma_initializer_8h_source}\index{Comma\+Initializer.\+h@{Comma\+Initializer.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2006-2008 Benoit Jacob <jacob.benoit.1@gmail.com>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_COMMAINITIALIZER\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_COMMAINITIALIZER\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00027 \textcolor{keyword}{template}<\textcolor{keyword}{typename} XprType>
00028 \textcolor{keyword}{struct }CommaInitializer
00029 \{
00030   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} XprType::Scalar Scalar;
00031 
00032   EIGEN\_DEVICE\_FUNC
00033   \textcolor{keyword}{inline} CommaInitializer(XprType& xpr, \textcolor{keyword}{const} Scalar& s)
00034     : m\_xpr(xpr), m\_row(0), m\_col(1), m\_currentBlockRows(1)
00035   \{
00036     m\_xpr.coeffRef(0,0) = s;
00037   \}
00038 
00039   \textcolor{keyword}{template}<\textcolor{keyword}{typename} OtherDerived>
00040   EIGEN\_DEVICE\_FUNC
00041   \textcolor{keyword}{inline} CommaInitializer(XprType& xpr, \textcolor{keyword}{const} DenseBase<OtherDerived>& other)
00042     : m\_xpr(xpr), m\_row(0), m\_col(other.cols()), m\_currentBlockRows(other.rows())
00043   \{
00044     m\_xpr.block(0, 0, other.rows(), other.cols()) = other;
00045   \}
00046 
00047   \textcolor{comment}{/* Copy/Move constructor which transfers ownership. This is crucial in }
00048 \textcolor{comment}{   * absence of return value optimization to avoid assertions during destruction. */}
00049   \textcolor{comment}{// FIXME in C++11 mode this could be replaced by a proper RValue constructor}
00050   EIGEN\_DEVICE\_FUNC
00051   \textcolor{keyword}{inline} CommaInitializer(\textcolor{keyword}{const} CommaInitializer& o)
00052   : m\_xpr(o.m\_xpr), m\_row(o.m\_row), m\_col(o.m\_col), m\_currentBlockRows(o.m\_currentBlockRows) \{
00053     \textcolor{comment}{// Mark original object as finished. In absence of R-value references we need to const\_cast:}
00054     \textcolor{keyword}{const\_cast<}CommaInitializer&\textcolor{keyword}{>}(o).m\_row = m\_xpr.rows();
00055     \textcolor{keyword}{const\_cast<}CommaInitializer&\textcolor{keyword}{>}(o).m\_col = m\_xpr.cols();
00056     \textcolor{keyword}{const\_cast<}CommaInitializer&\textcolor{keyword}{>}(o).m\_currentBlockRows = 0;
00057   \}
00058 
00059   \textcolor{comment}{/* inserts a scalar value in the target matrix */}
00060   EIGEN\_DEVICE\_FUNC
00061   CommaInitializer& operator,(\textcolor{keyword}{const} Scalar& s)
00062   \{
00063     \textcolor{keywordflow}{if} (m\_col==m\_xpr.cols())
00064     \{
00065       m\_row+=m\_currentBlockRows;
00066       m\_col = 0;
00067       m\_currentBlockRows = 1;
00068       eigen\_assert(m\_row<m\_xpr.rows()
00069         && \textcolor{stringliteral}{"Too many rows passed to comma initializer (operator<<)"});
00070     \}
00071     eigen\_assert(m\_col<m\_xpr.cols()
00072       && \textcolor{stringliteral}{"Too many coefficients passed to comma initializer (operator<<)"});
00073     eigen\_assert(m\_currentBlockRows==1);
00074     m\_xpr.coeffRef(m\_row, m\_col++) = s;
00075     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00076   \}
00077 
00078   \textcolor{comment}{/* inserts a matrix expression in the target matrix */}
00079   \textcolor{keyword}{template}<\textcolor{keyword}{typename} OtherDerived>
00080   EIGEN\_DEVICE\_FUNC
00081   CommaInitializer& operator,(\textcolor{keyword}{const} DenseBase<OtherDerived>& other)
00082   \{
00083     \textcolor{keywordflow}{if} (m\_col==m\_xpr.cols() && (other.cols()!=0 || other.rows()!=m\_currentBlockRows))
00084     \{
00085       m\_row+=m\_currentBlockRows;
00086       m\_col = 0;
00087       m\_currentBlockRows = other.rows();
00088       eigen\_assert(m\_row+m\_currentBlockRows<=m\_xpr.rows()
00089         && \textcolor{stringliteral}{"Too many rows passed to comma initializer (operator<<)"});
00090     \}
00091     eigen\_assert((m\_col + other.cols() <= m\_xpr.cols())
00092       && \textcolor{stringliteral}{"Too many coefficients passed to comma initializer (operator<<)"});
00093     eigen\_assert(m\_currentBlockRows==other.rows());
00094     m\_xpr.template block<OtherDerived::RowsAtCompileTime, OtherDerived::ColsAtCompileTime>
00095                     (m\_row, m\_col, other.rows(), other.cols()) = other;
00096     m\_col += other.cols();
00097     \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00098   \}
00099 
00100   EIGEN\_DEVICE\_FUNC
00101   \textcolor{keyword}{inline} ~CommaInitializer()
00102 \textcolor{preprocessor}{#if defined VERIFY\_RAISES\_ASSERT && (!defined EIGEN\_NO\_ASSERTION\_CHECKING) && defined EIGEN\_EXCEPTIONS}
00103   EIGEN\_EXCEPTION\_SPEC(\hyperlink{struct_eigen_1_1eigen__assert__exception}{Eigen::eigen\_assert\_exception})
00104 \textcolor{preprocessor}{#endif}
00105   \{
00106       \hyperlink{group___core___module_a3be7de7fb3e8d3c4d3063f480181b17f}{finished}();
00107   \}
00108 
00116   EIGEN\_DEVICE\_FUNC
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_core_2_comma_initializer_8h_source_l00117}\hyperlink{group___core___module_a3be7de7fb3e8d3c4d3063f480181b17f}{00117}   \textcolor{keyword}{inline} XprType& \hyperlink{group___core___module_a3be7de7fb3e8d3c4d3063f480181b17f}{finished}() \{
00118       eigen\_assert(((m\_row+m\_currentBlockRows) == m\_xpr.rows() || m\_xpr.cols() == 0)
00119            && m\_col == m\_xpr.cols()
00120            && \textcolor{stringliteral}{"Too few coefficients passed to comma initializer (operator<<)"});
00121       \textcolor{keywordflow}{return} m\_xpr;
00122   \}
00123 
00124   XprType& m\_xpr;           \textcolor{comment}{// target expression}
00125   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_row;              \textcolor{comment}{// current row id}
00126   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_col;              \textcolor{comment}{// current col id}
00127   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_currentBlockRows; \textcolor{comment}{// current block height}
00128 \};
00129 
00143 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00144 \textcolor{keyword}{inline} \hyperlink{group___core___module_struct_eigen_1_1_comma_initializer}{CommaInitializer<Derived>} 
      \hyperlink{group___core___module_a0e575eb0ba6cc6bc5f347872abd8509d}{DenseBase<Derived>::operator<< }(\textcolor{keyword}{const} Scalar& s)
00145 \{
00146   \textcolor{keywordflow}{return} \hyperlink{group___core___module_struct_eigen_1_1_comma_initializer}{CommaInitializer<Derived>}(*\textcolor{keyword}{static\_cast<}Derived*\textcolor{keyword}{>}(\textcolor{keyword}{this}), s);
00147 \}
00148 
00150 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00151 \textcolor{keyword}{template}<\textcolor{keyword}{typename} OtherDerived>
00152 \textcolor{keyword}{inline} \hyperlink{group___core___module_struct_eigen_1_1_comma_initializer}{CommaInitializer<Derived>}
00153 \hyperlink{group___core___module_a0e575eb0ba6cc6bc5f347872abd8509d}{DenseBase<Derived>::operator<<}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_dense_base}{DenseBase<OtherDerived>}& other)
00154 \{
00155   \textcolor{keywordflow}{return} \hyperlink{group___core___module_struct_eigen_1_1_comma_initializer}{CommaInitializer<Derived>}(*\textcolor{keyword}{static\_cast<}Derived *\textcolor{keyword}{>}(\textcolor{keyword}{this}), other);
00156 \}
00157 
00158 \} \textcolor{comment}{// end namespace Eigen}
00159 
00160 \textcolor{preprocessor}{#endif // EIGEN\_COMMAINITIALIZER\_H}
\end{DoxyCode}
