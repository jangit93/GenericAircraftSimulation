\hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source}{}\section{eigen/\+Eigen/src/\+Sparse\+L\+U/\+Sparse\+L\+U\+\_\+\+Supernodal\+Matrix.h}
\label{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source}\index{Sparse\+L\+U\+\_\+\+Supernodal\+Matrix.\+h@{Sparse\+L\+U\+\_\+\+Supernodal\+Matrix.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2012 Désiré Nuentsa-Wakam <desire.nuentsa\_wakam@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2012 Gael Guennebaud <gael.guennebaud@inria.fr>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_SPARSELU\_SUPERNODAL\_MATRIX\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_SPARSELU\_SUPERNODAL\_MATRIX\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00027 \textcolor{comment}{/* TODO}
00028 \textcolor{comment}{ * InnerIterator as for sparsematrix }
00029 \textcolor{comment}{ * SuperInnerIterator to iterate through all supernodes }
00030 \textcolor{comment}{ * Function for triangular solve}
00031 \textcolor{comment}{ */}
00032 \textcolor{keyword}{template} <\textcolor{keyword}{typename} \_Scalar, \textcolor{keyword}{typename} \_StorageIndex>
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00033}\hyperlink{group___sparse_l_u___module}{00033} \textcolor{keyword}{class }\hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}
00034 \{
00035   \textcolor{keyword}{public}:
00036     \textcolor{keyword}{typedef} \_Scalar Scalar; 
00037     \textcolor{keyword}{typedef} \_StorageIndex StorageIndex;
00038     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{Matrix<StorageIndex,Dynamic,1>} 
      \hyperlink{group___core___module}{IndexVector};
00039     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{Matrix<Scalar,Dynamic,1>} \hyperlink{group___core___module}{ScalarVector};
00040   \textcolor{keyword}{public}:
00041     \hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}()
00042     \{
00043       
00044     \}
00045     \hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n,  ScalarVector& nzval, 
      IndexVector& nzval\_colptr, IndexVector& rowind,
00046              IndexVector& rowind\_colptr, IndexVector& col\_to\_sup, IndexVector& sup\_to\_col )
00047     \{
00048       \hyperlink{group___sparse_l_u___module_af1427486564e2c75b9da68f98bd04e63}{setInfos}(m, n, nzval, nzval\_colptr, rowind, rowind\_colptr, col\_to\_sup, sup\_to\_col);
00049     \}
00050     
00051     ~\hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}()
00052     \{
00053       
00054     \}
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00061}\hyperlink{group___sparse_l_u___module_af1427486564e2c75b9da68f98bd04e63}{00061}     \textcolor{keywordtype}{void} \hyperlink{group___sparse_l_u___module_af1427486564e2c75b9da68f98bd04e63}{setInfos}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n, ScalarVector& nzval, IndexVector& nzval\_colptr, 
      IndexVector& rowind,
00062              IndexVector& rowind\_colptr, IndexVector& col\_to\_sup, IndexVector& sup\_to\_col )
00063     \{
00064       m\_row = m;
00065       m\_col = n; 
00066       m\_nzval = nzval.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00067       m\_nzval\_colptr = nzval\_colptr.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00068       m\_rowind = rowind.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00069       m\_rowind\_colptr = rowind\_colptr.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00070       m\_nsuper = col\_to\_sup(n); 
00071       m\_col\_to\_sup = col\_to\_sup.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00072       m\_sup\_to\_col = sup\_to\_col.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}(); 
00073     \}
00074     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00078}\hyperlink{group___sparse_l_u___module_a5cc8f3887a09bd7d078a6744c158b5a0}{00078}     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___sparse_l_u___module_a5cc8f3887a09bd7d078a6744c158b5a0}{rows}() \{ \textcolor{keywordflow}{return} m\_row; \}
00079     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00083}\hyperlink{group___sparse_l_u___module_a57b3811f03be2d94c0cdd105aba1b932}{00083}     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___sparse_l_u___module_a57b3811f03be2d94c0cdd105aba1b932}{cols}() \{ \textcolor{keywordflow}{return} m\_col; \}
00084     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00090}\hyperlink{group___sparse_l_u___module_a6e9ce7d448b76811802d11baf3da97d3}{00090}     Scalar* \hyperlink{group___sparse_l_u___module_a6e9ce7d448b76811802d11baf3da97d3}{valuePtr}() \{  \textcolor{keywordflow}{return} m\_nzval; \}
00091     
00092     \textcolor{keyword}{const} Scalar* \hyperlink{group___sparse_l_u___module_a6e9ce7d448b76811802d11baf3da97d3}{valuePtr}()\textcolor{keyword}{ const }
00093 \textcolor{keyword}{    }\{
00094       \textcolor{keywordflow}{return} m\_nzval; 
00095     \}
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00099}\hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{00099}     StorageIndex* \hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()
00100     \{
00101       \textcolor{keywordflow}{return} m\_nzval\_colptr; 
00102     \}
00103     
00104     \textcolor{keyword}{const} StorageIndex* \hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()\textcolor{keyword}{ const}
00105 \textcolor{keyword}{    }\{
00106       \textcolor{keywordflow}{return} m\_nzval\_colptr; 
00107     \}
00108     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00112}\hyperlink{group___sparse_l_u___module_a8e6b4f399aa468a10e58db627d43a12a}{00112}     StorageIndex* \hyperlink{group___sparse_l_u___module_a8e6b4f399aa468a10e58db627d43a12a}{rowIndex}()  \{ \textcolor{keywordflow}{return} m\_rowind; \}
00113     
00114     \textcolor{keyword}{const} StorageIndex* \hyperlink{group___sparse_l_u___module_a8e6b4f399aa468a10e58db627d43a12a}{rowIndex}()\textcolor{keyword}{ const}
00115 \textcolor{keyword}{    }\{
00116       \textcolor{keywordflow}{return} m\_rowind; 
00117     \}
00118     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00122}\hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{00122}     StorageIndex* \hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}() \{ \textcolor{keywordflow}{return} m\_rowind\_colptr; \}
00123     
00124     \textcolor{keyword}{const} StorageIndex* \hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}()\textcolor{keyword}{ const}
00125 \textcolor{keyword}{    }\{
00126       \textcolor{keywordflow}{return} m\_rowind\_colptr; 
00127     \}
00128     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00132}\hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{00132}     StorageIndex* \hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{colToSup}()  \{ \textcolor{keywordflow}{return} m\_col\_to\_sup; \}
00133     
00134     \textcolor{keyword}{const} StorageIndex* \hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{colToSup}()\textcolor{keyword}{ const}
00135 \textcolor{keyword}{    }\{
00136       \textcolor{keywordflow}{return} m\_col\_to\_sup;       
00137     \}
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00141}\hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{00141}     StorageIndex* \hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}() \{ \textcolor{keywordflow}{return} m\_sup\_to\_col; \}
00142     
00143     \textcolor{keyword}{const} StorageIndex* \hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}()\textcolor{keyword}{ const}
00144 \textcolor{keyword}{    }\{
00145       \textcolor{keywordflow}{return} m\_sup\_to\_col;
00146     \}
00147     
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00151}\hyperlink{group___sparse_l_u___module_a9c0b29102914a6ef9cfd6280fa016fa8}{00151}     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___sparse_l_u___module_a9c0b29102914a6ef9cfd6280fa016fa8}{nsuper}()\textcolor{keyword}{ const}
00152 \textcolor{keyword}{    }\{
00153       \textcolor{keywordflow}{return} m\_nsuper; 
00154     \}
00155     
00156     \textcolor{keyword}{class }\hyperlink{class_eigen_1_1_inner_iterator}{InnerIterator}; 
00157     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Dest>
00158     \textcolor{keywordtype}{void} \hyperlink{group___sparse_l_u___module_ab93581127fd87b6bc467b6f67fcf4eeb}{solveInPlace}( \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Dest>}&X) \textcolor{keyword}{const};
00159     
00160       
00161       
00162     
00163   \textcolor{keyword}{protected}:
00164     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_row; \textcolor{comment}{// Number of rows}
00165     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_col; \textcolor{comment}{// Number of columns}
00166     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_nsuper; \textcolor{comment}{// Number of supernodes}
00167     Scalar* m\_nzval; \textcolor{comment}{//array of nonzero values packed by column}
00168     StorageIndex* m\_nzval\_colptr; \textcolor{comment}{//nzval\_colptr[j] Stores the location in nzval[] which starts column j}
00169     StorageIndex* m\_rowind; \textcolor{comment}{// Array of compressed row indices of rectangular supernodes}
00170     StorageIndex* m\_rowind\_colptr; \textcolor{comment}{//rowind\_colptr[j] stores the location in rowind[] which starts column j}
00171     StorageIndex* m\_col\_to\_sup; \textcolor{comment}{// col\_to\_sup[j] is the supernode number to which column j belongs}
00172     StorageIndex* m\_sup\_to\_col; \textcolor{comment}{//sup\_to\_col[s] points to the starting column of the s-th supernode}
00173     
00174   private :
00175 \};
00176 
00181 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} StorageIndex>
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00182}\hyperlink{class_eigen_1_1internal_1_1_mapped_super_nodal_matrix_1_1_inner_iterator}{00182} \textcolor{keyword}{class }\hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}<Scalar,StorageIndex>::
      \hyperlink{class_eigen_1_1internal_1_1_mapped_super_nodal_matrix_1_1_inner_iterator}{InnerIterator}
00183 \{
00184   \textcolor{keyword}{public}:
00185      \hyperlink{class_eigen_1_1internal_1_1_mapped_super_nodal_matrix_1_1_inner_iterator}{InnerIterator}(\textcolor{keyword}{const} \hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}& mat, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outer)
00186       : m\_matrix(mat),
00187         m\_outer(outer),
00188         m\_supno(mat.\hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{colToSup}()[outer]),
00189         m\_idval(mat.\hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()[outer]),
00190         m\_startidval(m\_idval),
00191         m\_endidval(mat.\hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()[outer+1]),
00192         m\_idrow(mat.\hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}()[mat.\hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}()[mat.\hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{colToSup}()[outer]]]),
00193         m\_endidrow(mat.\hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}()[mat.\hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}()[mat.
      \hyperlink{group___sparse_l_u___module_a1e2c012b63809715188aa7f0c722868d}{colToSup}()[outer]]+1])
00194     \{\}
00195     \textcolor{keyword}{inline} \hyperlink{class_eigen_1_1internal_1_1_mapped_super_nodal_matrix_1_1_inner_iterator}{InnerIterator}& operator++()
00196     \{ 
00197       m\_idval++; 
00198       m\_idrow++;
00199       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00200     \}
00201     \textcolor{keyword}{inline} Scalar value()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.valuePtr()[m\_idval]; \}
00202     
00203     \textcolor{keyword}{inline} Scalar& valueRef() \{ \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}Scalar&\textcolor{keyword}{>}(m\_matrix.valuePtr()[m\_idval]); \}
00204     
00205     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} index()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.rowIndex()[m\_idrow]; \}
00206     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} index(); \}
00207     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} col()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_outer; \}
00208     
00209     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} supIndex()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_supno; \}
00210     
00211     \textcolor{keyword}{inline} \textcolor{keyword}{operator} bool()\textcolor{keyword}{ const }
00212 \textcolor{keyword}{    }\{ 
00213       \textcolor{keywordflow}{return} ( (m\_idval < m\_endidval) && (m\_idval >= m\_startidval)
00214                 && (m\_idrow < m\_endidrow) );
00215     \}
00216     
00217   \textcolor{keyword}{protected}:
00218     \textcolor{keyword}{const} \hyperlink{group___sparse_l_u___module_class_eigen_1_1internal_1_1_mapped_super_nodal_matrix}{MappedSuperNodalMatrix}& m\_matrix; \textcolor{comment}{// Supernodal lower triangular matrix }
00219     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_outer;                    \textcolor{comment}{// Current column }
00220     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_supno;                    \textcolor{comment}{// Current SuperNode number}
00221     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_idval;                          \textcolor{comment}{// Index to browse the values in the current column}
00222     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_startidval;               \textcolor{comment}{// Start of the column value}
00223     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_endidval;                 \textcolor{comment}{// End of the column value}
00224     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_idrow;                          \textcolor{comment}{// Index to browse the row indices }
00225     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_endidrow;                       \textcolor{comment}{// End index of row indices of the current column}
00226 \};
00227 
00232 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index\_>
00233 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Dest>
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___supernodal_matrix_8h_source_l00234}\hyperlink{group___sparse_l_u___module_ab93581127fd87b6bc467b6f67fcf4eeb}{00234} \textcolor{keywordtype}{void} \hyperlink{group___sparse_l_u___module_ab93581127fd87b6bc467b6f67fcf4eeb}{MappedSuperNodalMatrix<Scalar,Index\_>::solveInPlace}
      ( \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Dest>}&X)\textcolor{keyword}{ const}
00235 \textcolor{keyword}{}\{
00236     \textcolor{comment}{/* Explicit type conversion as the Index type of MatrixBase<Dest> may be wider than Index */}
00237 \textcolor{comment}{//    eigen\_assert(X.rows() <= NumTraits<Index>::highest());}
00238 \textcolor{comment}{//    eigen\_assert(X.cols() <= NumTraits<Index>::highest());}
00239     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n    = int(X.rows());
00240     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nrhs = \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}(X.cols());
00241     \textcolor{keyword}{const} Scalar * Lval = \hyperlink{group___sparse_l_u___module_a6e9ce7d448b76811802d11baf3da97d3}{valuePtr}();                 \textcolor{comment}{// Nonzero values }
00242     \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>}
       work(n, nrhs);     \textcolor{comment}{// working vector}
00243     work.\hyperlink{class_eigen_1_1_plain_object_base_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}();
00244     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k <= \hyperlink{group___sparse_l_u___module_a9c0b29102914a6ef9cfd6280fa016fa8}{nsuper}(); k ++)
00245     \{
00246       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} fsupc = \hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}()[k];                    \textcolor{comment}{// First column of the current supernode
       }
00247       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} istart = \hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}()[fsupc];            \textcolor{comment}{// Pointer index to the subscript of
       the current column}
00248       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nsupr = \hyperlink{group___sparse_l_u___module_a826186a823bf49f81b20673cce741250}{rowIndexPtr}()[fsupc+1] - istart;  \textcolor{comment}{// Number of rows in the current
       supernode}
00249       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nsupc = \hyperlink{group___sparse_l_u___module_ab2b1bdd663288f1f2af09ec42a0a62a5}{supToCol}()[k+1] - fsupc;          \textcolor{comment}{// Number of columns in the current
       supernode}
00250       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nrow = nsupr - nsupc;                     \textcolor{comment}{// Number of rows in the non-diagonal part of
       the supernode}
00251       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} irow;                                     \textcolor{comment}{//Current index row}
00252       
00253       \textcolor{keywordflow}{if} (nsupc == 1 )
00254       \{
00255         \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = 0; j < nrhs; j++)
00256         \{
00257           \hyperlink{class_eigen_1_1_inner_iterator}{InnerIterator} it(*\textcolor{keyword}{this}, fsupc);
00258           ++it; \textcolor{comment}{// Skip the diagonal element}
00259           \textcolor{keywordflow}{for} (; it; ++it)
00260           \{
00261             irow = it.\hyperlink{class_eigen_1_1_inner_iterator_a3ab6f3afdf62740623cdc9ecb14dc132}{row}();
00262             X(irow, j) -= X(fsupc, j) * it.\hyperlink{class_eigen_1_1_inner_iterator_ab04bccb41eb22ffcb92dc61125aab119}{value}();
00263           \}
00264         \}
00265       \}
00266       \textcolor{keywordflow}{else}
00267       \{
00268         \textcolor{comment}{// The supernode has more than one column }
00269         \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} luptr = \hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()[fsupc]; 
00270         \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} lda = \hyperlink{group___sparse_l_u___module_a87c0272aedd8ee01d4245bd719738b5d}{colIndexPtr}()[fsupc+1] - luptr;
00271         
00272         \textcolor{comment}{// Triangular solve }
00273         \hyperlink{group___core___module_class_eigen_1_1_map}{Map<const Matrix<Scalar,Dynamic,Dynamic, ColMajor>}
      , 0, \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>} > \hyperlink{group___core___module_class_eigen_1_1_matrix}{A}( &(Lval[luptr]), nsupc, nsupc, \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>}(lda) );
00274         \hyperlink{group___core___module_class_eigen_1_1_map}{Map< Matrix<Scalar,Dynamic,Dest::ColsAtCompileTime, ColMajor>}
      , 0, \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>} > U (&(X(fsupc,0)), nsupc, nrhs, \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>}(n) );
00275         U = A.template triangularView<UnitLower>().solve(U); 
00276         
00277         \textcolor{comment}{// Matrix-vector product }
00278         \textcolor{keyword}{new} (&A) \hyperlink{group___core___module_class_eigen_1_1_map}{Map}<\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,Dynamic, ColMajor>}
      , 0, \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>} > ( &(Lval[luptr+nsupc]), nrow, nsupc, 
      \hyperlink{class_eigen_1_1_outer_stride}{OuterStride<>}(lda) );
00279         work.topRows(nrow).noalias() = A * U;
00280         
00281         \textcolor{comment}{//Begin Scatter }
00282         \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = 0; j < nrhs; j++)
00283         \{
00284           \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} iptr = istart + nsupc; 
00285           \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < nrow; i++)
00286           \{
00287             irow = \hyperlink{group___sparse_l_u___module_a8e6b4f399aa468a10e58db627d43a12a}{rowIndex}()[iptr]; 
00288             X(irow, j) -= work(i, j); \textcolor{comment}{// Scatter operation}
00289             work(i, j) = Scalar(0); 
00290             iptr++;
00291           \}
00292         \}
00293       \}
00294     \} 
00295 \}
00296 
00297 \} \textcolor{comment}{// end namespace internal}
00298 
00299 \} \textcolor{comment}{// end namespace Eigen}
00300 
00301 \textcolor{preprocessor}{#endif // EIGEN\_SPARSELU\_MATRIX\_H}
\end{DoxyCode}
