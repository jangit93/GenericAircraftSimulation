\hypertarget{eigen_2blas_2f2c_2chpmv_8c_source}{}\section{eigen/blas/f2c/chpmv.c}
\label{eigen_2blas_2f2c_2chpmv_8c_source}\index{chpmv.\+c@{chpmv.\+c}}

\begin{DoxyCode}
00001 \textcolor{comment}{/* chpmv.f -- translated by f2c (version 20100827).}
00002 \textcolor{comment}{   You must link the resulting object file with libf2c:}
00003 \textcolor{comment}{    on Microsoft Windows system, link with libf2c.lib;}
00004 \textcolor{comment}{    on Linux or Unix systems, link with .../path/to/libf2c.a -lm}
00005 \textcolor{comment}{    or, if you install libf2c.a in a standard place, with -lf2c -lm}
00006 \textcolor{comment}{    -- in that order, at the end of the command line, as in}
00007 \textcolor{comment}{        cc *.o -lf2c -lm}
00008 \textcolor{comment}{    Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,}
00009 \textcolor{comment}{}
00010 \textcolor{comment}{        http://www.netlib.org/f2c/libf2c.zip}
00011 \textcolor{comment}{*/}
00012 
00013 \textcolor{preprocessor}{#include "datatypes.h"}
00014 
00015 \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} chpmv\_(\textcolor{keywordtype}{char} *uplo, integer *n, \hyperlink{structcomplex}{complex} *alpha, 
      \hyperlink{structcomplex}{complex} *
00016     ap, \hyperlink{structcomplex}{complex} *x, integer *incx, \hyperlink{structcomplex}{complex} *beta, \hyperlink{structcomplex}{complex} *y, integer *
00017     incy, ftnlen uplo\_len)
00018 \{
00019     \textcolor{comment}{/* System generated locals */}
00020     integer i\_\_1, i\_\_2, i\_\_3, i\_\_4, i\_\_5;
00021     real r\_\_1;
00022     \hyperlink{structcomplex}{complex} q\_\_1, q\_\_2, q\_\_3, q\_\_4;
00023 
00024     \textcolor{comment}{/* Builtin functions */}
00025     \textcolor{keywordtype}{void} r\_cnjg(\hyperlink{structcomplex}{complex} *, \hyperlink{structcomplex}{complex} *);
00026 
00027     \textcolor{comment}{/* Local variables */}
00028     integer i\_\_, j, k, kk, ix, iy, jx, jy, kx, ky, info;
00029     \hyperlink{structcomplex}{complex} temp1, temp2;
00030     \textcolor{keyword}{extern} logical lsame\_(\textcolor{keywordtype}{char} *, \textcolor{keywordtype}{char} *, ftnlen, ftnlen);
00031     \textcolor{keyword}{extern} \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} xerbla\_(\textcolor{keywordtype}{char} *, integer *, ftnlen);
00032 
00033 \textcolor{comment}{/*     .. Scalar Arguments .. */}
00034 \textcolor{comment}{/*     .. */}
00035 \textcolor{comment}{/*     .. Array Arguments .. */}
00036 \textcolor{comment}{/*     .. */}
00037 
00038 \textcolor{comment}{/*  Purpose */}
00039 \textcolor{comment}{/*  ======= */}
00040 
00041 \textcolor{comment}{/*  CHPMV  performs the matrix-vector operation */}
00042 
00043 \textcolor{comment}{/*     y := alpha*A*x + beta*y, */}
00044 
00045 \textcolor{comment}{/*  where alpha and beta are scalars, x and y are n element vectors and */}
00046 \textcolor{comment}{/*  A is an n by n hermitian matrix, supplied in packed form. */}
00047 
00048 \textcolor{comment}{/*  Arguments */}
00049 \textcolor{comment}{/*  ========== */}
00050 
00051 \textcolor{comment}{/*  UPLO   - CHARACTER*1. */}
00052 \textcolor{comment}{/*           On entry, UPLO specifies whether the upper or lower */}
00053 \textcolor{comment}{/*           triangular part of the matrix A is supplied in the packed */}
00054 \textcolor{comment}{/*           array AP as follows: */}
00055 
00056 \textcolor{comment}{/*              UPLO = 'U' or 'u'   The upper triangular part of A is */}
00057 \textcolor{comment}{/*                                  supplied in AP. */}
00058 
00059 \textcolor{comment}{/*              UPLO = 'L' or 'l'   The lower triangular part of A is */}
00060 \textcolor{comment}{/*                                  supplied in AP. */}
00061 
00062 \textcolor{comment}{/*           Unchanged on exit. */}
00063 
00064 \textcolor{comment}{/*  N      - INTEGER. */}
00065 \textcolor{comment}{/*           On entry, N specifies the order of the matrix A. */}
00066 \textcolor{comment}{/*           N must be at least zero. */}
00067 \textcolor{comment}{/*           Unchanged on exit. */}
00068 
00069 \textcolor{comment}{/*  ALPHA  - COMPLEX         . */}
00070 \textcolor{comment}{/*           On entry, ALPHA specifies the scalar alpha. */}
00071 \textcolor{comment}{/*           Unchanged on exit. */}
00072 
00073 \textcolor{comment}{/*  AP     - COMPLEX          array of DIMENSION at least */}
00074 \textcolor{comment}{/*           ( ( n*( n + 1 ) )/2 ). */}
00075 \textcolor{comment}{/*           Before entry with UPLO = 'U' or 'u', the array AP must */}
00076 \textcolor{comment}{/*           contain the upper triangular part of the hermitian matrix */}
00077 \textcolor{comment}{/*           packed sequentially, column by column, so that AP( 1 ) */}
00078 \textcolor{comment}{/*           contains a( 1, 1 ), AP( 2 ) and AP( 3 ) contain a( 1, 2 ) */}
00079 \textcolor{comment}{/*           and a( 2, 2 ) respectively, and so on. */}
00080 \textcolor{comment}{/*           Before entry with UPLO = 'L' or 'l', the array AP must */}
00081 \textcolor{comment}{/*           contain the lower triangular part of the hermitian matrix */}
00082 \textcolor{comment}{/*           packed sequentially, column by column, so that AP( 1 ) */}
00083 \textcolor{comment}{/*           contains a( 1, 1 ), AP( 2 ) and AP( 3 ) contain a( 2, 1 ) */}
00084 \textcolor{comment}{/*           and a( 3, 1 ) respectively, and so on. */}
00085 \textcolor{comment}{/*           Note that the imaginary parts of the diagonal elements need */}
00086 \textcolor{comment}{/*           not be set and are assumed to be zero. */}
00087 \textcolor{comment}{/*           Unchanged on exit. */}
00088 
00089 \textcolor{comment}{/*  X      - COMPLEX          array of dimension at least */}
00090 \textcolor{comment}{/*           ( 1 + ( n - 1 )*abs( INCX ) ). */}
00091 \textcolor{comment}{/*           Before entry, the incremented array X must contain the n */}
00092 \textcolor{comment}{/*           element vector x. */}
00093 \textcolor{comment}{/*           Unchanged on exit. */}
00094 
00095 \textcolor{comment}{/*  INCX   - INTEGER. */}
00096 \textcolor{comment}{/*           On entry, INCX specifies the increment for the elements of */}
00097 \textcolor{comment}{/*           X. INCX must not be zero. */}
00098 \textcolor{comment}{/*           Unchanged on exit. */}
00099 
00100 \textcolor{comment}{/*  BETA   - COMPLEX         . */}
00101 \textcolor{comment}{/*           On entry, BETA specifies the scalar beta. When BETA is */}
00102 \textcolor{comment}{/*           supplied as zero then Y need not be set on input. */}
00103 \textcolor{comment}{/*           Unchanged on exit. */}
00104 
00105 \textcolor{comment}{/*  Y      - COMPLEX          array of dimension at least */}
00106 \textcolor{comment}{/*           ( 1 + ( n - 1 )*abs( INCY ) ). */}
00107 \textcolor{comment}{/*           Before entry, the incremented array Y must contain the n */}
00108 \textcolor{comment}{/*           element vector y. On exit, Y is overwritten by the updated */}
00109 \textcolor{comment}{/*           vector y. */}
00110 
00111 \textcolor{comment}{/*  INCY   - INTEGER. */}
00112 \textcolor{comment}{/*           On entry, INCY specifies the increment for the elements of */}
00113 \textcolor{comment}{/*           Y. INCY must not be zero. */}
00114 \textcolor{comment}{/*           Unchanged on exit. */}
00115 
00116 \textcolor{comment}{/*  Further Details */}
00117 \textcolor{comment}{/*  =============== */}
00118 
00119 \textcolor{comment}{/*  Level 2 Blas routine. */}
00120 
00121 \textcolor{comment}{/*  -- Written on 22-October-1986. */}
00122 \textcolor{comment}{/*     Jack Dongarra, Argonne National Lab. */}
00123 \textcolor{comment}{/*     Jeremy Du Croz, Nag Central Office. */}
00124 \textcolor{comment}{/*     Sven Hammarling, Nag Central Office. */}
00125 \textcolor{comment}{/*     Richard Hanson, Sandia National Labs. */}
00126 
00127 \textcolor{comment}{/*  ===================================================================== */}
00128 
00129 \textcolor{comment}{/*     .. Parameters .. */}
00130 \textcolor{comment}{/*     .. */}
00131 \textcolor{comment}{/*     .. Local Scalars .. */}
00132 \textcolor{comment}{/*     .. */}
00133 \textcolor{comment}{/*     .. External Functions .. */}
00134 \textcolor{comment}{/*     .. */}
00135 \textcolor{comment}{/*     .. External Subroutines .. */}
00136 \textcolor{comment}{/*     .. */}
00137 \textcolor{comment}{/*     .. Intrinsic Functions .. */}
00138 \textcolor{comment}{/*     .. */}
00139 
00140 \textcolor{comment}{/*     Test the input parameters. */}
00141 
00142     \textcolor{comment}{/* Parameter adjustments */}
00143     --y;
00144     --x;
00145     --ap;
00146 
00147     \textcolor{comment}{/* Function Body */}
00148     info = 0;
00149     \textcolor{keywordflow}{if} (! lsame\_(uplo, \textcolor{stringliteral}{"U"}, (ftnlen)1, (ftnlen)1) && ! lsame\_(uplo, \textcolor{stringliteral}{"L"}, (
00150         ftnlen)1, (ftnlen)1)) \{
00151     info = 1;
00152     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*n < 0) \{
00153     info = 2;
00154     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*incx == 0) \{
00155     info = 6;
00156     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (*incy == 0) \{
00157     info = 9;
00158     \}
00159     \textcolor{keywordflow}{if} (info != 0) \{
00160     xerbla\_(\textcolor{stringliteral}{"CHPMV "}, &info, (ftnlen)6);
00161     \textcolor{keywordflow}{return} 0;
00162     \}
00163 
00164 \textcolor{comment}{/*     Quick return if possible. */}
00165 
00166     \textcolor{keywordflow}{if} (*n == 0 || (alpha->r == 0.f && alpha->i == 0.f && (beta->r == 1.f && 
00167                                                            beta->i == 0.f))) \{
00168     \textcolor{keywordflow}{return} 0;
00169     \}
00170 
00171 \textcolor{comment}{/*     Set up the start points in  X  and  Y. */}
00172 
00173     \textcolor{keywordflow}{if} (*incx > 0) \{
00174     kx = 1;
00175     \} \textcolor{keywordflow}{else} \{
00176     kx = 1 - (*n - 1) * *incx;
00177     \}
00178     \textcolor{keywordflow}{if} (*incy > 0) \{
00179     ky = 1;
00180     \} \textcolor{keywordflow}{else} \{
00181     ky = 1 - (*n - 1) * *incy;
00182     \}
00183 
00184 \textcolor{comment}{/*     Start the operations. In this version the elements of the array AP */}
00185 \textcolor{comment}{/*     are accessed sequentially with one pass through AP. */}
00186 
00187 \textcolor{comment}{/*     First form  y := beta*y. */}
00188 
00189     \textcolor{keywordflow}{if} (beta->r != 1.f || beta->i != 0.f) \{
00190     \textcolor{keywordflow}{if} (*incy == 1) \{
00191         \textcolor{keywordflow}{if} (beta->r == 0.f && beta->i == 0.f) \{
00192         i\_\_1 = *n;
00193         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{
00194             i\_\_2 = i\_\_;
00195             y[i\_\_2].r = 0.f, y[i\_\_2].i = 0.f;
00196 \textcolor{comment}{/* L10: */}
00197         \}
00198         \} \textcolor{keywordflow}{else} \{
00199         i\_\_1 = *n;
00200         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{
00201             i\_\_2 = i\_\_;
00202             i\_\_3 = i\_\_;
00203             q\_\_1.r = beta->r * y[i\_\_3].r - beta->i * y[i\_\_3].i, 
00204                 q\_\_1.i = beta->r * y[i\_\_3].i + beta->i * y[i\_\_3]
00205                 .r;
00206             y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00207 \textcolor{comment}{/* L20: */}
00208         \}
00209         \}
00210     \} \textcolor{keywordflow}{else} \{
00211         iy = ky;
00212         \textcolor{keywordflow}{if} (beta->r == 0.f && beta->i == 0.f) \{
00213         i\_\_1 = *n;
00214         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{
00215             i\_\_2 = iy;
00216             y[i\_\_2].r = 0.f, y[i\_\_2].i = 0.f;
00217             iy += *incy;
00218 \textcolor{comment}{/* L30: */}
00219         \}
00220         \} \textcolor{keywordflow}{else} \{
00221         i\_\_1 = *n;
00222         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_1; ++i\_\_) \{
00223             i\_\_2 = iy;
00224             i\_\_3 = iy;
00225             q\_\_1.r = beta->r * y[i\_\_3].r - beta->i * y[i\_\_3].i, 
00226                 q\_\_1.i = beta->r * y[i\_\_3].i + beta->i * y[i\_\_3]
00227                 .r;
00228             y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00229             iy += *incy;
00230 \textcolor{comment}{/* L40: */}
00231         \}
00232         \}
00233     \}
00234     \}
00235     \textcolor{keywordflow}{if} (alpha->r == 0.f && alpha->i == 0.f) \{
00236     \textcolor{keywordflow}{return} 0;
00237     \}
00238     kk = 1;
00239     \textcolor{keywordflow}{if} (lsame\_(uplo, \textcolor{stringliteral}{"U"}, (ftnlen)1, (ftnlen)1)) \{
00240 
00241 \textcolor{comment}{/*        Form  y  when AP contains the upper triangle. */}
00242 
00243     \textcolor{keywordflow}{if} (*incx == 1 && *incy == 1) \{
00244         i\_\_1 = *n;
00245         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{
00246         i\_\_2 = j;
00247         q\_\_1.r = alpha->r * x[i\_\_2].r - alpha->i * x[i\_\_2].i, q\_\_1.i =
00248              alpha->r * x[i\_\_2].i + alpha->i * x[i\_\_2].r;
00249         temp1.r = q\_\_1.r, temp1.i = q\_\_1.i;
00250         temp2.r = 0.f, temp2.i = 0.f;
00251         k = kk;
00252         i\_\_2 = j - 1;
00253         \textcolor{keywordflow}{for} (i\_\_ = 1; i\_\_ <= i\_\_2; ++i\_\_) \{
00254             i\_\_3 = i\_\_;
00255             i\_\_4 = i\_\_;
00256             i\_\_5 = k;
00257             q\_\_2.r = temp1.r * ap[i\_\_5].r - temp1.i * ap[i\_\_5].i, 
00258                 q\_\_2.i = temp1.r * ap[i\_\_5].i + temp1.i * ap[i\_\_5]
00259                 .r;
00260             q\_\_1.r = y[i\_\_4].r + q\_\_2.r, q\_\_1.i = y[i\_\_4].i + q\_\_2.i;
00261             y[i\_\_3].r = q\_\_1.r, y[i\_\_3].i = q\_\_1.i;
00262             r\_cnjg(&q\_\_3, &ap[k]);
00263             i\_\_3 = i\_\_;
00264             q\_\_2.r = q\_\_3.r * x[i\_\_3].r - q\_\_3.i * x[i\_\_3].i, q\_\_2.i =
00265                  q\_\_3.r * x[i\_\_3].i + q\_\_3.i * x[i\_\_3].r;
00266             q\_\_1.r = temp2.r + q\_\_2.r, q\_\_1.i = temp2.i + q\_\_2.i;
00267             temp2.r = q\_\_1.r, temp2.i = q\_\_1.i;
00268             ++k;
00269 \textcolor{comment}{/* L50: */}
00270         \}
00271         i\_\_2 = j;
00272         i\_\_3 = j;
00273         i\_\_4 = kk + j - 1;
00274         r\_\_1 = ap[i\_\_4].r;
00275         q\_\_3.r = r\_\_1 * temp1.r, q\_\_3.i = r\_\_1 * temp1.i;
00276         q\_\_2.r = y[i\_\_3].r + q\_\_3.r, q\_\_2.i = y[i\_\_3].i + q\_\_3.i;
00277         q\_\_4.r = alpha->r * temp2.r - alpha->i * temp2.i, q\_\_4.i = 
00278             alpha->r * temp2.i + alpha->i * temp2.r;
00279         q\_\_1.r = q\_\_2.r + q\_\_4.r, q\_\_1.i = q\_\_2.i + q\_\_4.i;
00280         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00281         kk += j;
00282 \textcolor{comment}{/* L60: */}
00283         \}
00284     \} \textcolor{keywordflow}{else} \{
00285         jx = kx;
00286         jy = ky;
00287         i\_\_1 = *n;
00288         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{
00289         i\_\_2 = jx;
00290         q\_\_1.r = alpha->r * x[i\_\_2].r - alpha->i * x[i\_\_2].i, q\_\_1.i =
00291              alpha->r * x[i\_\_2].i + alpha->i * x[i\_\_2].r;
00292         temp1.r = q\_\_1.r, temp1.i = q\_\_1.i;
00293         temp2.r = 0.f, temp2.i = 0.f;
00294         ix = kx;
00295         iy = ky;
00296         i\_\_2 = kk + j - 2;
00297         \textcolor{keywordflow}{for} (k = kk; k <= i\_\_2; ++k) \{
00298             i\_\_3 = iy;
00299             i\_\_4 = iy;
00300             i\_\_5 = k;
00301             q\_\_2.r = temp1.r * ap[i\_\_5].r - temp1.i * ap[i\_\_5].i, 
00302                 q\_\_2.i = temp1.r * ap[i\_\_5].i + temp1.i * ap[i\_\_5]
00303                 .r;
00304             q\_\_1.r = y[i\_\_4].r + q\_\_2.r, q\_\_1.i = y[i\_\_4].i + q\_\_2.i;
00305             y[i\_\_3].r = q\_\_1.r, y[i\_\_3].i = q\_\_1.i;
00306             r\_cnjg(&q\_\_3, &ap[k]);
00307             i\_\_3 = ix;
00308             q\_\_2.r = q\_\_3.r * x[i\_\_3].r - q\_\_3.i * x[i\_\_3].i, q\_\_2.i =
00309                  q\_\_3.r * x[i\_\_3].i + q\_\_3.i * x[i\_\_3].r;
00310             q\_\_1.r = temp2.r + q\_\_2.r, q\_\_1.i = temp2.i + q\_\_2.i;
00311             temp2.r = q\_\_1.r, temp2.i = q\_\_1.i;
00312             ix += *incx;
00313             iy += *incy;
00314 \textcolor{comment}{/* L70: */}
00315         \}
00316         i\_\_2 = jy;
00317         i\_\_3 = jy;
00318         i\_\_4 = kk + j - 1;
00319         r\_\_1 = ap[i\_\_4].r;
00320         q\_\_3.r = r\_\_1 * temp1.r, q\_\_3.i = r\_\_1 * temp1.i;
00321         q\_\_2.r = y[i\_\_3].r + q\_\_3.r, q\_\_2.i = y[i\_\_3].i + q\_\_3.i;
00322         q\_\_4.r = alpha->r * temp2.r - alpha->i * temp2.i, q\_\_4.i = 
00323             alpha->r * temp2.i + alpha->i * temp2.r;
00324         q\_\_1.r = q\_\_2.r + q\_\_4.r, q\_\_1.i = q\_\_2.i + q\_\_4.i;
00325         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00326         jx += *incx;
00327         jy += *incy;
00328         kk += j;
00329 \textcolor{comment}{/* L80: */}
00330         \}
00331     \}
00332     \} \textcolor{keywordflow}{else} \{
00333 
00334 \textcolor{comment}{/*        Form  y  when AP contains the lower triangle. */}
00335 
00336     \textcolor{keywordflow}{if} (*incx == 1 && *incy == 1) \{
00337         i\_\_1 = *n;
00338         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{
00339         i\_\_2 = j;
00340         q\_\_1.r = alpha->r * x[i\_\_2].r - alpha->i * x[i\_\_2].i, q\_\_1.i =
00341              alpha->r * x[i\_\_2].i + alpha->i * x[i\_\_2].r;
00342         temp1.r = q\_\_1.r, temp1.i = q\_\_1.i;
00343         temp2.r = 0.f, temp2.i = 0.f;
00344         i\_\_2 = j;
00345         i\_\_3 = j;
00346         i\_\_4 = kk;
00347         r\_\_1 = ap[i\_\_4].r;
00348         q\_\_2.r = r\_\_1 * temp1.r, q\_\_2.i = r\_\_1 * temp1.i;
00349         q\_\_1.r = y[i\_\_3].r + q\_\_2.r, q\_\_1.i = y[i\_\_3].i + q\_\_2.i;
00350         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00351         k = kk + 1;
00352         i\_\_2 = *n;
00353         \textcolor{keywordflow}{for} (i\_\_ = j + 1; i\_\_ <= i\_\_2; ++i\_\_) \{
00354             i\_\_3 = i\_\_;
00355             i\_\_4 = i\_\_;
00356             i\_\_5 = k;
00357             q\_\_2.r = temp1.r * ap[i\_\_5].r - temp1.i * ap[i\_\_5].i, 
00358                 q\_\_2.i = temp1.r * ap[i\_\_5].i + temp1.i * ap[i\_\_5]
00359                 .r;
00360             q\_\_1.r = y[i\_\_4].r + q\_\_2.r, q\_\_1.i = y[i\_\_4].i + q\_\_2.i;
00361             y[i\_\_3].r = q\_\_1.r, y[i\_\_3].i = q\_\_1.i;
00362             r\_cnjg(&q\_\_3, &ap[k]);
00363             i\_\_3 = i\_\_;
00364             q\_\_2.r = q\_\_3.r * x[i\_\_3].r - q\_\_3.i * x[i\_\_3].i, q\_\_2.i =
00365                  q\_\_3.r * x[i\_\_3].i + q\_\_3.i * x[i\_\_3].r;
00366             q\_\_1.r = temp2.r + q\_\_2.r, q\_\_1.i = temp2.i + q\_\_2.i;
00367             temp2.r = q\_\_1.r, temp2.i = q\_\_1.i;
00368             ++k;
00369 \textcolor{comment}{/* L90: */}
00370         \}
00371         i\_\_2 = j;
00372         i\_\_3 = j;
00373         q\_\_2.r = alpha->r * temp2.r - alpha->i * temp2.i, q\_\_2.i = 
00374             alpha->r * temp2.i + alpha->i * temp2.r;
00375         q\_\_1.r = y[i\_\_3].r + q\_\_2.r, q\_\_1.i = y[i\_\_3].i + q\_\_2.i;
00376         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00377         kk += *n - j + 1;
00378 \textcolor{comment}{/* L100: */}
00379         \}
00380     \} \textcolor{keywordflow}{else} \{
00381         jx = kx;
00382         jy = ky;
00383         i\_\_1 = *n;
00384         \textcolor{keywordflow}{for} (j = 1; j <= i\_\_1; ++j) \{
00385         i\_\_2 = jx;
00386         q\_\_1.r = alpha->r * x[i\_\_2].r - alpha->i * x[i\_\_2].i, q\_\_1.i =
00387              alpha->r * x[i\_\_2].i + alpha->i * x[i\_\_2].r;
00388         temp1.r = q\_\_1.r, temp1.i = q\_\_1.i;
00389         temp2.r = 0.f, temp2.i = 0.f;
00390         i\_\_2 = jy;
00391         i\_\_3 = jy;
00392         i\_\_4 = kk;
00393         r\_\_1 = ap[i\_\_4].r;
00394         q\_\_2.r = r\_\_1 * temp1.r, q\_\_2.i = r\_\_1 * temp1.i;
00395         q\_\_1.r = y[i\_\_3].r + q\_\_2.r, q\_\_1.i = y[i\_\_3].i + q\_\_2.i;
00396         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00397         ix = jx;
00398         iy = jy;
00399         i\_\_2 = kk + *n - j;
00400         \textcolor{keywordflow}{for} (k = kk + 1; k <= i\_\_2; ++k) \{
00401             ix += *incx;
00402             iy += *incy;
00403             i\_\_3 = iy;
00404             i\_\_4 = iy;
00405             i\_\_5 = k;
00406             q\_\_2.r = temp1.r * ap[i\_\_5].r - temp1.i * ap[i\_\_5].i, 
00407                 q\_\_2.i = temp1.r * ap[i\_\_5].i + temp1.i * ap[i\_\_5]
00408                 .r;
00409             q\_\_1.r = y[i\_\_4].r + q\_\_2.r, q\_\_1.i = y[i\_\_4].i + q\_\_2.i;
00410             y[i\_\_3].r = q\_\_1.r, y[i\_\_3].i = q\_\_1.i;
00411             r\_cnjg(&q\_\_3, &ap[k]);
00412             i\_\_3 = ix;
00413             q\_\_2.r = q\_\_3.r * x[i\_\_3].r - q\_\_3.i * x[i\_\_3].i, q\_\_2.i =
00414                  q\_\_3.r * x[i\_\_3].i + q\_\_3.i * x[i\_\_3].r;
00415             q\_\_1.r = temp2.r + q\_\_2.r, q\_\_1.i = temp2.i + q\_\_2.i;
00416             temp2.r = q\_\_1.r, temp2.i = q\_\_1.i;
00417 \textcolor{comment}{/* L110: */}
00418         \}
00419         i\_\_2 = jy;
00420         i\_\_3 = jy;
00421         q\_\_2.r = alpha->r * temp2.r - alpha->i * temp2.i, q\_\_2.i = 
00422             alpha->r * temp2.i + alpha->i * temp2.r;
00423         q\_\_1.r = y[i\_\_3].r + q\_\_2.r, q\_\_1.i = y[i\_\_3].i + q\_\_2.i;
00424         y[i\_\_2].r = q\_\_1.r, y[i\_\_2].i = q\_\_1.i;
00425         jx += *incx;
00426         jy += *incy;
00427         kk += *n - j + 1;
00428 \textcolor{comment}{/* L120: */}
00429         \}
00430     \}
00431     \}
00432 
00433     \textcolor{keywordflow}{return} 0;
00434 
00435 \textcolor{comment}{/*     End of CHPMV . */}
00436 
00437 \} \textcolor{comment}{/* chpmv\_ */}
00438 
\end{DoxyCode}
