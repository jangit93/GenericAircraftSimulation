\hypertarget{eigen_2_eigen_2src_2_core_2products_2_triangular_solver_matrix___b_l_a_s_8h_source}{}\section{eigen/\+Eigen/src/\+Core/products/\+Triangular\+Solver\+Matrix\+\_\+\+B\+L\+AS.h}
\label{eigen_2_eigen_2src_2_core_2products_2_triangular_solver_matrix___b_l_a_s_8h_source}\index{Triangular\+Solver\+Matrix\+\_\+\+B\+L\+A\+S.\+h@{Triangular\+Solver\+Matrix\+\_\+\+B\+L\+A\+S.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ Copyright (c) 2011, Intel Corporation. All rights reserved.}
00003 \textcolor{comment}{}
00004 \textcolor{comment}{ Redistribution and use in source and binary forms, with or without modification,}
00005 \textcolor{comment}{ are permitted provided that the following conditions are met:}
00006 \textcolor{comment}{}
00007 \textcolor{comment}{ * Redistributions of source code must retain the above copyright notice, this}
00008 \textcolor{comment}{   list of conditions and the following disclaimer.}
00009 \textcolor{comment}{ * Redistributions in binary form must reproduce the above copyright notice,}
00010 \textcolor{comment}{   this list of conditions and the following disclaimer in the documentation}
00011 \textcolor{comment}{   and/or other materials provided with the distribution.}
00012 \textcolor{comment}{ * Neither the name of Intel Corporation nor the names of its contributors may}
00013 \textcolor{comment}{   be used to endorse or promote products derived from this software without}
00014 \textcolor{comment}{   specific prior written permission.}
00015 \textcolor{comment}{}
00016 \textcolor{comment}{ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00017 \textcolor{comment}{ ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00018 \textcolor{comment}{ WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00019 \textcolor{comment}{ DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR}
00020 \textcolor{comment}{ ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00021 \textcolor{comment}{ (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00022 \textcolor{comment}{ LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00023 \textcolor{comment}{ ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00024 \textcolor{comment}{ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00025 \textcolor{comment}{ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00026 \textcolor{comment}{}
00027 \textcolor{comment}{ ********************************************************************************}
00028 \textcolor{comment}{ *   Content : Eigen bindings to BLAS F77}
00029 \textcolor{comment}{ *   Triangular matrix * matrix product functionality based on ?TRMM.}
00030 \textcolor{comment}{ ********************************************************************************}
00031 \textcolor{comment}{*/}
00032 
00033 \textcolor{preprocessor}{#ifndef EIGEN\_TRIANGULAR\_SOLVER\_MATRIX\_BLAS\_H}
00034 \textcolor{preprocessor}{#define EIGEN\_TRIANGULAR\_SOLVER\_MATRIX\_BLAS\_H}
00035 
00036 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00037 
00038 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00039 
00040 \textcolor{comment}{// implements LeftSide op(triangular)^-1 * general}
00041 \textcolor{preprocessor}{#define EIGEN\_BLAS\_TRSM\_L(EIGTYPE, BLASTYPE, BLASPREFIX) \(\backslash\)}
00042 \textcolor{preprocessor}{template <typename Index, int Mode, bool Conjugate, int TriStorageOrder> \(\backslash\)}
00043 \textcolor{preprocessor}{struct triangular\_solve\_matrix<EIGTYPE,Index,OnTheLeft,Mode,Conjugate,TriStorageOrder,ColMajor> \(\backslash\)}
00044 \textcolor{preprocessor}{\{ \(\backslash\)}
00045 \textcolor{preprocessor}{  enum \{ \(\backslash\)}
00046 \textcolor{preprocessor}{    IsLower = (Mode&Lower) == Lower, \(\backslash\)}
00047 \textcolor{preprocessor}{    IsUnitDiag  = (Mode&UnitDiag) ? 1 : 0, \(\backslash\)}
00048 \textcolor{preprocessor}{    IsZeroDiag  = (Mode&ZeroDiag) ? 1 : 0, \(\backslash\)}
00049 \textcolor{preprocessor}{    conjA = ((TriStorageOrder==ColMajor) && Conjugate) ? 1 : 0 \(\backslash\)}
00050 \textcolor{preprocessor}{  \}; \(\backslash\)}
00051 \textcolor{preprocessor}{  static void run( \(\backslash\)}
00052 \textcolor{preprocessor}{      Index size, Index otherSize, \(\backslash\)}
00053 \textcolor{preprocessor}{      const EIGTYPE* \_tri, Index triStride, \(\backslash\)}
00054 \textcolor{preprocessor}{      EIGTYPE* \_other, Index otherStride, level3\_blocking<EIGTYPE,EIGTYPE>& }\textcolor{comment}{/*blocking*/}\textcolor{preprocessor}{) \(\backslash\)}
00055 \textcolor{preprocessor}{  \{ \(\backslash\)}
00056 \textcolor{preprocessor}{   BlasIndex m = convert\_index<BlasIndex>(size), n = convert\_index<BlasIndex>(otherSize), lda, ldb; \(\backslash\)}
00057 \textcolor{preprocessor}{   char side = 'L', uplo, diag='N', transa; \(\backslash\)}
00058 \textcolor{preprocessor}{   }\textcolor{comment}{/* Set alpha\_ */}\textcolor{preprocessor}{ \(\backslash\)}
00059 \textcolor{preprocessor}{   EIGTYPE alpha(1); \(\backslash\)}
00060 \textcolor{preprocessor}{   ldb = convert\_index<BlasIndex>(otherStride);\(\backslash\)}
00061 \textcolor{preprocessor}{\(\backslash\)}
00062 \textcolor{preprocessor}{   const EIGTYPE *a; \(\backslash\)}
00063 \textcolor{preprocessor}{}\textcolor{comment}{/* Set trans */}\textcolor{preprocessor}{ \(\backslash\)}
00064 \textcolor{preprocessor}{   transa = (TriStorageOrder==RowMajor) ? ((Conjugate) ? 'C' : 'T') : 'N'; \(\backslash\)}
00065 \textcolor{preprocessor}{}\textcolor{comment}{/* Set uplo */}\textcolor{preprocessor}{ \(\backslash\)}
00066 \textcolor{preprocessor}{   uplo = IsLower ? 'L' : 'U'; \(\backslash\)}
00067 \textcolor{preprocessor}{   if (TriStorageOrder==RowMajor) uplo = (uplo == 'L') ? 'U' : 'L'; \(\backslash\)}
00068 \textcolor{preprocessor}{}\textcolor{comment}{/* Set a, lda */}\textcolor{preprocessor}{ \(\backslash\)}
00069 \textcolor{preprocessor}{   typedef Matrix<EIGTYPE, Dynamic, Dynamic, TriStorageOrder> MatrixTri; \(\backslash\)}
00070 \textcolor{preprocessor}{   Map<const MatrixTri, 0, OuterStride<> > tri(\_tri,size,size,OuterStride<>(triStride)); \(\backslash\)}
00071 \textcolor{preprocessor}{   MatrixTri a\_tmp; \(\backslash\)}
00072 \textcolor{preprocessor}{\(\backslash\)}
00073 \textcolor{preprocessor}{   if (conjA) \{ \(\backslash\)}
00074 \textcolor{preprocessor}{     a\_tmp = tri.conjugate(); \(\backslash\)}
00075 \textcolor{preprocessor}{     a = a\_tmp.data(); \(\backslash\)}
00076 \textcolor{preprocessor}{     lda = convert\_index<BlasIndex>(a\_tmp.outerStride()); \(\backslash\)}
00077 \textcolor{preprocessor}{   \} else \{ \(\backslash\)}
00078 \textcolor{preprocessor}{     a = \_tri; \(\backslash\)}
00079 \textcolor{preprocessor}{     lda = convert\_index<BlasIndex>(triStride); \(\backslash\)}
00080 \textcolor{preprocessor}{   \} \(\backslash\)}
00081 \textcolor{preprocessor}{   if (IsUnitDiag) diag='U'; \(\backslash\)}
00082 \textcolor{preprocessor}{}\textcolor{comment}{/* call ?trsm*/}\textcolor{preprocessor}{ \(\backslash\)}
00083 \textcolor{preprocessor}{   BLASPREFIX##trsm\_(&side, &uplo, &transa, &diag, &m, &n, &numext::real\_ref(alpha), (const BLASTYPE*)a,
       &lda, (BLASTYPE*)\_other, &ldb); \(\backslash\)}
00084 \textcolor{preprocessor}{ \} \(\backslash\)}
00085 \textcolor{preprocessor}{\};}
00086 
00087 EIGEN\_BLAS\_TRSM\_L(\textcolor{keywordtype}{double},   \textcolor{keywordtype}{double}, d)
00088 EIGEN\_BLAS\_TRSM\_L(dcomplex, \textcolor{keywordtype}{double}, z)
00089 EIGEN\_BLAS\_TRSM\_L(\textcolor{keywordtype}{float},    \textcolor{keywordtype}{float},  s)
00090 EIGEN\_BLAS\_TRSM\_L(scomplex, \textcolor{keywordtype}{float},  c)
00091 
00092 
00093 \textcolor{comment}{// implements RightSide general * op(triangular)^-1}
00094 \textcolor{preprocessor}{#define EIGEN\_BLAS\_TRSM\_R(EIGTYPE, BLASTYPE, BLASPREFIX) \(\backslash\)}
00095 \textcolor{preprocessor}{template <typename Index, int Mode, bool Conjugate, int TriStorageOrder> \(\backslash\)}
00096 \textcolor{preprocessor}{struct triangular\_solve\_matrix<EIGTYPE,Index,OnTheRight,Mode,Conjugate,TriStorageOrder,ColMajor> \(\backslash\)}
00097 \textcolor{preprocessor}{\{ \(\backslash\)}
00098 \textcolor{preprocessor}{  enum \{ \(\backslash\)}
00099 \textcolor{preprocessor}{    IsLower = (Mode&Lower) == Lower, \(\backslash\)}
00100 \textcolor{preprocessor}{    IsUnitDiag  = (Mode&UnitDiag) ? 1 : 0, \(\backslash\)}
00101 \textcolor{preprocessor}{    IsZeroDiag  = (Mode&ZeroDiag) ? 1 : 0, \(\backslash\)}
00102 \textcolor{preprocessor}{    conjA = ((TriStorageOrder==ColMajor) && Conjugate) ? 1 : 0 \(\backslash\)}
00103 \textcolor{preprocessor}{  \}; \(\backslash\)}
00104 \textcolor{preprocessor}{  static void run( \(\backslash\)}
00105 \textcolor{preprocessor}{      Index size, Index otherSize, \(\backslash\)}
00106 \textcolor{preprocessor}{      const EIGTYPE* \_tri, Index triStride, \(\backslash\)}
00107 \textcolor{preprocessor}{      EIGTYPE* \_other, Index otherStride, level3\_blocking<EIGTYPE,EIGTYPE>& }\textcolor{comment}{/*blocking*/}\textcolor{preprocessor}{) \(\backslash\)}
00108 \textcolor{preprocessor}{  \{ \(\backslash\)}
00109 \textcolor{preprocessor}{   BlasIndex m = convert\_index<BlasIndex>(otherSize), n = convert\_index<BlasIndex>(size), lda, ldb; \(\backslash\)}
00110 \textcolor{preprocessor}{   char side = 'R', uplo, diag='N', transa; \(\backslash\)}
00111 \textcolor{preprocessor}{   }\textcolor{comment}{/* Set alpha\_ */}\textcolor{preprocessor}{ \(\backslash\)}
00112 \textcolor{preprocessor}{   EIGTYPE alpha(1); \(\backslash\)}
00113 \textcolor{preprocessor}{   ldb = convert\_index<BlasIndex>(otherStride);\(\backslash\)}
00114 \textcolor{preprocessor}{\(\backslash\)}
00115 \textcolor{preprocessor}{   const EIGTYPE *a; \(\backslash\)}
00116 \textcolor{preprocessor}{}\textcolor{comment}{/* Set trans */}\textcolor{preprocessor}{ \(\backslash\)}
00117 \textcolor{preprocessor}{   transa = (TriStorageOrder==RowMajor) ? ((Conjugate) ? 'C' : 'T') : 'N'; \(\backslash\)}
00118 \textcolor{preprocessor}{}\textcolor{comment}{/* Set uplo */}\textcolor{preprocessor}{ \(\backslash\)}
00119 \textcolor{preprocessor}{   uplo = IsLower ? 'L' : 'U'; \(\backslash\)}
00120 \textcolor{preprocessor}{   if (TriStorageOrder==RowMajor) uplo = (uplo == 'L') ? 'U' : 'L'; \(\backslash\)}
00121 \textcolor{preprocessor}{}\textcolor{comment}{/* Set a, lda */}\textcolor{preprocessor}{ \(\backslash\)}
00122 \textcolor{preprocessor}{   typedef Matrix<EIGTYPE, Dynamic, Dynamic, TriStorageOrder> MatrixTri; \(\backslash\)}
00123 \textcolor{preprocessor}{   Map<const MatrixTri, 0, OuterStride<> > tri(\_tri,size,size,OuterStride<>(triStride)); \(\backslash\)}
00124 \textcolor{preprocessor}{   MatrixTri a\_tmp; \(\backslash\)}
00125 \textcolor{preprocessor}{\(\backslash\)}
00126 \textcolor{preprocessor}{   if (conjA) \{ \(\backslash\)}
00127 \textcolor{preprocessor}{     a\_tmp = tri.conjugate(); \(\backslash\)}
00128 \textcolor{preprocessor}{     a = a\_tmp.data(); \(\backslash\)}
00129 \textcolor{preprocessor}{     lda = convert\_index<BlasIndex>(a\_tmp.outerStride()); \(\backslash\)}
00130 \textcolor{preprocessor}{   \} else \{ \(\backslash\)}
00131 \textcolor{preprocessor}{     a = \_tri; \(\backslash\)}
00132 \textcolor{preprocessor}{     lda = convert\_index<BlasIndex>(triStride); \(\backslash\)}
00133 \textcolor{preprocessor}{   \} \(\backslash\)}
00134 \textcolor{preprocessor}{   if (IsUnitDiag) diag='U'; \(\backslash\)}
00135 \textcolor{preprocessor}{}\textcolor{comment}{/* call ?trsm*/}\textcolor{preprocessor}{ \(\backslash\)}
00136 \textcolor{preprocessor}{   BLASPREFIX##trsm\_(&side, &uplo, &transa, &diag, &m, &n, &numext::real\_ref(alpha), (const BLASTYPE*)a,
       &lda, (BLASTYPE*)\_other, &ldb); \(\backslash\)}
00137 \textcolor{preprocessor}{   }\textcolor{comment}{/*std::cout << "TRMS\_L specialization!\(\backslash\)n";*/}\textcolor{preprocessor}{ \(\backslash\)}
00138 \textcolor{preprocessor}{ \} \(\backslash\)}
00139 \textcolor{preprocessor}{\};}
00140 
00141 EIGEN\_BLAS\_TRSM\_R(\textcolor{keywordtype}{double},   \textcolor{keywordtype}{double}, d)
00142 EIGEN\_BLAS\_TRSM\_R(dcomplex, \textcolor{keywordtype}{double}, z)
00143 EIGEN\_BLAS\_TRSM\_R(\textcolor{keywordtype}{float},    \textcolor{keywordtype}{float},  s)
00144 EIGEN\_BLAS\_TRSM\_R(scomplex, \textcolor{keywordtype}{float},  c)
00145 
00146 
00147 \} \textcolor{comment}{// end namespace internal}
00148 
00149 \} \textcolor{comment}{// end namespace Eigen}
00150 
00151 \textcolor{preprocessor}{#endif // EIGEN\_TRIANGULAR\_SOLVER\_MATRIX\_BLAS\_H}
\end{DoxyCode}
