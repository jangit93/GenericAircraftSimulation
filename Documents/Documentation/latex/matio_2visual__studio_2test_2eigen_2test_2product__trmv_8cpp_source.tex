\hypertarget{matio_2visual__studio_2test_2eigen_2test_2product__trmv_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/test/product\+\_\+trmv.cpp}
\label{matio_2visual__studio_2test_2eigen_2test_2product__trmv_8cpp_source}\index{product\+\_\+trmv.\+cpp@{product\+\_\+trmv.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is triangularView of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keywordtype}{void} trmv(\textcolor{keyword}{const} MatrixType& m)
00013 \{
00014   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Index \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00015   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00016   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::Real} RealScalar;
00017   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar, MatrixType::RowsAtCompileTime, 1>} 
      \hyperlink{struct_vector_type}{VectorType};
00018 
00019   RealScalar largerEps = 10*test\_precision<RealScalar>();
00020 
00021   Index rows = m.rows();
00022   Index cols = m.cols();
00023 
00024   MatrixType m1 = MatrixType::Random(rows, cols),
00025              m3(rows, cols);
00026   VectorType v1 = VectorType::Random(rows);
00027 
00028   Scalar s1 = internal::random<Scalar>();
00029 
00030   m1 = MatrixType::Random(rows, cols);
00031 
00032   \textcolor{comment}{// check with a column-major matrix}
00033   m3 = m1.template triangularView<Eigen::Lower>();
00034   VERIFY((m3 * v1).isApprox(m1.template triangularView<Eigen::Lower>() * v1, largerEps));
00035   m3 = m1.template triangularView<Eigen::Upper>();
00036   VERIFY((m3 * v1).isApprox(m1.template triangularView<Eigen::Upper>() * v1, largerEps));
00037   m3 = m1.template triangularView<Eigen::UnitLower>();
00038   VERIFY((m3 * v1).isApprox(m1.template triangularView<Eigen::UnitLower>() * v1, largerEps));
00039   m3 = m1.template triangularView<Eigen::UnitUpper>();
00040   VERIFY((m3 * v1).isApprox(m1.template triangularView<Eigen::UnitUpper>() * v1, largerEps));
00041 
00042   \textcolor{comment}{// check conjugated and scalar multiple expressions (col-major)}
00043   m3 = m1.template triangularView<Eigen::Lower>();
00044   VERIFY(((s1*m3).conjugate() * v1).isApprox((s1*m1).conjugate().\textcolor{keyword}{template} triangularView<Eigen::Lower>() * 
      v1, largerEps));
00045   m3 = m1.template triangularView<Eigen::Upper>();
00046   VERIFY((m3.conjugate() * v1.conjugate()).isApprox(m1.conjugate().template triangularView<Eigen::Upper>() 
      * v1.conjugate(), largerEps));
00047 
00048   \textcolor{comment}{// check with a row-major matrix}
00049   m3 = m1.template triangularView<Eigen::Upper>();
00050   VERIFY((m3.transpose() * v1).isApprox(m1.transpose().template triangularView<Eigen::Lower>() * v1, 
      largerEps));
00051   m3 = m1.template triangularView<Eigen::Lower>();
00052   VERIFY((m3.transpose() * v1).isApprox(m1.transpose().template triangularView<Eigen::Upper>() * v1, 
      largerEps));
00053   m3 = m1.template triangularView<Eigen::UnitUpper>();
00054   VERIFY((m3.transpose() * v1).isApprox(m1.transpose().template triangularView<Eigen::UnitLower>() * v1, 
      largerEps));
00055   m3 = m1.template triangularView<Eigen::UnitLower>();
00056   VERIFY((m3.transpose() * v1).isApprox(m1.transpose().template triangularView<Eigen::UnitUpper>() * v1, 
      largerEps));
00057 
00058   \textcolor{comment}{// check conjugated and scalar multiple expressions (row-major)}
00059   m3 = m1.template triangularView<Eigen::Upper>();
00060   VERIFY((m3.adjoint() * v1).isApprox(m1.adjoint().template triangularView<Eigen::Lower>() * v1, largerEps)
      );
00061   m3 = m1.template triangularView<Eigen::Lower>();
00062   VERIFY((m3.adjoint() * (s1*v1.conjugate())).isApprox(m1.adjoint().template triangularView<Eigen::Upper>()
       * (s1*v1.conjugate()), largerEps));
00063   m3 = m1.template triangularView<Eigen::UnitUpper>();
00064 
00065   \textcolor{comment}{// check transposed cases:}
00066   m3 = m1.template triangularView<Eigen::Lower>();
00067   VERIFY((v1.transpose() * m3).isApprox(v1.transpose() * m1.template triangularView<Eigen::Lower>(), 
      largerEps));
00068   VERIFY((v1.adjoint() * m3).isApprox(v1.adjoint() * m1.template triangularView<Eigen::Lower>(), largerEps)
      );
00069   VERIFY((v1.adjoint() * m3.adjoint()).isApprox(v1.adjoint() * m1.template triangularView<Eigen::Lower>().
      adjoint(), largerEps));
00070 
00071   \textcolor{comment}{// TODO check with sub-matrices}
00072 \}
00073 
00074 \textcolor{keywordtype}{void} test\_product\_trmv()
00075 \{
00076   \textcolor{keywordtype}{int} s = 0;
00077   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < g\_repeat ; i++) \{
00078     CALL\_SUBTEST\_1( trmv(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 1, 1>}()) );
00079     CALL\_SUBTEST\_2( trmv(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 2, 2>}()) );
00080     CALL\_SUBTEST\_3( trmv(Matrix3d()) );
00081     
00082     s = internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE/2);
00083     CALL\_SUBTEST\_4( trmv(MatrixXcf(s,s)) );
00084     CALL\_SUBTEST\_5( trmv(MatrixXcd(s,s)) );
00085     TEST\_SET\_BUT\_UNUSED\_VARIABLE(s)
00086     
00087     s = internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE);
00088     CALL\_SUBTEST\_6( trmv(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float,Dynamic,Dynamic,RowMajor>}(s, s)
      ) );
00089     TEST\_SET\_BUT\_UNUSED\_VARIABLE(s)
00090   \}
00091 \}
\end{DoxyCode}
