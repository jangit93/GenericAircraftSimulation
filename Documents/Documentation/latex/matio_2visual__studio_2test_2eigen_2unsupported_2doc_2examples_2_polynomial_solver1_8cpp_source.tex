\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2doc_2examples_2_polynomial_solver1_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/doc/examples/\+Polynomial\+Solver1.cpp}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2doc_2examples_2_polynomial_solver1_8cpp_source}\index{Polynomial\+Solver1.\+cpp@{Polynomial\+Solver1.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include <unsupported/Eigen/Polynomials>}
00002 \textcolor{preprocessor}{#include <vector>}
00003 \textcolor{preprocessor}{#include <iostream>}
00004 
00005 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00006 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00007 
00008 \textcolor{keywordtype}{int} main()
00009 \{
00010   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<double,5,1>} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Vector5d};
00011 
00012   Vector5d roots = Vector5d::Random();
00013   cout << \textcolor{stringliteral}{"Roots: "} << roots.transpose() << endl;
00014   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<double,6,1>} polynomial;
00015   \hyperlink{namespace_eigen_afbc3648f7ef67db3d5d04454fc1257fd}{roots\_to\_monicPolynomial}( roots, polynomial );
00016 
00017   \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver<double,5>} psolve( polynomial );
00018   cout << \textcolor{stringliteral}{"Complex roots: "} << psolve.roots().transpose() << endl;
00019 
00020   std::vector<double> realRoots;
00021   psolve.realRoots( realRoots );
00022   \hyperlink{group___core___module_class_eigen_1_1_map}{Map<Vector5d>} mapRR( &realRoots[0] );
00023   cout << \textcolor{stringliteral}{"Real roots: "} << mapRR.transpose() << endl;
00024 
00025   cout << endl;
00026   cout << \textcolor{stringliteral}{"Illustration of the convergence problem with the QR algorithm: "} << endl;
00027   cout << \textcolor{stringliteral}{"---------------------------------------------------------------"} << endl;
00028   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<float,7,1>} hardCase\_polynomial;
00029   hardCase\_polynomial <<
00030   -0.957, 0.9219, 0.3516, 0.9453, -0.4023, -0.5508, -0.03125;
00031   cout << \textcolor{stringliteral}{"Hard case polynomial defined by floats: "} << hardCase\_polynomial.transpose() << endl;
00032   \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver<float,6>} psolvef( hardCase\_polynomial );
00033   cout << \textcolor{stringliteral}{"Complex roots: "} << psolvef.roots().transpose() << endl;
00034   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<float,6,1>} evals;
00035   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i=0; i<6; ++i )\{ evals[i] = std::abs( \hyperlink{namespace_eigen_adb64ffddaa9e83634e3ab0e3fd3664f5}{poly\_eval}( hardCase\_polynomial, psolvef.roots()[i
      ] ) ); \}
00036   cout << \textcolor{stringliteral}{"Norms of the evaluations of the polynomial at the roots: "} << evals.transpose() << endl << endl;
00037 
00038   cout << \textcolor{stringliteral}{"Using double's almost always solves the problem for small degrees: "} << endl;
00039   cout << \textcolor{stringliteral}{"-------------------------------------------------------------------"} << endl;
00040   \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver<double,6>} psolve6d( hardCase\_polynomial.cast<\textcolor{keywordtype}{double}>() );
00041   cout << \textcolor{stringliteral}{"Complex roots: "} << psolve6d.roots().transpose() << endl;
00042   \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i=0; i<6; ++i )
00043   \{
00044     std::complex<float> castedRoot( psolve6d.roots()[i].real(), psolve6d.roots()[i].imag() );
00045     evals[i] = std::abs( \hyperlink{namespace_eigen_adb64ffddaa9e83634e3ab0e3fd3664f5}{poly\_eval}( hardCase\_polynomial, castedRoot ) );
00046   \}
00047   cout << \textcolor{stringliteral}{"Norms of the evaluations of the polynomial at the roots: "} << evals.transpose() << endl << endl;
00048 
00049   cout.precision(10);
00050   cout << \textcolor{stringliteral}{"The last root in float then in double: "} << psolvef.roots()[5] << \textcolor{stringliteral}{"\(\backslash\)t"} << psolve6d.roots()[5] <<
       endl;
00051   std::complex<float> castedRoot( psolve6d.roots()[5].real(), psolve6d.roots()[5].imag() );
00052   cout << \textcolor{stringliteral}{"Norm of the difference: "} << std::abs( psolvef.roots()[5] - castedRoot ) << endl;
00053 \}
\end{DoxyCode}
