\hypertarget{eigen_2bench_2btl_2actions_2action__ger_8hh_source}{}\section{eigen/bench/btl/actions/action\+\_\+ger.hh}
\label{eigen_2bench_2btl_2actions_2action__ger_8hh_source}\index{action\+\_\+ger.\+hh@{action\+\_\+ger.\+hh}}

\begin{DoxyCode}
00001 
00002 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00003 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00004 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00005 \textcolor{comment}{// of the License, or (at your option) any later version.}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00008 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00009 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00010 \textcolor{comment}{// GNU General Public License for more details.}
00011 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00012 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00013 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00014 \textcolor{comment}{//}
00015 \textcolor{preprocessor}{#ifndef ACTION\_GER}
00016 \textcolor{preprocessor}{#define ACTION\_GER}
00017 \textcolor{preprocessor}{#include "utilities.h"}
00018 \textcolor{preprocessor}{#include "STL\_interface.hh"}
00019 \textcolor{preprocessor}{#include <string>}
00020 \textcolor{preprocessor}{#include "init/init\_function.hh"}
00021 \textcolor{preprocessor}{#include "init/init\_vector.hh"}
00022 \textcolor{preprocessor}{#include "init/init\_matrix.hh"}
00023 
00024 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00025 
00026 \textcolor{keyword}{template}<\textcolor{keyword}{class} Interface>
\Hypertarget{eigen_2bench_2btl_2actions_2action__ger_8hh_source_l00027}\hyperlink{class_action__ger}{00027} \textcolor{keyword}{class }\hyperlink{class_action__ger}{Action\_ger} \{
00028 
00029 public :
00030 
00031   \textcolor{comment}{// Ctor}
00032   BTL\_DONT\_INLINE \hyperlink{class_action__ger}{Action\_ger}( \textcolor{keywordtype}{int} size ):\_size(size)
00033   \{
00034     MESSAGE(\textcolor{stringliteral}{"Action\_ger Ctor"});
00035 
00036     \textcolor{comment}{// STL matrix and vector initialization}
00037     \textcolor{keyword}{typename} Interface::stl\_matrix tmp;
00038     init\_matrix<pseudo\_random>(A\_stl,\_size);
00039     init\_vector<pseudo\_random>(B\_stl,\_size);
00040     init\_vector<pseudo\_random>(X\_stl,\_size);
00041     init\_vector<null\_function>(resu\_stl,\_size);
00042 
00043     \textcolor{comment}{// generic matrix and vector initialization}
00044     Interface::matrix\_from\_stl(A\_ref,A\_stl);
00045     Interface::matrix\_from\_stl(A,A\_stl);
00046     Interface::vector\_from\_stl(B\_ref,B\_stl);
00047     Interface::vector\_from\_stl(B,B\_stl);
00048     Interface::vector\_from\_stl(X\_ref,X\_stl);
00049     Interface::vector\_from\_stl(X,X\_stl);
00050   \}
00051 
00052   \textcolor{comment}{// invalidate copy ctor}
00053   Action\_ger( \textcolor{keyword}{const}  Action\_ger & )
00054   \{
00055     INFOS(\textcolor{stringliteral}{"illegal call to Action\_ger Copy Ctor"});
00056     exit(1);
00057   \}
00058 
00059   \textcolor{comment}{// Dtor}
00060   BTL\_DONT\_INLINE ~Action\_ger( \textcolor{keywordtype}{void} )\{
00061     MESSAGE(\textcolor{stringliteral}{"Action\_ger Dtor"});
00062     Interface::free\_matrix(A,\_size);
00063     Interface::free\_vector(B);
00064     Interface::free\_vector(X);
00065     Interface::free\_matrix(A\_ref,\_size);
00066     Interface::free\_vector(B\_ref);
00067     Interface::free\_vector(X\_ref);
00068 
00069   \}
00070 
00071   \textcolor{comment}{// action name}
00072   \textcolor{keyword}{static} \textcolor{keyword}{inline} std::string name( \textcolor{keywordtype}{void} )
00073   \{
00074     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"ger\_"} + Interface::name();
00075   \}
00076 
00077   \textcolor{keywordtype}{double} nb\_op\_base( \textcolor{keywordtype}{void} )\{
00078     \textcolor{keywordflow}{return} 2.0*\_size*\_size;
00079   \}
00080 
00081   BTL\_DONT\_INLINE  \textcolor{keywordtype}{void} initialize( \textcolor{keywordtype}{void} )\{
00082     Interface::copy\_matrix(A\_ref,A,\_size);
00083     Interface::copy\_vector(B\_ref,B,\_size);
00084     Interface::copy\_vector(X\_ref,X,\_size);
00085   \}
00086 
00087   BTL\_DONT\_INLINE \textcolor{keywordtype}{void} calculate( \textcolor{keywordtype}{void} ) \{
00088     BTL\_ASM\_COMMENT(\textcolor{stringliteral}{"#begin ger"});
00089     Interface::ger(A,B,X,\_size);
00090     BTL\_ASM\_COMMENT(\textcolor{stringliteral}{"end ger"});
00091   \}
00092 
00093   BTL\_DONT\_INLINE \textcolor{keywordtype}{void} check\_result( \textcolor{keywordtype}{void} )\{
00094     \textcolor{comment}{// calculation check}
00095     Interface::vector\_to\_stl(X,resu\_stl);
00096 
00097     \hyperlink{class_s_t_l__interface}{STL\_interface<typename Interface::real\_type>::ger}(
      A\_stl,B\_stl,X\_stl,\_size);
00098 
00099     \textcolor{keyword}{typename} Interface::real\_type error=
00100       \hyperlink{class_s_t_l__interface}{STL\_interface<typename Interface::real\_type>::norm\_diff}
      (X\_stl,resu\_stl);
00101 
00102     \textcolor{keywordflow}{if} (error>1.e-3)\{
00103       INFOS(\textcolor{stringliteral}{"WRONG CALCULATION...residual="} << error);
00104 \textcolor{comment}{//       exit(0);}
00105     \}
00106 
00107   \}
00108 
00109 private :
00110 
00111   \textcolor{keyword}{typename} Interface::stl\_matrix A\_stl;
00112   \textcolor{keyword}{typename} Interface::stl\_vector B\_stl;
00113   \textcolor{keyword}{typename} Interface::stl\_vector X\_stl;
00114   \textcolor{keyword}{typename} Interface::stl\_vector resu\_stl;
00115 
00116   \textcolor{keyword}{typename} Interface::gene\_matrix A\_ref;
00117   \textcolor{keyword}{typename} Interface::gene\_vector B\_ref;
00118   \textcolor{keyword}{typename} Interface::gene\_vector X\_ref;
00119 
00120   \textcolor{keyword}{typename} Interface::gene\_matrix A;
00121   \textcolor{keyword}{typename} Interface::gene\_vector B;
00122   \textcolor{keyword}{typename} Interface::gene\_vector X;
00123 
00124   \textcolor{keywordtype}{int} \_size;
00125 \};
00126 
00127 
00128 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
