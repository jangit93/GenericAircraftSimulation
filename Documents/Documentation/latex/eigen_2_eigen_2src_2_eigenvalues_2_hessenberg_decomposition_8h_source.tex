\hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source}{}\section{eigen/\+Eigen/src/\+Eigenvalues/\+Hessenberg\+Decomposition.h}
\label{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source}\index{Hessenberg\+Decomposition.\+h@{Hessenberg\+Decomposition.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_HESSENBERGDECOMPOSITION\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_HESSENBERGDECOMPOSITION\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00017   
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00018}\hyperlink{group___eigenvalues___module}{00018} \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }\hyperlink{group___eigenvalues___module_struct_eigen_1_1internal_1_1_hessenberg_decomposition_matrix_h_return_type}{HessenbergDecompositionMatrixHReturnType}
      ;
00019 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00020}\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_hessenberg_decomposition_matrix_h_return_type_3_01_matrix_type_01_4_01_4}{00020} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}<\hyperlink{group___eigenvalues___module_struct_eigen_1_1internal_1_1_hessenberg_decomposition_matrix_h_return_type}{HessenbergDecompositionMatrixHReturnType}<
      MatrixType> >
00021 \{
00022   \textcolor{keyword}{typedef} MatrixType ReturnType;
00023 \};
00024 
00025 \}
00026 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00057}\hyperlink{group___eigenvalues___module}{00057} \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{class }\hyperlink{group___eigenvalues___module_class_eigen_1_1_hessenberg_decomposition}{HessenbergDecomposition}
00058 \{
00059   \textcolor{keyword}{public}:
00060 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00062}\hyperlink{group___eigenvalues___module_a93a611350a7db9d1da18f2c828ecea9f}{00062}     \textcolor{keyword}{typedef} \_MatrixType \hyperlink{group___eigenvalues___module_a93a611350a7db9d1da18f2c828ecea9f}{MatrixType};
00063 
00064     \textcolor{keyword}{enum} \{
00065       Size = MatrixType::RowsAtCompileTime,
00066       SizeMinusOne = Size == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : Size - 1,
00067       Options = MatrixType::Options,
00068       MaxSize = MatrixType::MaxRowsAtCompileTime,
00069       MaxSizeMinusOne = MaxSize == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : MaxSize - 1
00070     \};
00071 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00073}\hyperlink{group___eigenvalues___module_a9420c36226cae7d92da8308a3f97ac2f}{00073}     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar \hyperlink{group___eigenvalues___module_a9420c36226cae7d92da8308a3f97ac2f}{Scalar};
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00074}\hyperlink{group___eigenvalues___module_a8e287ac222f53e2c8ce82faa43e95ac6}{00074}     \textcolor{keyword}{typedef} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index} \hyperlink{group___eigenvalues___module_a8e287ac222f53e2c8ce82faa43e95ac6}{Index}; 
00075 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00082}\hyperlink{group___eigenvalues___module_a567f99f3770365777b67bf9832b6fac1}{00082}     \textcolor{keyword}{typedef} 
      \hyperlink{group___core___module}{Matrix<Scalar, SizeMinusOne, 1, Options & ~RowMajor, MaxSizeMinusOne, 1>}
       \hyperlink{group___eigenvalues___module_a567f99f3770365777b67bf9832b6fac1}{CoeffVectorType};
00083 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00085}\hyperlink{group___eigenvalues___module_a7c1188cd5d8f550c8941df75a50a7d08}{00085}     \textcolor{keyword}{typedef} 
      \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{HouseholderSequence<MatrixType,typename internal::remove\_all<typename
       CoeffVectorType::ConjugateReturnType>::type}
      > \hyperlink{group___eigenvalues___module_a7c1188cd5d8f550c8941df75a50a7d08}{HouseholderSequenceType};
00086     
00087     \textcolor{keyword}{typedef} \hyperlink{group___eigenvalues___module_struct_eigen_1_1internal_1_1_hessenberg_decomposition_matrix_h_return_type}{internal::HessenbergDecompositionMatrixHReturnType<MatrixType>}
       \hyperlink{group___eigenvalues___module_struct_eigen_1_1internal_1_1_hessenberg_decomposition_matrix_h_return_type}{MatrixHReturnType};
00088 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00100}\hyperlink{group___eigenvalues___module_aee1724cb6418ede1a8b9045036a5a319}{00100}     \textcolor{keyword}{explicit} \hyperlink{group___eigenvalues___module_aee1724cb6418ede1a8b9045036a5a319}{HessenbergDecomposition}(Index size = Size==
      \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? 2 : Size)
00101       : m\_matrix(size,size),
00102         m\_temp(size),
00103         m\_isInitialized(false)
00104     \{
00105       \textcolor{keywordflow}{if}(size>1)
00106         m\_hCoeffs.resize(size-1);
00107     \}
00108 
00118     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00119}\hyperlink{group___eigenvalues___module_acd22602a3e3e5a02f79990ba1e445dc9}{00119}     \textcolor{keyword}{explicit} \hyperlink{group___eigenvalues___module_acd22602a3e3e5a02f79990ba1e445dc9}{HessenbergDecomposition}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00120       : m\_matrix(matrix.derived()),
00121         m\_temp(matrix.rows()),
00122         m\_isInitialized(false)
00123     \{
00124       \textcolor{keywordflow}{if}(matrix.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()<2)
00125       \{
00126         m\_isInitialized = \textcolor{keyword}{true};
00127         \textcolor{keywordflow}{return};
00128       \}
00129       m\_hCoeffs.resize(matrix.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()-1,1);
00130       \_compute(m\_matrix, m\_hCoeffs, m\_temp);
00131       m\_isInitialized = \textcolor{keyword}{true};
00132     \}
00133 
00151     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00152}\hyperlink{group___eigenvalues___module_a239a6fd42c57aab3c0b048c47fde3004}{00152}     \hyperlink{group___eigenvalues___module_class_eigen_1_1_hessenberg_decomposition}{HessenbergDecomposition}& \hyperlink{group___eigenvalues___module_a239a6fd42c57aab3c0b048c47fde3004}{compute}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00153     \{
00154       m\_matrix = matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}();
00155       \textcolor{keywordflow}{if}(matrix.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()<2)
00156       \{
00157         m\_isInitialized = \textcolor{keyword}{true};
00158         \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00159       \}
00160       m\_hCoeffs.resize(matrix.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()-1,1);
00161       \_compute(m\_matrix, m\_hCoeffs, m\_temp);
00162       m\_isInitialized = \textcolor{keyword}{true};
00163       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00164     \}
00165 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00179}\hyperlink{group___eigenvalues___module_a65fa81ce79d956baa59a30a6d82f8a84}{00179}     \textcolor{keyword}{const} CoeffVectorType& \hyperlink{group___eigenvalues___module_a65fa81ce79d956baa59a30a6d82f8a84}{householderCoefficients}()\textcolor{keyword}{ const}
00180 \textcolor{keyword}{    }\{
00181       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"HessenbergDecomposition is not initialized."});
00182       \textcolor{keywordflow}{return} m\_hCoeffs;
00183     \}
00184 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00214}\hyperlink{group___eigenvalues___module_a1f72b7612fd4edc5a6f31005e433e1dd}{00214}     \textcolor{keyword}{const} MatrixType& \hyperlink{group___eigenvalues___module_a1f72b7612fd4edc5a6f31005e433e1dd}{packedMatrix}()\textcolor{keyword}{ const}
00215 \textcolor{keyword}{    }\{
00216       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"HessenbergDecomposition is not initialized."});
00217       \textcolor{keywordflow}{return} m\_matrix;
00218     \}
00219 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00234}\hyperlink{group___eigenvalues___module_a346441e4902a58d43d698ac3da6ff791}{00234}     HouseholderSequenceType \hyperlink{group___eigenvalues___module_a346441e4902a58d43d698ac3da6ff791}{matrixQ}()\textcolor{keyword}{ const}
00235 \textcolor{keyword}{    }\{
00236       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"HessenbergDecomposition is not initialized."});
00237       \textcolor{keywordflow}{return} HouseholderSequenceType(m\_matrix, m\_hCoeffs.conjugate())
00238              .setLength(m\_matrix.rows() - 1)
00239              .setShift(1);
00240     \}
00241 
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00262}\hyperlink{group___eigenvalues___module_a8e781d2e22a2304647bcf0ae913cc8ea}{00262}     MatrixHReturnType \hyperlink{group___eigenvalues___module_a8e781d2e22a2304647bcf0ae913cc8ea}{matrixH}()\textcolor{keyword}{ const}
00263 \textcolor{keyword}{    }\{
00264       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"HessenbergDecomposition is not initialized."});
00265       \textcolor{keywordflow}{return} MatrixHReturnType(*\textcolor{keyword}{this});
00266     \}
00267 
00268   \textcolor{keyword}{private}:
00269 
00270     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{Matrix<Scalar, 1, Size, Options | RowMajor, 1, MaxSize>}
       \hyperlink{group___core___module}{VectorType};
00271     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::Real} RealScalar;
00272     \textcolor{keyword}{static} \textcolor{keywordtype}{void} \_compute(MatrixType& matA, CoeffVectorType& hCoeffs, VectorType& temp);
00273 
00274   \textcolor{keyword}{protected}:
00275     MatrixType m\_matrix;
00276     CoeffVectorType m\_hCoeffs;
00277     VectorType m\_temp;
00278     \textcolor{keywordtype}{bool} m\_isInitialized;
00279 \};
00280 
00293 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00294 \textcolor{keywordtype}{void} \hyperlink{group___eigenvalues___module_class_eigen_1_1_hessenberg_decomposition}{HessenbergDecomposition<MatrixType>::\_compute}(
      \hyperlink{group___eigenvalues___module_a93a611350a7db9d1da18f2c828ecea9f}{MatrixType}& matA, \hyperlink{group___core___module}{CoeffVectorType}& hCoeffs, \hyperlink{group___core___module}{VectorType}& temp)
00295 \{
00296   eigen\_assert(matA.rows()==matA.cols());
00297   \hyperlink{group___eigenvalues___module_a8e287ac222f53e2c8ce82faa43e95ac6}{Index} n = matA.rows();
00298   temp.\hyperlink{class_eigen_1_1_plain_object_base_a99d9054ee2d5a40c6e00ded0265e9cea}{resize}(n);
00299   \textcolor{keywordflow}{for} (\hyperlink{group___eigenvalues___module_a8e287ac222f53e2c8ce82faa43e95ac6}{Index} i = 0; i<n-1; ++i)
00300   \{
00301     \textcolor{comment}{// let's consider the vector v = i-th column starting at position i+1}
00302     \hyperlink{group___eigenvalues___module_a8e287ac222f53e2c8ce82faa43e95ac6}{Index} remainingSize = n-i-1;
00303     RealScalar beta;
00304     \hyperlink{group___eigenvalues___module_a9420c36226cae7d92da8308a3f97ac2f}{Scalar} h;
00305     matA.col(i).tail(remainingSize).makeHouseholderInPlace(h, beta);
00306     matA.col(i).coeffRef(i+1) = beta;
00307     hCoeffs.\hyperlink{class_eigen_1_1_plain_object_base_a25626a55b26a4323565f79d1b7c48ea8}{coeffRef}(i) = h;
00308 
00309     \textcolor{comment}{// Apply similarity transformation to remaining columns,}
00310     \textcolor{comment}{// i.e., compute A = H A H'}
00311 
00312     \textcolor{comment}{// A = H A}
00313     matA.bottomRightCorner(remainingSize, remainingSize)
00314         .applyHouseholderOnTheLeft(matA.col(i).tail(remainingSize-1), h, &temp.
      \hyperlink{class_eigen_1_1_plain_object_base_a25626a55b26a4323565f79d1b7c48ea8}{coeffRef}(0));
00315 
00316     \textcolor{comment}{// A = A H'}
00317     matA.rightCols(remainingSize)
00318         .applyHouseholderOnTheRight(matA.col(i).tail(remainingSize-1).conjugate(), numext::conj(h), &temp.
      \hyperlink{class_eigen_1_1_plain_object_base_a25626a55b26a4323565f79d1b7c48ea8}{coeffRef}(0));
00319   \}
00320 \}
00321 
00322 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00323 
00339 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }HessenbergDecompositionMatrixHReturnType
00340 : \textcolor{keyword}{public} \hyperlink{group___core___module_class_eigen_1_1_return_by_value}{ReturnByValue}<HessenbergDecompositionMatrixHReturnType<MatrixType> >
00341 \{
00342   \textcolor{keyword}{public}:
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00347}\hyperlink{group___eigenvalues___module_aa6d46d84c1343c964c50457ca4ddf9fa}{00347}     \hyperlink{group___eigenvalues___module_aa6d46d84c1343c964c50457ca4ddf9fa}{HessenbergDecompositionMatrixHReturnType}(\textcolor{keyword}{const} 
      \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>}& hess) : m\_hess(hess) \{ \}
00348 
00354     \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResultType>
\Hypertarget{eigen_2_eigen_2src_2_eigenvalues_2_hessenberg_decomposition_8h_source_l00355}\hyperlink{group___eigenvalues___module_a7f1d84113072d2d2e507d3821ff9f15c}{00355}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{group___eigenvalues___module_a7f1d84113072d2d2e507d3821ff9f15c}{evalTo}(ResultType& result)\textcolor{keyword}{ const}
00356 \textcolor{keyword}{    }\{
00357       result = m\_hess.packedMatrix();
00358       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n = result.rows();
00359       \textcolor{keywordflow}{if} (n>2)
00360         result.bottomLeftCorner(n-2, n-2).template triangularView<Lower>().setZero();
00361     \}
00362 
00363     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hess.packedMatrix().rows(); \}
00364     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hess.packedMatrix().cols(); \}
00365 
00366   \textcolor{keyword}{protected}:
00367     \textcolor{keyword}{const} \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>}& m\_hess;
00368 \};
00369 
00370 \} \textcolor{comment}{// end namespace internal}
00371 
00372 \} \textcolor{comment}{// end namespace Eigen}
00373 
00374 \textcolor{preprocessor}{#endif // EIGEN\_HESSENBERGDECOMPOSITION\_H}
\end{DoxyCode}
