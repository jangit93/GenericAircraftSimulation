\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/\+Eigen/src/\+Levenberg\+Marquardt/\+Levenberg\+Marquardt.h}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source}\index{Levenberg\+Marquardt.\+h@{Levenberg\+Marquardt.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2009 Thomas Capricelli <orzel@freehackers.org>}
00005 \textcolor{comment}{// Copyright (C) 2012 Desire Nuentsa <desire.nuentsa\_wakam@inria.fr>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// The algorithm of this class initially comes from MINPACK whose original authors are:}
00008 \textcolor{comment}{// Copyright Jorge More - Argonne National Laboratory}
00009 \textcolor{comment}{// Copyright Burt Garbow - Argonne National Laboratory}
00010 \textcolor{comment}{// Copyright Ken Hillstrom - Argonne National Laboratory}
00011 \textcolor{comment}{//}
00012 \textcolor{comment}{// This Source Code Form is subject to the terms of the Minpack license}
00013 \textcolor{comment}{// (a BSD-like license) described in the campaigned CopyrightMINPACK.txt file.}
00014 \textcolor{comment}{//}
00015 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00016 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00017 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00018 
00019 \textcolor{preprocessor}{#ifndef EIGEN\_LEVENBERGMARQUARDT\_H}
00020 \textcolor{preprocessor}{#define EIGEN\_LEVENBERGMARQUARDT\_H}
00021 
00022 
00023 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00024 \textcolor{keyword}{namespace }LevenbergMarquardtSpace \{
00025     \textcolor{keyword}{enum} Status \{
00026         NotStarted = -2,
00027         Running = -1,
00028         ImproperInputParameters = 0,
00029         RelativeReductionTooSmall = 1,
00030         RelativeErrorTooSmall = 2,
00031         RelativeErrorAndReductionTooSmall = 3,
00032         CosinusTooSmall = 4,
00033         TooManyFunctionEvaluation = 5,
00034         FtolTooSmall = 6,
00035         XtolTooSmall = 7,
00036         GtolTooSmall = 8,
00037         UserAsked = 9
00038     \};
00039 \}
00040 
00041 \textcolor{keyword}{template} <\textcolor{keyword}{typename} \_Scalar, \textcolor{keywordtype}{int} NX=Dynamic, \textcolor{keywordtype}{int} NY=Dynamic>
00042 \textcolor{keyword}{struct }DenseFunctor
00043 \{
00044   \textcolor{keyword}{typedef} \_Scalar Scalar;
00045   \textcolor{keyword}{enum} \{
00046     InputsAtCompileTime = NX,
00047     ValuesAtCompileTime = NY
00048   \};
00049   \textcolor{keyword}{typedef} Matrix<Scalar,InputsAtCompileTime,1> InputType;
00050   \textcolor{keyword}{typedef} Matrix<Scalar,ValuesAtCompileTime,1> ValueType;
00051   \textcolor{keyword}{typedef} Matrix<Scalar,ValuesAtCompileTime,InputsAtCompileTime> JacobianType;
00052   \textcolor{keyword}{typedef} ColPivHouseholderQR<JacobianType> QRSolver;
00053   \textcolor{keyword}{const} \textcolor{keywordtype}{int} m\_inputs, m\_values;
00054 
00055   DenseFunctor() : m\_inputs(InputsAtCompileTime), m\_values(ValuesAtCompileTime) \{\}
00056   DenseFunctor(\textcolor{keywordtype}{int} inputs, \textcolor{keywordtype}{int} values) : m\_inputs(inputs), m\_values(values) \{\}
00057 
00058   \textcolor{keywordtype}{int} inputs()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_inputs; \}
00059   \textcolor{keywordtype}{int} values()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_values; \}
00060 
00061   \textcolor{comment}{//int operator()(const InputType &x, ValueType& fvec) \{ \}}
00062   \textcolor{comment}{// should be defined in derived classes}
00063   
00064   \textcolor{comment}{//int df(const InputType &x, JacobianType& fjac) \{ \}}
00065   \textcolor{comment}{// should be defined in derived classes}
00066 \};
00067 
00068 \textcolor{keyword}{template} <\textcolor{keyword}{typename} \_Scalar, \textcolor{keyword}{typename} \_Index>
00069 \textcolor{keyword}{struct }SparseFunctor
00070 \{
00071   \textcolor{keyword}{typedef} \_Scalar Scalar;
00072   \textcolor{keyword}{typedef} \_Index \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00073   \textcolor{keyword}{typedef} Matrix<Scalar,Dynamic,1> InputType;
00074   \textcolor{keyword}{typedef} Matrix<Scalar,Dynamic,1> ValueType;
00075   \textcolor{keyword}{typedef} SparseMatrix<Scalar, ColMajor, Index> JacobianType;
00076   \textcolor{keyword}{typedef} SparseQR<JacobianType, COLAMDOrdering<int> > QRSolver;
00077   \textcolor{keyword}{enum} \{
00078     InputsAtCompileTime = \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic},
00079     ValuesAtCompileTime = \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}
00080   \};
00081   
00082   SparseFunctor(\textcolor{keywordtype}{int} inputs, \textcolor{keywordtype}{int} values) : m\_inputs(inputs), m\_values(values) \{\}
00083 
00084   \textcolor{keywordtype}{int} inputs()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_inputs; \}
00085   \textcolor{keywordtype}{int} values()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_values; \}
00086   
00087   \textcolor{keyword}{const} \textcolor{keywordtype}{int} m\_inputs, m\_values;
00088   \textcolor{comment}{//int operator()(const InputType &x, ValueType& fvec) \{ \}}
00089   \textcolor{comment}{// to be defined in the functor}
00090   
00091   \textcolor{comment}{//int df(const InputType &x, JacobianType& fjac) \{ \}}
00092   \textcolor{comment}{// to be defined in the functor if no automatic differentiation}
00093   
00094 \};
00095 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00096 \textcolor{keyword}{template} <\textcolor{keyword}{typename} QRSolver, \textcolor{keyword}{typename} VectorType>
00097 \textcolor{keywordtype}{void} lmpar2(\textcolor{keyword}{const} QRSolver &qr, \textcolor{keyword}{const} \hyperlink{struct_vector_type}{VectorType}  &diag, \textcolor{keyword}{const} 
      \hyperlink{struct_vector_type}{VectorType}  &qtb,
00098         \textcolor{keyword}{typename} VectorType::Scalar m\_delta, \textcolor{keyword}{typename} VectorType::Scalar &par,
00099         \hyperlink{struct_vector_type}{VectorType}  &x);
00100     \}
00109 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_FunctorType>
00110 \textcolor{keyword}{class }LevenbergMarquardt : internal::no\_assignment\_operator
00111 \{
00112   \textcolor{keyword}{public}:
00113     \textcolor{keyword}{typedef} \_FunctorType FunctorType;
00114     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} FunctorType::QRSolver QRSolver;
00115     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} FunctorType::JacobianType JacobianType;
00116     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} JacobianType::Scalar Scalar;
00117     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} JacobianType::RealScalar RealScalar; 
00118     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} QRSolver::StorageIndex PermIndex;
00119     \textcolor{keyword}{typedef} Matrix<Scalar,Dynamic,1> FVectorType;
00120     \textcolor{keyword}{typedef} PermutationMatrix<Dynamic,Dynamic> PermutationType;
00121   \textcolor{keyword}{public}:
00122     LevenbergMarquardt(FunctorType& functor) 
00123     : m\_functor(functor),m\_nfev(0),m\_njev(0),m\_fnorm(0.0),m\_gnorm(0),
00124       m\_isInitialized(false),m\_info(\hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea945604f62795ffc70aedf2bd12ea0434}{InvalidInput})
00125     \{
00126       resetParameters();
00127       m\_useExternalScaling=\textcolor{keyword}{false}; 
00128     \}
00129     
00130     LevenbergMarquardtSpace::Status minimize(FVectorType &x);
00131     LevenbergMarquardtSpace::Status minimizeInit(FVectorType &x);
00132     LevenbergMarquardtSpace::Status minimizeOneStep(FVectorType &x);
00133     LevenbergMarquardtSpace::Status lmder1(
00134       FVectorType  &x, 
00135       \textcolor{keyword}{const} Scalar tol = std::sqrt(NumTraits<Scalar>::epsilon())
00136     );
00137     \textcolor{keyword}{static} LevenbergMarquardtSpace::Status lmdif1(
00138             FunctorType &functor,
00139             FVectorType  &x,
00140             \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} *nfev,
00141             \textcolor{keyword}{const} Scalar tol = std::sqrt(NumTraits<Scalar>::epsilon())
00142             );
00143     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00145}\hyperlink{class_eigen_1_1_levenberg_marquardt_a16172a2048058ea0a908213a7b0f8971}{00145}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a16172a2048058ea0a908213a7b0f8971}{resetParameters}() 
00146     \{
00147       \textcolor{keyword}{using} std::sqrt;        
00148 
00149       m\_factor = 100.; 
00150       m\_maxfev = 400; 
00151       m\_ftol = sqrt(\hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<RealScalar>::epsilon}());
00152       m\_xtol = sqrt(\hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<RealScalar>::epsilon}());
00153       m\_gtol = 0. ; 
00154       m\_epsfcn = 0. ;
00155     \}
00156     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00158}\hyperlink{class_eigen_1_1_levenberg_marquardt_a691b571366630f1329d2de7a5e40e7a5}{00158}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a691b571366630f1329d2de7a5e40e7a5}{setXtol}(RealScalar xtol) \{ m\_xtol = xtol; \}
00159     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00161}\hyperlink{class_eigen_1_1_levenberg_marquardt_a09c0852c6a4534b84a16ac5d9c631c12}{00161}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a09c0852c6a4534b84a16ac5d9c631c12}{setFtol}(RealScalar ftol) \{ m\_ftol = ftol; \}
00162     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00164}\hyperlink{class_eigen_1_1_levenberg_marquardt_ad5610b2353f1ce5e0c7357ed1b215fea}{00164}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_ad5610b2353f1ce5e0c7357ed1b215fea}{setGtol}(RealScalar gtol) \{ m\_gtol = gtol; \}
00165     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00167}\hyperlink{class_eigen_1_1_levenberg_marquardt_a3054eeba042b197ae8d415729770db69}{00167}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a3054eeba042b197ae8d415729770db69}{setFactor}(RealScalar factor) \{ m\_factor = factor; \}    
00168     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00170}\hyperlink{class_eigen_1_1_levenberg_marquardt_a3e13f6631ae59be984ee1ea196899cd7}{00170}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a3e13f6631ae59be984ee1ea196899cd7}{setEpsilon} (RealScalar epsfcn) \{ m\_epsfcn = epsfcn; \}
00171     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00173}\hyperlink{class_eigen_1_1_levenberg_marquardt_af072d0f89c44415d8ed284df8b4a634a}{00173}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_af072d0f89c44415d8ed284df8b4a634a}{setMaxfev}(Index maxfev) \{m\_maxfev = maxfev; \}
00174     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00176}\hyperlink{class_eigen_1_1_levenberg_marquardt_a4af7d41545ec5908485357493839e6f6}{00176}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_levenberg_marquardt_a4af7d41545ec5908485357493839e6f6}{setExternalScaling}(\textcolor{keywordtype}{bool} value) \{m\_useExternalScaling  = value; \}
00177     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00179}\hyperlink{class_eigen_1_1_levenberg_marquardt_a25a7629ea877d8f08670536b3d234897}{00179}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_a25a7629ea877d8f08670536b3d234897}{xtol}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_xtol; \}
00180     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00182}\hyperlink{class_eigen_1_1_levenberg_marquardt_a957ac071ec775779bb03d10b463ddfbc}{00182}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_a957ac071ec775779bb03d10b463ddfbc}{ftol}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_ftol; \}
00183     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00185}\hyperlink{class_eigen_1_1_levenberg_marquardt_a18597c537ec7d492ee6d43788178e458}{00185}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_a18597c537ec7d492ee6d43788178e458}{gtol}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_gtol; \}
00186     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00188}\hyperlink{class_eigen_1_1_levenberg_marquardt_a282e28b8331376b9875429dab1e280ba}{00188}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_a282e28b8331376b9875429dab1e280ba}{factor}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_factor; \}
00189     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00191}\hyperlink{class_eigen_1_1_levenberg_marquardt_aac799068926ca0bc3387b2dc5c0eb113}{00191}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_aac799068926ca0bc3387b2dc5c0eb113}{epsilon}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_epsfcn; \}
00192     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00194}\hyperlink{class_eigen_1_1_levenberg_marquardt_a495894dde1fedfba97721f6b4a076901}{00194}     Index \hyperlink{class_eigen_1_1_levenberg_marquardt_a495894dde1fedfba97721f6b4a076901}{maxfev}()\textcolor{keyword}{ const }\{\textcolor{keywordflow}{return} m\_maxfev; \}
00195     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00197}\hyperlink{class_eigen_1_1_levenberg_marquardt_a6e237ca1f23cdf5caa98fe23c6bcf464}{00197}     FVectorType& \hyperlink{class_eigen_1_1_levenberg_marquardt_a6e237ca1f23cdf5caa98fe23c6bcf464}{diag}() \{\textcolor{keywordflow}{return} m\_diag; \}
00198     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00200}\hyperlink{class_eigen_1_1_levenberg_marquardt_aeb094683f0abe9c29ee89be0677de744}{00200}     Index \hyperlink{class_eigen_1_1_levenberg_marquardt_aeb094683f0abe9c29ee89be0677de744}{iterations}() \{ \textcolor{keywordflow}{return} m\_iter; \}
00201     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00203}\hyperlink{class_eigen_1_1_levenberg_marquardt_ad9563c6abeb33c0aba82e55fd72c64a6}{00203}     Index \hyperlink{class_eigen_1_1_levenberg_marquardt_ad9563c6abeb33c0aba82e55fd72c64a6}{nfev}() \{ \textcolor{keywordflow}{return} m\_nfev; \}
00204     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00206}\hyperlink{class_eigen_1_1_levenberg_marquardt_a31bedcc92106ed170fde5750559a62a5}{00206}     Index \hyperlink{class_eigen_1_1_levenberg_marquardt_a31bedcc92106ed170fde5750559a62a5}{njev}() \{ \textcolor{keywordflow}{return} m\_njev; \}
00207     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00209}\hyperlink{class_eigen_1_1_levenberg_marquardt_ac30c5ce96ac91663b287b2ba7ec7c712}{00209}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_ac30c5ce96ac91663b287b2ba7ec7c712}{fnorm}() \{\textcolor{keywordflow}{return} m\_fnorm; \}
00210     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00212}\hyperlink{class_eigen_1_1_levenberg_marquardt_ab91ec0507fb508a2402ac0dfa15af776}{00212}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_ab91ec0507fb508a2402ac0dfa15af776}{gnorm}() \{\textcolor{keywordflow}{return} m\_gnorm; \}
00213     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00215}\hyperlink{class_eigen_1_1_levenberg_marquardt_aa8aa0d8c1dab58ac51df999587609e09}{00215}     RealScalar \hyperlink{class_eigen_1_1_levenberg_marquardt_aa8aa0d8c1dab58ac51df999587609e09}{lm\_param}(\textcolor{keywordtype}{void}) \{ \textcolor{keywordflow}{return} m\_par; \}
00216     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00219}\hyperlink{class_eigen_1_1_levenberg_marquardt_a6c296a4a5b91f0ecc398b479a67c242d}{00219}     FVectorType& \hyperlink{class_eigen_1_1_levenberg_marquardt_a6c296a4a5b91f0ecc398b479a67c242d}{fvec}() \{\textcolor{keywordflow}{return} m\_fvec; \}
00220     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00223}\hyperlink{class_eigen_1_1_levenberg_marquardt_aaf2179310fdf873483f5d8b46f15da8c}{00223}     JacobianType& \hyperlink{class_eigen_1_1_levenberg_marquardt_aaf2179310fdf873483f5d8b46f15da8c}{jacobian}() \{\textcolor{keywordflow}{return} m\_fjac; \}
00224     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00228}\hyperlink{class_eigen_1_1_levenberg_marquardt_afd6cd64fdd7ca32cc71a83d91432ea69}{00228}     JacobianType& \hyperlink{class_eigen_1_1_levenberg_marquardt_afd6cd64fdd7ca32cc71a83d91432ea69}{matrixR}() \{\textcolor{keywordflow}{return} m\_rfactor; \}
00229     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00232}\hyperlink{class_eigen_1_1_levenberg_marquardt_a691142ba877e072c58016b4be77e9855}{00232}     PermutationType \hyperlink{class_eigen_1_1_levenberg_marquardt_a691142ba877e072c58016b4be77e9855}{permutation}() \{\textcolor{keywordflow}{return} m\_permutation; \}
00233     
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_levenberg_marquardt_2_levenberg_marquardt_8h_source_l00243}\hyperlink{class_eigen_1_1_levenberg_marquardt_ae65bdccd2487989ae9b25f9c2e9dfab9}{00243}     \hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo} \hyperlink{class_eigen_1_1_levenberg_marquardt_ae65bdccd2487989ae9b25f9c2e9dfab9}{info}()\textcolor{keyword}{ const}
00244 \textcolor{keyword}{    }\{
00245       
00246       \textcolor{keywordflow}{return} m\_info;
00247     \}
00248   \textcolor{keyword}{private}:
00249     JacobianType m\_fjac; 
00250     JacobianType m\_rfactor; \textcolor{comment}{// The triangular matrix R from the QR of the jacobian matrix m\_fjac}
00251     FunctorType &m\_functor;
00252     FVectorType m\_fvec, m\_qtf, m\_diag; 
00253     Index n;
00254     Index m; 
00255     Index m\_nfev;
00256     Index m\_njev; 
00257     RealScalar m\_fnorm; \textcolor{comment}{// Norm of the current vector function}
00258     RealScalar m\_gnorm; \textcolor{comment}{//Norm of the gradient of the error }
00259     RealScalar m\_factor; \textcolor{comment}{//}
00260     Index m\_maxfev; \textcolor{comment}{// Maximum number of function evaluation}
00261     RealScalar m\_ftol; \textcolor{comment}{//Tolerance in the norm of the vector function}
00262     RealScalar m\_xtol; \textcolor{comment}{// }
00263     RealScalar m\_gtol; \textcolor{comment}{//tolerance of the norm of the error gradient}
00264     RealScalar m\_epsfcn; \textcolor{comment}{//}
00265     Index m\_iter; \textcolor{comment}{// Number of iterations performed}
00266     RealScalar m\_delta;
00267     \textcolor{keywordtype}{bool} m\_useExternalScaling;
00268     PermutationType m\_permutation;
00269     FVectorType m\_wa1, m\_wa2, m\_wa3, m\_wa4; \textcolor{comment}{//Temporary vectors}
00270     RealScalar m\_par;
00271     \textcolor{keywordtype}{bool} m\_isInitialized; \textcolor{comment}{// Check whether the minimization step has been called}
00272     \hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo} m\_info; 
00273 \};
00274 
00275 \textcolor{keyword}{template}<\textcolor{keyword}{typename} FunctorType>
00276 LevenbergMarquardtSpace::Status
00277 \hyperlink{class_eigen_1_1_levenberg_marquardt}{LevenbergMarquardt<FunctorType>::minimize}(FVectorType  &x)
00278 \{
00279     LevenbergMarquardtSpace::Status status = minimizeInit(x);
00280     \textcolor{keywordflow}{if} (status==LevenbergMarquardtSpace::ImproperInputParameters) \{
00281       m\_isInitialized = \textcolor{keyword}{true};
00282       \textcolor{keywordflow}{return} status;
00283     \}
00284     \textcolor{keywordflow}{do} \{
00285 \textcolor{comment}{//       std::cout << " uv " << x.transpose() << "\(\backslash\)n";}
00286         status = minimizeOneStep(x);
00287     \} \textcolor{keywordflow}{while} (status==LevenbergMarquardtSpace::Running);
00288      m\_isInitialized = \textcolor{keyword}{true};
00289      \textcolor{keywordflow}{return} status;
00290 \}
00291 
00292 \textcolor{keyword}{template}<\textcolor{keyword}{typename} FunctorType>
00293 LevenbergMarquardtSpace::Status
00294 \hyperlink{class_eigen_1_1_levenberg_marquardt}{LevenbergMarquardt<FunctorType>::minimizeInit}(FVectorType  &x)
00295 \{
00296     n = x.size();
00297     m = m\_functor.values();
00298 
00299     m\_wa1.resize(n); m\_wa2.resize(n); m\_wa3.resize(n);
00300     m\_wa4.resize(m);
00301     m\_fvec.resize(m);
00302     \textcolor{comment}{//FIXME Sparse Case : Allocate space for the jacobian}
00303     m\_fjac.resize(m, n);
00304 \textcolor{comment}{//     m\_fjac.reserve(VectorXi::Constant(n,5)); // FIXME Find a better alternative}
00305     \textcolor{keywordflow}{if} (!m\_useExternalScaling)
00306         m\_diag.resize(n);
00307     eigen\_assert( (!m\_useExternalScaling || m\_diag.size()==n) && \textcolor{stringliteral}{"When m\_useExternalScaling is set, the
       caller must provide a valid 'm\_diag'"});
00308     m\_qtf.resize(n);
00309 
00310     \textcolor{comment}{/* Function Body */}
00311     m\_nfev = 0;
00312     m\_njev = 0;
00313 
00314     \textcolor{comment}{/*     check the input parameters for errors. */}
00315     \textcolor{keywordflow}{if} (n <= 0 || m < n || m\_ftol < 0. || m\_xtol < 0. || m\_gtol < 0. || m\_maxfev <= 0 || m\_factor <= 0.)\{
00316       m\_info = \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea945604f62795ffc70aedf2bd12ea0434}{InvalidInput};
00317       \textcolor{keywordflow}{return} LevenbergMarquardtSpace::ImproperInputParameters;
00318     \}
00319 
00320     \textcolor{keywordflow}{if} (m\_useExternalScaling)
00321         \textcolor{keywordflow}{for} (Index j = 0; j < n; ++j)
00322             \textcolor{keywordflow}{if} (m\_diag[j] <= 0.) 
00323             \{
00324               m\_info = \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea945604f62795ffc70aedf2bd12ea0434}{InvalidInput};
00325               \textcolor{keywordflow}{return} LevenbergMarquardtSpace::ImproperInputParameters;
00326             \}
00327 
00328     \textcolor{comment}{/*     evaluate the function at the starting point */}
00329     \textcolor{comment}{/*     and calculate its norm. */}
00330     m\_nfev = 1;
00331     \textcolor{keywordflow}{if} ( m\_functor(x, m\_fvec) < 0)
00332         \textcolor{keywordflow}{return} LevenbergMarquardtSpace::UserAsked;
00333     m\_fnorm = m\_fvec.stableNorm();
00334 
00335     \textcolor{comment}{/*     initialize levenberg-marquardt parameter and iteration counter. */}
00336     m\_par = 0.;
00337     m\_iter = 1;
00338 
00339     \textcolor{keywordflow}{return} LevenbergMarquardtSpace::NotStarted;
00340 \}
00341 
00342 \textcolor{keyword}{template}<\textcolor{keyword}{typename} FunctorType>
00343 LevenbergMarquardtSpace::Status
00344 \hyperlink{class_eigen_1_1_levenberg_marquardt}{LevenbergMarquardt<FunctorType>::lmder1}(
00345         FVectorType  &x,
00346         \textcolor{keyword}{const} Scalar tol
00347         )
00348 \{
00349     n = x.size();
00350     m = m\_functor.values();
00351 
00352     \textcolor{comment}{/* check the input parameters for errors. */}
00353     \textcolor{keywordflow}{if} (n <= 0 || m < n || tol < 0.)
00354         \textcolor{keywordflow}{return} LevenbergMarquardtSpace::ImproperInputParameters;
00355 
00356     resetParameters();
00357     m\_ftol = tol;
00358     m\_xtol = tol;
00359     m\_maxfev = 100*(n+1);
00360 
00361     \textcolor{keywordflow}{return} minimize(x);
00362 \}
00363 
00364 
00365 \textcolor{keyword}{template}<\textcolor{keyword}{typename} FunctorType>
00366 LevenbergMarquardtSpace::Status
00367 \hyperlink{class_eigen_1_1_levenberg_marquardt}{LevenbergMarquardt<FunctorType>::lmdif1}(
00368         FunctorType &functor,
00369         FVectorType  &x,
00370         Index *nfev,
00371         \textcolor{keyword}{const} Scalar tol
00372         )
00373 \{
00374     Index n = x.size();
00375     Index m = functor.values();
00376 
00377     \textcolor{comment}{/* check the input parameters for errors. */}
00378     \textcolor{keywordflow}{if} (n <= 0 || m < n || tol < 0.)
00379         \textcolor{keywordflow}{return} LevenbergMarquardtSpace::ImproperInputParameters;
00380 
00381     \hyperlink{class_eigen_1_1_numerical_diff}{NumericalDiff<FunctorType>} numDiff(functor);
00382     \textcolor{comment}{// embedded LevenbergMarquardt}
00383     \hyperlink{class_eigen_1_1_levenberg_marquardt}{LevenbergMarquardt<NumericalDiff<FunctorType>} > lm(numDiff
      );
00384     lm.setFtol(tol);
00385     lm.setXtol(tol);
00386     lm.setMaxfev(200*(n+1));
00387 
00388     LevenbergMarquardtSpace::Status info = LevenbergMarquardtSpace::Status(lm.minimize(x));
00389     \textcolor{keywordflow}{if} (nfev)
00390         * nfev = lm.nfev();
00391     \textcolor{keywordflow}{return} info;
00392 \}
00393 
00394 \} \textcolor{comment}{// end namespace Eigen}
00395 
00396 \textcolor{preprocessor}{#endif // EIGEN\_LEVENBERGMARQUARDT\_H}
\end{DoxyCode}
