\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat1_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/dblat1.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat1_8f_source}\index{dblat1.\+f@{dblat1.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b DBLAT1}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM DBLAT1}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*>    Test program for the DOUBLE PRECISION Level 1 BLAS.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*>    Based upon the original BLAS test routine together with:}
00022 \textcolor{comment}{*>    F06EAF Example Program Text}
00023 \textcolor{comment}{*> \(\backslash\)endverbatim}
00024 \textcolor{comment}{*}
00025 \textcolor{comment}{*  Authors:}
00026 \textcolor{comment}{*  ========}
00027 \textcolor{comment}{*}
00028 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00029 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00030 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00031 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00032 \textcolor{comment}{*}
00033 \textcolor{comment}{*> \(\backslash\)date April 2012}
00034 \textcolor{comment}{*}
00035 \textcolor{comment}{*> \(\backslash\)ingroup double\_blas\_testing}
00036 \textcolor{comment}{*}
00037 \textcolor{comment}{*  =====================================================================}
00038       \textcolor{keyword}{PROGRAM} dblat1
00039 \textcolor{comment}{*}
00040 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00041 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00042 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00043 \textcolor{comment}{*     April 2012}
00044 \textcolor{comment}{*}
00045 \textcolor{comment}{*  =====================================================================}
00046 \textcolor{comment}{*}
00047 \textcolor{comment}{*     .. Parameters ..}
00048       \textcolor{keywordtype}{INTEGER}          nout
00049       parameter(nout=6)
00050 \textcolor{comment}{*     .. Scalars in Common ..}
00051       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00052       \textcolor{keywordtype}{LOGICAL}          pass
00053 \textcolor{comment}{*     .. Local Scalars ..}
00054       \textcolor{keywordtype}{DOUBLE PRECISION} sfac
00055       \textcolor{keywordtype}{INTEGER}          ic
00056 \textcolor{comment}{*     .. External Subroutines ..}
00057       \textcolor{keywordtype}{EXTERNAL}         check0, check1, check2, check3, header
00058 \textcolor{comment}{*     .. Common blocks ..}
00059       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00060 \textcolor{comment}{*     .. Data statements ..}
00061       \textcolor{keyword}{DATA}             sfac/9.765625d-4/
00062 \textcolor{comment}{*     .. Executable Statements ..}
00063       \textcolor{keyword}{WRITE} (nout,99999)
00064       \textcolor{keywordflow}{DO} 20 ic = 1, 13
00065          icase = ic
00066          \textcolor{keyword}{CALL }header
00067 \textcolor{comment}{*}
00068 \textcolor{comment}{*        .. Initialize  PASS,  INCX,  and INCY for a new case. ..}
00069 \textcolor{comment}{*        .. the value 9999 for INCX or INCY will appear in the ..}
00070 \textcolor{comment}{*        .. detailed  output, if any, for cases  that do not involve ..}
00071 \textcolor{comment}{*        .. these parameters ..}
00072 \textcolor{comment}{*}
00073          pass = .true.
00074          incx = 9999
00075          incy = 9999
00076          \textcolor{keywordflow}{IF} (icase.EQ.3 .OR. icase.EQ.11) \textcolor{keywordflow}{THEN}
00077             \textcolor{keyword}{CALL }check0(sfac)
00078          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.7 .OR. icase.EQ.8 .OR. icase.EQ.9 .OR.
00079      +            icase.EQ.10) \textcolor{keywordflow}{THEN}
00080             \textcolor{keyword}{CALL }check1(sfac)
00081          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.1 .OR. icase.EQ.2 .OR. icase.EQ.5 .OR.
00082      +            icase.EQ.6 .OR. icase.EQ.12 .OR. icase.EQ.13) \textcolor{keywordflow}{THEN}
00083             \textcolor{keyword}{CALL }check2(sfac)
00084          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.4) \textcolor{keywordflow}{THEN}
00085             \textcolor{keyword}{CALL }check3(sfac)
00086 \textcolor{keywordflow}{         END IF}
00087 \textcolor{comment}{*        -- Print}
00088          \textcolor{keywordflow}{IF} (pass) \textcolor{keyword}{WRITE} (nout,99998)
00089    20 \textcolor{keywordflow}{CONTINUE}
00090       stop
00091 \textcolor{comment}{*}
00092 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{' Real BLAS Test Program Results'},/1x)
00093 99998 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                    ----- PASS -----'})
00094 \textcolor{keyword}{      END}
00095 \textcolor{keyword}{      SUBROUTINE }header
00096 \textcolor{comment}{*     .. Parameters ..}
00097       \textcolor{keywordtype}{INTEGER}          nout
00098       parameter(nout=6)
00099 \textcolor{comment}{*     .. Scalars in Common ..}
00100       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00101       \textcolor{keywordtype}{LOGICAL}          pass
00102 \textcolor{comment}{*     .. Local Arrays ..}
00103       \textcolor{keywordtype}{CHARACTER*6}      l(13)
00104 \textcolor{comment}{*     .. Common blocks ..}
00105       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00106 \textcolor{comment}{*     .. Data statements ..}
00107       \textcolor{keyword}{DATA}             l(1)/\textcolor{stringliteral}{' DDOT '}/
00108       \textcolor{keyword}{DATA}             l(2)/\textcolor{stringliteral}{'DAXPY '}/
00109       \textcolor{keyword}{DATA}             l(3)/\textcolor{stringliteral}{'DROTG '}/
00110       \textcolor{keyword}{DATA}             l(4)/\textcolor{stringliteral}{' DROT '}/
00111       \textcolor{keyword}{DATA}             l(5)/\textcolor{stringliteral}{'DCOPY '}/
00112       \textcolor{keyword}{DATA}             l(6)/\textcolor{stringliteral}{'DSWAP '}/
00113       \textcolor{keyword}{DATA}             l(7)/\textcolor{stringliteral}{'DNRM2 '}/
00114       \textcolor{keyword}{DATA}             l(8)/\textcolor{stringliteral}{'DASUM '}/
00115       \textcolor{keyword}{DATA}             l(9)/\textcolor{stringliteral}{'DSCAL '}/
00116       \textcolor{keyword}{DATA}             l(10)/\textcolor{stringliteral}{'IDAMAX'}/
00117       \textcolor{keyword}{DATA}             l(11)/\textcolor{stringliteral}{'DROTMG'}/
00118       \textcolor{keyword}{DATA}             l(12)/\textcolor{stringliteral}{'DROTM '}/
00119       \textcolor{keyword}{DATA}             l(13)/\textcolor{stringliteral}{'DSDOT '}/
00120 \textcolor{comment}{*     .. Executable Statements ..}
00121       \textcolor{keyword}{WRITE} (nout,99999) icase, l(icase)
00122       \textcolor{keywordflow}{RETURN}
00123 \textcolor{comment}{*}
00124 99999 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' Test of subprogram number'},i3,12x,a6)
00125 \textcolor{keyword}{      END}
00126 \textcolor{keyword}{      SUBROUTINE }check0(SFAC)
00127 \textcolor{comment}{*     .. Parameters ..}
00128       \textcolor{keywordtype}{INTEGER}           nout
00129       parameter(nout=6)
00130 \textcolor{comment}{*     .. Scalar Arguments ..}
00131       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00132 \textcolor{comment}{*     .. Scalars in Common ..}
00133       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00134       \textcolor{keywordtype}{LOGICAL}           pass
00135 \textcolor{comment}{*     .. Local Scalars ..}
00136       \textcolor{keywordtype}{DOUBLE PRECISION}  sa, sb, sc, ss, d12
00137       \textcolor{keywordtype}{INTEGER}           i, k
00138 \textcolor{comment}{*     .. Local Arrays ..}
00139       \textcolor{keywordtype}{DOUBLE PRECISION}  da1(8), datrue(8), db1(8), dbtrue(8), dc1(8),
00140      $                  ds1(8), dab(4,9), dtemp(9), dtrue(9,9)
00141 \textcolor{comment}{*     .. External Subroutines ..}
00142       \textcolor{keywordtype}{EXTERNAL}          drotg, drotmg, stest1
00143 \textcolor{comment}{*     .. Common blocks ..}
00144       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00145 \textcolor{comment}{*     .. Data statements ..}
00146       \textcolor{keyword}{DATA}              da1/0.3d0, 0.4d0, -0.3d0, -0.4d0, -0.3d0, 0.0d0,
00147      +                  0.0d0, 1.0d0/
00148       \textcolor{keyword}{DATA}              db1/0.4d0, 0.3d0, 0.4d0, 0.3d0, -0.4d0, 0.0d0,
00149      +                  1.0d0, 0.0d0/
00150       \textcolor{keyword}{DATA}              dc1/0.6d0, 0.8d0, -0.6d0, 0.8d0, 0.6d0, 1.0d0,
00151      +                  0.0d0, 1.0d0/
00152       \textcolor{keyword}{DATA}              ds1/0.8d0, 0.6d0, 0.8d0, -0.6d0, 0.8d0, 0.0d0,
00153      +                  1.0d0, 0.0d0/
00154       \textcolor{keyword}{DATA}              datrue/0.5d0, 0.5d0, 0.5d0, -0.5d0, -0.5d0,
00155      +                  0.0d0, 1.0d0, 1.0d0/
00156       \textcolor{keyword}{DATA}              dbtrue/0.0d0, 0.6d0, 0.0d0, -0.6d0, 0.0d0,
00157      +                  0.0d0, 1.0d0, 0.0d0/
00158 \textcolor{comment}{*     INPUT FOR MODIFIED GIVENS}
00159       \textcolor{keyword}{DATA} dab/ .1d0,.3d0,1.2d0,.2d0,
00160      a          .7d0, .2d0, .6d0, 4.2d0,
00161      b          0.d0,0.d0,0.d0,0.d0,
00162      c          4.d0, -1.d0, 2.d0, 4.d0,
00163      d          6.d-10, 2.d-2, 1.d5, 10.d0,
00164      e          4.d10, 2.d-2, 1.d-5, 10.d0,
00165      f          2.d-10, 4.d-2, 1.d5, 10.d0,
00166      g          2.d10, 4.d-2, 1.d-5, 10.d0,
00167      h          4.d0, -2.d0, 8.d0, 4.d0    /
00168 \textcolor{comment}{*    TRUE RESULTS FOR MODIFIED GIVENS}
00169       \textcolor{keyword}{DATA} dtrue/0.d0,0.d0, 1.3d0, .2d0, 0.d0,0.d0,0.d0, .5d0, 0.d0,
00170      a           0.d0,0.d0, 4.5d0, 4.2d0, 1.d0, .5d0, 0.d0,0.d0,0.d0,
00171      b           0.d0,0.d0,0.d0,0.d0, -2.d0, 0.d0,0.d0,0.d0,0.d0,
00172      c           0.d0,0.d0,0.d0, 4.d0, -1.d0, 0.d0,0.d0,0.d0,0.d0,
00173      d           0.d0, 15.d-3, 0.d0, 10.d0, -1.d0, 0.d0, -1.d-4,
00174      e           0.d0, 1.d0,
00175      f           0.d0,0.d0, 6144.d-5, 10.d0, -1.d0, 4096.d0, -1.d6,
00176      g           0.d0, 1.d0,
00177      h           0.d0,0.d0,15.d0,10.d0,-1.d0, 5.d-5, 0.d0,1.d0,0.d0,
00178      i           0.d0,0.d0, 15.d0, 10.d0, -1. d0, 5.d5, -4096.d0,
00179      j           1.d0, 4096.d-6,
00180      k           0.d0,0.d0, 7.d0, 4.d0, 0.d0,0.d0, -.5d0, -.25d0, 0.d0/
00181 \textcolor{comment}{*                   4096 = 2 ** 12}
00182       \textcolor{keyword}{DATA} d12  /4096.d0/
00183       dtrue(1,1) = 12.d0 / 130.d0
00184       dtrue(2,1) = 36.d0 / 130.d0
00185       dtrue(7,1) = -1.d0 / 6.d0
00186       dtrue(1,2) = 14.d0 / 75.d0
00187       dtrue(2,2) = 49.d0 / 75.d0
00188       dtrue(9,2) = 1.d0 / 7.d0
00189       dtrue(1,5) = 45.d-11 * (d12 * d12)
00190       dtrue(3,5) = 4.d5 / (3.d0 * d12)
00191       dtrue(6,5) = 1.d0 / d12
00192       dtrue(8,5) = 1.d4 / (3.d0 * d12)
00193       dtrue(1,6) = 4.d10 / (1.5d0 * d12 * d12)
00194       dtrue(2,6) = 2.d-2 / 1.5d0
00195       dtrue(8,6) = 5.d-7 * d12
00196       dtrue(1,7) = 4.d0 / 150.d0
00197       dtrue(2,7) = (2.d-10 / 1.5d0) * (d12 * d12)
00198       dtrue(7,7) = -dtrue(6,5)
00199       dtrue(9,7) = 1.d4 / d12
00200       dtrue(1,8) = dtrue(1,7)
00201       dtrue(2,8) = 2.d10 / (1.5d0 * d12 * d12)
00202       dtrue(1,9) = 32.d0 / 7.d0
00203       dtrue(2,9) = -16.d0 / 7.d0
00204 \textcolor{comment}{*     .. Executable Statements ..}
00205 \textcolor{comment}{*}
00206 \textcolor{comment}{*     Compute true values which cannot be prestored}
00207 \textcolor{comment}{*     in decimal notation}
00208 \textcolor{comment}{*}
00209       dbtrue(1) = 1.0d0/0.6d0
00210       dbtrue(3) = -1.0d0/0.6d0
00211       dbtrue(5) = 1.0d0/0.6d0
00212 \textcolor{comment}{*}
00213       \textcolor{keywordflow}{DO} 20 k = 1, 8
00214 \textcolor{comment}{*        .. Set N=K for identification in output if any ..}
00215          n = k
00216          \textcolor{keywordflow}{IF} (icase.EQ.3) \textcolor{keywordflow}{THEN}
00217 \textcolor{comment}{*           .. DROTG ..}
00218             \textcolor{keywordflow}{IF} (k.GT.8) \textcolor{keywordflow}{GO TO} 40
00219             sa = da1(k)
00220             sb = db1(k)
00221             \textcolor{keyword}{CALL }drotg(sa,sb,sc,ss)
00222             \textcolor{keyword}{CALL }stest1(sa,datrue(k),datrue(k),sfac)
00223             \textcolor{keyword}{CALL }stest1(sb,dbtrue(k),dbtrue(k),sfac)
00224             \textcolor{keyword}{CALL }stest1(sc,dc1(k),dc1(k),sfac)
00225             \textcolor{keyword}{CALL }stest1(ss,ds1(k),ds1(k),sfac)
00226          \textcolor{keywordflow}{ELSEIF} (icase.EQ.11) \textcolor{keywordflow}{THEN}
00227 \textcolor{comment}{*           .. DROTMG ..}
00228             \textcolor{keywordflow}{DO} i=1,4
00229                dtemp(i)= dab(i,k)
00230                dtemp(i+4) = 0.0
00231 \textcolor{keywordflow}{            END DO}
00232             dtemp(9) = 0.0
00233             \textcolor{keyword}{CALL }drotmg(dtemp(1),dtemp(2),dtemp(3),dtemp(4),dtemp(5))
00234             \textcolor{keyword}{CALL }stest(9,dtemp,dtrue(1,k),dtrue(1,k),sfac)
00235          \textcolor{keywordflow}{ELSE}
00236             \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK0'}
00237             stop
00238 \textcolor{keywordflow}{         END IF}
00239    20 \textcolor{keywordflow}{CONTINUE}
00240    40 \textcolor{keywordflow}{RETURN}
00241 \textcolor{keyword}{      END}
00242 \textcolor{keyword}{      SUBROUTINE }check1(SFAC)
00243 \textcolor{comment}{*     .. Parameters ..}
00244       \textcolor{keywordtype}{INTEGER}           nout
00245       parameter(nout=6)
00246 \textcolor{comment}{*     .. Scalar Arguments ..}
00247       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00248 \textcolor{comment}{*     .. Scalars in Common ..}
00249       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00250       \textcolor{keywordtype}{LOGICAL}           pass
00251 \textcolor{comment}{*     .. Local Scalars ..}
00252       \textcolor{keywordtype}{INTEGER}           i, len, np1
00253 \textcolor{comment}{*     .. Local Arrays ..}
00254       \textcolor{keywordtype}{DOUBLE PRECISION}  dtrue1(5), dtrue3(5), dtrue5(8,5,2), dv(8,5,2),
00255      +                  sa(10), stemp(1), strue(8), sx(8)
00256       \textcolor{keywordtype}{INTEGER}           itrue2(5)
00257 \textcolor{comment}{*     .. External Functions ..}
00258       \textcolor{keywordtype}{DOUBLE PRECISION}  dasum, dnrm2
00259       \textcolor{keywordtype}{INTEGER}           idamax
00260       \textcolor{keywordtype}{EXTERNAL}          dasum, dnrm2, idamax
00261 \textcolor{comment}{*     .. External Subroutines ..}
00262       \textcolor{keywordtype}{EXTERNAL}          itest1, dscal, stest, stest1
00263 \textcolor{comment}{*     .. Intrinsic Functions ..}
00264       \textcolor{keywordtype}{INTRINSIC}         max
00265 \textcolor{comment}{*     .. Common blocks ..}
00266       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00267 \textcolor{comment}{*     .. Data statements ..}
00268       \textcolor{keyword}{DATA}              sa/0.3d0, -1.0d0, 0.0d0, 1.0d0, 0.3d0, 0.3d0,
00269      +                  0.3d0, 0.3d0, 0.3d0, 0.3d0/
00270       \textcolor{keyword}{DATA}              dv/0.1d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0,
00271      +                  2.0d0, 2.0d0, 0.3d0, 3.0d0, 3.0d0, 3.0d0, 3.0d0,
00272      +                  3.0d0, 3.0d0, 3.0d0, 0.3d0, -0.4d0, 4.0d0,
00273      +                  4.0d0, 4.0d0, 4.0d0, 4.0d0, 4.0d0, 0.2d0,
00274      +                  -0.6d0, 0.3d0, 5.0d0, 5.0d0, 5.0d0, 5.0d0,
00275      +                  5.0d0, 0.1d0, -0.3d0, 0.5d0, -0.1d0, 6.0d0,
00276      +                  6.0d0, 6.0d0, 6.0d0, 0.1d0, 8.0d0, 8.0d0, 8.0d0,
00277      +                  8.0d0, 8.0d0, 8.0d0, 8.0d0, 0.3d0, 9.0d0, 9.0d0,
00278      +                  9.0d0, 9.0d0, 9.0d0, 9.0d0, 9.0d0, 0.3d0, 2.0d0,
00279      +                  -0.4d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0,
00280      +                  0.2d0, 3.0d0, -0.6d0, 5.0d0, 0.3d0, 2.0d0,
00281      +                  2.0d0, 2.0d0, 0.1d0, 4.0d0, -0.3d0, 6.0d0,
00282      +                  -0.5d0, 7.0d0, -0.1d0, 3.0d0/
00283       \textcolor{keyword}{DATA}              dtrue1/0.0d0, 0.3d0, 0.5d0, 0.7d0, 0.6d0/
00284       \textcolor{keyword}{DATA}              dtrue3/0.0d0, 0.3d0, 0.7d0, 1.1d0, 1.0d0/
00285       \textcolor{keyword}{DATA}              dtrue5/0.10d0, 2.0d0, 2.0d0, 2.0d0, 2.0d0,
00286      +                  2.0d0, 2.0d0, 2.0d0, -0.3d0, 3.0d0, 3.0d0,
00287      +                  3.0d0, 3.0d0, 3.0d0, 3.0d0, 3.0d0, 0.0d0, 0.0d0,
00288      +                  4.0d0, 4.0d0, 4.0d0, 4.0d0, 4.0d0, 4.0d0,
00289      +                  0.20d0, -0.60d0, 0.30d0, 5.0d0, 5.0d0, 5.0d0,
00290      +                  5.0d0, 5.0d0, 0.03d0, -0.09d0, 0.15d0, -0.03d0,
00291      +                  6.0d0, 6.0d0, 6.0d0, 6.0d0, 0.10d0, 8.0d0,
00292      +                  8.0d0, 8.0d0, 8.0d0, 8.0d0, 8.0d0, 8.0d0,
00293      +                  0.09d0, 9.0d0, 9.0d0, 9.0d0, 9.0d0, 9.0d0,
00294      +                  9.0d0, 9.0d0, 0.09d0, 2.0d0, -0.12d0, 2.0d0,
00295      +                  2.0d0, 2.0d0, 2.0d0, 2.0d0, 0.06d0, 3.0d0,
00296      +                  -0.18d0, 5.0d0, 0.09d0, 2.0d0, 2.0d0, 2.0d0,
00297      +                  0.03d0, 4.0d0, -0.09d0, 6.0d0, -0.15d0, 7.0d0,
00298      +                  -0.03d0, 3.0d0/
00299       \textcolor{keyword}{DATA}              itrue2/0, 1, 2, 2, 3/
00300 \textcolor{comment}{*     .. Executable Statements ..}
00301       \textcolor{keywordflow}{DO} 80 incx = 1, 2
00302          \textcolor{keywordflow}{DO} 60 np1 = 1, 5
00303             n = np1 - 1
00304             len = 2*max(n,1)
00305 \textcolor{comment}{*           .. Set vector arguments ..}
00306             \textcolor{keywordflow}{DO} 20 i = 1, len
00307                sx(i) = dv(i,np1,incx)
00308    20       \textcolor{keywordflow}{CONTINUE}
00309 \textcolor{comment}{*}
00310             \textcolor{keywordflow}{IF} (icase.EQ.7) \textcolor{keywordflow}{THEN}
00311 \textcolor{comment}{*              .. DNRM2 ..}
00312                stemp(1) = dtrue1(np1)
00313                \textcolor{keyword}{CALL }stest1(dnrm2(n,sx,incx),stemp(1),stemp,sfac)
00314             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.8) \textcolor{keywordflow}{THEN}
00315 \textcolor{comment}{*              .. DASUM ..}
00316                stemp(1) = dtrue3(np1)
00317                \textcolor{keyword}{CALL }stest1(dasum(n,sx,incx),stemp(1),stemp,sfac)
00318             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.9) \textcolor{keywordflow}{THEN}
00319 \textcolor{comment}{*              .. DSCAL ..}
00320                \textcolor{keyword}{CALL }dscal(n,sa((incx-1)*5+np1),sx,incx)
00321                \textcolor{keywordflow}{DO} 40 i = 1, len
00322                   strue(i) = dtrue5(i,np1,incx)
00323    40          \textcolor{keywordflow}{CONTINUE}
00324                \textcolor{keyword}{CALL }stest(len,sx,strue,strue,sfac)
00325             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.10) \textcolor{keywordflow}{THEN}
00326 \textcolor{comment}{*              .. IDAMAX ..}
00327                \textcolor{keyword}{CALL }itest1(idamax(n,sx,incx),itrue2(np1))
00328             \textcolor{keywordflow}{ELSE}
00329                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK1'}
00330                stop
00331 \textcolor{keywordflow}{            END IF}
00332    60    \textcolor{keywordflow}{CONTINUE}
00333    80 \textcolor{keywordflow}{CONTINUE}
00334       \textcolor{keywordflow}{RETURN}
00335 \textcolor{keyword}{      END}
00336 \textcolor{keyword}{      SUBROUTINE }check2(SFAC)
00337 \textcolor{comment}{*     .. Parameters ..}
00338       \textcolor{keywordtype}{INTEGER}           nout
00339       parameter(nout=6)
00340 \textcolor{comment}{*     .. Scalar Arguments ..}
00341       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00342 \textcolor{comment}{*     .. Scalars in Common ..}
00343       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00344       \textcolor{keywordtype}{LOGICAL}           pass
00345 \textcolor{comment}{*     .. Local Scalars ..}
00346       \textcolor{keywordtype}{DOUBLE PRECISION}  sa
00347       \textcolor{keywordtype}{INTEGER}           i, j, ki, kn, kni, kpar, ksize, lenx, leny,
00348      $                  mx, my 
00349 \textcolor{comment}{*     .. Local Arrays ..}
00350       \textcolor{keywordtype}{DOUBLE PRECISION}  dt10x(7,4,4), dt10y(7,4,4), dt7(4,4),
00351      $                  dt8(7,4,4), dx1(7),
00352      $                  dy1(7), ssize1(4), ssize2(14,2), ssize(7),
00353      $                  stx(7), sty(7), sx(7), sy(7),
00354      $                  dpar(5,4), dt19x(7,4,16),dt19xa(7,4,4),
00355      $                  dt19xb(7,4,4), dt19xc(7,4,4),dt19xd(7,4,4),
00356      $                  dt19y(7,4,16), dt19ya(7,4,4),dt19yb(7,4,4),
00357      $                  dt19yc(7,4,4), dt19yd(7,4,4), dtemp(5)
00358       \textcolor{keywordtype}{INTEGER}           incxs(4), incys(4), lens(4,2), ns(4)
00359 \textcolor{comment}{*     .. External Functions ..}
00360       \textcolor{keywordtype}{DOUBLE PRECISION}  ddot, dsdot
00361       \textcolor{keywordtype}{EXTERNAL}          ddot, dsdot
00362 \textcolor{comment}{*     .. External Subroutines ..}
00363       \textcolor{keywordtype}{EXTERNAL}          daxpy, dcopy, drotm, dswap, stest, stest1
00364 \textcolor{comment}{*     .. Intrinsic Functions ..}
00365       \textcolor{keywordtype}{INTRINSIC}         abs, min
00366 \textcolor{comment}{*     .. Common blocks ..}
00367       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00368 \textcolor{comment}{*     .. Data statements ..}
00369       equivalence(dt19x(1,1,1),dt19xa(1,1,1)),(dt19x(1,1,5),
00370      a   dt19xb(1,1,1)),(dt19x(1,1,9),dt19xc(1,1,1)),
00371      b   (dt19x(1,1,13),dt19xd(1,1,1))
00372       equivalence(dt19y(1,1,1),dt19ya(1,1,1)),(dt19y(1,1,5),
00373      a   dt19yb(1,1,1)),(dt19y(1,1,9),dt19yc(1,1,1)),
00374      b   (dt19y(1,1,13),dt19yd(1,1,1))
00375 
00376       \textcolor{keyword}{DATA}              sa/0.3d0/
00377       \textcolor{keyword}{DATA}              incxs/1, 2, -2, -1/
00378       \textcolor{keyword}{DATA}              incys/1, -2, 1, -2/
00379       \textcolor{keyword}{DATA}              lens/1, 1, 2, 4, 1, 1, 3, 7/
00380       \textcolor{keyword}{DATA}              ns/0, 1, 2, 4/
00381       \textcolor{keyword}{DATA}              dx1/0.6d0, 0.1d0, -0.5d0, 0.8d0, 0.9d0, -0.3d0,
00382      +                  -0.4d0/
00383       \textcolor{keyword}{DATA}              dy1/0.5d0, -0.9d0, 0.3d0, 0.7d0, -0.6d0, 0.2d0,
00384      +                  0.8d0/
00385       \textcolor{keyword}{DATA}              dt7/0.0d0, 0.30d0, 0.21d0, 0.62d0, 0.0d0,
00386      +                  0.30d0, -0.07d0, 0.85d0, 0.0d0, 0.30d0, -0.79d0,
00387      +                  -0.74d0, 0.0d0, 0.30d0, 0.33d0, 1.27d0/
00388       \textcolor{keyword}{DATA}              dt8/0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00389      +                  0.0d0, 0.68d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00390      +                  0.0d0, 0.0d0, 0.68d0, -0.87d0, 0.0d0, 0.0d0,
00391      +                  0.0d0, 0.0d0, 0.0d0, 0.68d0, -0.87d0, 0.15d0,
00392      +                  0.94d0, 0.0d0, 0.0d0, 0.0d0, 0.5d0, 0.0d0,
00393      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.68d0,
00394      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00395      +                  0.35d0, -0.9d0, 0.48d0, 0.0d0, 0.0d0, 0.0d0,
00396      +                  0.0d0, 0.38d0, -0.9d0, 0.57d0, 0.7d0, -0.75d0,
00397      +                  0.2d0, 0.98d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0,
00398      +                  0.0d0, 0.0d0, 0.0d0, 0.68d0, 0.0d0, 0.0d0,
00399      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.35d0, -0.72d0,
00400      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.38d0,
00401      +                  -0.63d0, 0.15d0, 0.88d0, 0.0d0, 0.0d0, 0.0d0,
00402      +                  0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00403      +                  0.68d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00404      +                  0.0d0, 0.68d0, -0.9d0, 0.33d0, 0.0d0, 0.0d0,
00405      +                  0.0d0, 0.0d0, 0.68d0, -0.9d0, 0.33d0, 0.7d0,
00406      +                  -0.75d0, 0.2d0, 1.04d0/
00407       \textcolor{keyword}{DATA}              dt10x/0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00408      +                  0.0d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00409      +                  0.0d0, 0.5d0, -0.9d0, 0.0d0, 0.0d0, 0.0d0,
00410      +                  0.0d0, 0.0d0, 0.5d0, -0.9d0, 0.3d0, 0.7d0,
00411      +                  0.0d0, 0.0d0, 0.0d0, 0.6d0, 0.0d0, 0.0d0, 0.0d0,
00412      +                  0.0d0, 0.0d0, 0.0d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0,
00413      +                  0.0d0, 0.0d0, 0.0d0, 0.3d0, 0.1d0, 0.5d0, 0.0d0,
00414      +                  0.0d0, 0.0d0, 0.0d0, 0.8d0, 0.1d0, -0.6d0,
00415      +                  0.8d0, 0.3d0, -0.3d0, 0.5d0, 0.6d0, 0.0d0,
00416      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.5d0, 0.0d0,
00417      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, -0.9d0,
00418      +                  0.1d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.7d0,
00419      +                  0.1d0, 0.3d0, 0.8d0, -0.9d0, -0.3d0, 0.5d0,
00420      +                  0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00421      +                  0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00422      +                  0.5d0, 0.3d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00423      +                  0.5d0, 0.3d0, -0.6d0, 0.8d0, 0.0d0, 0.0d0,
00424      +                  0.0d0/
00425       \textcolor{keyword}{DATA}              dt10y/0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00426      +                  0.0d0, 0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00427      +                  0.0d0, 0.6d0, 0.1d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00428      +                  0.0d0, 0.6d0, 0.1d0, -0.5d0, 0.8d0, 0.0d0,
00429      +                  0.0d0, 0.0d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00430      +                  0.0d0, 0.0d0, 0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00431      +                  0.0d0, 0.0d0, -0.5d0, -0.9d0, 0.6d0, 0.0d0,
00432      +                  0.0d0, 0.0d0, 0.0d0, -0.4d0, -0.9d0, 0.9d0,
00433      +                  0.7d0, -0.5d0, 0.2d0, 0.6d0, 0.5d0, 0.0d0,
00434      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.6d0, 0.0d0,
00435      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, -0.5d0,
00436      +                  0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00437      +                  -0.4d0, 0.9d0, -0.5d0, 0.6d0, 0.0d0, 0.0d0,
00438      +                  0.0d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00439      +                  0.0d0, 0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00440      +                  0.0d0, 0.6d0, -0.9d0, 0.1d0, 0.0d0, 0.0d0,
00441      +                  0.0d0, 0.0d0, 0.6d0, -0.9d0, 0.1d0, 0.7d0,
00442      +                  -0.5d0, 0.2d0, 0.8d0/
00443       \textcolor{keyword}{DATA}              ssize1/0.0d0, 0.3d0, 1.6d0, 3.2d0/
00444       \textcolor{keyword}{DATA}              ssize2/0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00445      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00446      +                  0.0d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0,
00447      +                  1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0,
00448      +                  1.17d0, 1.17d0, 1.17d0/
00449 \textcolor{comment}{*}
00450 \textcolor{comment}{*                         FOR DROTM}
00451 \textcolor{comment}{*}
00452       \textcolor{keyword}{DATA} dpar/-2.d0,  0.d0,0.d0,0.d0,0.d0,
00453      a          -1.d0,  2.d0, -3.d0, -4.d0,  5.d0,
00454      b           0.d0,  0.d0,  2.d0, -3.d0,  0.d0,
00455      c           1.d0,  5.d0,  2.d0,  0.d0, -4.d0/
00456 \textcolor{comment}{*                        TRUE X RESULTS F0R ROTATIONS DROTM}
00457       \textcolor{keyword}{DATA} dt19xa/.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00458      a            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00459      b            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00460      c            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00461      d            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00462      e           -.8d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00463      f           -.9d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00464      g           3.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00465      h            .6d0,   .1d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00466      i           -.8d0,  3.8d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00467      j           -.9d0,  2.8d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00468      k           3.5d0,  -.4d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00469      l            .6d0,   .1d0,  -.5d0,   .8d0,          0.d0,0.d0,0.d0,
00470      m           -.8d0,  3.8d0, -2.2d0, -1.2d0,          0.d0,0.d0,0.d0,
00471      n           -.9d0,  2.8d0, -1.4d0, -1.3d0,          0.d0,0.d0,0.d0,
00472      o           3.5d0,  -.4d0, -2.2d0,  4.7d0,          0.d0,0.d0,0.d0/
00473 \textcolor{comment}{*}
00474       \textcolor{keyword}{DATA} dt19xb/.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00475      a            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00476      b            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00477      c            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00478      d            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00479      e           -.8d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00480      f           -.9d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00481      g           3.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00482      h            .6d0,   .1d0,  -.5d0,             0.d0,0.d0,0.d0,0.d0,
00483      i           0.d0,    .1d0, -3.0d0,             0.d0,0.d0,0.d0,0.d0,
00484      j           -.3d0,   .1d0, -2.0d0,             0.d0,0.d0,0.d0,0.d0,
00485      k           3.3d0,   .1d0, -2.0d0,             0.d0,0.d0,0.d0,0.d0,
00486      l            .6d0,   .1d0,  -.5d0,   .8d0,   .9d0,  -.3d0,  -.4d0,
00487      m          -2.0d0,   .1d0,  1.4d0,   .8d0,   .6d0,  -.3d0, -2.8d0,
00488      n          -1.8d0,   .1d0,  1.3d0,   .8d0,  0.d0,   -.3d0, -1.9d0,
00489      o           3.8d0,   .1d0, -3.1d0,   .8d0,  4.8d0,  -.3d0, -1.5d0 /
00490 \textcolor{comment}{*}
00491       \textcolor{keyword}{DATA} dt19xc/.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00492      a            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00493      b            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00494      c            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00495      d            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00496      e           -.8d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00497      f           -.9d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00498      g           3.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00499      h            .6d0,   .1d0,  -.5d0,             0.d0,0.d0,0.d0,0.d0,
00500      i           4.8d0,   .1d0, -3.0d0,             0.d0,0.d0,0.d0,0.d0,
00501      j           3.3d0,   .1d0, -2.0d0,             0.d0,0.d0,0.d0,0.d0,
00502      k           2.1d0,   .1d0, -2.0d0,             0.d0,0.d0,0.d0,0.d0,
00503      l            .6d0,   .1d0,  -.5d0,   .8d0,   .9d0,  -.3d0,  -.4d0,
00504      m          -1.6d0,   .1d0, -2.2d0,   .8d0,  5.4d0,  -.3d0, -2.8d0,
00505      n          -1.5d0,   .1d0, -1.4d0,   .8d0,  3.6d0,  -.3d0, -1.9d0,
00506      o           3.7d0,   .1d0, -2.2d0,   .8d0,  3.6d0,  -.3d0, -1.5d0 /
00507 \textcolor{comment}{*}
00508       \textcolor{keyword}{DATA} dt19xd/.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00509      a            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00510      b            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00511      c            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00512      d            .6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00513      e           -.8d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00514      f           -.9d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00515      g           3.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00516      h            .6d0,   .1d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00517      i           -.8d0, -1.0d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00518      j           -.9d0,  -.8d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00519      k           3.5d0,   .8d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00520      l            .6d0,   .1d0,  -.5d0,   .8d0,          0.d0,0.d0,0.d0,
00521      m           -.8d0, -1.0d0,  1.4d0, -1.6d0,          0.d0,0.d0,0.d0,
00522      n           -.9d0,  -.8d0,  1.3d0, -1.6d0,          0.d0,0.d0,0.d0,
00523      o           3.5d0,   .8d0, -3.1d0,  4.8d0,          0.d0,0.d0,0.d0/
00524 \textcolor{comment}{*                        TRUE Y RESULTS FOR ROTATIONS DROTM}
00525       \textcolor{keyword}{DATA} dt19ya/.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00526      a            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00527      b            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00528      c            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00529      d            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00530      e            .7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00531      f           1.7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00532      g          -2.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00533      h            .5d0,  -.9d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00534      i            .7d0, -4.8d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00535      j           1.7d0,  -.7d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00536      k          -2.6d0,  3.5d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00537      l            .5d0,  -.9d0,   .3d0,   .7d0,          0.d0,0.d0,0.d0,
00538      m            .7d0, -4.8d0,  3.0d0,  1.1d0,          0.d0,0.d0,0.d0,
00539      n           1.7d0,  -.7d0,  -.7d0,  2.3d0,          0.d0,0.d0,0.d0,
00540      o          -2.6d0,  3.5d0,  -.7d0, -3.6d0,          0.d0,0.d0,0.d0/
00541 \textcolor{comment}{*}
00542       \textcolor{keyword}{DATA} dt19yb/.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00543      a            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00544      b            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00545      c            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00546      d            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00547      e            .7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00548      f           1.7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00549      g          -2.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00550      h            .5d0,  -.9d0,   .3d0,             0.d0,0.d0,0.d0,0.d0,
00551      i           4.0d0,  -.9d0,  -.3d0,             0.d0,0.d0,0.d0,0.d0,
00552      j           -.5d0,  -.9d0,  1.5d0,             0.d0,0.d0,0.d0,0.d0,
00553      k          -1.5d0,  -.9d0, -1.8d0,             0.d0,0.d0,0.d0,0.d0,
00554      l            .5d0,  -.9d0,   .3d0,   .7d0,  -.6d0,   .2d0,   .8d0,
00555      m           3.7d0,  -.9d0, -1.2d0,   .7d0, -1.5d0,   .2d0,  2.2d0,
00556      n           -.3d0,  -.9d0,  2.1d0,   .7d0, -1.6d0,   .2d0,  2.0d0,
00557      o          -1.6d0,  -.9d0, -2.1d0,   .7d0,  2.9d0,   .2d0, -3.8d0 /
00558 \textcolor{comment}{*}
00559       \textcolor{keyword}{DATA} dt19yc/.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00560      a            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00561      b            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00562      c            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00563      d            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00564      e            .7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00565      f           1.7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00566      g          -2.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00567      h            .5d0,  -.9d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00568      i           4.0d0, -6.3d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00569      j           -.5d0,   .3d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00570      k          -1.5d0,  3.0d0,             0.d0,0.d0,0.d0,0.d0,0.d0,
00571      l            .5d0,  -.9d0,   .3d0,   .7d0,          0.d0,0.d0,0.d0,
00572      m           3.7d0, -7.2d0,  3.0d0,  1.7d0,          0.d0,0.d0,0.d0,
00573      n           -.3d0,   .9d0,  -.7d0,  1.9d0,          0.d0,0.d0,0.d0,
00574      o          -1.6d0,  2.7d0,  -.7d0, -3.4d0,          0.d0,0.d0,0.d0/
00575 \textcolor{comment}{*}
00576       \textcolor{keyword}{DATA} dt19yd/.5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00577      a            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00578      b            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00579      c            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00580      d            .5d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00581      e            .7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00582      f           1.7d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00583      g          -2.6d0,                  0.d0,0.d0,0.d0,0.d0,0.d0,0.d0,
00584      h            .5d0,  -.9d0,   .3d0,             0.d0,0.d0,0.d0,0.d0,
00585      i            .7d0,  -.9d0,  1.2d0,             0.d0,0.d0,0.d0,0.d0,
00586      j           1.7d0,  -.9d0,   .5d0,             0.d0,0.d0,0.d0,0.d0,
00587      k          -2.6d0,  -.9d0, -1.3d0,             0.d0,0.d0,0.d0,0.d0,
00588      l            .5d0,  -.9d0,   .3d0,   .7d0,  -.6d0,   .2d0,   .8d0,
00589      m            .7d0,  -.9d0,  1.2d0,   .7d0, -1.5d0,   .2d0,  1.6d0,
00590      n           1.7d0,  -.9d0,   .5d0,   .7d0, -1.6d0,   .2d0,  2.4d0,
00591      o          -2.6d0,  -.9d0, -1.3d0,   .7d0,  2.9d0,   .2d0, -4.0d0 /
00592 \textcolor{comment}{*    }
00593 \textcolor{comment}{*     .. Executable Statements ..}
00594 \textcolor{comment}{*}
00595       \textcolor{keywordflow}{DO} 120 ki = 1, 4
00596          incx = incxs(ki)
00597          incy = incys(ki)
00598          mx = abs(incx)
00599          my = abs(incy)
00600 \textcolor{comment}{*}
00601          \textcolor{keywordflow}{DO} 100 kn = 1, 4
00602             n = ns(kn)
00603             ksize = min(2,kn)
00604             lenx = lens(kn,mx)
00605             leny = lens(kn,my)
00606 \textcolor{comment}{*           .. Initialize all argument arrays ..}
00607             \textcolor{keywordflow}{DO} 20 i = 1, 7
00608                sx(i) = dx1(i)
00609                sy(i) = dy1(i)
00610    20       \textcolor{keywordflow}{CONTINUE}
00611 \textcolor{comment}{*}
00612             \textcolor{keywordflow}{IF} (icase.EQ.1) \textcolor{keywordflow}{THEN}
00613 \textcolor{comment}{*              .. DDOT ..}
00614                \textcolor{keyword}{CALL }stest1(ddot(n,sx,incx,sy,incy),dt7(kn,ki),ssize1(kn)
00615      +                     ,sfac)
00616             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.2) \textcolor{keywordflow}{THEN}
00617 \textcolor{comment}{*              .. DAXPY ..}
00618                \textcolor{keyword}{CALL }daxpy(n,sa,sx,incx,sy,incy)
00619                \textcolor{keywordflow}{DO} 40 j = 1, leny
00620                   sty(j) = dt8(j,kn,ki)
00621    40          \textcolor{keywordflow}{CONTINUE}
00622                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,ksize),sfac)
00623             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.5) \textcolor{keywordflow}{THEN}
00624 \textcolor{comment}{*              .. DCOPY ..}
00625                \textcolor{keywordflow}{DO} 60 i = 1, 7
00626                   sty(i) = dt10y(i,kn,ki)
00627    60          \textcolor{keywordflow}{CONTINUE}
00628                \textcolor{keyword}{CALL }dcopy(n,sx,incx,sy,incy)
00629                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,1),1.0d0)
00630             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.6) \textcolor{keywordflow}{THEN}
00631 \textcolor{comment}{*              .. DSWAP ..}
00632                \textcolor{keyword}{CALL }dswap(n,sx,incx,sy,incy)
00633                \textcolor{keywordflow}{DO} 80 i = 1, 7
00634                   stx(i) = dt10x(i,kn,ki)
00635                   sty(i) = dt10y(i,kn,ki)
00636    80          \textcolor{keywordflow}{CONTINUE}
00637                \textcolor{keyword}{CALL }stest(lenx,sx,stx,ssize2(1,1),1.0d0)
00638                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,1),1.0d0)
00639             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.12) \textcolor{keywordflow}{THEN}
00640 \textcolor{comment}{*              .. DROTM ..}
00641                kni=kn+4*(ki-1)
00642                \textcolor{keywordflow}{DO} kpar=1,4
00643                   \textcolor{keywordflow}{DO} i=1,7
00644                      sx(i) = dx1(i)
00645                      sy(i) = dy1(i)
00646                      stx(i)= dt19x(i,kpar,kni)
00647                      sty(i)= dt19y(i,kpar,kni)
00648 \textcolor{keywordflow}{                  END DO}
00649 \textcolor{comment}{*}
00650                   \textcolor{keywordflow}{DO} i=1,5
00651                      dtemp(i) = dpar(i,kpar)
00652 \textcolor{keywordflow}{                  END DO}
00653 \textcolor{comment}{*}
00654                   \textcolor{keywordflow}{DO}  i=1,lenx
00655                      ssize(i)=stx(i)
00656 \textcolor{keywordflow}{                  END DO}
00657 \textcolor{comment}{*                   SEE REMARK ABOVE ABOUT DT11X(1,2,7)}
00658 \textcolor{comment}{*                       AND DT11X(5,3,8).}
00659                   \textcolor{keywordflow}{IF} ((kpar .EQ. 2) .AND. (kni .EQ. 7))
00660      $               ssize(1) = 2.4d0
00661                   \textcolor{keywordflow}{IF} ((kpar .EQ. 3) .AND. (kni .EQ. 8))
00662      $               ssize(5) = 1.8d0
00663 \textcolor{comment}{*}
00664                   \textcolor{keyword}{CALL   }drotm(n,sx,incx,sy,incy,dtemp)
00665                   \textcolor{keyword}{CALL   }stest(lenx,sx,stx,ssize,sfac)
00666                   \textcolor{keyword}{CALL   }stest(leny,sy,sty,sty,sfac)
00667 \textcolor{keywordflow}{               END DO}
00668             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.13) \textcolor{keywordflow}{THEN}
00669 \textcolor{comment}{*              .. DSDOT ..}
00670             \textcolor{keyword}{CALL }testdsdot(\textcolor{keywordtype}{REAL(DSDOT(N,REAL(SX),INCX,REAL(SY),INCY))},
00671      $                 \textcolor{keywordtype}{REAL(DT7(KN,KI))},\textcolor{keywordtype}{REAL(SSIZE1(KN))}, .3125e-1)
00672             \textcolor{keywordflow}{ELSE}
00673                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK2'}
00674                stop
00675 \textcolor{keywordflow}{            END IF}
00676   100    \textcolor{keywordflow}{CONTINUE}
00677   120 \textcolor{keywordflow}{CONTINUE}
00678       \textcolor{keywordflow}{RETURN}
00679 \textcolor{keyword}{      END}
00680 \textcolor{keyword}{      SUBROUTINE }check3(SFAC)
00681 \textcolor{comment}{*     .. Parameters ..}
00682       \textcolor{keywordtype}{INTEGER}           nout
00683       parameter(nout=6)
00684 \textcolor{comment}{*     .. Scalar Arguments ..}
00685       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00686 \textcolor{comment}{*     .. Scalars in Common ..}
00687       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00688       \textcolor{keywordtype}{LOGICAL}           pass
00689 \textcolor{comment}{*     .. Local Scalars ..}
00690       \textcolor{keywordtype}{DOUBLE PRECISION}  sc, ss
00691       \textcolor{keywordtype}{INTEGER}           i, k, ki, kn, ksize, lenx, leny, mx, my
00692 \textcolor{comment}{*     .. Local Arrays ..}
00693       \textcolor{keywordtype}{DOUBLE PRECISION}  copyx(5), copyy(5), dt9x(7,4,4), dt9y(7,4,4),
00694      +                  dx1(7), dy1(7), mwpc(11), mwps(11), mwpstx(5),
00695      +                  mwpsty(5), mwptx(11,5), mwpty(11,5), mwpx(5),
00696      +                  mwpy(5), ssize2(14,2), stx(7), sty(7), sx(7),
00697      +                  sy(7)
00698       \textcolor{keywordtype}{INTEGER}           incxs(4), incys(4), lens(4,2), mwpinx(11),
00699      +                  mwpiny(11), mwpn(11), ns(4)
00700 \textcolor{comment}{*     .. External Subroutines ..}
00701       \textcolor{keywordtype}{EXTERNAL}          drot, stest
00702 \textcolor{comment}{*     .. Intrinsic Functions ..}
00703       \textcolor{keywordtype}{INTRINSIC}         abs, min
00704 \textcolor{comment}{*     .. Common blocks ..}
00705       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00706 \textcolor{comment}{*     .. Data statements ..}
00707       \textcolor{keyword}{DATA}              incxs/1, 2, -2, -1/
00708       \textcolor{keyword}{DATA}              incys/1, -2, 1, -2/
00709       \textcolor{keyword}{DATA}              lens/1, 1, 2, 4, 1, 1, 3, 7/
00710       \textcolor{keyword}{DATA}              ns/0, 1, 2, 4/
00711       \textcolor{keyword}{DATA}              dx1/0.6d0, 0.1d0, -0.5d0, 0.8d0, 0.9d0, -0.3d0,
00712      +                  -0.4d0/
00713       \textcolor{keyword}{DATA}              dy1/0.5d0, -0.9d0, 0.3d0, 0.7d0, -0.6d0, 0.2d0,
00714      +                  0.8d0/
00715       \textcolor{keyword}{DATA}              sc, ss/0.8d0, 0.6d0/
00716       \textcolor{keyword}{DATA}              dt9x/0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00717      +                  0.0d0, 0.78d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00718      +                  0.0d0, 0.0d0, 0.78d0, -0.46d0, 0.0d0, 0.0d0,
00719      +                  0.0d0, 0.0d0, 0.0d0, 0.78d0, -0.46d0, -0.22d0,
00720      +                  1.06d0, 0.0d0, 0.0d0, 0.0d0, 0.6d0, 0.0d0,
00721      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.78d0,
00722      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00723      +                  0.66d0, 0.1d0, -0.1d0, 0.0d0, 0.0d0, 0.0d0,
00724      +                  0.0d0, 0.96d0, 0.1d0, -0.76d0, 0.8d0, 0.90d0,
00725      +                  -0.3d0, -0.02d0, 0.6d0, 0.0d0, 0.0d0, 0.0d0,
00726      +                  0.0d0, 0.0d0, 0.0d0, 0.78d0, 0.0d0, 0.0d0,
00727      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, -0.06d0, 0.1d0,
00728      +                  -0.1d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.90d0,
00729      +                  0.1d0, -0.22d0, 0.8d0, 0.18d0, -0.3d0, -0.02d0,
00730      +                  0.6d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00731      +                  0.78d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00732      +                  0.0d0, 0.78d0, 0.26d0, 0.0d0, 0.0d0, 0.0d0,
00733      +                  0.0d0, 0.0d0, 0.78d0, 0.26d0, -0.76d0, 1.12d0,
00734      +                  0.0d0, 0.0d0, 0.0d0/
00735       \textcolor{keyword}{DATA}              dt9y/0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00736      +                  0.0d0, 0.04d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00737      +                  0.0d0, 0.0d0, 0.04d0, -0.78d0, 0.0d0, 0.0d0,
00738      +                  0.0d0, 0.0d0, 0.0d0, 0.04d0, -0.78d0, 0.54d0,
00739      +                  0.08d0, 0.0d0, 0.0d0, 0.0d0, 0.5d0, 0.0d0,
00740      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.04d0,
00741      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.7d0,
00742      +                  -0.9d0, -0.12d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00743      +                  0.64d0, -0.9d0, -0.30d0, 0.7d0, -0.18d0, 0.2d0,
00744      +                  0.28d0, 0.5d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00745      +                  0.0d0, 0.0d0, 0.04d0, 0.0d0, 0.0d0, 0.0d0,
00746      +                  0.0d0, 0.0d0, 0.0d0, 0.7d0, -1.08d0, 0.0d0,
00747      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.64d0, -1.26d0,
00748      +                  0.54d0, 0.20d0, 0.0d0, 0.0d0, 0.0d0, 0.5d0,
00749      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00750      +                  0.04d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00751      +                  0.0d0, 0.04d0, -0.9d0, 0.18d0, 0.0d0, 0.0d0,
00752      +                  0.0d0, 0.0d0, 0.04d0, -0.9d0, 0.18d0, 0.7d0,
00753      +                  -0.18d0, 0.2d0, 0.16d0/
00754       \textcolor{keyword}{DATA}              ssize2/0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00755      +                  0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0, 0.0d0,
00756      +                  0.0d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0,
00757      +                  1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0, 1.17d0,
00758      +                  1.17d0, 1.17d0, 1.17d0/
00759 \textcolor{comment}{*     .. Executable Statements ..}
00760 \textcolor{comment}{*}
00761       \textcolor{keywordflow}{DO} 60 ki = 1, 4
00762          incx = incxs(ki)
00763          incy = incys(ki)
00764          mx = abs(incx)
00765          my = abs(incy)
00766 \textcolor{comment}{*}
00767          \textcolor{keywordflow}{DO} 40 kn = 1, 4
00768             n = ns(kn)
00769             ksize = min(2,kn)
00770             lenx = lens(kn,mx)
00771             leny = lens(kn,my)
00772 \textcolor{comment}{*}
00773             \textcolor{keywordflow}{IF} (icase.EQ.4) \textcolor{keywordflow}{THEN}
00774 \textcolor{comment}{*              .. DROT ..}
00775                \textcolor{keywordflow}{DO} 20 i = 1, 7
00776                   sx(i) = dx1(i)
00777                   sy(i) = dy1(i)
00778                   stx(i) = dt9x(i,kn,ki)
00779                   sty(i) = dt9y(i,kn,ki)
00780    20          \textcolor{keywordflow}{CONTINUE}
00781                \textcolor{keyword}{CALL }drot(n,sx,incx,sy,incy,sc,ss)
00782                \textcolor{keyword}{CALL }stest(lenx,sx,stx,ssize2(1,ksize),sfac)
00783                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,ksize),sfac)
00784             \textcolor{keywordflow}{ELSE}
00785                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK3'}
00786                stop
00787 \textcolor{keywordflow}{            END IF}
00788    40    \textcolor{keywordflow}{CONTINUE}
00789    60 \textcolor{keywordflow}{CONTINUE}
00790 \textcolor{comment}{*}
00791       mwpc(1) = 1
00792       \textcolor{keywordflow}{DO} 80 i = 2, 11
00793          mwpc(i) = 0
00794    80 \textcolor{keywordflow}{CONTINUE}
00795       mwps(1) = 0
00796       \textcolor{keywordflow}{DO} 100 i = 2, 6
00797          mwps(i) = 1
00798   100 \textcolor{keywordflow}{CONTINUE}
00799       \textcolor{keywordflow}{DO} 120 i = 7, 11
00800          mwps(i) = -1
00801   120 \textcolor{keywordflow}{CONTINUE}
00802       mwpinx(1) = 1
00803       mwpinx(2) = 1
00804       mwpinx(3) = 1
00805       mwpinx(4) = -1
00806       mwpinx(5) = 1
00807       mwpinx(6) = -1
00808       mwpinx(7) = 1
00809       mwpinx(8) = 1
00810       mwpinx(9) = -1
00811       mwpinx(10) = 1
00812       mwpinx(11) = -1
00813       mwpiny(1) = 1
00814       mwpiny(2) = 1
00815       mwpiny(3) = -1
00816       mwpiny(4) = -1
00817       mwpiny(5) = 2
00818       mwpiny(6) = 1
00819       mwpiny(7) = 1
00820       mwpiny(8) = -1
00821       mwpiny(9) = -1
00822       mwpiny(10) = 2
00823       mwpiny(11) = 1
00824       \textcolor{keywordflow}{DO} 140 i = 1, 11
00825          mwpn(i) = 5
00826   140 \textcolor{keywordflow}{CONTINUE}
00827       mwpn(5) = 3
00828       mwpn(10) = 3
00829       \textcolor{keywordflow}{DO} 160 i = 1, 5
00830          mwpx(i) = i
00831          mwpy(i) = i
00832          mwptx(1,i) = i
00833          mwpty(1,i) = i
00834          mwptx(2,i) = i
00835          mwpty(2,i) = -i
00836          mwptx(3,i) = 6 - i
00837          mwpty(3,i) = i - 6
00838          mwptx(4,i) = i
00839          mwpty(4,i) = -i
00840          mwptx(6,i) = 6 - i
00841          mwpty(6,i) = i - 6
00842          mwptx(7,i) = -i
00843          mwpty(7,i) = i
00844          mwptx(8,i) = i - 6
00845          mwpty(8,i) = 6 - i
00846          mwptx(9,i) = -i
00847          mwpty(9,i) = i
00848          mwptx(11,i) = i - 6
00849          mwpty(11,i) = 6 - i
00850   160 \textcolor{keywordflow}{CONTINUE}
00851       mwptx(5,1) = 1
00852       mwptx(5,2) = 3
00853       mwptx(5,3) = 5
00854       mwptx(5,4) = 4
00855       mwptx(5,5) = 5
00856       mwpty(5,1) = -1
00857       mwpty(5,2) = 2
00858       mwpty(5,3) = -2
00859       mwpty(5,4) = 4
00860       mwpty(5,5) = -3
00861       mwptx(10,1) = -1
00862       mwptx(10,2) = -3
00863       mwptx(10,3) = -5
00864       mwptx(10,4) = 4
00865       mwptx(10,5) = 5
00866       mwpty(10,1) = 1
00867       mwpty(10,2) = 2
00868       mwpty(10,3) = 2
00869       mwpty(10,4) = 4
00870       mwpty(10,5) = 3
00871       \textcolor{keywordflow}{DO} 200 i = 1, 11
00872          incx = mwpinx(i)
00873          incy = mwpiny(i)
00874          \textcolor{keywordflow}{DO} 180 k = 1, 5
00875             copyx(k) = mwpx(k)
00876             copyy(k) = mwpy(k)
00877             mwpstx(k) = mwptx(i,k)
00878             mwpsty(k) = mwpty(i,k)
00879   180    \textcolor{keywordflow}{CONTINUE}
00880          \textcolor{keyword}{CALL }drot(mwpn(i),copyx,incx,copyy,incy,mwpc(i),mwps(i))
00881          \textcolor{keyword}{CALL }stest(5,copyx,mwpstx,mwpstx,sfac)
00882          \textcolor{keyword}{CALL }stest(5,copyy,mwpsty,mwpsty,sfac)
00883   200 \textcolor{keywordflow}{CONTINUE}
00884       \textcolor{keywordflow}{RETURN}
00885 \textcolor{keyword}{      END}
00886 \textcolor{keyword}{      SUBROUTINE }stest(LEN,SCOMP,STRUE,SSIZE,SFAC)
00887 \textcolor{comment}{*     ********************************* STEST **************************}
00888 \textcolor{comment}{*}
00889 \textcolor{comment}{*     THIS SUBR COMPARES ARRAYS  SCOMP() AND STRUE() OF LENGTH LEN TO}
00890 \textcolor{comment}{*     SEE IF THE TERM BY TERM DIFFERENCES, MULTIPLIED BY SFAC, ARE}
00891 \textcolor{comment}{*     NEGLIGIBLE.}
00892 \textcolor{comment}{*}
00893 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00894 \textcolor{comment}{*}
00895 \textcolor{comment}{*     .. Parameters ..}
00896       \textcolor{keywordtype}{INTEGER}          nout
00897       \textcolor{keywordtype}{DOUBLE PRECISION} zero
00898       parameter(nout=6, zero=0.0d0)
00899 \textcolor{comment}{*     .. Scalar Arguments ..}
00900       \textcolor{keywordtype}{DOUBLE PRECISION} sfac
00901       \textcolor{keywordtype}{INTEGER}          len
00902 \textcolor{comment}{*     .. Array Arguments ..}
00903       \textcolor{keywordtype}{DOUBLE PRECISION} scomp(len), ssize(len), strue(len)
00904 \textcolor{comment}{*     .. Scalars in Common ..}
00905       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00906       \textcolor{keywordtype}{LOGICAL}          pass
00907 \textcolor{comment}{*     .. Local Scalars ..}
00908       \textcolor{keywordtype}{DOUBLE PRECISION} sd
00909       \textcolor{keywordtype}{INTEGER}          i
00910 \textcolor{comment}{*     .. External Functions ..}
00911       \textcolor{keywordtype}{DOUBLE PRECISION} sdiff
00912       \textcolor{keywordtype}{EXTERNAL}         sdiff
00913 \textcolor{comment}{*     .. Intrinsic Functions ..}
00914       \textcolor{keywordtype}{INTRINSIC}        abs
00915 \textcolor{comment}{*     .. Common blocks ..}
00916       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00917 \textcolor{comment}{*     .. Executable Statements ..}
00918 \textcolor{comment}{*}
00919       \textcolor{keywordflow}{DO} 40 i = 1, len
00920          sd = scomp(i) - strue(i)
00921          \textcolor{keywordflow}{IF} (abs(sfac*sd) .LE. abs(ssize(i))*epsilon(zero))
00922      +       \textcolor{keywordflow}{GO TO} 40
00923 \textcolor{comment}{*}
00924 \textcolor{comment}{*                             HERE    SCOMP(I) IS NOT CLOSE TO STRUE(I).}
00925 \textcolor{comment}{*}
00926          \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
00927 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
00928          pass = .false.
00929          \textcolor{keyword}{WRITE} (nout,99999)
00930          \textcolor{keyword}{WRITE} (nout,99998)
00931    20    \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, i, scomp(i),
00932      +     strue(i), sd, ssize(i)
00933    40 \textcolor{keywordflow}{CONTINUE}
00934       \textcolor{keywordflow}{RETURN}
00935 \textcolor{comment}{*}
00936 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
00937 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY  I                            '},
00938      +       \textcolor{stringliteral}{' COMP(I)                             TRUE(I)  DIFFERENCE'},
00939      +       \textcolor{stringliteral}{'     SIZE(I)'},/1x)
00940 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,2i5,i3,2d36.8,2d12.4)
00941 \textcolor{keyword}{      END}
00942 \textcolor{keyword}{      SUBROUTINE }testdsdot(SCOMP,STRUE,SSIZE,SFAC)
00943 \textcolor{comment}{*     ********************************* STEST **************************}
00944 \textcolor{comment}{*}
00945 \textcolor{comment}{*     THIS SUBR COMPARES ARRAYS  SCOMP() AND STRUE() OF LENGTH LEN TO}
00946 \textcolor{comment}{*     SEE IF THE TERM BY TERM DIFFERENCES, MULTIPLIED BY SFAC, ARE}
00947 \textcolor{comment}{*     NEGLIGIBLE.}
00948 \textcolor{comment}{*}
00949 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00950 \textcolor{comment}{*}
00951 \textcolor{comment}{*     .. Parameters ..}
00952       \textcolor{keywordtype}{INTEGER}          nout
00953       \textcolor{keywordtype}{REAL}             zero
00954       parameter(nout=6, zero=0.0e0)
00955 \textcolor{comment}{*     .. Scalar Arguments ..}
00956       \textcolor{keywordtype}{REAL}             sfac, scomp, ssize, strue
00957 \textcolor{comment}{*     .. Scalars in Common ..}
00958       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00959       \textcolor{keywordtype}{LOGICAL}          pass
00960 \textcolor{comment}{*     .. Local Scalars ..}
00961       \textcolor{keywordtype}{REAL}             sd
00962 \textcolor{comment}{*     .. Intrinsic Functions ..}
00963       \textcolor{keywordtype}{INTRINSIC}        abs
00964 \textcolor{comment}{*     .. Common blocks ..}
00965       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00966 \textcolor{comment}{*     .. Executable Statements ..}
00967 \textcolor{comment}{*}
00968          sd = scomp - strue
00969          \textcolor{keywordflow}{IF} (abs(sfac*sd) .LE. abs(ssize) * epsilon(zero))
00970      +       \textcolor{keywordflow}{GO TO} 40
00971 \textcolor{comment}{*}
00972 \textcolor{comment}{*                             HERE    SCOMP(I) IS NOT CLOSE TO STRUE(I).}
00973 \textcolor{comment}{*}
00974          \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
00975 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
00976          pass = .false.
00977          \textcolor{keyword}{WRITE} (nout,99999)
00978          \textcolor{keyword}{WRITE} (nout,99998)
00979    20    \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, scomp,
00980      +     strue, sd, ssize
00981    40 \textcolor{keywordflow}{CONTINUE}
00982       \textcolor{keywordflow}{RETURN}
00983 \textcolor{comment}{*}
00984 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
00985 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY                           '},
00986      +       \textcolor{stringliteral}{' COMP(I)                             TRUE(I)  DIFFERENCE'},
00987      +       \textcolor{stringliteral}{'     SIZE(I)'},/1x)
00988 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,1i5,i3,2e36.8,2e12.4)
00989 \textcolor{keyword}{      END}
00990 \textcolor{keyword}{      SUBROUTINE }stest1(SCOMP1,STRUE1,SSIZE,SFAC)
00991 \textcolor{comment}{*     ************************* STEST1 *****************************}
00992 \textcolor{comment}{*}
00993 \textcolor{comment}{*     THIS IS AN INTERFACE SUBROUTINE TO ACCOMODATE THE FORTRAN}
00994 \textcolor{comment}{*     REQUIREMENT THAT WHEN A DUMMY ARGUMENT IS AN ARRAY, THE}
00995 \textcolor{comment}{*     ACTUAL ARGUMENT MUST ALSO BE AN ARRAY OR AN ARRAY ELEMENT.}
00996 \textcolor{comment}{*}
00997 \textcolor{comment}{*     C.L. LAWSON, JPL, 1978 DEC 6}
00998 \textcolor{comment}{*}
00999 \textcolor{comment}{*     .. Scalar Arguments ..}
01000       \textcolor{keywordtype}{DOUBLE PRECISION}  scomp1, sfac, strue1
01001 \textcolor{comment}{*     .. Array Arguments ..}
01002       \textcolor{keywordtype}{DOUBLE PRECISION}  ssize(*)
01003 \textcolor{comment}{*     .. Local Arrays ..}
01004       \textcolor{keywordtype}{DOUBLE PRECISION}  scomp(1), strue(1)
01005 \textcolor{comment}{*     .. External Subroutines ..}
01006       \textcolor{keywordtype}{EXTERNAL}          stest
01007 \textcolor{comment}{*     .. Executable Statements ..}
01008 \textcolor{comment}{*}
01009       scomp(1) = scomp1
01010       strue(1) = strue1
01011       \textcolor{keyword}{CALL }stest(1,scomp,strue,ssize,sfac)
01012 \textcolor{comment}{*}
01013       \textcolor{keywordflow}{RETURN}
01014 \textcolor{keyword}{      END}
01015 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }sdiff(SA,SB)
01016 \textcolor{comment}{*     ********************************* SDIFF **************************}
01017 \textcolor{comment}{*     COMPUTES DIFFERENCE OF TWO NUMBERS.  C. L. LAWSON, JPL 1974 FEB 15}
01018 \textcolor{comment}{*}
01019 \textcolor{comment}{*     .. Scalar Arguments ..}
01020       \textcolor{keywordtype}{DOUBLE PRECISION}                sa, sb
01021 \textcolor{comment}{*     .. Executable Statements ..}
01022       sdiff = sa - sb
01023       \textcolor{keywordflow}{RETURN}
01024 \textcolor{keyword}{      END}
01025 \textcolor{keyword}{      SUBROUTINE }itest1(ICOMP,ITRUE)
01026 \textcolor{comment}{*     ********************************* ITEST1 *************************}
01027 \textcolor{comment}{*}
01028 \textcolor{comment}{*     THIS SUBROUTINE COMPARES THE VARIABLES ICOMP AND ITRUE FOR}
01029 \textcolor{comment}{*     EQUALITY.}
01030 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
01031 \textcolor{comment}{*}
01032 \textcolor{comment}{*     .. Parameters ..}
01033       \textcolor{keywordtype}{INTEGER}           nout
01034       parameter(nout=6)
01035 \textcolor{comment}{*     .. Scalar Arguments ..}
01036       \textcolor{keywordtype}{INTEGER}           icomp, itrue
01037 \textcolor{comment}{*     .. Scalars in Common ..}
01038       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
01039       \textcolor{keywordtype}{LOGICAL}           pass
01040 \textcolor{comment}{*     .. Local Scalars ..}
01041       \textcolor{keywordtype}{INTEGER}           id
01042 \textcolor{comment}{*     .. Common blocks ..}
01043       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
01044 \textcolor{comment}{*     .. Executable Statements ..}
01045 \textcolor{comment}{*}
01046       \textcolor{keywordflow}{IF} (icomp.EQ.itrue) \textcolor{keywordflow}{GO TO} 40
01047 \textcolor{comment}{*}
01048 \textcolor{comment}{*                            HERE ICOMP IS NOT EQUAL TO ITRUE.}
01049 \textcolor{comment}{*}
01050       \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
01051 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
01052       pass = .false.
01053       \textcolor{keyword}{WRITE} (nout,99999)
01054       \textcolor{keyword}{WRITE} (nout,99998)
01055    20 id = icomp - itrue
01056       \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, icomp, itrue, id
01057    40 \textcolor{keywordflow}{CONTINUE}
01058       \textcolor{keywordflow}{RETURN}
01059 \textcolor{comment}{*}
01060 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
01061 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY                               '},
01062      +       \textcolor{stringliteral}{' COMP                                TRUE     DIFFERENCE'},
01063      +       /1x)
01064 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,2i5,2i36,i12)
01065 \textcolor{keyword}{      END}
\end{DoxyCode}
