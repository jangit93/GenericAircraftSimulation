\hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source}{}\section{eigen/demos/opengl/gpuhelper.h}
\label{eigen_2demos_2opengl_2gpuhelper_8h_source}\index{gpuhelper.\+h@{gpuhelper.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_GPUHELPER\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_GPUHELPER\_H}
00012 
00013 \textcolor{preprocessor}{#include <Eigen/Geometry>}
00014 \textcolor{preprocessor}{#include <GL/gl.h>}
00015 \textcolor{preprocessor}{#include <vector>}
00016 
00017 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00018 
00019 \textcolor{keyword}{typedef} Vector4f Color;
00020 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00021}\hyperlink{class_gpu_helper}{00021} \textcolor{keyword}{class }\hyperlink{class_gpu_helper}{GpuHelper}
00022 \{
00023   \textcolor{keyword}{public}:
00024 
00025     \hyperlink{class_gpu_helper}{GpuHelper}();
00026 
00027     ~\hyperlink{class_gpu_helper}{GpuHelper}();
00028 
00029     \textcolor{keyword}{enum} ProjectionMode2D \{ PM\_Normalized = 1, PM\_Viewport = 2 \};
00030     \textcolor{keywordtype}{void} pushProjectionMode2D(ProjectionMode2D pm);
00031     \textcolor{keywordtype}{void} popProjectionMode2D();
00032 
00040     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
00041     \textcolor{keywordtype}{void} multMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,4,4, \_Flags, 4,4>}& mat, GLenum 
      matrixTarget);
00042 
00050     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
00051     \textcolor{keywordtype}{void} loadMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<Scalar,4,4, \_Flags, 4,4>}& mat
      , GLenum matrixTarget);
00052 
00053     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Derived>
00054     \textcolor{keywordtype}{void} loadMatrix(
00055         \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_cwise_nullary_op}{Eigen::CwiseNullaryOp}<
      \hyperlink{struct_eigen_1_1internal_1_1scalar__identity__op}{Eigen::internal::scalar\_identity\_op<Scalar>},Derived>&,
00056         GLenum matrixTarget);
00057 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00063}\hyperlink{class_gpu_helper_a52a9ab12d07acbf4ad80737595a9b06e}{00063}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a52a9ab12d07acbf4ad80737595a9b06e}{forceMatrixTarget}(GLenum matrixTarget) \{glMatrixMode(mCurrentMatrixTarget=
      matrixTarget);\}
00064 
00065     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} setMatrixTarget(GLenum matrixTarget);
00066 
00069     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
00070     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pushMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,4,4, \_Flags, 4,4>}& mat, 
      GLenum matrixTarget);
00071 
00072     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Derived>
00073     \textcolor{keywordtype}{void} pushMatrix(
00074         \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_cwise_nullary_op}{Eigen::CwiseNullaryOp}<
      \hyperlink{struct_eigen_1_1internal_1_1scalar__identity__op}{Eigen::internal::scalar\_identity\_op<Scalar>},Derived>&,
00075         GLenum matrixTarget);
00076 
00079     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pushMatrix(GLenum matrixTarget);
00080 
00083     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} popMatrix(GLenum matrixTarget);
00084 
00085     \textcolor{keywordtype}{void} drawVector(\textcolor{keyword}{const} Vector3f& position, \textcolor{keyword}{const} Vector3f& vec, \textcolor{keyword}{const} Color& color, \textcolor{keywordtype}{float} aspect = 50.);
00086     \textcolor{keywordtype}{void} drawVectorBox(\textcolor{keyword}{const} Vector3f& position, \textcolor{keyword}{const} Vector3f& vec, \textcolor{keyword}{const} Color& color, \textcolor{keywordtype}{float} aspect = 50
      .);
00087     \textcolor{keywordtype}{void} drawUnitCube(\textcolor{keywordtype}{void});
00088     \textcolor{keywordtype}{void} drawUnitSphere(\textcolor{keywordtype}{int} level=0);
00089 
00091     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} draw(GLenum mode, uint nofElement);
00092 
00094     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} draw(GLenum mode, uint start, uint end);
00095 
00097     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} draw(GLenum mode, \textcolor{keyword}{const} std::vector<uint>* pIndexes);
00098 
00099 \textcolor{keyword}{protected}:
00100 
00101     \textcolor{keywordtype}{void} update(\textcolor{keywordtype}{void});
00102 
00103     GLuint mColorBufferId;
00104     \textcolor{keywordtype}{int} mVpWidth, mVpHeight;
00105     GLenum mCurrentMatrixTarget;
00106     \textcolor{keywordtype}{bool} mInitialized;
00107 \};
00108 
00111 \textcolor{keyword}{extern} \hyperlink{class_gpu_helper}{GpuHelper} gpu;
00112 
00113 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00116}\hyperlink{struct_gl_matrix_helper}{00116} \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} RowMajor, \textcolor{keywordtype}{int} \_Flags> \textcolor{keyword}{struct }\hyperlink{struct_gl_matrix_helper}{GlMatrixHelper};
00117 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00118}\hyperlink{struct_gl_matrix_helper_3_01false_00_01___flags_01_4}{00118} \textcolor{keyword}{template}<\textcolor{keywordtype}{int} \_Flags> \textcolor{keyword}{struct }\hyperlink{struct_gl_matrix_helper}{GlMatrixHelper}<false,\_Flags>
00119 \{
00120     \textcolor{keyword}{static} \textcolor{keywordtype}{void} loadMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 4,4, \_Flags, 4,4>}&  mat) \{ 
      glLoadMatrixf(mat.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00121     \textcolor{keyword}{static} \textcolor{keywordtype}{void} loadMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<double,4,4, \_Flags, 4,4>}& mat) \{ 
      glLoadMatrixd(mat.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00122     \textcolor{keyword}{static} \textcolor{keywordtype}{void} multMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 4,4, \_Flags, 4,4>}&  mat) \{ 
      glMultMatrixf(mat.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00123     \textcolor{keyword}{static} \textcolor{keywordtype}{void} multMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<double,4,4, \_Flags, 4,4>}& mat) \{ 
      glMultMatrixd(mat.\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00124 \};
00125 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00126}\hyperlink{struct_gl_matrix_helper_3_01true_00_01___flags_01_4}{00126} \textcolor{keyword}{template}<\textcolor{keywordtype}{int} \_Flags> \textcolor{keyword}{struct }\hyperlink{struct_gl_matrix_helper}{GlMatrixHelper}<true,\_Flags>
00127 \{
00128     \textcolor{keyword}{static} \textcolor{keywordtype}{void} loadMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 4,4, \_Flags, 4,4>}&  mat) \{ 
      glLoadMatrixf(mat.transpose().eval().\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00129     \textcolor{keyword}{static} \textcolor{keywordtype}{void} loadMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<double,4,4, \_Flags, 4,4>}& mat) \{ 
      glLoadMatrixd(mat.transpose().eval().\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00130     \textcolor{keyword}{static} \textcolor{keywordtype}{void} multMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 4,4, \_Flags, 4,4>}&  mat) \{ 
      glMultMatrixf(mat.transpose().eval().\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00131     \textcolor{keyword}{static} \textcolor{keywordtype}{void} multMatrix(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<double,4,4, \_Flags, 4,4>}& mat) \{ 
      glMultMatrixd(mat.transpose().eval().\hyperlink{class_eigen_1_1_plain_object_base_ac25699535374b1854cf8494e44ad31b2}{data}()); \}
00132 \};
00133 
00134 \textcolor{keyword}{inline} \textcolor{keywordtype}{void} GpuHelper::setMatrixTarget(GLenum matrixTarget)
00135 \{
00136     \textcolor{keywordflow}{if} (matrixTarget != mCurrentMatrixTarget)
00137         glMatrixMode(mCurrentMatrixTarget=matrixTarget);
00138 \}
00139 
00140 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00141}\hyperlink{class_gpu_helper_a3abb45392e7dcf6450fa94bd345d9096}{00141} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a3abb45392e7dcf6450fa94bd345d9096}{GpuHelper::multMatrix}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,4,4, \_Flags, 4,4>}& mat, GLenum matrixTarget)
00142 \{
00143     setMatrixTarget(matrixTarget);
00144     \hyperlink{struct_gl_matrix_helper}{GlMatrixHelper<\_Flags&Eigen::RowMajorBit, \_Flags>::multMatrix}
      (mat);
00145 \}
00146 
00147 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Derived>
00148 \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a31ac77373dc54409648558d79d5a8c3e}{GpuHelper::loadMatrix}(
00149     \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_cwise_nullary_op}{Eigen::CwiseNullaryOp}<
      \hyperlink{struct_eigen_1_1internal_1_1scalar__identity__op}{Eigen::internal::scalar\_identity\_op<Scalar>},Derived>&,
00150     GLenum matrixTarget)
00151 \{
00152     setMatrixTarget(matrixTarget);
00153     glLoadIdentity();
00154 \}
00155 
00156 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00157}\hyperlink{class_gpu_helper_a31ac77373dc54409648558d79d5a8c3e}{00157} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a31ac77373dc54409648558d79d5a8c3e}{GpuHelper::loadMatrix}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<Scalar,4,4, \_Flags, 4,4>}& mat, GLenum matrixTarget)
00158 \{
00159     setMatrixTarget(matrixTarget);
00160     \hyperlink{struct_gl_matrix_helper}{GlMatrixHelper<(\_Flags&Eigen::RowMajorBit)!=0, \_Flags>::loadMatrix}
      (mat);
00161 \}
00162 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00163}\hyperlink{class_gpu_helper_a515a9248689ca95d90a1919b2e6973ec}{00163} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_ac51c8b669a80ca6e4338c87136fb991e}{GpuHelper::pushMatrix}(GLenum matrixTarget)
00164 \{
00165     setMatrixTarget(matrixTarget);
00166     glPushMatrix();
00167 \}
00168 
00169 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} \_Flags>
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00170}\hyperlink{class_gpu_helper_ac51c8b669a80ca6e4338c87136fb991e}{00170} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_ac51c8b669a80ca6e4338c87136fb991e}{GpuHelper::pushMatrix}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,4,4, \_Flags, 4,4>}& mat, GLenum matrixTarget)
00171 \{
00172     pushMatrix(matrixTarget);
00173     \hyperlink{struct_gl_matrix_helper}{GlMatrixHelper<\_Flags&Eigen::RowMajorBit,\_Flags>::loadMatrix}
      (mat);
00174 \}
00175 
00176 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Derived>
00177 \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_ac51c8b669a80ca6e4338c87136fb991e}{GpuHelper::pushMatrix}(
00178     \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_cwise_nullary_op}{Eigen::CwiseNullaryOp}<
      \hyperlink{struct_eigen_1_1internal_1_1scalar__identity__op}{Eigen::internal::scalar\_identity\_op<Scalar>},Derived>&,
00179     GLenum matrixTarget)
00180 \{
00181     pushMatrix(matrixTarget);
00182     glLoadIdentity();
00183 \}
00184 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00185}\hyperlink{class_gpu_helper_aad0cc23c2eaf0dcc610b180e5c8b195e}{00185} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_aad0cc23c2eaf0dcc610b180e5c8b195e}{GpuHelper::popMatrix}(GLenum matrixTarget)
00186 \{
00187     setMatrixTarget(matrixTarget);
00188     glPopMatrix();
00189 \}
00190 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00191}\hyperlink{class_gpu_helper_a154eb0bf7bf7c764dccb874ce38af766}{00191} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a154eb0bf7bf7c764dccb874ce38af766}{GpuHelper::draw}(GLenum mode, uint nofElement)
00192 \{
00193     glDrawArrays(mode, 0, nofElement);
00194 \}
00195 
00196 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00197}\hyperlink{class_gpu_helper_a2fe175b94cd2566fdf9645067b9dd69e}{00197} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a154eb0bf7bf7c764dccb874ce38af766}{GpuHelper::draw}(GLenum mode, \textcolor{keyword}{const} std::vector<uint>* pIndexes)
00198 \{
00199     glDrawElements(mode, pIndexes->size(), GL\_UNSIGNED\_INT, &(pIndexes->front()));
00200 \}
00201 
\Hypertarget{eigen_2demos_2opengl_2gpuhelper_8h_source_l00202}\hyperlink{class_gpu_helper_a4450191786c5b0533d4bc291d2b6ce19}{00202} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_gpu_helper_a154eb0bf7bf7c764dccb874ce38af766}{GpuHelper::draw}(GLenum mode, uint start, uint end)
00203 \{
00204     glDrawArrays(mode, start, end-start);
00205 \}
00206 
00207 \textcolor{preprocessor}{#endif // EIGEN\_GPUHELPER\_H}
\end{DoxyCode}
