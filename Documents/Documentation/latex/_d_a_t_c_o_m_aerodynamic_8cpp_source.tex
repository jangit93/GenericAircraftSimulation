\hypertarget{_d_a_t_c_o_m_aerodynamic_8cpp_source}{}\section{D\+A\+T\+C\+O\+M\+Aerodynamic.\+cpp}
\label{_d_a_t_c_o_m_aerodynamic_8cpp_source}\index{D\+A\+T\+C\+O\+M\+Aerodynamic.\+cpp@{D\+A\+T\+C\+O\+M\+Aerodynamic.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include "DATCOMAerodynamic.h"}
00002 
\Hypertarget{_d_a_t_c_o_m_aerodynamic_8cpp_source_l00003}\hyperlink{group___aerodynamic_a03d01a72cf389483e03e2bf6cce33299}{00003} \hyperlink{group___aerodynamic_a03d01a72cf389483e03e2bf6cce33299}{DATCOMAerodymamic::DATCOMAerodymamic}()
00004 \{
00005     readIn = \textcolor{keyword}{new} \hyperlink{classread_in_data}{readInData};
00006     logAeroData = \textcolor{keyword}{new} \hyperlink{group___tools_class_data_logger}{DataLogger}(\textcolor{stringliteral}{"AerodynamicData.txt"}, 25, \textcolor{stringliteral}{" "});
00007     
00008 \}
00009 
\Hypertarget{_d_a_t_c_o_m_aerodynamic_8cpp_source_l00010}\hyperlink{group___aerodynamic_a3619e38867cad4b0c8b06a939281a74e}{00010} \hyperlink{group___aerodynamic_a3619e38867cad4b0c8b06a939281a74e}{DATCOMAerodymamic::~DATCOMAerodymamic}()
00011 \{
00012 \}
00013 
\Hypertarget{_d_a_t_c_o_m_aerodynamic_8cpp_source_l00014}\hyperlink{group___aerodynamic_ab2d6d5df8505f3b1f1b8d74be820ca34}{00014} \textcolor{keywordtype}{void} \hyperlink{group___aerodynamic_ab2d6d5df8505f3b1f1b8d74be820ca34}{DATCOMAerodymamic::initAerodynamic}(AerodynamicStruct & AeroData,
00015                                               AircraftStruct & AircraftData)
00016 \{
00017 
00018     \hyperlink{class_mat_file_reader}{MatFileReader} readAeroData(\textcolor{stringliteral}{"../ADM.mat"});
00019     std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_A"}));
00020     readIn->\hyperlink{classread_in_data_ad67d566fd837f6d721db279144d484e0}{setPath}(\textcolor{stringliteral}{"../Input/Aerodynamics/"});
00021 
00022     \textcolor{comment}{//read in tables of derivatives}
00023     CA      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_A"}));\textcolor{comment}{//readIn->readInTable("CL.txt");}
00024     CAeta   = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Aeta"}));\textcolor{comment}{//readIn->readInTable("CLeta.txt");}
00025     CAq     = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Aq"}));\textcolor{comment}{//readIn->readInVector("CLQ.txt");}
00026     CAalpha = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Aalpha"}));
00027              
00028     CW      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_W"}));\textcolor{comment}{//readIn->readInTable("CD.txt");}
00029     CWeta   = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Weta"}));\textcolor{comment}{//readIn->readInTable("CDeta.txt");}
00030         
00031     CQ      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Y"}));
00032     CQp     = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Yp"}));
00033     CQzeta  = std::get<2>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Yzeta"}));
00034 
00035     CM      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_M"}));\textcolor{comment}{//readIn->readInTable("CM.txt");}
00036     CMalpha = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Malpha"}));\textcolor{comment}{//readIn->readInTable("CMA.txt");}
00037     CMeta   = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Meta"}));\textcolor{comment}{//readIn->readInTable("CMeta.txt");}
00038     CMq     = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Mq"}));\textcolor{comment}{//readIn->readInVector("CMq.txt");}
00039               
00040     CN      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_N"}));\textcolor{comment}{//readIn->readInTable("CN.txt");}
00041     CNp     = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Np"}));\textcolor{comment}{//readIn->readInTable("CNP.txt");}
00042     CNr     = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Nr"}));\textcolor{comment}{//readIn->readInTable("CNR.txt");}
00043     CNxi    = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Nxi"}));\textcolor{comment}{//readIn->readInTable("CNxi.txt");}
00044     CNzeta = std::get<2>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Nzeta"}));
00045 
00046     CL      = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_L"}));\textcolor{comment}{//readIn->readInTable("CLmoment.txt");}
00047     CLp     = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Lp"}));\textcolor{comment}{//readIn->readInTable("CLP.txt");}
00048     CLr     = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Lr"})); \textcolor{comment}{//readIn->readInTable("CLR.txt");}
00049     CLxi    = std::get<0>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Lxi"}));\textcolor{comment}{//readIn->readInTable("CLxi.txt");}
00050     CLzeta = std::get<2>(readAeroData.readMatFileData(\textcolor{stringliteral}{"C\_Lzeta"}));
00051 
00052     \textcolor{comment}{//read in Vectors for interpolation}
00053     AoA     = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"AoA"}));\textcolor{comment}{//readIn->readInVector("AoA.txt");}
00054     AoS     = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"AoS"}));\textcolor{comment}{//readIn->readInVector("AoS.txt");}
00055     Mach    = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"Mach"}));\textcolor{comment}{//readIn->readInVector("Ma.txt");}
00056     Xi      = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"Xi"}));\textcolor{comment}{//readIn->readInVector("Xi.txt");}
00057     Eta     = std::get<1>(readAeroData.readMatFileData(\textcolor{stringliteral}{"Eta"}));\textcolor{comment}{//readIn->readInVector("Eta.txt");}
00058 
00059     b = AircraftData.wingspan;
00060     S = AircraftData.wingarea;
00061     l\_nu = AircraftData.MAC;
00062 
00063     initLogAeroData(AeroData);
00064 \}
00065 
\Hypertarget{_d_a_t_c_o_m_aerodynamic_8cpp_source_l00066}\hyperlink{group___aerodynamic_a589f8dbf43ca52f47581ca9caa53af8e}{00066} \textcolor{keywordtype}{void} \hyperlink{group___aerodynamic_a589f8dbf43ca52f47581ca9caa53af8e}{DATCOMAerodymamic::updateAerodynamic}(
      \hyperlink{group___tools_ga3f1431cb9f76da10f59246d1d743dc2c}{Float64} FlightTime,
00067                                         AtmosphereStruct & AtmoData,
00068                                         AerodynamicStruct & AeroData,
00069                                         AirframeStruct & AirframeData,
00070                                         ThrustStruct & ThrustData)
00071 \{
00072     relVelNED = AirframeData.velNED;
00073 
00074      absVel             = sqrt(relVelNED(0)*relVelNED(0)+ relVelNED(1)*relVelNED(1)+ relVelNED(2)*relVelNED
      (2));
00075      rho                = AtmoData.rho;
00076      SpeedOfSound       = AtmoData.speedOfSound;
00077 
00078      Ma                 = absVel / SpeedOfSound;
00079      qbar               = 0.5*rho*absVel*absVel;
00080 
00081 
00082     velBody                 = AirframeData.matNEDToBody*AirframeData.velNED;
00083     AirframeData.velBody    = velBody;
00084     
00085      Alpha  = atan2(velBody(2), velBody(0)) * 180 / PI;
00086      Beta   = atan2(velBody(1), sqrt(velBody(0)*velBody(0)+ velBody(1)*velBody(1)+ velBody(2)*velBody(2))) 
      * 180 / PI;
00087 
00088      ETA    = AirframeData.Eta * 180 / PI;
00089      XI     = AirframeData.Xi * 180 / PI;
00090      ZETA   = AirframeData.Zeta * 180 / PI;
00091      
00092      p = AirframeData.rotRatesBody(0) * b / 2 * absVel;
00093      q = AirframeData.rotRatesBody(1) * l\_nu*absVel;
00094      r = AirframeData.rotRatesBody(2)* b / 2 * absVel;
00095 
00096 
00097     \textcolor{keywordflow}{if} (Ma >= 0.9)
00098     \{
00099         Ma = 0.9;
00100     \}
00101 
00102     c\_a     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CA, Alpha, Ma);
00103     c\_aEta  = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(Eta, Mach, CAeta, ETA, Ma);
00104     c\_w     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CW, Alpha, Ma);
00105     c\_weta  = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(Eta, Mach, CWeta, ETA, Ma);
00106     c\_m     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CM, Alpha, Ma);
00107     c\_meta  = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(Eta, Mach, CMeta, ETA, Ma);
00108     c\_mq    = Interpolation.\hyperlink{class_linear_interpolation_aee1cf48d321cf6708470d9119fbf79e4}{linearInterpolation1D}(Mach, CMq,Ma);
00109     c\_aq    = Interpolation.\hyperlink{class_linear_interpolation_aee1cf48d321cf6708470d9119fbf79e4}{linearInterpolation1D}(Mach, CAq, Ma);
00110 
00111     c\_y     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoS, Mach, CQ, Beta, Ma);
00112     c\_yp    = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CQp, Alpha, Ma);
00113     c\_yzeta = CQzeta;
00114     c\_yxi   = CQzeta;
00115     
00116     c\_l     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoS, Mach, CL, Beta, Ma);
00117     c\_lxi   = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(Xi, Mach, CLxi, XI, Ma);
00118     c\_lp    = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CLp, Alpha, Ma);
00119     c\_lr    = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CLr, Alpha, Ma);
00120     c\_lzeta = CLzeta;
00121 
00122     c\_n     = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoS, Mach, CN, Beta, Ma);
00123     c\_nxi   = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(Xi, Mach, CNxi, XI, Ma);
00124     c\_np    = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CNp, Alpha, Ma);
00125     c\_nr    = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CNr, Alpha, Ma);
00126     c\_nzeta = CNzeta;
00127     
00128     alpha   = Alpha * PI / 180;
00129     beta    = Beta * PI / 180;
00130     eta     = ETA * PI / 180;
00131     xi      = XI * PI / 180;
00132     zeta    = ZETA * PI / 180;
00133 
00134     C\_A = c\_a + c\_aq * q + c\_aEta *eta;
00135 
00136     C\_W = c\_w + c\_weta * eta;
00137 
00138     C\_Q = c\_y + c\_yp*p   + c\_yzeta*zeta + c\_yxi*xi;  \textcolor{comment}{//Fehler in Aeromodell BA!!!!!}
00139 
00140     C\_L = c\_l + c\_lp * p + c\_lr * r + c\_lxi * xi + c\_lzeta * zeta; 
00141 
00142     C\_M = c\_m + c\_mq * q + c\_meta * eta;
00143 
00144     C\_N = c\_n + c\_np * p + c\_nr *r + c\_nxi * xi  + c\_nzeta*zeta;
00145 
00146     C\_X = -C\_W * cos(alpha) * cos(beta) - C\_Q  *cos(alpha) * sin(beta) + C\_A * sin(alpha);
00147     
00148     C\_Y = C\_Q * cos(beta) - C\_W*sin(beta); 
00149 
00150     C\_Z = -C\_W * sin(alpha) * cos(beta) - C\_Q  *sin(alpha) * sin(beta) - C\_A * cos(alpha);
00151 
00152     \textcolor{comment}{// Guidanc daten noch ergänzen}
00153     \hyperlink{group___tools_ga3f1431cb9f76da10f59246d1d743dc2c}{Float64} alpha0 = 0;
00154     ca\_alpha = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CAalpha, Alpha, Ma);
00155     ca\_0 = Interpolation.\hyperlink{class_linear_interpolation_aaf48c1f0fa673ada9b8d6218690161f4}{linearInterpolation2D}(AoA, Mach, CA, alpha0, Ma);
00156     c\_zdalpha = -C\_W - ca\_alpha;
00157 
00158     \textcolor{comment}{// Kräfte und Momente}
00159     AeroData.AeroForces(0) = C\_X * qbar*S;
00160     AeroData.AeroForces(1) = C\_Y * qbar*S;
00161     AeroData.AeroForces(2) = C\_Z * qbar*S;
00162 
00163     AeroData.AeroMoments(0) = C\_L * qbar*S * (b / 2);
00164     AeroData.AeroMoments(1) = C\_M * qbar*S *  l\_nu;
00165     AeroData.AeroMoments(2) = C\_N * qbar*S * (b / 2);
00166     
00167     \textcolor{comment}{// Daten in Struktur}
00168     AeroData.C\_zdalpha = c\_zdalpha;
00169     AeroData.C\_A0 = ca\_0;
00170 
00171     AeroData.CA = C\_A;
00172     AeroData.CW = C\_W;
00173     AeroData.CM = C\_M;
00174     AeroData.CZ = C\_Z;
00175     AeroData.CX = C\_X;
00176     AeroData.AoA = Alpha;
00177     AeroData.AoS = Beta;
00178     AeroData.Mach = Ma;
00179 
00180 
00181 \}
00182 
00183 \textcolor{keywordtype}{void} DATCOMAerodymamic::initLogAeroData(AerodynamicStruct & AeroData)
00184 \{
00185     \textcolor{comment}{/*}
00186 \textcolor{comment}{    logAeroData.add("AoA size", a);}
00187 \textcolor{comment}{    logAeroData.add("Mach size", b);}
00188 \textcolor{comment}{    logAeroData.add("Eta size", c);}
00189 \textcolor{comment}{}
00190 \textcolor{comment}{    logAeroData.add("CA", AeroData.CA);}
00191 \textcolor{comment}{    logAeroData.add("CM", AeroData.CM);}
00192 \textcolor{comment}{    logAeroData.add("CW", AeroData.CW);}
00193 \textcolor{comment}{    logAeroData.add("CZ", AeroData.CZ);}
00194 \textcolor{comment}{    logAeroData.add("CX", AeroData.CX);}
00195 \textcolor{comment}{    logAeroData.add("AoA [Deg]", AeroData.AoA);}
00196 \textcolor{comment}{    logAeroData.add("Mach [-]", AeroData.Mach);}
00197 \textcolor{comment}{    logAeroData.add("Eta [Deg]", AirframeData.Eta);}
00198 \textcolor{comment}{}
00199 \textcolor{comment}{    */}
00200     \textcolor{comment}{//logAeroData->printHeader();}
00201 \}
00202 
00203 \textcolor{keywordtype}{void} DATCOMAerodymamic::LogAeroData()
00204 \{
00205     logAeroData->\hyperlink{group___tools_aa1bd66fc07169787398f386d9276708b}{print}();
00206 \}
00207 
\end{DoxyCode}
