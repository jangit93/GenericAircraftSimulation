\hypertarget{eigen_2test_2meta_8cpp_source}{}\section{eigen/test/meta.cpp}
\label{eigen_2test_2meta_8cpp_source}\index{meta.\+cpp@{meta.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{keyword}{template}<\textcolor{keyword}{typename} From, \textcolor{keyword}{typename} To>
00013 \textcolor{keywordtype}{bool} check\_is\_convertible(\textcolor{keyword}{const} From&, \textcolor{keyword}{const} To&)
00014 \{
00015   \textcolor{keywordflow}{return} internal::is\_convertible<From,To>::value;
00016 \}
00017 
00018 \textcolor{keywordtype}{void} test\_meta()
00019 \{
00020   VERIFY((internal::conditional<(3<4),internal::true\_type, internal::false\_type>::type::value));
00021   VERIFY(( internal::is\_same<float,float>::value));
00022   VERIFY((!internal::is\_same<float,double>::value));
00023   VERIFY((!internal::is\_same<float,float&>::value));
00024   VERIFY((!internal::is\_same<float,const float&>::value));
00025   
00026   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<const float&>::type}
       >::value));
00027   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<const float*>::type}
       >::value));
00028   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<const float*&>::type}
       >::value));
00029   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<float**>::type} >
      ::value));
00030   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<float**&>::type}
       >::value));
00031   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<float* const *&>::type}
       >::value));
00032   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_all<float* const>::type}
       >::value));
00033 
00034   \textcolor{comment}{// test add\_const}
00035   VERIFY(( internal::is\_same< \hyperlink{group___core___module_class_eigen_1_1_transpose}{internal::add\_const<float>::type}, \textcolor{keyword}{const} \textcolor{keywordtype}{float}
       >::value));
00036   VERIFY(( internal::is\_same< \hyperlink{group___core___module_class_eigen_1_1_transpose}{internal::add\_const<float*>::type}, \textcolor{keywordtype}{float}* \textcolor{keyword}{
      const}>::value));
00037   VERIFY(( internal::is\_same< \hyperlink{group___core___module_class_eigen_1_1_transpose}{internal::add\_const<float const*>::type}
      , \textcolor{keywordtype}{float} \textcolor{keyword}{const}* \textcolor{keyword}{const}>::value));
00038   VERIFY(( internal::is\_same< \hyperlink{group___core___module_class_eigen_1_1_transpose}{internal::add\_const<float&>::type}, \textcolor{keywordtype}{float}& >:
      :value));
00039 
00040   \textcolor{comment}{// test remove\_const}
00041   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::remove\_const<float const* const>::type}
      , \textcolor{keywordtype}{float} \textcolor{keyword}{const}* >::value));
00042   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::remove\_const<float const*>::type}
      , \textcolor{keywordtype}{float} \textcolor{keyword}{const}* >::value));
00043   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::remove\_const<float* const>::type}
      , \textcolor{keywordtype}{float}* >::value));
00044 
00045   \textcolor{comment}{// test add\_const\_on\_value\_type}
00046   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<float&>::type}
      , \textcolor{keywordtype}{float} \textcolor{keyword}{const}& >::value));
00047   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<float*>::type}
      , \textcolor{keywordtype}{float} \textcolor{keyword}{const}* >::value));
00048 
00049   VERIFY(( internal::is\_same< \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<float>::type}
      , \textcolor{keyword}{const} \textcolor{keywordtype}{float} >::value));
00050   VERIFY(( internal::is\_same< 
      \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<const float>::type}, \textcolor{keyword}{
      const} \textcolor{keywordtype}{float} >::value));
00051 
00052   VERIFY(( internal::is\_same< 
      \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<const float* const>::type}
      , \textcolor{keyword}{const} \textcolor{keywordtype}{float}* \textcolor{keyword}{const}>::value));
00053   VERIFY(( internal::is\_same< 
      \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<float* const>::type},
       \textcolor{keyword}{const} \textcolor{keywordtype}{float}* \textcolor{keyword}{const}>::value));
00054   
00055   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},\hyperlink{group___sparse_core___module}{internal::remove\_reference<float&>::type}
       >::value));
00056   VERIFY(( internal::is\_same<\textcolor{keyword}{const} \textcolor{keywordtype}{float},
      \hyperlink{group___sparse_core___module}{internal::remove\_reference<const float&>::type} >::value));
00057   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},internal::remove\_pointer<float*>::type >::value));
00058   VERIFY(( internal::is\_same<\textcolor{keyword}{const} \textcolor{keywordtype}{float},internal::remove\_pointer<const float*>::type >::value));
00059   VERIFY(( internal::is\_same<\textcolor{keywordtype}{float},internal::remove\_pointer<float* const >::type >::value));
00060   
00061   VERIFY(( internal::is\_convertible<float,double>::value ));
00062   VERIFY(( internal::is\_convertible<int,double>::value ));
00063   VERIFY(( internal::is\_convertible<double,int>::value ));
00064   VERIFY((!internal::is\_convertible<std::complex<double>,\textcolor{keywordtype}{double}>::value ));
00065   VERIFY(( internal::is\_convertible<Array33f,Matrix3f>::value ));
00066 \textcolor{comment}{//   VERIFY((!internal::is\_convertible<Matrix3f,Matrix3d>::value )); //does not work because the conversion
       is prevented by a static assertion}
00067   VERIFY((!internal::is\_convertible<Array33f,int>::value ));
00068   VERIFY((!internal::is\_convertible<MatrixXf,float>::value ));
00069   \{
00070     \textcolor{keywordtype}{float} f;
00071     MatrixXf \hyperlink{group___core___module_class_eigen_1_1_matrix}{A}, \hyperlink{group___core___module_class_eigen_1_1_matrix}{B};
00072     VectorXf a, b;
00073     VERIFY(( check\_is\_convertible(a.dot(b), f) ));
00074     VERIFY(( check\_is\_convertible(a.transpose()*b, f) ));
00075     VERIFY((!check\_is\_convertible(A*B, f) ));
00076     VERIFY(( check\_is\_convertible(A*B, A) ));
00077   \}
00078   
00079   VERIFY(internal::meta\_sqrt<1>::ret == 1);
00080 \textcolor{preprocessor}{  #define VERIFY\_META\_SQRT(X) VERIFY(internal::meta\_sqrt<X>::ret == int(std::sqrt(double(X))))}
00081   VERIFY\_META\_SQRT(2);
00082   VERIFY\_META\_SQRT(3);
00083   VERIFY\_META\_SQRT(4);
00084   VERIFY\_META\_SQRT(5);
00085   VERIFY\_META\_SQRT(6);
00086   VERIFY\_META\_SQRT(8);
00087   VERIFY\_META\_SQRT(9);
00088   VERIFY\_META\_SQRT(15);
00089   VERIFY\_META\_SQRT(16);
00090   VERIFY\_META\_SQRT(17);
00091   VERIFY\_META\_SQRT(255);
00092   VERIFY\_META\_SQRT(256);
00093   VERIFY\_META\_SQRT(257);
00094   VERIFY\_META\_SQRT(1023);
00095   VERIFY\_META\_SQRT(1024);
00096   VERIFY\_META\_SQRT(1025);
00097 \}
\end{DoxyCode}
