\hypertarget{eigen_2test_2hessenberg_8cpp_source}{}\section{eigen/test/hessenberg.cpp}
\label{eigen_2test_2hessenberg_8cpp_source}\index{hessenberg.\+cpp@{hessenberg.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#include "main.h"}
00012 \textcolor{preprocessor}{#include <Eigen/Eigenvalues>}
00013 
00014 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar,\textcolor{keywordtype}{int} Size> \textcolor{keywordtype}{void} hessenberg(\textcolor{keywordtype}{int} size = Size)
00015 \{
00016   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,Size,Size>} MatrixType;
00017 
00018   \textcolor{comment}{// Test basic functionality: A = U H U* and H is Hessenberg}
00019   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} counter = 0; counter < g\_repeat; ++counter) \{
00020     MatrixType m = MatrixType::Random(size,size);
00021     \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>} hess(m);
00022     MatrixType Q = hess.matrixQ();
00023     MatrixType H = hess.matrixH();
00024     VERIFY\_IS\_APPROX(m, Q * H * Q.adjoint());
00025     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} row = 2; row < size; ++row) \{
00026       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} col = 0; col < row-1; ++col) \{
00027     VERIFY(H(row,col) == (\textcolor{keyword}{typename} MatrixType::Scalar)0);
00028       \}
00029     \}
00030   \}
00031 
00032   \textcolor{comment}{// Test whether compute() and constructor returns same result}
00033   MatrixType \hyperlink{group___core___module_class_eigen_1_1_matrix}{A} = MatrixType::Random(size, size);
00034   \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>} cs1;
00035   cs1.\hyperlink{group___eigenvalues___module_a239a6fd42c57aab3c0b048c47fde3004}{compute}(A);
00036   \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>} cs2(A);
00037   VERIFY\_IS\_EQUAL(cs1.\hyperlink{group___eigenvalues___module_a8e781d2e22a2304647bcf0ae913cc8ea}{matrixH}().eval(), cs2.matrixH().eval());
00038   MatrixType cs1Q = cs1.\hyperlink{group___eigenvalues___module_a346441e4902a58d43d698ac3da6ff791}{matrixQ}();
00039   MatrixType cs2Q = cs2.matrixQ();  
00040   VERIFY\_IS\_EQUAL(cs1Q, cs2Q);
00041 
00042   \textcolor{comment}{// Test assertions for when used uninitialized}
00043   \hyperlink{group___eigenvalues___module}{HessenbergDecomposition<MatrixType>} hessUninitialized;
00044   VERIFY\_RAISES\_ASSERT( hessUninitialized.\hyperlink{group___eigenvalues___module_a8e781d2e22a2304647bcf0ae913cc8ea}{matrixH}() );
00045   VERIFY\_RAISES\_ASSERT( hessUninitialized.\hyperlink{group___eigenvalues___module_a346441e4902a58d43d698ac3da6ff791}{matrixQ}() );
00046   VERIFY\_RAISES\_ASSERT( hessUninitialized.\hyperlink{group___eigenvalues___module_a65fa81ce79d956baa59a30a6d82f8a84}{householderCoefficients}() );
00047   VERIFY\_RAISES\_ASSERT( hessUninitialized.\hyperlink{group___eigenvalues___module_a1f72b7612fd4edc5a6f31005e433e1dd}{packedMatrix}() );
00048 
00049   \textcolor{comment}{// TODO: Add tests for packedMatrix() and householderCoefficients()}
00050 \}
00051 
00052 \textcolor{keywordtype}{void} test\_hessenberg()
00053 \{
00054   CALL\_SUBTEST\_1(( hessenberg<std::complex<double>,1>() ));
00055   CALL\_SUBTEST\_2(( hessenberg<std::complex<double>,2>() ));
00056   CALL\_SUBTEST\_3(( hessenberg<std::complex<float>,4>() ));
00057   CALL\_SUBTEST\_4(( hessenberg<float,Dynamic>(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE)) ));
00058   CALL\_SUBTEST\_5(( hessenberg<std::complex<double>,Dynamic>(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE)) )
      );
00059 
00060   \textcolor{comment}{// Test problem size constructors}
00061   CALL\_SUBTEST\_6(\hyperlink{group___eigenvalues___module_class_eigen_1_1_hessenberg_decomposition}{HessenbergDecomposition<MatrixXf>}(10));
00062 \}
\end{DoxyCode}
