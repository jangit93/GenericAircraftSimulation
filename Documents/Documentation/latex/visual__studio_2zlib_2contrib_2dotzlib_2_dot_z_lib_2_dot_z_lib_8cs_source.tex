\hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source}{}\section{visual\+\_\+studio/zlib/contrib/dotzlib/\+Dot\+Z\+Lib/\+Dot\+Z\+Lib.cs}
\label{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source}\index{Dot\+Z\+Lib.\+cs@{Dot\+Z\+Lib.\+cs}}

\begin{DoxyCode}
00001 \textcolor{comment}{//}
00002 \textcolor{comment}{// © Copyright Henrik Ravn 2004}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Use, modification and distribution are subject to the Boost Software License, Version 1.0.}
00005 \textcolor{comment}{// (See accompanying file LICENSE\_1\_0.txt or copy at http://www.boost.org/LICENSE\_1\_0.txt)}
00006 \textcolor{comment}{//}
00007 
00008 \textcolor{keyword}{using} \hyperlink{namespace_system}{System};
00009 \textcolor{keyword}{using} \hyperlink{namespace_system}{System}.IO;
00010 \textcolor{keyword}{using} \hyperlink{namespace_system}{System}.Runtime.InteropServices;
00011 \textcolor{keyword}{using} \hyperlink{namespace_system}{System}.Text;
00012 
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_dot_z_lib}{DotZLib}
00015 \{
00016 
00017 \textcolor{preprocessor}{    #region Internal types}
00018 
00022     \textcolor{keyword}{internal} \textcolor{keyword}{enum} FlushTypes
00023     \{
00024         None,  Partial,  Sync,  Full,  Finish,  Block
00025     \}
00026 
00027 \textcolor{preprocessor}{    #region ZStream structure}
00028     \textcolor{comment}{// internal mapping of the zlib zstream structure for marshalling}
00029     [StructLayoutAttribute(LayoutKind.Sequential, Pack=4, Size=0, CharSet=CharSet.Ansi)]
00030     \textcolor{keyword}{internal} \textcolor{keyword}{struct }ZStream
00031     \{
00032         \textcolor{keyword}{public} IntPtr next\_in;
00033         \textcolor{keyword}{public} uint avail\_in;
00034         \textcolor{keyword}{public} uint total\_in;
00035 
00036         \textcolor{keyword}{public} IntPtr next\_out;
00037         \textcolor{keyword}{public} uint avail\_out;
00038         \textcolor{keyword}{public} uint total\_out;
00039 
00040         [MarshalAs(UnmanagedType.LPStr)]
00041         \textcolor{keywordtype}{string} msg;
00042         uint \hyperlink{structstate}{state};
00043 
00044         uint zalloc;
00045         uint zfree;
00046         uint opaque;
00047 
00048         \textcolor{keywordtype}{int} data\_type;
00049         \textcolor{keyword}{public} uint adler;
00050         uint reserved;
00051     \}
00052 
00053 \textcolor{preprocessor}{    #endregion}
00054 
00055 \textcolor{preprocessor}{    #endregion}
00056 
00057 \textcolor{preprocessor}{    #region Public enums}
00058     \textcolor{keyword}{public} \textcolor{keyword}{enum} \hyperlink{namespace_dot_z_lib_a034f7a1ef9856d8834e6f6b1c53d8a4c}{CompressLevel} : \textcolor{keywordtype}{int}
00062     \{
00066         \hyperlink{namespace_dot_z_lib_a034f7a1ef9856d8834e6f6b1c53d8a4ca7a1920d61156abc05a60135aefe8bc67}{Default} = -1,
00070         None = 0,
00074         \hyperlink{namespace_dot_z_lib_a034f7a1ef9856d8834e6f6b1c53d8a4ca68ef004de6166492c1d668eb8efe09bd}{Best} = 9,
00078         \hyperlink{namespace_dot_z_lib_a034f7a1ef9856d8834e6f6b1c53d8a4ca90fd7fdf6f41406a75e5265b9583bb4e}{Fastest} = 1
00079     \}
00080 \textcolor{preprocessor}{    #endregion}
00081 
00082 \textcolor{preprocessor}{    #region Exception classes}
00083     \textcolor{keyword}{public} \textcolor{keyword}{class }ZLibException : ApplicationException
00087     \{
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00094}\hyperlink{class_dot_z_lib_1_1_z_lib_exception_a6a413e419130b98ef8a443a74b2f8ded}{00094}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_z_lib_exception_a6a413e419130b98ef8a443a74b2f8ded}{ZLibException}(\textcolor{keywordtype}{int} errorCode, \textcolor{keywordtype}{string} msg) : base(String.Format(\textcolor{stringliteral}{"ZLib error \{0\}
       \{1\}"}, errorCode, msg))
00095         \{
00096         \}
00097 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00103}\hyperlink{class_dot_z_lib_1_1_z_lib_exception_af8dd9c725ef7bd7b2d2042e827ce9fb7}{00103}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_z_lib_exception_af8dd9c725ef7bd7b2d2042e827ce9fb7}{ZLibException}(\textcolor{keywordtype}{int} errorCode) : base(String.Format(\textcolor{stringliteral}{"ZLib error \{0\}"}, errorCode))
00104         \{
00105         \}
00106     \}
00107 \textcolor{preprocessor}{    #endregion}
00108 
00109 \textcolor{preprocessor}{    #region Interfaces}
00110 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00114}\hyperlink{interface_dot_z_lib_1_1_checksum_generator}{00114}     \textcolor{keyword}{public} \textcolor{keyword}{interface }\hyperlink{interface_dot_z_lib_1_1_checksum_generator}{ChecksumGenerator}
00115     \{
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00119}\hyperlink{interface_dot_z_lib_1_1_checksum_generator_a9da6eca33adb6bfe5dfc260797e07f49}{00119}         uint Value \{ \textcolor{keyword}{get}; \}
00120 
00124         \textcolor{keywordtype}{void} Reset();
00125 
00130         \textcolor{keywordtype}{void} Update(byte[] data);
00131 
00141         \textcolor{keywordtype}{void} Update(byte[] data, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} count);
00142 
00148         \textcolor{keywordtype}{void} Update(\textcolor{keywordtype}{string} data);
00149 
00155         \textcolor{keywordtype}{void} Update(\textcolor{keywordtype}{string} data, Encoding encoding);
00156     \}
00157 
00158 
00169     \textcolor{keyword}{public} delegate \textcolor{keywordtype}{void} \hyperlink{namespace_dot_z_lib_a13a751b897fc2af0be2307e4deb7eb1c}{DataAvailableHandler}(byte[] data, \textcolor{keywordtype}{int} startIndex, \textcolor{keywordtype}{int} count);
00170 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00174}\hyperlink{interface_dot_z_lib_1_1_codec}{00174}     \textcolor{keyword}{public} \textcolor{keyword}{interface }\hyperlink{interface_dot_z_lib_1_1_codec}{Codec}
00175     \{
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00179}\hyperlink{interface_dot_z_lib_1_1_codec_a402ac1b984b22dc3ddae49f7e9e3cc33}{00179}         \textcolor{keyword}{event} DataAvailableHandler \hyperlink{interface_dot_z_lib_1_1_codec_a402ac1b984b22dc3ddae49f7e9e3cc33}{DataAvailable};
00180 
00186         \textcolor{keywordtype}{void} Add(byte[] data);
00187 
00195         \textcolor{keywordtype}{void} Add(byte[] data, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} count);
00196 
00200         \textcolor{keywordtype}{void} Finish();
00201 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00205}\hyperlink{interface_dot_z_lib_1_1_codec_ab5bdf7dd00f261c89c05a59a9cd7604b}{00205}         uint Checksum \{ \textcolor{keyword}{get}; \}
00206 
00207 
00208     \}
00209 
00210 \textcolor{preprocessor}{    #endregion}
00211 
00212 \textcolor{preprocessor}{    #region Classes}
00213     \textcolor{keyword}{public} \textcolor{keyword}{class }\hyperlink{class_dot_z_lib_1_1_info}{Info}
00217     \{
00218 \textcolor{preprocessor}{        #region DLL imports}
00219         [DllImport(\textcolor{stringliteral}{"ZLIB1.dll"}, CallingConvention=CallingConvention.Cdecl)]
00220         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} uint zlibCompileFlags();
00221 
00222         [DllImport(\textcolor{stringliteral}{"ZLIB1.dll"}, CallingConvention=CallingConvention.Cdecl)]
00223         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} \textcolor{keywordtype}{string} zlibVersion();
00224 \textcolor{preprocessor}{        #endregion}
00225 
00226 \textcolor{preprocessor}{        #region Private stuff}
00227         \textcolor{keyword}{private} uint \_flags;
00228 
00229         \textcolor{comment}{// helper function that unpacks a bitsize mask}
00230         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keywordtype}{int} bitSize(uint bits)
00231         \{
00232             \textcolor{keywordflow}{switch} (bits)
00233             \{
00234                 \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{return} 16;
00235                 \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{return} 32;
00236                 \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{return} 64;
00237             \}
00238             \textcolor{keywordflow}{return} -1;
00239         \}
00240 \textcolor{preprocessor}{        #endregion}
00241 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00245}\hyperlink{class_dot_z_lib_1_1_info_a48b690fe56ca7cc8e8a40a740476696b}{00245}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_info_a48b690fe56ca7cc8e8a40a740476696b}{Info}()
00246         \{
00247             \_flags = zlibCompileFlags();
00248         \}
00249 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00253}\hyperlink{class_dot_z_lib_1_1_info_ad37fbab0ca0a3b8219d9c59ad7964255}{00253}         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} HasDebugInfo \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} 0 != (\_flags & 0x100); \} \}
00254 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00258}\hyperlink{class_dot_z_lib_1_1_info_a7fa48f081aa54199a54e4c00681c4040}{00258}         \textcolor{keyword}{public} \textcolor{keywordtype}{bool} UsesAssemblyCode \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} 0 != (\_flags & 0x200); \} \}
00259 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00263}\hyperlink{class_dot_z_lib_1_1_info_aea3a993ab00cb3b89aa4c3efc3b3adcb}{00263}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} SizeOfUInt \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} bitSize(\_flags & 3); \} \}
00264 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00268}\hyperlink{class_dot_z_lib_1_1_info_a0a6d4a4c79e2b30388a5161f31d9a9ad}{00268}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} SizeOfULong \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} bitSize((\_flags >> 2) & 3); \} \}
00269 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00273}\hyperlink{class_dot_z_lib_1_1_info_a18ba70edb75d11f7a09d4ae4742f3c2f}{00273}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} SizeOfPointer \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} bitSize((\_flags >> 4) & 3); \} \}
00274 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00278}\hyperlink{class_dot_z_lib_1_1_info_ad1ea695cbf9012e1b458f0a754dcfe7f}{00278}         \textcolor{keyword}{public} \textcolor{keywordtype}{int} SizeOfOffset \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} bitSize((\_flags >> 6) & 3); \} \}
00279 
\Hypertarget{visual__studio_2zlib_2contrib_2dotzlib_2_dot_z_lib_2_dot_z_lib_8cs_source_l00283}\hyperlink{class_dot_z_lib_1_1_info_a55b101b2c131860775880231fdf5fbd7}{00283}         \textcolor{keyword}{public} \textcolor{keyword}{static} \textcolor{keywordtype}{string} Version \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} zlibVersion(); \} \}
00284     \}
00285 
00286 \textcolor{preprocessor}{    #endregion}
00287 
00288 \}
\end{DoxyCode}
