\hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source}{}\section{eigen/\+Eigen/src/\+Core/arch/\+A\+V\+X512/\+Packet\+Math.h}
\label{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source}\index{Packet\+Math.\+h@{Packet\+Math.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2016 Benoit Steiner (benoit.steiner.goog@gmail.com)}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_PACKET\_MATH\_AVX512\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_PACKET\_MATH\_AVX512\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00017 \textcolor{preprocessor}{#ifndef EIGEN\_CACHEFRIENDLY\_PRODUCT\_THRESHOLD}
00018 \textcolor{preprocessor}{#define EIGEN\_CACHEFRIENDLY\_PRODUCT\_THRESHOLD 8}
00019 \textcolor{preprocessor}{#endif}
00020 
00021 \textcolor{preprocessor}{#ifndef EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS}
00022 \textcolor{preprocessor}{#define EIGEN\_ARCH\_DEFAULT\_NUMBER\_OF\_REGISTERS (2*sizeof(void*))}
00023 \textcolor{preprocessor}{#endif}
00024 
00025 \textcolor{preprocessor}{#ifdef \_\_FMA\_\_}
00026 \textcolor{preprocessor}{#ifndef EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD}
00027 \textcolor{preprocessor}{#define EIGEN\_HAS\_SINGLE\_INSTRUCTION\_MADD}
00028 \textcolor{preprocessor}{#endif}
00029 \textcolor{preprocessor}{#endif}
00030 
00031 \textcolor{keyword}{typedef} \_\_m512 Packet16f;
00032 \textcolor{keyword}{typedef} \_\_m512i Packet16i;
00033 \textcolor{keyword}{typedef} \_\_m512d Packet8d;
00034 
00035 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00036}\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic_3_01____m512_01_4}{00036} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic}{is\_arithmetic}<\_\_m512> \{
00037   \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \};
00038 \};
00039 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00040}\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic_3_01____m512i_01_4}{00040} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic}{is\_arithmetic}<\_\_m512i> \{
00041   \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \};
00042 \};
00043 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00044}\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic_3_01____m512d_01_4}{00044} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1is__arithmetic}{is\_arithmetic}<\_\_m512d> \{
00045   \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \};
00046 \};
00047 
00048 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1packet__traits}{packet\_traits}<float>  : \hyperlink{struct_eigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}
00049 \{
00050   \textcolor{keyword}{typedef} Packet16f type;
00051   \textcolor{keyword}{typedef} Packet8f \hyperlink{struct_eigen_1_1half}{half};
00052   \textcolor{keyword}{enum} \{
00053     Vectorizable = 1,
00054     AlignedOnScalar = 1,
00055     size = 16,
00056     HasHalfPacket = 1,
00057 \textcolor{preprocessor}{#if EIGEN\_GNUC\_AT\_LEAST(5, 3)}
00058 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00059     HasLog = 1,
00060 \textcolor{preprocessor}{#endif}
00061     HasExp = 1,
00062     HasSqrt = 1,
00063     HasRsqrt = 1,
00064 \textcolor{preprocessor}{#endif}
00065     HasDiv = 1
00066   \};
00067  \};
00068 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1packet__traits}{packet\_traits}<double> : \hyperlink{struct_eigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}
00069 \{
00070   \textcolor{keyword}{typedef} Packet8d type;
00071   \textcolor{keyword}{typedef} Packet4d \hyperlink{struct_eigen_1_1half}{half};
00072   \textcolor{keyword}{enum} \{
00073     Vectorizable = 1,
00074     AlignedOnScalar = 1,
00075     size = 8,
00076     HasHalfPacket = 1,
00077 \textcolor{preprocessor}{#if EIGEN\_GNUC\_AT\_LEAST(5, 3)}
00078     HasSqrt = 1,
00079     HasRsqrt = EIGEN\_FAST\_MATH,
00080 \textcolor{preprocessor}{#endif}
00081     HasDiv = 1
00082   \};
00083 \};
00084 
00085 \textcolor{comment}{/* TODO Implement AVX512 for integers}
00086 \textcolor{comment}{template<> struct packet\_traits<int>    : default\_packet\_traits}
00087 \textcolor{comment}{\{}
00088 \textcolor{comment}{  typedef Packet16i type;}
00089 \textcolor{comment}{  enum \{}
00090 \textcolor{comment}{    Vectorizable = 1,}
00091 \textcolor{comment}{    AlignedOnScalar = 1,}
00092 \textcolor{comment}{    size=8}
00093 \textcolor{comment}{  \};}
00094 \textcolor{comment}{\};}
00095 \textcolor{comment}{*/}
00096 
00097 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00098}\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_3_01_packet16f_01_4}{00098} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}<Packet16f> \{
00099   \textcolor{keyword}{typedef} \textcolor{keywordtype}{float} type;
00100   \textcolor{keyword}{typedef} Packet8f half;
00101   \textcolor{keyword}{enum} \{ size = 16, alignment=\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a0f4f4451618a2e67cade6b54ca0fc84b}{Aligned64} \};
00102 \};
00103 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00104}\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_3_01_packet8d_01_4}{00104} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}<Packet8d> \{
00105   \textcolor{keyword}{typedef} \textcolor{keywordtype}{double} type;
00106   \textcolor{keyword}{typedef} Packet4d half;
00107   \textcolor{keyword}{enum} \{ size = 8, alignment=\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a0f4f4451618a2e67cade6b54ca0fc84b}{Aligned64} \};
00108 \};
00109 \textcolor{keyword}{template} <>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00110}\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_3_01_packet16i_01_4}{00110} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}<Packet16i> \{
00111   \textcolor{keyword}{typedef} \textcolor{keywordtype}{int} type;
00112   \textcolor{keyword}{typedef} Packet8i half;
00113   \textcolor{keyword}{enum} \{ size = 16, alignment=\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a0f4f4451618a2e67cade6b54ca0fc84b}{Aligned64} \};
00114 \};
00115 
00116 \textcolor{keyword}{template} <>
00117 EIGEN\_STRONG\_INLINE Packet16f pset1<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}& from) \{
00118   \textcolor{keywordflow}{return} \_mm512\_set1\_ps(from);
00119 \}
00120 \textcolor{keyword}{template} <>
00121 EIGEN\_STRONG\_INLINE Packet8d pset1<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}& from) \{
00122   \textcolor{keywordflow}{return} \_mm512\_set1\_pd(from);
00123 \}
00124 \textcolor{keyword}{template} <>
00125 EIGEN\_STRONG\_INLINE Packet16i pset1<Packet16i>(\textcolor{keyword}{const} \textcolor{keywordtype}{int}& from) \{
00126   \textcolor{keywordflow}{return} \_mm512\_set1\_epi32(from);
00127 \}
00128 
00129 \textcolor{keyword}{template} <>
00130 EIGEN\_STRONG\_INLINE Packet16f pload1<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00131   \textcolor{keywordflow}{return} \_mm512\_broadcastss\_ps(\_mm\_load\_ps1(from));
00132 \}
00133 \textcolor{keyword}{template} <>
00134 EIGEN\_STRONG\_INLINE Packet8d pload1<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00135   \textcolor{keywordflow}{return} \_mm512\_broadcastsd\_pd(\_mm\_load\_pd1(from));
00136 \}
00137 
00138 \textcolor{keyword}{template} <>
00139 EIGEN\_STRONG\_INLINE Packet16f plset<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}& a) \{
00140   \textcolor{keywordflow}{return} \_mm512\_add\_ps(
00141       \_mm512\_set1\_ps(a),
00142       \_mm512\_set\_ps(15.0f, 14.0f, 13.0f, 12.0f, 11.0f, 10.0f, 9.0f, 8.0f, 7.0f, 6.0f, 5.0f,
00143                     4.0f, 3.0f, 2.0f, 1.0f, 0.0f));
00144 \}
00145 \textcolor{keyword}{template} <>
00146 EIGEN\_STRONG\_INLINE Packet8d plset<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}& a) \{
00147   \textcolor{keywordflow}{return} \_mm512\_add\_pd(\_mm512\_set1\_pd(a),
00148                        \_mm512\_set\_pd(7.0, 6.0, 5.0, 4.0, 3.0, 2.0, 1.0, 0.0));
00149 \}
00150 
00151 \textcolor{keyword}{template} <>
00152 EIGEN\_STRONG\_INLINE Packet16f padd<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00153                                               \textcolor{keyword}{const} Packet16f& b) \{
00154   \textcolor{keywordflow}{return} \_mm512\_add\_ps(a, b);
00155 \}
00156 \textcolor{keyword}{template} <>
00157 EIGEN\_STRONG\_INLINE Packet8d padd<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00158                                             \textcolor{keyword}{const} Packet8d& b) \{
00159   \textcolor{keywordflow}{return} \_mm512\_add\_pd(a, b);
00160 \}
00161 
00162 \textcolor{keyword}{template} <>
00163 EIGEN\_STRONG\_INLINE Packet16f psub<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00164                                               \textcolor{keyword}{const} Packet16f& b) \{
00165   \textcolor{keywordflow}{return} \_mm512\_sub\_ps(a, b);
00166 \}
00167 \textcolor{keyword}{template} <>
00168 EIGEN\_STRONG\_INLINE Packet8d psub<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00169                                             \textcolor{keyword}{const} Packet8d& b) \{
00170   \textcolor{keywordflow}{return} \_mm512\_sub\_pd(a, b);
00171 \}
00172 
00173 \textcolor{keyword}{template} <>
00174 EIGEN\_STRONG\_INLINE Packet16f pnegate(\textcolor{keyword}{const} Packet16f& a) \{
00175   \textcolor{keywordflow}{return} \_mm512\_sub\_ps(\_mm512\_set1\_ps(0.0), a);
00176 \}
00177 \textcolor{keyword}{template} <>
00178 EIGEN\_STRONG\_INLINE Packet8d pnegate(\textcolor{keyword}{const} Packet8d& a) \{
00179   \textcolor{keywordflow}{return} \_mm512\_sub\_pd(\_mm512\_set1\_pd(0.0), a);
00180 \}
00181 
00182 \textcolor{keyword}{template} <>
00183 EIGEN\_STRONG\_INLINE Packet16f pconj(\textcolor{keyword}{const} Packet16f& a) \{
00184   \textcolor{keywordflow}{return} a;
00185 \}
00186 \textcolor{keyword}{template} <>
00187 EIGEN\_STRONG\_INLINE Packet8d pconj(\textcolor{keyword}{const} Packet8d& a) \{
00188   \textcolor{keywordflow}{return} a;
00189 \}
00190 \textcolor{keyword}{template} <>
00191 EIGEN\_STRONG\_INLINE Packet16i pconj(\textcolor{keyword}{const} Packet16i& a) \{
00192   \textcolor{keywordflow}{return} a;
00193 \}
00194 
00195 \textcolor{keyword}{template} <>
00196 EIGEN\_STRONG\_INLINE Packet16f pmul<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00197                                               \textcolor{keyword}{const} Packet16f& b) \{
00198   \textcolor{keywordflow}{return} \_mm512\_mul\_ps(a, b);
00199 \}
00200 \textcolor{keyword}{template} <>
00201 EIGEN\_STRONG\_INLINE Packet8d pmul<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00202                                             \textcolor{keyword}{const} Packet8d& b) \{
00203   \textcolor{keywordflow}{return} \_mm512\_mul\_pd(a, b);
00204 \}
00205 
00206 \textcolor{keyword}{template} <>
00207 EIGEN\_STRONG\_INLINE Packet16f pdiv<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00208                                               \textcolor{keyword}{const} Packet16f& b) \{
00209   \textcolor{keywordflow}{return} \_mm512\_div\_ps(a, b);
00210 \}
00211 \textcolor{keyword}{template} <>
00212 EIGEN\_STRONG\_INLINE Packet8d pdiv<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00213                                             \textcolor{keyword}{const} Packet8d& b) \{
00214   \textcolor{keywordflow}{return} \_mm512\_div\_pd(a, b);
00215 \}
00216 
00217 \textcolor{preprocessor}{#ifdef \_\_FMA\_\_}
00218 \textcolor{keyword}{template} <>
00219 EIGEN\_STRONG\_INLINE Packet16f pmadd(\textcolor{keyword}{const} Packet16f& a, \textcolor{keyword}{const} Packet16f& b,
00220                                     \textcolor{keyword}{const} Packet16f& c) \{
00221   \textcolor{keywordflow}{return} \_mm512\_fmadd\_ps(a, b, c);
00222 \}
00223 \textcolor{keyword}{template} <>
00224 EIGEN\_STRONG\_INLINE Packet8d pmadd(\textcolor{keyword}{const} Packet8d& a, \textcolor{keyword}{const} Packet8d& b,
00225                                    \textcolor{keyword}{const} Packet8d& c) \{
00226   \textcolor{keywordflow}{return} \_mm512\_fmadd\_pd(a, b, c);
00227 \}
00228 \textcolor{preprocessor}{#endif}
00229 
00230 \textcolor{keyword}{template} <>
00231 EIGEN\_STRONG\_INLINE Packet16f pmin<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00232                                               \textcolor{keyword}{const} Packet16f& b) \{
00233   \textcolor{keywordflow}{return} \_mm512\_min\_ps(a, b);
00234 \}
00235 \textcolor{keyword}{template} <>
00236 EIGEN\_STRONG\_INLINE Packet8d pmin<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00237                                             \textcolor{keyword}{const} Packet8d& b) \{
00238   \textcolor{keywordflow}{return} \_mm512\_min\_pd(a, b);
00239 \}
00240 
00241 \textcolor{keyword}{template} <>
00242 EIGEN\_STRONG\_INLINE Packet16f pmax<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00243                                               \textcolor{keyword}{const} Packet16f& b) \{
00244   \textcolor{keywordflow}{return} \_mm512\_max\_ps(a, b);
00245 \}
00246 \textcolor{keyword}{template} <>
00247 EIGEN\_STRONG\_INLINE Packet8d pmax<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00248                                             \textcolor{keyword}{const} Packet8d& b) \{
00249   \textcolor{keywordflow}{return} \_mm512\_max\_pd(a, b);
00250 \}
00251 
00252 \textcolor{keyword}{template} <>
00253 EIGEN\_STRONG\_INLINE Packet16f pand<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00254                                               \textcolor{keyword}{const} Packet16f& b) \{
00255 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00256   \textcolor{keywordflow}{return} \_mm512\_and\_ps(a, b);
00257 \textcolor{preprocessor}{#else}
00258   Packet16f res = \_mm512\_undefined\_ps();
00259   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_a = \_mm512\_extractf32x4\_ps(a, 0);
00260   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_b = \_mm512\_extractf32x4\_ps(b, 0);
00261   res = \_mm512\_insertf32x4(res, \_mm\_and\_ps(lane0\_a, lane0\_b), 0);
00262 
00263   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_a = \_mm512\_extractf32x4\_ps(a, 1);
00264   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_b = \_mm512\_extractf32x4\_ps(b, 1);
00265   res = \_mm512\_insertf32x4(res, \_mm\_and\_ps(lane1\_a, lane1\_b), 1);
00266 
00267   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_a = \_mm512\_extractf32x4\_ps(a, 2);
00268   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_b = \_mm512\_extractf32x4\_ps(b, 2);
00269   res = \_mm512\_insertf32x4(res, \_mm\_and\_ps(lane2\_a, lane2\_b), 2);
00270 
00271   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_a = \_mm512\_extractf32x4\_ps(a, 3);
00272   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_b = \_mm512\_extractf32x4\_ps(b, 3);
00273   res = \_mm512\_insertf32x4(res, \_mm\_and\_ps(lane3\_a, lane3\_b), 3);
00274 
00275   \textcolor{keywordflow}{return} res;
00276 \textcolor{preprocessor}{#endif}
00277 \}
00278 \textcolor{keyword}{template} <>
00279 EIGEN\_STRONG\_INLINE Packet8d pand<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00280                                             \textcolor{keyword}{const} Packet8d& b) \{
00281 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00282   \textcolor{keywordflow}{return} \_mm512\_and\_pd(a, b);
00283 \textcolor{preprocessor}{#else}
00284   Packet8d res = \_mm512\_undefined\_pd();
00285   Packet4d lane0\_a = \_mm512\_extractf64x4\_pd(a, 0);
00286   Packet4d lane0\_b = \_mm512\_extractf64x4\_pd(b, 0);
00287   res = \_mm512\_insertf64x4(res, \_mm256\_and\_pd(lane0\_a, lane0\_b), 0);
00288 
00289   Packet4d lane1\_a = \_mm512\_extractf64x4\_pd(a, 1);
00290   Packet4d lane1\_b = \_mm512\_extractf64x4\_pd(b, 1);
00291   res = \_mm512\_insertf64x4(res, \_mm256\_and\_pd(lane1\_a, lane1\_b), 1);
00292 
00293   \textcolor{keywordflow}{return} res;
00294 \textcolor{preprocessor}{#endif}
00295 \}
00296 \textcolor{keyword}{template} <>
00297 EIGEN\_STRONG\_INLINE Packet16f por<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00298                                              \textcolor{keyword}{const} Packet16f& b) \{
00299 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00300   \textcolor{keywordflow}{return} \_mm512\_or\_ps(a, b);
00301 \textcolor{preprocessor}{#else}
00302   Packet16f res = \_mm512\_undefined\_ps();
00303   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_a = \_mm512\_extractf32x4\_ps(a, 0);
00304   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_b = \_mm512\_extractf32x4\_ps(b, 0);
00305   res = \_mm512\_insertf32x4(res, \_mm\_or\_ps(lane0\_a, lane0\_b), 0);
00306 
00307   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_a = \_mm512\_extractf32x4\_ps(a, 1);
00308   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_b = \_mm512\_extractf32x4\_ps(b, 1);
00309   res = \_mm512\_insertf32x4(res, \_mm\_or\_ps(lane1\_a, lane1\_b), 1);
00310 
00311   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_a = \_mm512\_extractf32x4\_ps(a, 2);
00312   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_b = \_mm512\_extractf32x4\_ps(b, 2);
00313   res = \_mm512\_insertf32x4(res, \_mm\_or\_ps(lane2\_a, lane2\_b), 2);
00314 
00315   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_a = \_mm512\_extractf32x4\_ps(a, 3);
00316   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_b = \_mm512\_extractf32x4\_ps(b, 3);
00317   res = \_mm512\_insertf32x4(res, \_mm\_or\_ps(lane3\_a, lane3\_b), 3);
00318 
00319   \textcolor{keywordflow}{return} res;
00320 \textcolor{preprocessor}{#endif}
00321 \}
00322 
00323 \textcolor{keyword}{template} <>
00324 EIGEN\_STRONG\_INLINE Packet8d por<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00325                                            \textcolor{keyword}{const} Packet8d& b) \{
00326 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00327   \textcolor{keywordflow}{return} \_mm512\_or\_pd(a, b);
00328 \textcolor{preprocessor}{#else}
00329   Packet8d res = \_mm512\_undefined\_pd();
00330   Packet4d lane0\_a = \_mm512\_extractf64x4\_pd(a, 0);
00331   Packet4d lane0\_b = \_mm512\_extractf64x4\_pd(b, 0);
00332   res = \_mm512\_insertf64x4(res, \_mm256\_or\_pd(lane0\_a, lane0\_b), 0);
00333 
00334   Packet4d lane1\_a = \_mm512\_extractf64x4\_pd(a, 1);
00335   Packet4d lane1\_b = \_mm512\_extractf64x4\_pd(b, 1);
00336   res = \_mm512\_insertf64x4(res, \_mm256\_or\_pd(lane1\_a, lane1\_b), 1);
00337 
00338   \textcolor{keywordflow}{return} res;
00339 \textcolor{preprocessor}{#endif}
00340 \}
00341 
00342 \textcolor{keyword}{template} <>
00343 EIGEN\_STRONG\_INLINE Packet16f pxor<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00344                                               \textcolor{keyword}{const} Packet16f& b) \{
00345 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00346   \textcolor{keywordflow}{return} \_mm512\_xor\_ps(a, b);
00347 \textcolor{preprocessor}{#else}
00348   Packet16f res = \_mm512\_undefined\_ps();
00349   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_a = \_mm512\_extractf32x4\_ps(a, 0);
00350   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_b = \_mm512\_extractf32x4\_ps(b, 0);
00351   res = \_mm512\_insertf32x4(res, \_mm\_xor\_ps(lane0\_a, lane0\_b), 0);
00352 
00353   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_a = \_mm512\_extractf32x4\_ps(a, 1);
00354   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_b = \_mm512\_extractf32x4\_ps(b, 1);
00355   res = \_mm512\_insertf32x4(res, \_mm\_xor\_ps(lane1\_a, lane1\_b), 1);
00356 
00357   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_a = \_mm512\_extractf32x4\_ps(a, 2);
00358   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_b = \_mm512\_extractf32x4\_ps(b, 2);
00359   res = \_mm512\_insertf32x4(res, \_mm\_xor\_ps(lane2\_a, lane2\_b), 2);
00360 
00361   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_a = \_mm512\_extractf32x4\_ps(a, 3);
00362   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_b = \_mm512\_extractf32x4\_ps(b, 3);
00363   res = \_mm512\_insertf32x4(res, \_mm\_xor\_ps(lane3\_a, lane3\_b), 3);
00364 
00365   \textcolor{keywordflow}{return} res;
00366 \textcolor{preprocessor}{#endif}
00367 \}
00368 \textcolor{keyword}{template} <>
00369 EIGEN\_STRONG\_INLINE Packet8d pxor<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00370                                             \textcolor{keyword}{const} Packet8d& b) \{
00371 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00372   \textcolor{keywordflow}{return} \_mm512\_xor\_pd(a, b);
00373 \textcolor{preprocessor}{#else}
00374   Packet8d res = \_mm512\_undefined\_pd();
00375   Packet4d lane0\_a = \_mm512\_extractf64x4\_pd(a, 0);
00376   Packet4d lane0\_b = \_mm512\_extractf64x4\_pd(b, 0);
00377   res = \_mm512\_insertf64x4(res, \_mm256\_xor\_pd(lane0\_a, lane0\_b), 0);
00378 
00379   Packet4d lane1\_a = \_mm512\_extractf64x4\_pd(a, 1);
00380   Packet4d lane1\_b = \_mm512\_extractf64x4\_pd(b, 1);
00381   res = \_mm512\_insertf64x4(res, \_mm256\_xor\_pd(lane1\_a, lane1\_b), 1);
00382 
00383   \textcolor{keywordflow}{return} res;
00384 \textcolor{preprocessor}{#endif}
00385 \}
00386 
00387 \textcolor{keyword}{template} <>
00388 EIGEN\_STRONG\_INLINE Packet16f pandnot<Packet16f>(\textcolor{keyword}{const} Packet16f& a,
00389                                                  \textcolor{keyword}{const} Packet16f& b) \{
00390 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00391   \textcolor{keywordflow}{return} \_mm512\_andnot\_ps(a, b);
00392 \textcolor{preprocessor}{#else}
00393   Packet16f res = \_mm512\_undefined\_ps();
00394   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_a = \_mm512\_extractf32x4\_ps(a, 0);
00395   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0\_b = \_mm512\_extractf32x4\_ps(b, 0);
00396   res = \_mm512\_insertf32x4(res, \_mm\_andnot\_ps(lane0\_a, lane0\_b), 0);
00397 
00398   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_a = \_mm512\_extractf32x4\_ps(a, 1);
00399   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1\_b = \_mm512\_extractf32x4\_ps(b, 1);
00400   res = \_mm512\_insertf32x4(res, \_mm\_andnot\_ps(lane1\_a, lane1\_b), 1);
00401 
00402   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_a = \_mm512\_extractf32x4\_ps(a, 2);
00403   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2\_b = \_mm512\_extractf32x4\_ps(b, 2);
00404   res = \_mm512\_insertf32x4(res, \_mm\_andnot\_ps(lane2\_a, lane2\_b), 2);
00405 
00406   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_a = \_mm512\_extractf32x4\_ps(a, 3);
00407   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3\_b = \_mm512\_extractf32x4\_ps(b, 3);
00408   res = \_mm512\_insertf32x4(res, \_mm\_andnot\_ps(lane3\_a, lane3\_b), 3);
00409 
00410   \textcolor{keywordflow}{return} res;
00411 \textcolor{preprocessor}{#endif}
00412 \}
00413 \textcolor{keyword}{template} <>
00414 EIGEN\_STRONG\_INLINE Packet8d pandnot<Packet8d>(\textcolor{keyword}{const} Packet8d& a,
00415                                                \textcolor{keyword}{const} Packet8d& b) \{
00416 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00417   \textcolor{keywordflow}{return} \_mm512\_andnot\_pd(a, b);
00418 \textcolor{preprocessor}{#else}
00419   Packet8d res = \_mm512\_undefined\_pd();
00420   Packet4d lane0\_a = \_mm512\_extractf64x4\_pd(a, 0);
00421   Packet4d lane0\_b = \_mm512\_extractf64x4\_pd(b, 0);
00422   res = \_mm512\_insertf64x4(res, \_mm256\_andnot\_pd(lane0\_a, lane0\_b), 0);
00423 
00424   Packet4d lane1\_a = \_mm512\_extractf64x4\_pd(a, 1);
00425   Packet4d lane1\_b = \_mm512\_extractf64x4\_pd(b, 1);
00426   res = \_mm512\_insertf64x4(res, \_mm256\_andnot\_pd(lane1\_a, lane1\_b), 1);
00427 
00428   \textcolor{keywordflow}{return} res;
00429 \textcolor{preprocessor}{#endif}
00430 \}
00431 
00432 \textcolor{keyword}{template} <>
00433 EIGEN\_STRONG\_INLINE Packet16f pload<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00434   EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_load\_ps(from);
00435 \}
00436 \textcolor{keyword}{template} <>
00437 EIGEN\_STRONG\_INLINE Packet8d pload<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00438   EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_load\_pd(from);
00439 \}
00440 \textcolor{keyword}{template} <>
00441 EIGEN\_STRONG\_INLINE Packet16i pload<Packet16i>(\textcolor{keyword}{const} \textcolor{keywordtype}{int}* from) \{
00442   EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_load\_si512(
00443       reinterpret\_cast<const \_\_m512i*>(from));
00444 \}
00445 
00446 \textcolor{keyword}{template} <>
00447 EIGEN\_STRONG\_INLINE Packet16f ploadu<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00448   EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_loadu\_ps(from);
00449 \}
00450 \textcolor{keyword}{template} <>
00451 EIGEN\_STRONG\_INLINE Packet8d ploadu<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00452   EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_loadu\_pd(from);
00453 \}
00454 \textcolor{keyword}{template} <>
00455 EIGEN\_STRONG\_INLINE Packet16i ploadu<Packet16i>(\textcolor{keyword}{const} \textcolor{keywordtype}{int}* from) \{
00456   EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} \_mm512\_loadu\_si512(
00457       reinterpret\_cast<const \_\_m512i*>(from));
00458 \}
00459 
00460 \textcolor{comment}{// Loads 8 floats from memory a returns the packet}
00461 \textcolor{comment}{// \{a0, a0  a1, a1, a2, a2, a3, a3, a4, a4, a5, a5, a6, a6, a7, a7\}}
00462 \textcolor{keyword}{template} <>
00463 EIGEN\_STRONG\_INLINE Packet16f ploaddup<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00464   Packet8f lane0 = \_mm256\_broadcast\_ps((\textcolor{keyword}{const} \_\_m128*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)from);
00465   \textcolor{comment}{// mimic an "inplace" permutation of the lower 128bits using a blend}
00466   lane0 = \_mm256\_blend\_ps(
00467       lane0, \_mm256\_castps128\_ps256(\_mm\_permute\_ps(
00468                  \_mm256\_castps256\_ps128(lane0), \_MM\_SHUFFLE(1, 0, 1, 0))),
00469       15);
00470   \textcolor{comment}{// then we can perform a consistent permutation on the global register to get}
00471   \textcolor{comment}{// everything in shape:}
00472   lane0 = \_mm256\_permute\_ps(lane0, \_MM\_SHUFFLE(3, 3, 2, 2));
00473 
00474   Packet8f lane1 = \_mm256\_broadcast\_ps((\textcolor{keyword}{const} \_\_m128*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)(from + 4));
00475   \textcolor{comment}{// mimic an "inplace" permutation of the lower 128bits using a blend}
00476   lane1 = \_mm256\_blend\_ps(
00477       lane1, \_mm256\_castps128\_ps256(\_mm\_permute\_ps(
00478                  \_mm256\_castps256\_ps128(lane1), \_MM\_SHUFFLE(1, 0, 1, 0))),
00479       15);
00480   \textcolor{comment}{// then we can perform a consistent permutation on the global register to get}
00481   \textcolor{comment}{// everything in shape:}
00482   lane1 = \_mm256\_permute\_ps(lane1, \_MM\_SHUFFLE(3, 3, 2, 2));
00483 
00484 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00485   Packet16f res = \_mm512\_undefined\_ps();
00486   \textcolor{keywordflow}{return} \_mm512\_insertf32x8(res, lane0, 0);
00487   \textcolor{keywordflow}{return} \_mm512\_insertf32x8(res, lane1, 1);
00488   \textcolor{keywordflow}{return} res;
00489 \textcolor{preprocessor}{#else}
00490   Packet16f res = \_mm512\_undefined\_ps();
00491   res = \_mm512\_insertf32x4(res, \_mm256\_extractf128\_ps(lane0, 0), 0);
00492   res = \_mm512\_insertf32x4(res, \_mm256\_extractf128\_ps(lane0, 1), 1);
00493   res = \_mm512\_insertf32x4(res, \_mm256\_extractf128\_ps(lane1, 0), 2);
00494   res = \_mm512\_insertf32x4(res, \_mm256\_extractf128\_ps(lane1, 1), 3);
00495   \textcolor{keywordflow}{return} res;
00496 \textcolor{preprocessor}{#endif}
00497 \}
00498 \textcolor{comment}{// Loads 4 doubles from memory a returns the packet \{a0, a0  a1, a1, a2, a2, a3,}
00499 \textcolor{comment}{// a3\}}
00500 \textcolor{keyword}{template} <>
00501 EIGEN\_STRONG\_INLINE Packet8d ploaddup<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00502   Packet4d lane0 = \_mm256\_broadcast\_pd((\textcolor{keyword}{const} \_\_m128d*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)from);
00503   lane0 = \_mm256\_permute\_pd(lane0, 3 << 2);
00504 
00505   Packet4d lane1 = \_mm256\_broadcast\_pd((\textcolor{keyword}{const} \_\_m128d*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)(from + 2));
00506   lane1 = \_mm256\_permute\_pd(lane1, 3 << 2);
00507 
00508   Packet8d res = \_mm512\_undefined\_pd();
00509   res = \_mm512\_insertf64x4(res, lane0, 0);
00510   \textcolor{keywordflow}{return} \_mm512\_insertf64x4(res, lane1, 1);
00511 \}
00512 
00513 \textcolor{comment}{// Loads 4 floats from memory a returns the packet}
00514 \textcolor{comment}{// \{a0, a0  a0, a0, a1, a1, a1, a1, a2, a2, a2, a2, a3, a3, a3, a3\}}
00515 \textcolor{keyword}{template} <>
00516 EIGEN\_STRONG\_INLINE Packet16f ploadquad<Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00517   Packet16f tmp = \_mm512\_undefined\_ps();
00518   tmp = \_mm512\_insertf32x4(tmp, \_mm\_load\_ps1(from), 0);
00519   tmp = \_mm512\_insertf32x4(tmp, \_mm\_load\_ps1(from + 1), 1);
00520   tmp = \_mm512\_insertf32x4(tmp, \_mm\_load\_ps1(from + 2), 2);
00521   tmp = \_mm512\_insertf32x4(tmp, \_mm\_load\_ps1(from + 3), 3);
00522   \textcolor{keywordflow}{return} tmp;
00523 \}
00524 \textcolor{comment}{// Loads 2 doubles from memory a returns the packet}
00525 \textcolor{comment}{// \{a0, a0  a0, a0, a1, a1, a1, a1\}}
00526 \textcolor{keyword}{template} <>
00527 EIGEN\_STRONG\_INLINE Packet8d ploadquad<Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00528   Packet8d tmp = \_mm512\_undefined\_pd();
00529   Packet2d tmp0 = \_mm\_load\_pd1(from);
00530   Packet2d tmp1 = \_mm\_load\_pd1(from + 1);
00531   Packet4d lane0 = \_mm256\_broadcastsd\_pd(tmp0);
00532   Packet4d lane1 = \_mm256\_broadcastsd\_pd(tmp1);
00533   tmp = \_mm512\_insertf64x4(tmp, lane0, 0);
00534   \textcolor{keywordflow}{return} \_mm512\_insertf64x4(tmp, lane1, 1);
00535 \}
00536 
00537 \textcolor{keyword}{template} <>
00538 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore<float>(\textcolor{keywordtype}{float}* to, \textcolor{keyword}{const} Packet16f& from) \{
00539   EIGEN\_DEBUG\_ALIGNED\_STORE \_mm512\_store\_ps(to, from);
00540 \}
00541 \textcolor{keyword}{template} <>
00542 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore<double>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} Packet8d& from) \{
00543   EIGEN\_DEBUG\_ALIGNED\_STORE \_mm512\_store\_pd(to, from);
00544 \}
00545 \textcolor{keyword}{template} <>
00546 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore<int>(\textcolor{keywordtype}{int}* to, \textcolor{keyword}{const} Packet16i& from) \{
00547   EIGEN\_DEBUG\_ALIGNED\_STORE \_mm512\_storeu\_si512(reinterpret\_cast<\_\_m512i*>(to),
00548                                                 from);
00549 \}
00550 
00551 \textcolor{keyword}{template} <>
00552 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<float>(\textcolor{keywordtype}{float}* to, \textcolor{keyword}{const} Packet16f& from) \{
00553   EIGEN\_DEBUG\_UNALIGNED\_STORE \_mm512\_storeu\_ps(to, from);
00554 \}
00555 \textcolor{keyword}{template} <>
00556 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<double>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} Packet8d& from) \{
00557   EIGEN\_DEBUG\_UNALIGNED\_STORE \_mm512\_storeu\_pd(to, from);
00558 \}
00559 \textcolor{keyword}{template} <>
00560 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<int>(\textcolor{keywordtype}{int}* to, \textcolor{keyword}{const} Packet16i& from) \{
00561   EIGEN\_DEBUG\_UNALIGNED\_STORE \_mm512\_storeu\_si512(
00562       reinterpret\_cast<\_\_m512i*>(to), from);
00563 \}
00564 
00565 \textcolor{keyword}{template} <>
00566 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} Packet16f pgather<float, Packet16f>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from,
00567                                                              \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00568   Packet16i stride\_vector = \_mm512\_set1\_epi32(stride);
00569   Packet16i stride\_multiplier =
00570       \_mm512\_set\_epi32(15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0);
00571   Packet16i indices = \_mm512\_mullo\_epi32(stride\_vector, stride\_multiplier);
00572 
00573   \textcolor{keywordflow}{return} \_mm512\_i32gather\_ps(indices, from, 4);
00574 \}
00575 \textcolor{keyword}{template} <>
00576 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} Packet8d pgather<double, Packet8d>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from,
00577                                                             \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00578   Packet8i stride\_vector = \_mm256\_set1\_epi32(stride);
00579   Packet8i stride\_multiplier = \_mm256\_set\_epi32(7, 6, 5, 4, 3, 2, 1, 0);
00580   Packet8i indices = \_mm256\_mullo\_epi32(stride\_vector, stride\_multiplier);
00581 
00582   \textcolor{keywordflow}{return} \_mm512\_i32gather\_pd(indices, from, 8);
00583 \}
00584 
00585 \textcolor{keyword}{template} <>
00586 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<float, Packet16f>(\textcolor{keywordtype}{float}* to,
00587                                                          \textcolor{keyword}{const} Packet16f& from,
00588                                                          \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00589   Packet16i stride\_vector = \_mm512\_set1\_epi32(stride);
00590   Packet16i stride\_multiplier =
00591       \_mm512\_set\_epi32(15, 14, 13, 12, 11, 10, 9, 8, 7, 6, 5, 4, 3, 2, 1, 0);
00592   Packet16i indices = \_mm512\_mullo\_epi32(stride\_vector, stride\_multiplier);
00593   \_mm512\_i32scatter\_ps(to, indices, from, 4);
00594 \}
00595 \textcolor{keyword}{template} <>
00596 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<double, Packet8d>(\textcolor{keywordtype}{double}* to,
00597                                                          \textcolor{keyword}{const} Packet8d& from,
00598                                                          \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00599   Packet8i stride\_vector = \_mm256\_set1\_epi32(stride);
00600   Packet8i stride\_multiplier = \_mm256\_set\_epi32(7, 6, 5, 4, 3, 2, 1, 0);
00601   Packet8i indices = \_mm256\_mullo\_epi32(stride\_vector, stride\_multiplier);
00602   \_mm512\_i32scatter\_pd(to, indices, from, 8);
00603 \}
00604 
00605 \textcolor{keyword}{template} <>
00606 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore1<Packet16f>(\textcolor{keywordtype}{float}* to, \textcolor{keyword}{const} \textcolor{keywordtype}{float}& a) \{
00607   Packet16f pa = pset1<Packet16f>(a);
00608   pstore(to, pa);
00609 \}
00610 \textcolor{keyword}{template} <>
00611 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore1<Packet8d>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} \textcolor{keywordtype}{double}& a) \{
00612   Packet8d pa = pset1<Packet8d>(a);
00613   pstore(to, pa);
00614 \}
00615 \textcolor{keyword}{template} <>
00616 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore1<Packet16i>(\textcolor{keywordtype}{int}* to, \textcolor{keyword}{const} \textcolor{keywordtype}{int}& a) \{
00617   Packet16i pa = pset1<Packet16i>(a);
00618   pstore(to, pa);
00619 \}
00620 
00621 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} prefetch<float>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}*   addr) \{ \_mm\_prefetch((\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)(addr)
      , \_MM\_HINT\_T0); \}
00622 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} prefetch<double>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* addr) \{ \_mm\_prefetch((\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)(addr)
      , \_MM\_HINT\_T0); \}
00623 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} prefetch<int>(\textcolor{keyword}{const} \textcolor{keywordtype}{int}*       addr) \{ \_mm\_prefetch((\textcolor{keyword}{const} \textcolor{keywordtype}{char}*)(addr)
      , \_MM\_HINT\_T0); \}
00624 
00625 \textcolor{keyword}{template} <>
00626 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{float} pfirst<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00627   \textcolor{keywordflow}{return} \_mm\_cvtss\_f32(\_mm512\_extractf32x4\_ps(a, 0));
00628 \}
00629 \textcolor{keyword}{template} <>
00630 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{double} pfirst<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00631   \textcolor{keywordflow}{return} \_mm\_cvtsd\_f64(\_mm256\_extractf128\_pd(\_mm512\_extractf64x4\_pd(a, 0), 0));
00632 \}
00633 \textcolor{keyword}{template} <>
00634 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{int} pfirst<Packet16i>(\textcolor{keyword}{const} Packet16i& a) \{
00635   \textcolor{keywordflow}{return} \_mm\_extract\_epi32(\_mm512\_extracti32x4\_epi32(a, 0), 0);
00636 \}
00637 
00638 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet16f preverse(\textcolor{keyword}{const} Packet16f& a)
00639 \{
00640   \textcolor{keywordflow}{return} \_mm512\_permutexvar\_ps(\_mm512\_set\_epi32(0, 1, 2, 3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 14, 15), a);
00641 \}
00642 
00643 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet8d preverse(\textcolor{keyword}{const} Packet8d& a)
00644 \{
00645   \textcolor{keywordflow}{return} \_mm512\_permutexvar\_pd(\_mm512\_set\_epi32(0, 0, 0, 1, 0, 2, 0, 3, 0, 4, 0, 5, 0, 6, 0, 7), a);
00646 \}
00647 
00648 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet16f pabs(\textcolor{keyword}{const} Packet16f& a)
00649 \{
00650   \textcolor{comment}{// \_mm512\_abs\_ps intrinsic not found, so hack around it}
00651   \textcolor{keywordflow}{return} (\_\_m512)\_mm512\_and\_si512((\_\_m512i)a, \_mm512\_set1\_epi32(0x7fffffff));
00652 \}
00653 \textcolor{keyword}{template} <>
00654 EIGEN\_STRONG\_INLINE Packet8d pabs(\textcolor{keyword}{const} Packet8d& a) \{
00655   \textcolor{comment}{// \_mm512\_abs\_ps intrinsic not found, so hack around it}
00656   \textcolor{keywordflow}{return} (\_\_m512d)\_mm512\_and\_si512((\_\_m512i)a,
00657                                    \_mm512\_set1\_epi64(0x7fffffffffffffff));
00658 \}
00659 
00660 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00661 \textcolor{comment}{// AVX512F does not define \_mm512\_extractf32x8\_ps to extract \_m256 from \_m512}
00662 \textcolor{preprocessor}{#define EIGEN\_EXTRACT\_8f\_FROM\_16f(INPUT, OUTPUT)                           \(\backslash\)}
00663 \textcolor{preprocessor}{  \_\_m256 OUTPUT##\_0 = \_mm512\_extractf32x8\_ps(INPUT, 0) \_\_m256 OUTPUT##\_1 = \(\backslash\)}
00664 \textcolor{preprocessor}{      \_mm512\_extractf32x8\_ps(INPUT, 1)}
00665 \textcolor{preprocessor}{#else}
00666 \textcolor{preprocessor}{#define EIGEN\_EXTRACT\_8f\_FROM\_16f(INPUT, OUTPUT)                \(\backslash\)}
00667 \textcolor{preprocessor}{  \_\_m256 OUTPUT##\_0 = \_mm256\_insertf128\_ps(                     \(\backslash\)}
00668 \textcolor{preprocessor}{      \_mm256\_castps128\_ps256(\_mm512\_extractf32x4\_ps(INPUT, 0)), \(\backslash\)}
00669 \textcolor{preprocessor}{      \_mm512\_extractf32x4\_ps(INPUT, 1), 1);                     \(\backslash\)}
00670 \textcolor{preprocessor}{  \_\_m256 OUTPUT##\_1 = \_mm256\_insertf128\_ps(                     \(\backslash\)}
00671 \textcolor{preprocessor}{      \_mm256\_castps128\_ps256(\_mm512\_extractf32x4\_ps(INPUT, 2)), \(\backslash\)}
00672 \textcolor{preprocessor}{      \_mm512\_extractf32x4\_ps(INPUT, 3), 1);}
00673 \textcolor{preprocessor}{#endif}
00674 
00675 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00676 \textcolor{preprocessor}{#define EIGEN\_INSERT\_8f\_INTO\_16f(OUTPUT, INPUTA, INPUTB) \(\backslash\)}
00677 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x8(OUTPUT, INPUTA, 0);        \(\backslash\)}
00678 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x8(OUTPUT, INPUTB, 1);}
00679 \textcolor{preprocessor}{#else}
00680 \textcolor{preprocessor}{#define EIGEN\_INSERT\_8f\_INTO\_16f(OUTPUT, INPUTA, INPUTB)                    \(\backslash\)}
00681 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x4(OUTPUT, \_mm256\_extractf128\_ps(INPUTA, 0), 0); \(\backslash\)}
00682 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x4(OUTPUT, \_mm256\_extractf128\_ps(INPUTA, 1), 1); \(\backslash\)}
00683 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x4(OUTPUT, \_mm256\_extractf128\_ps(INPUTB, 0), 2); \(\backslash\)}
00684 \textcolor{preprocessor}{  OUTPUT = \_mm512\_insertf32x4(OUTPUT, \_mm256\_extractf128\_ps(INPUTB, 1), 3);}
00685 \textcolor{preprocessor}{#endif}
00686 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet16f preduxp<Packet16f>(\textcolor{keyword}{const} Packet16f*
00687 vecs)
00688 \{
00689   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[0], vecs0);
00690   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[1], vecs1);
00691   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[2], vecs2);
00692   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[3], vecs3);
00693   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[4], vecs4);
00694   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[5], vecs5);
00695   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[6], vecs6);
00696   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[7], vecs7);
00697   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[8], vecs8);
00698   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[9], vecs9);
00699   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[10], vecs10);
00700   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[11], vecs11);
00701   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[12], vecs12);
00702   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[13], vecs13);
00703   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[14], vecs14);
00704   EIGEN\_EXTRACT\_8f\_FROM\_16f(vecs[15], vecs15);
00705 
00706   \_\_m256 hsum1 = \_mm256\_hadd\_ps(vecs0\_0, vecs1\_0);
00707   \_\_m256 hsum2 = \_mm256\_hadd\_ps(vecs2\_0, vecs3\_0);
00708   \_\_m256 hsum3 = \_mm256\_hadd\_ps(vecs4\_0, vecs5\_0);
00709   \_\_m256 hsum4 = \_mm256\_hadd\_ps(vecs6\_0, vecs7\_0);
00710 
00711   \_\_m256 hsum5 = \_mm256\_hadd\_ps(hsum1, hsum1);
00712   \_\_m256 hsum6 = \_mm256\_hadd\_ps(hsum2, hsum2);
00713   \_\_m256 hsum7 = \_mm256\_hadd\_ps(hsum3, hsum3);
00714   \_\_m256 hsum8 = \_mm256\_hadd\_ps(hsum4, hsum4);
00715 
00716   \_\_m256 perm1 = \_mm256\_permute2f128\_ps(hsum5, hsum5, 0x23);
00717   \_\_m256 perm2 = \_mm256\_permute2f128\_ps(hsum6, hsum6, 0x23);
00718   \_\_m256 perm3 = \_mm256\_permute2f128\_ps(hsum7, hsum7, 0x23);
00719   \_\_m256 perm4 = \_mm256\_permute2f128\_ps(hsum8, hsum8, 0x23);
00720 
00721   \_\_m256 sum1 = \_mm256\_add\_ps(perm1, hsum5);
00722   \_\_m256 sum2 = \_mm256\_add\_ps(perm2, hsum6);
00723   \_\_m256 sum3 = \_mm256\_add\_ps(perm3, hsum7);
00724   \_\_m256 sum4 = \_mm256\_add\_ps(perm4, hsum8);
00725 
00726   \_\_m256 blend1 = \_mm256\_blend\_ps(sum1, sum2, 0xcc);
00727   \_\_m256 blend2 = \_mm256\_blend\_ps(sum3, sum4, 0xcc);
00728 
00729   \_\_m256 \textcolor{keyword}{final} = \_mm256\_blend\_ps(blend1, blend2, 0xf0);
00730 
00731   hsum1 = \_mm256\_hadd\_ps(vecs0\_1, vecs1\_1);
00732   hsum2 = \_mm256\_hadd\_ps(vecs2\_1, vecs3\_1);
00733   hsum3 = \_mm256\_hadd\_ps(vecs4\_1, vecs5\_1);
00734   hsum4 = \_mm256\_hadd\_ps(vecs6\_1, vecs7\_1);
00735 
00736   hsum5 = \_mm256\_hadd\_ps(hsum1, hsum1);
00737   hsum6 = \_mm256\_hadd\_ps(hsum2, hsum2);
00738   hsum7 = \_mm256\_hadd\_ps(hsum3, hsum3);
00739   hsum8 = \_mm256\_hadd\_ps(hsum4, hsum4);
00740 
00741   perm1 = \_mm256\_permute2f128\_ps(hsum5, hsum5, 0x23);
00742   perm2 = \_mm256\_permute2f128\_ps(hsum6, hsum6, 0x23);
00743   perm3 = \_mm256\_permute2f128\_ps(hsum7, hsum7, 0x23);
00744   perm4 = \_mm256\_permute2f128\_ps(hsum8, hsum8, 0x23);
00745 
00746   sum1 = \_mm256\_add\_ps(perm1, hsum5);
00747   sum2 = \_mm256\_add\_ps(perm2, hsum6);
00748   sum3 = \_mm256\_add\_ps(perm3, hsum7);
00749   sum4 = \_mm256\_add\_ps(perm4, hsum8);
00750 
00751   blend1 = \_mm256\_blend\_ps(sum1, sum2, 0xcc);
00752   blend2 = \_mm256\_blend\_ps(sum3, sum4, 0xcc);
00753 
00754   \textcolor{keyword}{final} = padd(\textcolor{keyword}{final}, \_mm256\_blend\_ps(blend1, blend2, 0xf0));
00755 
00756   hsum1 = \_mm256\_hadd\_ps(vecs8\_0, vecs9\_0);
00757   hsum2 = \_mm256\_hadd\_ps(vecs10\_0, vecs11\_0);
00758   hsum3 = \_mm256\_hadd\_ps(vecs12\_0, vecs13\_0);
00759   hsum4 = \_mm256\_hadd\_ps(vecs14\_0, vecs15\_0);
00760 
00761   hsum5 = \_mm256\_hadd\_ps(hsum1, hsum1);
00762   hsum6 = \_mm256\_hadd\_ps(hsum2, hsum2);
00763   hsum7 = \_mm256\_hadd\_ps(hsum3, hsum3);
00764   hsum8 = \_mm256\_hadd\_ps(hsum4, hsum4);
00765 
00766   perm1 = \_mm256\_permute2f128\_ps(hsum5, hsum5, 0x23);
00767   perm2 = \_mm256\_permute2f128\_ps(hsum6, hsum6, 0x23);
00768   perm3 = \_mm256\_permute2f128\_ps(hsum7, hsum7, 0x23);
00769   perm4 = \_mm256\_permute2f128\_ps(hsum8, hsum8, 0x23);
00770 
00771   sum1 = \_mm256\_add\_ps(perm1, hsum5);
00772   sum2 = \_mm256\_add\_ps(perm2, hsum6);
00773   sum3 = \_mm256\_add\_ps(perm3, hsum7);
00774   sum4 = \_mm256\_add\_ps(perm4, hsum8);
00775 
00776   blend1 = \_mm256\_blend\_ps(sum1, sum2, 0xcc);
00777   blend2 = \_mm256\_blend\_ps(sum3, sum4, 0xcc);
00778 
00779   \_\_m256 final\_1 = \_mm256\_blend\_ps(blend1, blend2, 0xf0);
00780 
00781   hsum1 = \_mm256\_hadd\_ps(vecs8\_1, vecs9\_1);
00782   hsum2 = \_mm256\_hadd\_ps(vecs10\_1, vecs11\_1);
00783   hsum3 = \_mm256\_hadd\_ps(vecs12\_1, vecs13\_1);
00784   hsum4 = \_mm256\_hadd\_ps(vecs14\_1, vecs15\_1);
00785 
00786   hsum5 = \_mm256\_hadd\_ps(hsum1, hsum1);
00787   hsum6 = \_mm256\_hadd\_ps(hsum2, hsum2);
00788   hsum7 = \_mm256\_hadd\_ps(hsum3, hsum3);
00789   hsum8 = \_mm256\_hadd\_ps(hsum4, hsum4);
00790 
00791   perm1 = \_mm256\_permute2f128\_ps(hsum5, hsum5, 0x23);
00792   perm2 = \_mm256\_permute2f128\_ps(hsum6, hsum6, 0x23);
00793   perm3 = \_mm256\_permute2f128\_ps(hsum7, hsum7, 0x23);
00794   perm4 = \_mm256\_permute2f128\_ps(hsum8, hsum8, 0x23);
00795 
00796   sum1 = \_mm256\_add\_ps(perm1, hsum5);
00797   sum2 = \_mm256\_add\_ps(perm2, hsum6);
00798   sum3 = \_mm256\_add\_ps(perm3, hsum7);
00799   sum4 = \_mm256\_add\_ps(perm4, hsum8);
00800 
00801   blend1 = \_mm256\_blend\_ps(sum1, sum2, 0xcc);
00802   blend2 = \_mm256\_blend\_ps(sum3, sum4, 0xcc);
00803 
00804   final\_1 = padd(final\_1, \_mm256\_blend\_ps(blend1, blend2, 0xf0));
00805 
00806   \_\_m512 final\_output;
00807 
00808   EIGEN\_INSERT\_8f\_INTO\_16f(final\_output, \textcolor{keyword}{final}, final\_1);
00809   \textcolor{keywordflow}{return} final\_output;
00810 \}
00811 
00812 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE Packet8d preduxp<Packet8d>(\textcolor{keyword}{const} Packet8d* vecs)
00813 \{
00814   Packet4d vecs0\_0 = \_mm512\_extractf64x4\_pd(vecs[0], 0);
00815   Packet4d vecs0\_1 = \_mm512\_extractf64x4\_pd(vecs[0], 1);
00816 
00817   Packet4d vecs1\_0 = \_mm512\_extractf64x4\_pd(vecs[1], 0);
00818   Packet4d vecs1\_1 = \_mm512\_extractf64x4\_pd(vecs[1], 1);
00819 
00820   Packet4d vecs2\_0 = \_mm512\_extractf64x4\_pd(vecs[2], 0);
00821   Packet4d vecs2\_1 = \_mm512\_extractf64x4\_pd(vecs[2], 1);
00822 
00823   Packet4d vecs3\_0 = \_mm512\_extractf64x4\_pd(vecs[3], 0);
00824   Packet4d vecs3\_1 = \_mm512\_extractf64x4\_pd(vecs[3], 1);
00825 
00826   Packet4d vecs4\_0 = \_mm512\_extractf64x4\_pd(vecs[4], 0);
00827   Packet4d vecs4\_1 = \_mm512\_extractf64x4\_pd(vecs[4], 1);
00828 
00829   Packet4d vecs5\_0 = \_mm512\_extractf64x4\_pd(vecs[5], 0);
00830   Packet4d vecs5\_1 = \_mm512\_extractf64x4\_pd(vecs[5], 1);
00831 
00832   Packet4d vecs6\_0 = \_mm512\_extractf64x4\_pd(vecs[6], 0);
00833   Packet4d vecs6\_1 = \_mm512\_extractf64x4\_pd(vecs[6], 1);
00834 
00835   Packet4d vecs7\_0 = \_mm512\_extractf64x4\_pd(vecs[7], 0);
00836   Packet4d vecs7\_1 = \_mm512\_extractf64x4\_pd(vecs[7], 1);
00837 
00838   Packet4d tmp0, tmp1;
00839 
00840   tmp0 = \_mm256\_hadd\_pd(vecs0\_0, vecs1\_0);
00841   tmp0 = \_mm256\_add\_pd(tmp0, \_mm256\_permute2f128\_pd(tmp0, tmp0, 1));
00842 
00843   tmp1 = \_mm256\_hadd\_pd(vecs2\_0, vecs3\_0);
00844   tmp1 = \_mm256\_add\_pd(tmp1, \_mm256\_permute2f128\_pd(tmp1, tmp1, 1));
00845 
00846   \_\_m256d final\_0 = \_mm256\_blend\_pd(tmp0, tmp1, 0xC);
00847 
00848   tmp0 = \_mm256\_hadd\_pd(vecs0\_1, vecs1\_1);
00849   tmp0 = \_mm256\_add\_pd(tmp0, \_mm256\_permute2f128\_pd(tmp0, tmp0, 1));
00850 
00851   tmp1 = \_mm256\_hadd\_pd(vecs2\_1, vecs3\_1);
00852   tmp1 = \_mm256\_add\_pd(tmp1, \_mm256\_permute2f128\_pd(tmp1, tmp1, 1));
00853 
00854   final\_0 = padd(final\_0, \_mm256\_blend\_pd(tmp0, tmp1, 0xC));
00855 
00856   tmp0 = \_mm256\_hadd\_pd(vecs4\_0, vecs5\_0);
00857   tmp0 = \_mm256\_add\_pd(tmp0, \_mm256\_permute2f128\_pd(tmp0, tmp0, 1));
00858 
00859   tmp1 = \_mm256\_hadd\_pd(vecs6\_0, vecs7\_0);
00860   tmp1 = \_mm256\_add\_pd(tmp1, \_mm256\_permute2f128\_pd(tmp1, tmp1, 1));
00861 
00862   \_\_m256d final\_1 = \_mm256\_blend\_pd(tmp0, tmp1, 0xC);
00863 
00864   tmp0 = \_mm256\_hadd\_pd(vecs4\_1, vecs5\_1);
00865   tmp0 = \_mm256\_add\_pd(tmp0, \_mm256\_permute2f128\_pd(tmp0, tmp0, 1));
00866 
00867   tmp1 = \_mm256\_hadd\_pd(vecs6\_1, vecs7\_1);
00868   tmp1 = \_mm256\_add\_pd(tmp1, \_mm256\_permute2f128\_pd(tmp1, tmp1, 1));
00869 
00870   final\_1 = padd(final\_1, \_mm256\_blend\_pd(tmp0, tmp1, 0xC));
00871 
00872   \_\_m512d final\_output = \_mm512\_insertf64x4(final\_output, final\_0, 0);
00873 
00874   \textcolor{keywordflow}{return} \_mm512\_insertf64x4(final\_output, final\_1, 1);
00875 \}
00876 
00877 \textcolor{keyword}{template} <>
00878 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{float} predux<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00879   \textcolor{comment}{//#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00880 \textcolor{preprocessor}{#if 0}
00881   Packet8f lane0 = \_mm512\_extractf32x8\_ps(a, 0);
00882   Packet8f lane1 = \_mm512\_extractf32x8\_ps(a, 1);
00883   Packet8f sum = padd(lane0, lane1);
00884   Packet8f tmp0 = \_mm256\_hadd\_ps(sum, \_mm256\_permute2f128\_ps(a, a, 1));
00885   tmp0 = \_mm256\_hadd\_ps(tmp0, tmp0);
00886   \textcolor{keywordflow}{return} pfirst(\_mm256\_hadd\_ps(tmp0, tmp0));
00887 \textcolor{preprocessor}{#else}
00888   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0 = \_mm512\_extractf32x4\_ps(a, 0);
00889   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1 = \_mm512\_extractf32x4\_ps(a, 1);
00890   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2 = \_mm512\_extractf32x4\_ps(a, 2);
00891   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3 = \_mm512\_extractf32x4\_ps(a, 3);
00892   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} sum = padd(padd(lane0, lane1), padd(lane2, lane3));
00893   sum = \_mm\_hadd\_ps(sum, sum);
00894   sum = \_mm\_hadd\_ps(sum, \_mm\_permute\_ps(sum, 1));
00895   \textcolor{keywordflow}{return} pfirst(sum);
00896 \textcolor{preprocessor}{#endif}
00897 \}
00898 \textcolor{keyword}{template} <>
00899 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{double} predux<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00900   Packet4d lane0 = \_mm512\_extractf64x4\_pd(a, 0);
00901   Packet4d lane1 = \_mm512\_extractf64x4\_pd(a, 1);
00902   Packet4d sum = padd(lane0, lane1);
00903   Packet4d tmp0 = \_mm256\_hadd\_pd(sum, \_mm256\_permute2f128\_pd(sum, sum, 1));
00904   \textcolor{keywordflow}{return} pfirst(\_mm256\_hadd\_pd(tmp0, tmp0));
00905 \}
00906 
00907 \textcolor{keyword}{template} <>
00908 EIGEN\_STRONG\_INLINE Packet8f predux\_downto4<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00909 \textcolor{preprocessor}{#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00910   Packet8f lane0 = \_mm512\_extractf32x8\_ps(a, 0);
00911   Packet8f lane1 = \_mm512\_extractf32x8\_ps(a, 1);
00912   \textcolor{keywordflow}{return} padd(lane0, lane1);
00913 \textcolor{preprocessor}{#else}
00914   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0 = \_mm512\_extractf32x4\_ps(a, 0);
00915   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1 = \_mm512\_extractf32x4\_ps(a, 1);
00916   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2 = \_mm512\_extractf32x4\_ps(a, 2);
00917   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3 = \_mm512\_extractf32x4\_ps(a, 3);
00918   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} sum0 = padd(lane0, lane2);
00919   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} sum1 = padd(lane1, lane3);
00920   \textcolor{keywordflow}{return} \_mm256\_insertf128\_ps(\_mm256\_castps128\_ps256(sum0), sum1, 1);
00921 \textcolor{preprocessor}{#endif}
00922 \}
00923 \textcolor{keyword}{template} <>
00924 EIGEN\_STRONG\_INLINE Packet4d predux\_downto4<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00925   Packet4d lane0 = \_mm512\_extractf64x4\_pd(a, 0);
00926   Packet4d lane1 = \_mm512\_extractf64x4\_pd(a, 1);
00927   Packet4d res = padd(lane0, lane1);
00928   \textcolor{keywordflow}{return} res;
00929 \}
00930 
00931 \textcolor{keyword}{template} <>
00932 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{float} predux\_mul<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00933 \textcolor{comment}{//#ifdef EIGEN\_VECTORIZE\_AVX512DQ}
00934 \textcolor{preprocessor}{#if 0}
00935   Packet8f lane0 = \_mm512\_extractf32x8\_ps(a, 0);
00936   Packet8f lane1 = \_mm512\_extractf32x8\_ps(a, 1);
00937   Packet8f res = pmul(lane0, lane1);
00938   res = pmul(res, \_mm256\_permute2f128\_ps(res, res, 1));
00939   res = pmul(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 3, 2)));
00940   \textcolor{keywordflow}{return} pfirst(pmul(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 0, 1))));
00941 \textcolor{preprocessor}{#else}
00942   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0 = \_mm512\_extractf32x4\_ps(a, 0);
00943   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1 = \_mm512\_extractf32x4\_ps(a, 1);
00944   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2 = \_mm512\_extractf32x4\_ps(a, 2);
00945   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3 = \_mm512\_extractf32x4\_ps(a, 3);
00946   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} res = pmul(pmul(lane0, lane1), pmul(lane2, lane3));
00947   res = pmul(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 3, 2)));
00948   \textcolor{keywordflow}{return} pfirst(pmul(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 0, 1))));
00949 \textcolor{preprocessor}{#endif}
00950 \}
00951 \textcolor{keyword}{template} <>
00952 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{double} predux\_mul<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00953   Packet4d lane0 = \_mm512\_extractf64x4\_pd(a, 0);
00954   Packet4d lane1 = \_mm512\_extractf64x4\_pd(a, 1);
00955   Packet4d res = pmul(lane0, lane1);
00956   res = pmul(res, \_mm256\_permute2f128\_pd(res, res, 1));
00957   \textcolor{keywordflow}{return} pfirst(pmul(res, \_mm256\_shuffle\_pd(res, res, 1)));
00958 \}
00959 
00960 \textcolor{keyword}{template} <>
00961 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{float} predux\_min<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00962   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0 = \_mm512\_extractf32x4\_ps(a, 0);
00963   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1 = \_mm512\_extractf32x4\_ps(a, 1);
00964   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2 = \_mm512\_extractf32x4\_ps(a, 2);
00965   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3 = \_mm512\_extractf32x4\_ps(a, 3);
00966   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} res = \_mm\_min\_ps(\_mm\_min\_ps(lane0, lane1), \_mm\_min\_ps(lane2, lane3));
00967   res = \_mm\_min\_ps(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 3, 2)));
00968   \textcolor{keywordflow}{return} pfirst(\_mm\_min\_ps(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 0, 1))));
00969 \}
00970 \textcolor{keyword}{template} <>
00971 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{double} predux\_min<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00972   Packet4d lane0 = \_mm512\_extractf64x4\_pd(a, 0);
00973   Packet4d lane1 = \_mm512\_extractf64x4\_pd(a, 1);
00974   Packet4d res = \_mm256\_min\_pd(lane0, lane1);
00975   res = \_mm256\_min\_pd(res, \_mm256\_permute2f128\_pd(res, res, 1));
00976   \textcolor{keywordflow}{return} pfirst(\_mm256\_min\_pd(res, \_mm256\_shuffle\_pd(res, res, 1)));
00977 \}
00978 
00979 \textcolor{keyword}{template} <>
00980 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{float} predux\_max<Packet16f>(\textcolor{keyword}{const} Packet16f& a) \{
00981   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane0 = \_mm512\_extractf32x4\_ps(a, 0);
00982   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane1 = \_mm512\_extractf32x4\_ps(a, 1);
00983   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane2 = \_mm512\_extractf32x4\_ps(a, 2);
00984   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} lane3 = \_mm512\_extractf32x4\_ps(a, 3);
00985   \hyperlink{struct_eigen_1_1internal_1_1_packet4f}{Packet4f} res = \_mm\_max\_ps(\_mm\_max\_ps(lane0, lane1), \_mm\_max\_ps(lane2, lane3));
00986   res = \_mm\_max\_ps(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 3, 2)));
00987   \textcolor{keywordflow}{return} pfirst(\_mm\_max\_ps(res, \_mm\_permute\_ps(res, \_MM\_SHUFFLE(0, 0, 0, 1))));
00988 \}
00989 \textcolor{keyword}{template} <>
00990 EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{double} predux\_max<Packet8d>(\textcolor{keyword}{const} Packet8d& a) \{
00991   Packet4d lane0 = \_mm512\_extractf64x4\_pd(a, 0);
00992   Packet4d lane1 = \_mm512\_extractf64x4\_pd(a, 1);
00993   Packet4d res = \_mm256\_max\_pd(lane0, lane1);
00994   res = \_mm256\_max\_pd(res, \_mm256\_permute2f128\_pd(res, res, 1));
00995   \textcolor{keywordflow}{return} pfirst(\_mm256\_max\_pd(res, \_mm256\_shuffle\_pd(res, res, 1)));
00996 \}
00997 
00998 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} Offset>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l00999}\hyperlink{struct_eigen_1_1internal_1_1palign__impl_3_01_offset_00_01_packet16f_01_4}{00999} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl}<Offset, Packet16f> \{
01000   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} run(Packet16f& first,
01001                                       \textcolor{keyword}{const} Packet16f& second) \{
01002     \textcolor{keywordflow}{if} (Offset != 0) \{
01003       \_\_m512i first\_idx = \_mm512\_set\_epi32(
01004           Offset + 15, Offset + 14, Offset + 13, Offset + 12, Offset + 11,
01005           Offset + 10, Offset + 9, Offset + 8, Offset + 7, Offset + 6,
01006           Offset + 5, Offset + 4, Offset + 3, Offset + 2, Offset + 1, Offset);
01007 
01008       \_\_m512i second\_idx =
01009           \_mm512\_set\_epi32(Offset - 1, Offset - 2, Offset - 3, Offset - 4,
01010                            Offset - 5, Offset - 6, Offset - 7, Offset - 8,
01011                            Offset - 9, Offset - 10, Offset - 11, Offset - 12,
01012                            Offset - 13, Offset - 14, Offset - 15, Offset - 16);
01013 
01014       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{short} mask = 0xFFFF;
01015       mask <<= (16 - Offset);
01016 
01017       first = \_mm512\_permutexvar\_ps(first\_idx, first);
01018       Packet16f tmp = \_mm512\_permutexvar\_ps(second\_idx, second);
01019       first = \_mm512\_mask\_blend\_ps(mask, first, tmp);
01020     \}
01021   \}
01022 \};
01023 \textcolor{keyword}{template} <\textcolor{keywordtype}{int} Offset>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x512_2_packet_math_8h_source_l01024}\hyperlink{struct_eigen_1_1internal_1_1palign__impl_3_01_offset_00_01_packet8d_01_4}{01024} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl}<Offset, Packet8d> \{
01025   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} run(Packet8d& first, \textcolor{keyword}{const} Packet8d& second) \{
01026     \textcolor{keywordflow}{if} (Offset != 0) \{
01027       \_\_m512i first\_idx = \_mm512\_set\_epi32(
01028           0, Offset + 7, 0, Offset + 6, 0, Offset + 5, 0, Offset + 4, 0,
01029           Offset + 3, 0, Offset + 2, 0, Offset + 1, 0, Offset);
01030 
01031       \_\_m512i second\_idx = \_mm512\_set\_epi32(
01032           0, Offset - 1, 0, Offset - 2, 0, Offset - 3, 0, Offset - 4, 0,
01033           Offset - 5, 0, Offset - 6, 0, Offset - 7, 0, Offset - 8);
01034 
01035       \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{char} mask = 0xFF;
01036       mask <<= (8 - Offset);
01037 
01038       first = \_mm512\_permutexvar\_pd(first\_idx, first);
01039       Packet8d tmp = \_mm512\_permutexvar\_pd(second\_idx, second);
01040       first = \_mm512\_mask\_blend\_pd(mask, first, tmp);
01041     \}
01042   \}
01043 \};
01044 
01045 
01046 \textcolor{preprocessor}{#define PACK\_OUTPUT(OUTPUT, INPUT, INDEX, STRIDE) \(\backslash\)}
01047 \textcolor{preprocessor}{  EIGEN\_INSERT\_8f\_INTO\_16f(OUTPUT[INDEX], INPUT[INDEX], INPUT[INDEX + STRIDE]);}
01048 
01049 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet16f, 16>}& kernel) \{
01050   \_\_m512 T0 = \_mm512\_unpacklo\_ps(kernel.packet[0], kernel.packet[1]);
01051   \_\_m512 T1 = \_mm512\_unpackhi\_ps(kernel.packet[0], kernel.packet[1]);
01052   \_\_m512 T2 = \_mm512\_unpacklo\_ps(kernel.packet[2], kernel.packet[3]);
01053   \_\_m512 T3 = \_mm512\_unpackhi\_ps(kernel.packet[2], kernel.packet[3]);
01054   \_\_m512 T4 = \_mm512\_unpacklo\_ps(kernel.packet[4], kernel.packet[5]);
01055   \_\_m512 T5 = \_mm512\_unpackhi\_ps(kernel.packet[4], kernel.packet[5]);
01056   \_\_m512 T6 = \_mm512\_unpacklo\_ps(kernel.packet[6], kernel.packet[7]);
01057   \_\_m512 T7 = \_mm512\_unpackhi\_ps(kernel.packet[6], kernel.packet[7]);
01058   \_\_m512 T8 = \_mm512\_unpacklo\_ps(kernel.packet[8], kernel.packet[9]);
01059   \_\_m512 T9 = \_mm512\_unpackhi\_ps(kernel.packet[8], kernel.packet[9]);
01060   \_\_m512 T10 = \_mm512\_unpacklo\_ps(kernel.packet[10], kernel.packet[11]);
01061   \_\_m512 T11 = \_mm512\_unpackhi\_ps(kernel.packet[10], kernel.packet[11]);
01062   \_\_m512 T12 = \_mm512\_unpacklo\_ps(kernel.packet[12], kernel.packet[13]);
01063   \_\_m512 T13 = \_mm512\_unpackhi\_ps(kernel.packet[12], kernel.packet[13]);
01064   \_\_m512 T14 = \_mm512\_unpacklo\_ps(kernel.packet[14], kernel.packet[15]);
01065   \_\_m512 T15 = \_mm512\_unpackhi\_ps(kernel.packet[14], kernel.packet[15]);
01066   \_\_m512 S0 = \_mm512\_shuffle\_ps(T0, T2, \_MM\_SHUFFLE(1, 0, 1, 0));
01067   \_\_m512 S1 = \_mm512\_shuffle\_ps(T0, T2, \_MM\_SHUFFLE(3, 2, 3, 2));
01068   \_\_m512 S2 = \_mm512\_shuffle\_ps(T1, T3, \_MM\_SHUFFLE(1, 0, 1, 0));
01069   \_\_m512 S3 = \_mm512\_shuffle\_ps(T1, T3, \_MM\_SHUFFLE(3, 2, 3, 2));
01070   \_\_m512 S4 = \_mm512\_shuffle\_ps(T4, T6, \_MM\_SHUFFLE(1, 0, 1, 0));
01071   \_\_m512 S5 = \_mm512\_shuffle\_ps(T4, T6, \_MM\_SHUFFLE(3, 2, 3, 2));
01072   \_\_m512 S6 = \_mm512\_shuffle\_ps(T5, T7, \_MM\_SHUFFLE(1, 0, 1, 0));
01073   \_\_m512 S7 = \_mm512\_shuffle\_ps(T5, T7, \_MM\_SHUFFLE(3, 2, 3, 2));
01074   \_\_m512 S8 = \_mm512\_shuffle\_ps(T8, T10, \_MM\_SHUFFLE(1, 0, 1, 0));
01075   \_\_m512 S9 = \_mm512\_shuffle\_ps(T8, T10, \_MM\_SHUFFLE(3, 2, 3, 2));
01076   \_\_m512 S10 = \_mm512\_shuffle\_ps(T9, T11, \_MM\_SHUFFLE(1, 0, 1, 0));
01077   \_\_m512 S11 = \_mm512\_shuffle\_ps(T9, T11, \_MM\_SHUFFLE(3, 2, 3, 2));
01078   \_\_m512 S12 = \_mm512\_shuffle\_ps(T12, T14, \_MM\_SHUFFLE(1, 0, 1, 0));
01079   \_\_m512 S13 = \_mm512\_shuffle\_ps(T12, T14, \_MM\_SHUFFLE(3, 2, 3, 2));
01080   \_\_m512 S14 = \_mm512\_shuffle\_ps(T13, T15, \_MM\_SHUFFLE(1, 0, 1, 0));
01081   \_\_m512 S15 = \_mm512\_shuffle\_ps(T13, T15, \_MM\_SHUFFLE(3, 2, 3, 2));
01082 
01083   EIGEN\_EXTRACT\_8f\_FROM\_16f(S0, S0);
01084   EIGEN\_EXTRACT\_8f\_FROM\_16f(S1, S1);
01085   EIGEN\_EXTRACT\_8f\_FROM\_16f(S2, S2);
01086   EIGEN\_EXTRACT\_8f\_FROM\_16f(S3, S3);
01087   EIGEN\_EXTRACT\_8f\_FROM\_16f(S4, S4);
01088   EIGEN\_EXTRACT\_8f\_FROM\_16f(S5, S5);
01089   EIGEN\_EXTRACT\_8f\_FROM\_16f(S6, S6);
01090   EIGEN\_EXTRACT\_8f\_FROM\_16f(S7, S7);
01091   EIGEN\_EXTRACT\_8f\_FROM\_16f(S8, S8);
01092   EIGEN\_EXTRACT\_8f\_FROM\_16f(S9, S9);
01093   EIGEN\_EXTRACT\_8f\_FROM\_16f(S10, S10);
01094   EIGEN\_EXTRACT\_8f\_FROM\_16f(S11, S11);
01095   EIGEN\_EXTRACT\_8f\_FROM\_16f(S12, S12);
01096   EIGEN\_EXTRACT\_8f\_FROM\_16f(S13, S13);
01097   EIGEN\_EXTRACT\_8f\_FROM\_16f(S14, S14);
01098   EIGEN\_EXTRACT\_8f\_FROM\_16f(S15, S15);
01099 
01100   \hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet8f, 32>} tmp;
01101 
01102   tmp.packet[0] = \_mm256\_permute2f128\_ps(S0\_0, S4\_0, 0x20);
01103   tmp.packet[1] = \_mm256\_permute2f128\_ps(S1\_0, S5\_0, 0x20);
01104   tmp.packet[2] = \_mm256\_permute2f128\_ps(S2\_0, S6\_0, 0x20);
01105   tmp.packet[3] = \_mm256\_permute2f128\_ps(S3\_0, S7\_0, 0x20);
01106   tmp.packet[4] = \_mm256\_permute2f128\_ps(S0\_0, S4\_0, 0x31);
01107   tmp.packet[5] = \_mm256\_permute2f128\_ps(S1\_0, S5\_0, 0x31);
01108   tmp.packet[6] = \_mm256\_permute2f128\_ps(S2\_0, S6\_0, 0x31);
01109   tmp.packet[7] = \_mm256\_permute2f128\_ps(S3\_0, S7\_0, 0x31);
01110 
01111   tmp.packet[8] = \_mm256\_permute2f128\_ps(S0\_1, S4\_1, 0x20);
01112   tmp.packet[9] = \_mm256\_permute2f128\_ps(S1\_1, S5\_1, 0x20);
01113   tmp.packet[10] = \_mm256\_permute2f128\_ps(S2\_1, S6\_1, 0x20);
01114   tmp.packet[11] = \_mm256\_permute2f128\_ps(S3\_1, S7\_1, 0x20);
01115   tmp.packet[12] = \_mm256\_permute2f128\_ps(S0\_1, S4\_1, 0x31);
01116   tmp.packet[13] = \_mm256\_permute2f128\_ps(S1\_1, S5\_1, 0x31);
01117   tmp.packet[14] = \_mm256\_permute2f128\_ps(S2\_1, S6\_1, 0x31);
01118   tmp.packet[15] = \_mm256\_permute2f128\_ps(S3\_1, S7\_1, 0x31);
01119 
01120   \textcolor{comment}{// Second set of \_m256 outputs}
01121   tmp.packet[16] = \_mm256\_permute2f128\_ps(S8\_0, S12\_0, 0x20);
01122   tmp.packet[17] = \_mm256\_permute2f128\_ps(S9\_0, S13\_0, 0x20);
01123   tmp.packet[18] = \_mm256\_permute2f128\_ps(S10\_0, S14\_0, 0x20);
01124   tmp.packet[19] = \_mm256\_permute2f128\_ps(S11\_0, S15\_0, 0x20);
01125   tmp.packet[20] = \_mm256\_permute2f128\_ps(S8\_0, S12\_0, 0x31);
01126   tmp.packet[21] = \_mm256\_permute2f128\_ps(S9\_0, S13\_0, 0x31);
01127   tmp.packet[22] = \_mm256\_permute2f128\_ps(S10\_0, S14\_0, 0x31);
01128   tmp.packet[23] = \_mm256\_permute2f128\_ps(S11\_0, S15\_0, 0x31);
01129 
01130   tmp.packet[24] = \_mm256\_permute2f128\_ps(S8\_1, S12\_1, 0x20);
01131   tmp.packet[25] = \_mm256\_permute2f128\_ps(S9\_1, S13\_1, 0x20);
01132   tmp.packet[26] = \_mm256\_permute2f128\_ps(S10\_1, S14\_1, 0x20);
01133   tmp.packet[27] = \_mm256\_permute2f128\_ps(S11\_1, S15\_1, 0x20);
01134   tmp.packet[28] = \_mm256\_permute2f128\_ps(S8\_1, S12\_1, 0x31);
01135   tmp.packet[29] = \_mm256\_permute2f128\_ps(S9\_1, S13\_1, 0x31);
01136   tmp.packet[30] = \_mm256\_permute2f128\_ps(S10\_1, S14\_1, 0x31);
01137   tmp.packet[31] = \_mm256\_permute2f128\_ps(S11\_1, S15\_1, 0x31);
01138 
01139   \textcolor{comment}{// Pack them into the output}
01140   PACK\_OUTPUT(kernel.packet, tmp.packet, 0, 16);
01141   PACK\_OUTPUT(kernel.packet, tmp.packet, 1, 16);
01142   PACK\_OUTPUT(kernel.packet, tmp.packet, 2, 16);
01143   PACK\_OUTPUT(kernel.packet, tmp.packet, 3, 16);
01144 
01145   PACK\_OUTPUT(kernel.packet, tmp.packet, 4, 16);
01146   PACK\_OUTPUT(kernel.packet, tmp.packet, 5, 16);
01147   PACK\_OUTPUT(kernel.packet, tmp.packet, 6, 16);
01148   PACK\_OUTPUT(kernel.packet, tmp.packet, 7, 16);
01149 
01150   PACK\_OUTPUT(kernel.packet, tmp.packet, 8, 16);
01151   PACK\_OUTPUT(kernel.packet, tmp.packet, 9, 16);
01152   PACK\_OUTPUT(kernel.packet, tmp.packet, 10, 16);
01153   PACK\_OUTPUT(kernel.packet, tmp.packet, 11, 16);
01154 
01155   PACK\_OUTPUT(kernel.packet, tmp.packet, 12, 16);
01156   PACK\_OUTPUT(kernel.packet, tmp.packet, 13, 16);
01157   PACK\_OUTPUT(kernel.packet, tmp.packet, 14, 16);
01158   PACK\_OUTPUT(kernel.packet, tmp.packet, 15, 16);
01159 \}
01160 \textcolor{preprocessor}{#define PACK\_OUTPUT\_2(OUTPUT, INPUT, INDEX, STRIDE)         \(\backslash\)}
01161 \textcolor{preprocessor}{  EIGEN\_INSERT\_8f\_INTO\_16f(OUTPUT[INDEX], INPUT[2 * INDEX], \(\backslash\)}
01162 \textcolor{preprocessor}{                           INPUT[2 * INDEX + STRIDE]);}
01163 
01164 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet16f, 4>}& kernel) \{
01165   \_\_m512 T0 = \_mm512\_unpacklo\_ps(kernel.packet[0], kernel.packet[1]);
01166   \_\_m512 T1 = \_mm512\_unpackhi\_ps(kernel.packet[0], kernel.packet[1]);
01167   \_\_m512 T2 = \_mm512\_unpacklo\_ps(kernel.packet[2], kernel.packet[3]);
01168   \_\_m512 T3 = \_mm512\_unpackhi\_ps(kernel.packet[2], kernel.packet[3]);
01169 
01170   \_\_m512 S0 = \_mm512\_shuffle\_ps(T0, T2, \_MM\_SHUFFLE(1, 0, 1, 0));
01171   \_\_m512 S1 = \_mm512\_shuffle\_ps(T0, T2, \_MM\_SHUFFLE(3, 2, 3, 2));
01172   \_\_m512 S2 = \_mm512\_shuffle\_ps(T1, T3, \_MM\_SHUFFLE(1, 0, 1, 0));
01173   \_\_m512 S3 = \_mm512\_shuffle\_ps(T1, T3, \_MM\_SHUFFLE(3, 2, 3, 2));
01174 
01175   EIGEN\_EXTRACT\_8f\_FROM\_16f(S0, S0);
01176   EIGEN\_EXTRACT\_8f\_FROM\_16f(S1, S1);
01177   EIGEN\_EXTRACT\_8f\_FROM\_16f(S2, S2);
01178   EIGEN\_EXTRACT\_8f\_FROM\_16f(S3, S3);
01179 
01180   \hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet8f, 8>} tmp;
01181 
01182   tmp.packet[0] = \_mm256\_permute2f128\_ps(S0\_0, S1\_0, 0x20);
01183   tmp.packet[1] = \_mm256\_permute2f128\_ps(S2\_0, S3\_0, 0x20);
01184   tmp.packet[2] = \_mm256\_permute2f128\_ps(S0\_0, S1\_0, 0x31);
01185   tmp.packet[3] = \_mm256\_permute2f128\_ps(S2\_0, S3\_0, 0x31);
01186 
01187   tmp.packet[4] = \_mm256\_permute2f128\_ps(S0\_1, S1\_1, 0x20);
01188   tmp.packet[5] = \_mm256\_permute2f128\_ps(S2\_1, S3\_1, 0x20);
01189   tmp.packet[6] = \_mm256\_permute2f128\_ps(S0\_1, S1\_1, 0x31);
01190   tmp.packet[7] = \_mm256\_permute2f128\_ps(S2\_1, S3\_1, 0x31);
01191 
01192   PACK\_OUTPUT\_2(kernel.packet, tmp.packet, 0, 1);
01193   PACK\_OUTPUT\_2(kernel.packet, tmp.packet, 1, 1);
01194   PACK\_OUTPUT\_2(kernel.packet, tmp.packet, 2, 1);
01195   PACK\_OUTPUT\_2(kernel.packet, tmp.packet, 3, 1);
01196 \}
01197 
01198 \textcolor{preprocessor}{#define PACK\_OUTPUT\_SQ\_D(OUTPUT, INPUT, INDEX, STRIDE)                \(\backslash\)}
01199 \textcolor{preprocessor}{  OUTPUT[INDEX] = \_mm512\_insertf64x4(OUTPUT[INDEX], INPUT[INDEX], 0); \(\backslash\)}
01200 \textcolor{preprocessor}{  OUTPUT[INDEX] = \_mm512\_insertf64x4(OUTPUT[INDEX], INPUT[INDEX + STRIDE], 1);}
01201 
01202 \textcolor{preprocessor}{#define PACK\_OUTPUT\_D(OUTPUT, INPUT, INDEX, STRIDE)                         \(\backslash\)}
01203 \textcolor{preprocessor}{  OUTPUT[INDEX] = \_mm512\_insertf64x4(OUTPUT[INDEX], INPUT[(2 * INDEX)], 0); \(\backslash\)}
01204 \textcolor{preprocessor}{  OUTPUT[INDEX] =                                                           \(\backslash\)}
01205 \textcolor{preprocessor}{      \_mm512\_insertf64x4(OUTPUT[INDEX], INPUT[(2 * INDEX) + STRIDE], 1);}
01206 
01207 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet8d, 4>}& kernel) \{
01208   \_\_m512d T0 = \_mm512\_shuffle\_pd(kernel.packet[0], kernel.packet[1], 0);
01209   \_\_m512d T1 = \_mm512\_shuffle\_pd(kernel.packet[0], kernel.packet[1], 0xff);
01210   \_\_m512d T2 = \_mm512\_shuffle\_pd(kernel.packet[2], kernel.packet[3], 0);
01211   \_\_m512d T3 = \_mm512\_shuffle\_pd(kernel.packet[2], kernel.packet[3], 0xff);
01212 
01213   \hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet4d, 8>} tmp;
01214 
01215   tmp.packet[0] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 0),
01216                                          \_mm512\_extractf64x4\_pd(T2, 0), 0x20);
01217   tmp.packet[1] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 0),
01218                                          \_mm512\_extractf64x4\_pd(T3, 0), 0x20);
01219   tmp.packet[2] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 0),
01220                                          \_mm512\_extractf64x4\_pd(T2, 0), 0x31);
01221   tmp.packet[3] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 0),
01222                                          \_mm512\_extractf64x4\_pd(T3, 0), 0x31);
01223 
01224   tmp.packet[4] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 1),
01225                                          \_mm512\_extractf64x4\_pd(T2, 1), 0x20);
01226   tmp.packet[5] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 1),
01227                                          \_mm512\_extractf64x4\_pd(T3, 1), 0x20);
01228   tmp.packet[6] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 1),
01229                                          \_mm512\_extractf64x4\_pd(T2, 1), 0x31);
01230   tmp.packet[7] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 1),
01231                                          \_mm512\_extractf64x4\_pd(T3, 1), 0x31);
01232 
01233   PACK\_OUTPUT\_D(kernel.packet, tmp.packet, 0, 1);
01234   PACK\_OUTPUT\_D(kernel.packet, tmp.packet, 1, 1);
01235   PACK\_OUTPUT\_D(kernel.packet, tmp.packet, 2, 1);
01236   PACK\_OUTPUT\_D(kernel.packet, tmp.packet, 3, 1);
01237 \}
01238 
01239 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet8d, 8>}& kernel) \{
01240   \_\_m512d T0 = \_mm512\_unpacklo\_pd(kernel.packet[0], kernel.packet[1]);
01241   \_\_m512d T1 = \_mm512\_unpackhi\_pd(kernel.packet[0], kernel.packet[1]);
01242   \_\_m512d T2 = \_mm512\_unpacklo\_pd(kernel.packet[2], kernel.packet[3]);
01243   \_\_m512d T3 = \_mm512\_unpackhi\_pd(kernel.packet[2], kernel.packet[3]);
01244   \_\_m512d T4 = \_mm512\_unpacklo\_pd(kernel.packet[4], kernel.packet[5]);
01245   \_\_m512d T5 = \_mm512\_unpackhi\_pd(kernel.packet[4], kernel.packet[5]);
01246   \_\_m512d T6 = \_mm512\_unpacklo\_pd(kernel.packet[6], kernel.packet[7]);
01247   \_\_m512d T7 = \_mm512\_unpackhi\_pd(kernel.packet[6], kernel.packet[7]);
01248 
01249   \hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet4d, 16>} tmp;
01250 
01251   tmp.packet[0] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 0),
01252                                          \_mm512\_extractf64x4\_pd(T2, 0), 0x20);
01253   tmp.packet[1] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 0),
01254                                          \_mm512\_extractf64x4\_pd(T3, 0), 0x20);
01255   tmp.packet[2] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 0),
01256                                          \_mm512\_extractf64x4\_pd(T2, 0), 0x31);
01257   tmp.packet[3] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 0),
01258                                          \_mm512\_extractf64x4\_pd(T3, 0), 0x31);
01259 
01260   tmp.packet[4] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 1),
01261                                          \_mm512\_extractf64x4\_pd(T2, 1), 0x20);
01262   tmp.packet[5] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 1),
01263                                          \_mm512\_extractf64x4\_pd(T3, 1), 0x20);
01264   tmp.packet[6] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T0, 1),
01265                                          \_mm512\_extractf64x4\_pd(T2, 1), 0x31);
01266   tmp.packet[7] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T1, 1),
01267                                          \_mm512\_extractf64x4\_pd(T3, 1), 0x31);
01268 
01269   tmp.packet[8] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T4, 0),
01270                                          \_mm512\_extractf64x4\_pd(T6, 0), 0x20);
01271   tmp.packet[9] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T5, 0),
01272                                          \_mm512\_extractf64x4\_pd(T7, 0), 0x20);
01273   tmp.packet[10] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T4, 0),
01274                                           \_mm512\_extractf64x4\_pd(T6, 0), 0x31);
01275   tmp.packet[11] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T5, 0),
01276                                           \_mm512\_extractf64x4\_pd(T7, 0), 0x31);
01277 
01278   tmp.packet[12] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T4, 1),
01279                                           \_mm512\_extractf64x4\_pd(T6, 1), 0x20);
01280   tmp.packet[13] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T5, 1),
01281                                           \_mm512\_extractf64x4\_pd(T7, 1), 0x20);
01282   tmp.packet[14] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T4, 1),
01283                                           \_mm512\_extractf64x4\_pd(T6, 1), 0x31);
01284   tmp.packet[15] = \_mm256\_permute2f128\_pd(\_mm512\_extractf64x4\_pd(T5, 1),
01285                                           \_mm512\_extractf64x4\_pd(T7, 1), 0x31);
01286 
01287   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 0, 8);
01288   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 1, 8);
01289   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 2, 8);
01290   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 3, 8);
01291 
01292   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 4, 8);
01293   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 5, 8);
01294   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 6, 8);
01295   PACK\_OUTPUT\_SQ\_D(kernel.packet, tmp.packet, 7, 8);
01296 \}
01297 \textcolor{keyword}{template} <>
01298 EIGEN\_STRONG\_INLINE Packet16f pblend(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_selector}{Selector<16>}& \textcolor{comment}{/*ifPacket*/},
01299                                      \textcolor{keyword}{const} Packet16f& \textcolor{comment}{/*thenPacket*/},
01300                                      \textcolor{keyword}{const} Packet16f& \textcolor{comment}{/*elsePacket*/}) \{
01301   assert(\textcolor{keyword}{false} && \textcolor{stringliteral}{"To be implemented"});
01302   \textcolor{keywordflow}{return} Packet16f();
01303 \}
01304 \textcolor{keyword}{template} <>
01305 EIGEN\_STRONG\_INLINE Packet8d pblend(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_selector}{Selector<8>}& \textcolor{comment}{/*ifPacket*/},
01306                                     \textcolor{keyword}{const} Packet8d& \textcolor{comment}{/*thenPacket*/},
01307                                     \textcolor{keyword}{const} Packet8d& \textcolor{comment}{/*elsePacket*/}) \{
01308   assert(\textcolor{keyword}{false} && \textcolor{stringliteral}{"To be implemented"});
01309   \textcolor{keywordflow}{return} Packet8d();
01310 \}
01311 
01312 \} \textcolor{comment}{// end namespace internal}
01313 
01314 \} \textcolor{comment}{// end namespace Eigen}
01315 
01316 \textcolor{preprocessor}{#endif // EIGEN\_PACKET\_MATH\_AVX512\_H}
\end{DoxyCode}
