\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Q\+R/\+Full\+Piv\+Householder\+QR.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source}\index{Full\+Piv\+Householder\+Q\+R.\+h@{Full\+Piv\+Householder\+Q\+R.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2009 Benoit Jacob <jacob.benoit.1@gmail.com>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_FULLPIVOTINGHOUSEHOLDERQR\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_FULLPIVOTINGHOUSEHOLDERQR\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00017 
00018 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{struct }traits<FullPivHouseholderQR<\_MatrixType> >
00019  : traits<\_MatrixType>
00020 \{
00021   \textcolor{keyword}{enum} \{ Flags = 0 \};
00022 \};
00023 
00024 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }FullPivHouseholderQRMatrixQReturnType;
00025 
00026 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00027 \textcolor{keyword}{struct }traits<FullPivHouseholderQRMatrixQReturnType<MatrixType> >
00028 \{
00029   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::PlainObject ReturnType;
00030 \};
00031 
00032 \} \textcolor{comment}{// end namespace internal}
00033 
00057 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{class }FullPivHouseholderQR
00058 \{
00059   \textcolor{keyword}{public}:
00060 
00061     \textcolor{keyword}{typedef} \_MatrixType MatrixType;
00062     \textcolor{keyword}{enum} \{
00063       RowsAtCompileTime = MatrixType::RowsAtCompileTime,
00064       ColsAtCompileTime = MatrixType::ColsAtCompileTime,
00065       MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,
00066       MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime
00067     \};
00068     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00069     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00070     \textcolor{comment}{// FIXME should be int}
00071     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::StorageIndex StorageIndex;
00072     \textcolor{keyword}{typedef} internal::FullPivHouseholderQRMatrixQReturnType<MatrixType> MatrixQReturnType;
00073     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::plain\_diag\_type<MatrixType>::type HCoeffsType;
00074     \textcolor{keyword}{typedef} Matrix<StorageIndex, 1,
00075                    EIGEN\_SIZE\_MIN\_PREFER\_DYNAMIC(ColsAtCompileTime,RowsAtCompileTime), 
      \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}, 1,
00076                    EIGEN\_SIZE\_MIN\_PREFER\_FIXED(MaxColsAtCompileTime,MaxRowsAtCompileTime)> 
      IntDiagSizeVectorType;
00077     \textcolor{keyword}{typedef} PermutationMatrix<ColsAtCompileTime, MaxColsAtCompileTime> PermutationType;
00078     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::plain\_row\_type<MatrixType>::type RowVectorType;
00079     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::plain\_col\_type<MatrixType>::type ColVectorType;
00080     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::PlainObject PlainObject;
00081 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00087}\hyperlink{group___q_r___module_aeb14b4c1eef33128207b40a00bd0bd08}{00087}     \hyperlink{group___q_r___module_aeb14b4c1eef33128207b40a00bd0bd08}{FullPivHouseholderQR}()
00088       : m\_qr(),
00089         m\_hCoeffs(),
00090         m\_rows\_transpositions(),
00091         m\_cols\_transpositions(),
00092         m\_cols\_permutation(),
00093         m\_temp(),
00094         m\_isInitialized(false),
00095         m\_usePrescribedThreshold(false) \{\}
00096 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00103}\hyperlink{group___q_r___module_abf722e1dc7241a5d6f76460ef0c87821}{00103}     \hyperlink{group___q_r___module_abf722e1dc7241a5d6f76460ef0c87821}{FullPivHouseholderQR}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols)
00104       : m\_qr(rows, cols),
00105         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(rows,cols)),
00106         m\_rows\_transpositions((\hyperlink{namespacestd}{std}::min)(rows,cols)),
00107         m\_cols\_transpositions((\hyperlink{namespacestd}{std}::min)(rows,cols)),
00108         m\_cols\_permutation(cols),
00109         m\_temp(cols),
00110         m\_isInitialized(false),
00111         m\_usePrescribedThreshold(false) \{\}
00112 
00125     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00126}\hyperlink{group___q_r___module_aeeace3abca6b215025e94c3e098b0a97}{00126}     \textcolor{keyword}{explicit} \hyperlink{group___q_r___module_aeeace3abca6b215025e94c3e098b0a97}{FullPivHouseholderQR}(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& 
      matrix)
00127       : m\_qr(matrix.rows(), matrix.cols()),
00128         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00129         m\_rows\_transpositions((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00130         m\_cols\_transpositions((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00131         m\_cols\_permutation(matrix.cols()),
00132         m\_temp(matrix.cols()),
00133         m\_isInitialized(false),
00134         m\_usePrescribedThreshold(false)
00135     \{
00136       compute(matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}());
00137     \}
00138 
00145     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00146}\hyperlink{group___q_r___module_ac9bdb4f7fa77c1aa16f238592c248e70}{00146}     \textcolor{keyword}{explicit} \hyperlink{group___q_r___module_ac9bdb4f7fa77c1aa16f238592c248e70}{FullPivHouseholderQR}(\hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00147       : m\_qr(matrix.derived()),
00148         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00149         m\_rows\_transpositions((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00150         m\_cols\_transpositions((\hyperlink{namespacestd}{std}::min)(matrix.rows(), matrix.cols())),
00151         m\_cols\_permutation(matrix.cols()),
00152         m\_temp(matrix.cols()),
00153         m\_isInitialized(false),
00154         m\_usePrescribedThreshold(false)
00155     \{
00156       computeInPlace();
00157     \}
00158 
00174     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs>
00175     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<FullPivHouseholderQR, Rhs>}
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00176}\hyperlink{group___q_r___module_a6f1b0a116c78e642e3d2a100a29d1a4a}{00176}     \hyperlink{group___q_r___module_a6f1b0a116c78e642e3d2a100a29d1a4a}{solve}(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Rhs>}& b)\textcolor{keyword}{ const}
00177 \textcolor{keyword}{    }\{
00178       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00179       \textcolor{keywordflow}{return} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<FullPivHouseholderQR, Rhs>}(*\textcolor{keyword}{this}, b.derived());
00180     \}
00181 
00184     MatrixQReturnType matrixQ(\textcolor{keywordtype}{void}) \textcolor{keyword}{const};
00185 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00188}\hyperlink{group___q_r___module_a9c16411e5d8f1fc634a5797018d5aa3e}{00188}     \textcolor{keyword}{const} MatrixType& \hyperlink{group___q_r___module_a9c16411e5d8f1fc634a5797018d5aa3e}{matrixQR}()\textcolor{keyword}{ const}
00189 \textcolor{keyword}{    }\{
00190       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00191       \textcolor{keywordflow}{return} m\_qr;
00192     \}
00193 
00194     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
00195     \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR}& compute(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& 
      matrix);
00196 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00198}\hyperlink{group___q_r___module_abeda6d91e196c13d4dd8b7542fef3e17}{00198}     \textcolor{keyword}{const} PermutationType& \hyperlink{group___q_r___module_abeda6d91e196c13d4dd8b7542fef3e17}{colsPermutation}()\textcolor{keyword}{ const}
00199 \textcolor{keyword}{    }\{
00200       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00201       \textcolor{keywordflow}{return} m\_cols\_permutation;
00202     \}
00203 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00205}\hyperlink{group___q_r___module_abebbfc0ca6e3dd285a0ad0c907abb093}{00205}     \textcolor{keyword}{const} IntDiagSizeVectorType& \hyperlink{group___q_r___module_abebbfc0ca6e3dd285a0ad0c907abb093}{rowsTranspositions}()\textcolor{keyword}{ const}
00206 \textcolor{keyword}{    }\{
00207       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00208       \textcolor{keywordflow}{return} m\_rows\_transpositions;
00209     \}
00210 
00224     \textcolor{keyword}{typename} MatrixType::RealScalar absDeterminant() \textcolor{keyword}{const};
00225 
00238     \textcolor{keyword}{typename} MatrixType::RealScalar logAbsDeterminant() \textcolor{keyword}{const};
00239 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00246}\hyperlink{group___q_r___module_aeae555220f46477818ccc94aca2de770}{00246}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_aeae555220f46477818ccc94aca2de770}{rank}()\textcolor{keyword}{ const}
00247 \textcolor{keyword}{    }\{
00248       \textcolor{keyword}{using} std::abs;
00249       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00250       RealScalar premultiplied\_threshold = abs(m\_maxpivot) * threshold();
00251       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} result = 0;
00252       \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < m\_nonzero\_pivots; ++i)
00253         result += (abs(m\_qr.coeff(i,i)) > premultiplied\_threshold);
00254       \textcolor{keywordflow}{return} result;
00255     \}
00256 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00263}\hyperlink{group___q_r___module_a3b5fe5edc66acc01c45b16e728470aa0}{00263}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_a3b5fe5edc66acc01c45b16e728470aa0}{dimensionOfKernel}()\textcolor{keyword}{ const}
00264 \textcolor{keyword}{    }\{
00265       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00266       \textcolor{keywordflow}{return} cols() - rank();
00267     \}
00268 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00276}\hyperlink{group___q_r___module_a6776788011026b0f63192485a59deaed}{00276}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_a6776788011026b0f63192485a59deaed}{isInjective}()\textcolor{keyword}{ const}
00277 \textcolor{keyword}{    }\{
00278       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00279       \textcolor{keywordflow}{return} rank() == cols();
00280     \}
00281 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00289}\hyperlink{group___q_r___module_aa3593db4708ce9079b0bdf219b99f57e}{00289}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_aa3593db4708ce9079b0bdf219b99f57e}{isSurjective}()\textcolor{keyword}{ const}
00290 \textcolor{keyword}{    }\{
00291       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00292       \textcolor{keywordflow}{return} rank() == rows();
00293     \}
00294 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00301}\hyperlink{group___q_r___module_aeb1d779ec22ec68a5a28d4235db02ec1}{00301}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_aeb1d779ec22ec68a5a28d4235db02ec1}{isInvertible}()\textcolor{keyword}{ const}
00302 \textcolor{keyword}{    }\{
00303       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00304       \textcolor{keywordflow}{return} isInjective() && isSurjective();
00305     \}
00306 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00312}\hyperlink{group___q_r___module_a352ce66397af06da214ddde343cec6f5}{00312}     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{class_eigen_1_1_inverse}{Inverse<FullPivHouseholderQR>} 
      \hyperlink{group___q_r___module_a352ce66397af06da214ddde343cec6f5}{inverse}()\textcolor{keyword}{ const}
00313 \textcolor{keyword}{    }\{
00314       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00315       \textcolor{keywordflow}{return} \hyperlink{class_eigen_1_1_inverse}{Inverse<FullPivHouseholderQR>}(*this);
00316     \}
00317 
00318     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.rows(); \}
00319     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.cols(); \}
00320     
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00325}\hyperlink{group___q_r___module_a874fcd822871010f7961d9e94f1767e4}{00325}     \textcolor{keyword}{const} HCoeffsType& \hyperlink{group___q_r___module_a874fcd822871010f7961d9e94f1767e4}{hCoeffs}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hCoeffs; \}
00326 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00344}\hyperlink{group___q_r___module_a92277e572bf98245891015d12dd2b602}{00344}     \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR}& \hyperlink{group___q_r___module_a92277e572bf98245891015d12dd2b602}{setThreshold}(\textcolor{keyword}{const} RealScalar& threshold)
00345     \{
00346       m\_usePrescribedThreshold = \textcolor{keyword}{true};
00347       m\_prescribedThreshold = threshold;
00348       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00349     \}
00350 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00359}\hyperlink{group___q_r___module_aaea4bf3dd145e0cddb16e364cca9d887}{00359}     \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR}& \hyperlink{group___q_r___module_aaea4bf3dd145e0cddb16e364cca9d887}{setThreshold}(Default\_t)
00360     \{
00361       m\_usePrescribedThreshold = \textcolor{keyword}{false};
00362       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00363     \}
00364 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00369}\hyperlink{group___q_r___module_af7f6ac15ca19c2b9e45dc3eaae58c201}{00369}     RealScalar \hyperlink{group___q_r___module_af7f6ac15ca19c2b9e45dc3eaae58c201}{threshold}()\textcolor{keyword}{ const}
00370 \textcolor{keyword}{    }\{
00371       eigen\_assert(m\_isInitialized || m\_usePrescribedThreshold);
00372       \textcolor{keywordflow}{return} m\_usePrescribedThreshold ? m\_prescribedThreshold
00373       \textcolor{comment}{// this formula comes from experimenting (see "LU precision tuning" thread on the list)}
00374       \textcolor{comment}{// and turns out to be identical to Higham's formula used already in LDLt.}
00375                                       : \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::epsilon}() * RealScalar
      (m\_qr.diagonalSize());
00376     \}
00377 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00385}\hyperlink{group___q_r___module_af1e4d04824084a964c1a6e51db68376f}{00385}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_af1e4d04824084a964c1a6e51db68376f}{nonzeroPivots}()\textcolor{keyword}{ const}
00386 \textcolor{keyword}{    }\{
00387       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LU is not initialized."});
00388       \textcolor{keywordflow}{return} m\_nonzero\_pivots;
00389     \}
00390 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_q_r_2_full_piv_householder_q_r_8h_source_l00394}\hyperlink{group___q_r___module_a7887506237a3bf912aebc9aaa8edacec}{00394}     RealScalar \hyperlink{group___q_r___module_a7887506237a3bf912aebc9aaa8edacec}{maxPivot}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_maxpivot; \}
00395     
00396 \textcolor{preprocessor}{    #ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00397     \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00398     EIGEN\_DEVICE\_FUNC
00399     \textcolor{keywordtype}{void} \_solve\_impl(\textcolor{keyword}{const} RhsType &rhs, DstType &dst) \textcolor{keyword}{const};
00400 \textcolor{preprocessor}{    #endif}
00401 
00402   \textcolor{keyword}{protected}:
00403     
00404     \textcolor{keyword}{static} \textcolor{keywordtype}{void} check\_template\_parameters()
00405     \{
00406       EIGEN\_STATIC\_ASSERT\_NON\_INTEGER(Scalar);
00407     \}
00408     
00409     \textcolor{keywordtype}{void} computeInPlace();
00410     
00411     MatrixType m\_qr;
00412     HCoeffsType m\_hCoeffs;
00413     IntDiagSizeVectorType m\_rows\_transpositions;
00414     IntDiagSizeVectorType m\_cols\_transpositions;
00415     PermutationType m\_cols\_permutation;
00416     RowVectorType m\_temp;
00417     \textcolor{keywordtype}{bool} m\_isInitialized, m\_usePrescribedThreshold;
00418     RealScalar m\_prescribedThreshold, m\_maxpivot;
00419     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_nonzero\_pivots;
00420     RealScalar m\_precision;
00421     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_det\_pq;
00422 \};
00423 
00424 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00425 \textcolor{keyword}{typename} MatrixType::RealScalar \hyperlink{group___q_r___module_a1029e1ccc70bb8669043c5775e7f3b75}{FullPivHouseholderQR<MatrixType>::absDeterminant}
      ()\textcolor{keyword}{ const}
00426 \textcolor{keyword}{}\{
00427   \textcolor{keyword}{using} std::abs;
00428   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00429   eigen\_assert(m\_qr.rows() == m\_qr.cols() && \textcolor{stringliteral}{"You can't take the determinant of a non-square matrix!"});
00430   \textcolor{keywordflow}{return} abs(m\_qr.diagonal().prod());
00431 \}
00432 
00433 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00434 \textcolor{keyword}{typename} MatrixType::RealScalar 
      \hyperlink{group___q_r___module_aafde38918912c9b562f44b0fc3b22589}{FullPivHouseholderQR<MatrixType>::logAbsDeterminant}()\textcolor{keyword}{
       const}
00435 \textcolor{keyword}{}\{
00436   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00437   eigen\_assert(m\_qr.rows() == m\_qr.cols() && \textcolor{stringliteral}{"You can't take the determinant of a non-square matrix!"});
00438   \textcolor{keywordflow}{return} m\_qr.diagonal().cwiseAbs().array().log().sum();
00439 \}
00440 
00447 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00448 \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
00449 \hyperlink{group___q_r___module}{FullPivHouseholderQR<MatrixType>}& 
      \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>::compute}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00450 \{
00451   m\_qr = matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}();
00452   computeInPlace();
00453   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00454 \}
00455 
00456 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00457 \textcolor{keywordtype}{void} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>::computeInPlace}()
00458 \{
00459   check\_template\_parameters();
00460 
00461   \textcolor{keyword}{using} std::abs;
00462   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows = m\_qr.rows();
00463   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols = m\_qr.cols();
00464   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = (std::min)(rows,cols);
00465 
00466   
00467   m\_hCoeffs.resize(size);
00468 
00469   m\_temp.resize(cols);
00470 
00471   m\_precision = \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::epsilon}() * RealScalar(size);
00472 
00473   m\_rows\_transpositions.resize(size);
00474   m\_cols\_transpositions.resize(size);
00475   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} number\_of\_transpositions = 0;
00476 
00477   RealScalar biggest(0);
00478 
00479   m\_nonzero\_pivots = size; \textcolor{comment}{// the generic case is that in which all pivots are nonzero (invertible case)}
00480   m\_maxpivot = RealScalar(0);
00481 
00482   \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < size; ++k)
00483   \{
00484     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row\_of\_biggest\_in\_corner, col\_of\_biggest\_in\_corner;
00485     \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1scalar__score__coeff__op}{internal::scalar\_score\_coeff\_op<Scalar>} Scoring;
00486     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Scoring::result\_type Score;
00487 
00488     Score score = m\_qr.bottomRightCorner(rows-k, cols-k)
00489                       .unaryExpr(Scoring())
00490                       .maxCoeff(&row\_of\_biggest\_in\_corner, &col\_of\_biggest\_in\_corner);
00491     row\_of\_biggest\_in\_corner += k;
00492     col\_of\_biggest\_in\_corner += k;
00493     RealScalar biggest\_in\_corner = \hyperlink{struct_eigen_1_1internal_1_1abs__knowing__score}{internal::abs\_knowing\_score<Scalar>}()
      (m\_qr(row\_of\_biggest\_in\_corner, col\_of\_biggest\_in\_corner), score);
00494     \textcolor{keywordflow}{if}(k==0) biggest = biggest\_in\_corner;
00495 
00496     \textcolor{comment}{// if the corner is negligible, then we have less than full rank, and we can finish early}
00497     \textcolor{keywordflow}{if}(internal::isMuchSmallerThan(biggest\_in\_corner, biggest, m\_precision))
00498     \{
00499       m\_nonzero\_pivots = k;
00500       \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = k; i < size; i++)
00501       \{
00502         m\_rows\_transpositions.coeffRef(i) = i;
00503         m\_cols\_transpositions.coeffRef(i) = i;
00504         m\_hCoeffs.coeffRef(i) = Scalar(0);
00505       \}
00506       \textcolor{keywordflow}{break};
00507     \}
00508 
00509     m\_rows\_transpositions.coeffRef(k) = row\_of\_biggest\_in\_corner;
00510     m\_cols\_transpositions.coeffRef(k) = col\_of\_biggest\_in\_corner;
00511     \textcolor{keywordflow}{if}(k != row\_of\_biggest\_in\_corner) \{
00512       m\_qr.row(k).tail(cols-k).swap(m\_qr.row(row\_of\_biggest\_in\_corner).tail(cols-k));
00513       ++number\_of\_transpositions;
00514     \}
00515     \textcolor{keywordflow}{if}(k != col\_of\_biggest\_in\_corner) \{
00516       m\_qr.col(k).swap(m\_qr.col(col\_of\_biggest\_in\_corner));
00517       ++number\_of\_transpositions;
00518     \}
00519 
00520     RealScalar beta;
00521     m\_qr.col(k).tail(rows-k).makeHouseholderInPlace(m\_hCoeffs.coeffRef(k), beta);
00522     m\_qr.coeffRef(k,k) = beta;
00523 
00524     \textcolor{comment}{// remember the maximum absolute value of diagonal coefficients}
00525     \textcolor{keywordflow}{if}(abs(beta) > m\_maxpivot) m\_maxpivot = abs(beta);
00526 
00527     m\_qr.bottomRightCorner(rows-k, cols-k-1)
00528         .applyHouseholderOnTheLeft(m\_qr.col(k).tail(rows-k-1), m\_hCoeffs.coeffRef(k), &m\_temp.coeffRef(k+1)
      );
00529   \}
00530 
00531   m\_cols\_permutation.setIdentity(cols);
00532   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < size; ++k)
00533     m\_cols\_permutation.applyTranspositionOnTheRight(k, m\_cols\_transpositions.coeff(k));
00534 
00535   m\_det\_pq = (number\_of\_transpositions%2) ? -1 : 1;
00536   m\_isInitialized = \textcolor{keyword}{true};
00537 \}
00538 
00539 \textcolor{preprocessor}{#ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00540 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType>
00541 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00542 \textcolor{keywordtype}{void} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<\_MatrixType>::\_solve\_impl}(\textcolor{keyword}{const} 
      RhsType &rhs, DstType &dst)\textcolor{keyword}{ const}
00543 \textcolor{keyword}{}\{
00544   eigen\_assert(rhs.rows() == rows());
00545   \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} l\_rank = rank();
00546 
00547   \textcolor{comment}{// FIXME introduce nonzeroPivots() and use it here. and more generally,}
00548   \textcolor{comment}{// make the same improvements in this dec as in FullPivLU.}
00549   \textcolor{keywordflow}{if}(l\_rank==0)
00550   \{
00551     dst.setZero();
00552     \textcolor{keywordflow}{return};
00553   \}
00554 
00555   \textcolor{keyword}{typename} RhsType::PlainObject c(rhs);
00556 
00557   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,1,RhsType::ColsAtCompileTime>} temp(rhs.cols());
00558   \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < l\_rank; ++k)
00559   \{
00560     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} remainingSize = rows()-k;
00561     c.row(k).swap(c.row(m\_rows\_transpositions.coeff(k)));
00562     c.bottomRightCorner(remainingSize, rhs.cols())
00563       .applyHouseholderOnTheLeft(m\_qr.col(k).tail(remainingSize-1),
00564                                m\_hCoeffs.coeff(k), &temp.coeffRef(0));
00565   \}
00566 
00567   m\_qr.topLeftCorner(l\_rank, l\_rank)
00568       .template triangularView<Upper>()
00569       .solveInPlace(c.topRows(l\_rank));
00570 
00571   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < l\_rank; ++i) dst.row(m\_cols\_permutation.indices().coeff(i)) = c.row(i);
00572   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = l\_rank; i < cols(); ++i) dst.row(m\_cols\_permutation.indices().coeff(i)).setZero();
00573 \}
00574 \textcolor{preprocessor}{#endif}
00575 
00576 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00577   
00578 \textcolor{keyword}{template}<\textcolor{keyword}{typename} DstXprType, \textcolor{keyword}{typename} MatrixType>
00579 \textcolor{keyword}{struct }Assignment<DstXprType, Inverse<FullPivHouseholderQR<MatrixType> >, internal::assign\_op<typename DstX
      prType::Scalar,typename FullPivHouseholderQR<MatrixType>::Scalar>, Dense2Dense>
00580 \{
00581   \textcolor{keyword}{typedef} \hyperlink{group___q_r___module}{FullPivHouseholderQR<MatrixType>} QrType;
00582   \textcolor{keyword}{typedef} \hyperlink{class_eigen_1_1_inverse}{Inverse<QrType>} SrcXprType;
00583   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(DstXprType &dst, \textcolor{keyword}{const} SrcXprType &src, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1assign__op}{internal::assign\_op<typename DstXprType::Scalar,typename QrType::Scalar>}
       &)
00584   \{    
00585     dst = src.nestedExpression().solve(MatrixType::Identity(src.rows(), src.cols()));
00586   \}
00587 \};
00588 
00595 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }FullPivHouseholderQRMatrixQReturnType
00596   : \textcolor{keyword}{public} \hyperlink{group___core___module_class_eigen_1_1_return_by_value}{ReturnByValue}<FullPivHouseholderQRMatrixQReturnType<MatrixType> >
00597 \{
00598 \textcolor{keyword}{public}:
00599   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>::IntDiagSizeVectorType}
       \hyperlink{group___core___module}{IntDiagSizeVectorType};
00600   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_diag\_type<MatrixType>::type} 
      \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{HCoeffsType};
00601   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix}<\textcolor{keyword}{typename} MatrixType::Scalar, 1, MatrixType::RowsAtCompileTime, 
      \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}, 1,
00602                  MatrixType::MaxRowsAtCompileTime> WorkVectorType;
00603 
00604   FullPivHouseholderQRMatrixQReturnType(\textcolor{keyword}{const} MatrixType&       qr,
00605                                         \textcolor{keyword}{const} HCoeffsType&      hCoeffs,
00606                                         \textcolor{keyword}{const} IntDiagSizeVectorType& rowsTranspositions)
00607     : m\_qr(qr),
00608       m\_hCoeffs(hCoeffs),
00609       m\_rowsTranspositions(rowsTranspositions)
00610   \{\}
00611 
00612   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResultType>
00613   \textcolor{keywordtype}{void} evalTo(ResultType& result)\textcolor{keyword}{ const}
00614 \textcolor{keyword}{  }\{
00615     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows = m\_qr.rows();
00616     WorkVectorType workspace(rows);
00617     evalTo(result, workspace);
00618   \}
00619 
00620   \textcolor{keyword}{template} <\textcolor{keyword}{typename} ResultType>
00621   \textcolor{keywordtype}{void} evalTo(ResultType& result, WorkVectorType& workspace)\textcolor{keyword}{ const}
00622 \textcolor{keyword}{  }\{
00623     \textcolor{keyword}{using} numext::conj;
00624     \textcolor{comment}{// compute the product H'\_0 H'\_1 ... H'\_n-1,}
00625     \textcolor{comment}{// where H\_k is the k-th Householder transformation I - h\_k v\_k v\_k'}
00626     \textcolor{comment}{// and v\_k is the k-th Householder vector [1,m\_qr(k+1,k), m\_qr(k+2,k), ...]}
00627     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows = m\_qr.rows();
00628     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols = m\_qr.cols();
00629     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = (std::min)(rows, cols);
00630     workspace.resize(rows);
00631     result.setIdentity(rows, rows);
00632     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = size-1; k >= 0; k--)
00633     \{
00634       result.block(k, k, rows-k, rows-k)
00635             .applyHouseholderOnTheLeft(m\_qr.col(k).tail(rows-k-1), conj(m\_hCoeffs.coeff(k)), &workspace.
      coeffRef(k));
00636       result.row(k).swap(result.row(m\_rowsTranspositions.coeff(k)));
00637     \}
00638   \}
00639 
00640   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.rows(); \}
00641   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.rows(); \}
00642 
00643 \textcolor{keyword}{protected}:
00644   \textcolor{keyword}{typename} MatrixType::Nested m\_qr;
00645   \textcolor{keyword}{typename} HCoeffsType::Nested m\_hCoeffs;
00646   \textcolor{keyword}{typename} IntDiagSizeVectorType::Nested m\_rowsTranspositions;
00647 \};
00648 
00649 \textcolor{comment}{// template<typename MatrixType>}
00650 \textcolor{comment}{// struct evaluator<FullPivHouseholderQRMatrixQReturnType<MatrixType> >}
00651 \textcolor{comment}{//  : public evaluator<ReturnByValue<FullPivHouseholderQRMatrixQReturnType<MatrixType> > >}
00652 \textcolor{comment}{// \{\};}
00653 
00654 \} \textcolor{comment}{// end namespace internal}
00655 
00656 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00657 \textcolor{keyword}{inline} \textcolor{keyword}{typename} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<MatrixType>::MatrixQReturnType}
       \hyperlink{group___q_r___module_ad26dd2d3c002939771d2375e4e051c28}{FullPivHouseholderQR<MatrixType>::matrixQ}()\textcolor{keyword}{ const}
00658 \textcolor{keyword}{}\{
00659   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"FullPivHouseholderQR is not initialized."});
00660   \textcolor{keywordflow}{return} \hyperlink{group___q_r___module_struct_eigen_1_1internal_1_1_full_piv_householder_q_r_matrix_q_return_type}{MatrixQReturnType}(m\_qr, m\_hCoeffs, m\_rows\_transpositions);
00661 \}
00662 
00667 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00668 \textcolor{keyword}{const} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<typename MatrixBase<Derived>::PlainObject}
      >
00669 \hyperlink{group___core___module_a863bc0e06b641a089508eabec6835ab2}{MatrixBase<Derived>::fullPivHouseholderQr}()\textcolor{keyword}{ const}
00670 \textcolor{keyword}{}\{
00671   \textcolor{keywordflow}{return} \hyperlink{group___q_r___module_class_eigen_1_1_full_piv_householder_q_r}{FullPivHouseholderQR<PlainObject>}(eval());
00672 \}
00673 
00674 \} \textcolor{comment}{// end namespace Eigen}
00675 
00676 \textcolor{preprocessor}{#endif // EIGEN\_FULLPIVOTINGHOUSEHOLDERQR\_H}
\end{DoxyCode}
