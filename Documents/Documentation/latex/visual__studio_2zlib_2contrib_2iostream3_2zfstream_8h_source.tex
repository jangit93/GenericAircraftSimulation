\hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source}{}\section{visual\+\_\+studio/zlib/contrib/iostream3/zfstream.h}
\label{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source}\index{zfstream.\+h@{zfstream.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ * A C++ I/O streams interface to the zlib gz* functions}
00003 \textcolor{comment}{ *}
00004 \textcolor{comment}{ * by Ludwig Schwardt <schwardt@sun.ac.za>}
00005 \textcolor{comment}{ * original version by Kevin Ruland <kevin@rodin.wustl.edu>}
00006 \textcolor{comment}{ *}
00007 \textcolor{comment}{ * This version is standard-compliant and compatible with gcc 3.x.}
00008 \textcolor{comment}{ */}
00009 
00010 \textcolor{preprocessor}{#ifndef ZFSTREAM\_H}
00011 \textcolor{preprocessor}{#define ZFSTREAM\_H}
00012 
00013 \textcolor{preprocessor}{#include <istream>}  \textcolor{comment}{// not iostream, since we don't need cin/cout}
00014 \textcolor{preprocessor}{#include <ostream>}
00015 \textcolor{preprocessor}{#include "zlib.h"}
00016 
00017 \textcolor{comment}{/*****************************************************************************/}
00018 
00027 \textcolor{keyword}{class }\hyperlink{classgzfilebuf}{gzfilebuf} : \textcolor{keyword}{public} std::streambuf
00028 \{
00029 \textcolor{keyword}{public}:
00030   \textcolor{comment}{//  Default constructor.}
00031   \hyperlink{classgzfilebuf}{gzfilebuf}();
00032 
00033   \textcolor{comment}{//  Destructor.}
00034   \textcolor{keyword}{virtual}
00035   ~\hyperlink{classgzfilebuf}{gzfilebuf}();
00036 
00048   \textcolor{keywordtype}{int}
00049   \hyperlink{classgzfilebuf_ad109ea4fc4ca7cc19d8014b53375255d}{setcompression}(\textcolor{keywordtype}{int} comp\_level,
00050                  \textcolor{keywordtype}{int} comp\_strategy = Z\_DEFAULT\_STRATEGY);
00051 
00056   \textcolor{keywordtype}{bool}
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00057}\hyperlink{classgzfilebuf_a24dfb3e35c147aaf3a562c1ea4268757}{00057}   \hyperlink{classgzfilebuf_a24dfb3e35c147aaf3a562c1ea4268757}{is\_open}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} (\hyperlink{structfile}{file} != NULL); \}
00058 
00065   \hyperlink{classgzfilebuf}{gzfilebuf}*
00066   open(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name,
00067        std::ios\_base::openmode mode);
00068 
00075   \hyperlink{classgzfilebuf}{gzfilebuf}*
00076   attach(\textcolor{keywordtype}{int} fd,
00077          std::ios\_base::openmode mode);
00078 
00083   \hyperlink{classgzfilebuf}{gzfilebuf}*
00084   close();
00085 
00086 \textcolor{keyword}{protected}:
00091   \textcolor{keywordtype}{bool}
00092   \hyperlink{classgzfilebuf_ab0c2c304183e591706681af26add3da2}{open\_mode}(std::ios\_base::openmode mode,
00093             \textcolor{keywordtype}{char}* c\_mode) \textcolor{keyword}{const};
00094 
00102   \textcolor{keyword}{virtual} std::streamsize
00103   \hyperlink{classgzfilebuf_afbe2418d8a9c3f4a321cc26aa4ae5f7a}{showmanyc}();
00104 
00112   \textcolor{keyword}{virtual} int\_type
00113   underflow();
00114 
00124   \textcolor{keyword}{virtual} int\_type
00125   overflow(int\_type c = traits\_type::eof());
00126 
00135   \textcolor{keyword}{virtual} std::streambuf*
00136   \hyperlink{classgzfilebuf_a856bc21f7cfc6ba43f017c9c3f0d5f81}{setbuf}(char\_type* p,
00137          std::streamsize n);
00138 
00145   \textcolor{keyword}{virtual} \textcolor{keywordtype}{int}
00146   sync();
00147 
00148 \textcolor{comment}{//}
00149 \textcolor{comment}{// Some future enhancements}
00150 \textcolor{comment}{//}
00151 \textcolor{comment}{//  virtual int\_type uflow();}
00152 \textcolor{comment}{//  virtual int\_type pbackfail(int\_type c = traits\_type::eof());}
00153 \textcolor{comment}{//  virtual pos\_type}
00154 \textcolor{comment}{//  seekoff(off\_type off,}
00155 \textcolor{comment}{//          std::ios\_base::seekdir way,}
00156 \textcolor{comment}{//          std::ios\_base::openmode mode = std::ios\_base::in|std::ios\_base::out);}
00157 \textcolor{comment}{//  virtual pos\_type}
00158 \textcolor{comment}{//  seekpos(pos\_type sp,}
00159 \textcolor{comment}{//          std::ios\_base::openmode mode = std::ios\_base::in|std::ios\_base::out);}
00160 
00161 \textcolor{keyword}{private}:
00170   \textcolor{keywordtype}{void}
00171   enable\_buffer();
00172 
00180   \textcolor{keywordtype}{void}
00181   disable\_buffer();
00182 
00186   \hyperlink{structgz_file__s}{gzFile} \hyperlink{structfile}{file};
00187 
00191   std::ios\_base::openmode io\_mode;
00192 
00199   \textcolor{keywordtype}{bool} own\_fd;
00200 
00207   char\_type* buffer;
00208 
00215   std::streamsize buffer\_size;
00216 
00223   \textcolor{keywordtype}{bool} own\_buffer;
00224 \};
00225 
00226 \textcolor{comment}{/*****************************************************************************/}
00227 
00234 \textcolor{keyword}{class }\hyperlink{classgzifstream}{gzifstream} : \textcolor{keyword}{public} std::istream
00235 \{
00236 \textcolor{keyword}{public}:
00237   \textcolor{comment}{//  Default constructor}
00238   \hyperlink{classgzifstream}{gzifstream}();
00239 
00245   \textcolor{keyword}{explicit}
00246   \hyperlink{classgzifstream}{gzifstream}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name,
00247              std::ios\_base::openmode mode = std::ios\_base::in);
00248 
00254   \textcolor{keyword}{explicit}
00255   \hyperlink{classgzifstream}{gzifstream}(\textcolor{keywordtype}{int} fd,
00256              std::ios\_base::openmode mode = std::ios\_base::in);
00257 
00261   \hyperlink{classgzfilebuf}{gzfilebuf}*
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00262}\hyperlink{classgzifstream_a1c5a0ab4f99f8d8e3406af7bfd82b133}{00262}   \hyperlink{classgzifstream_a1c5a0ab4f99f8d8e3406af7bfd82b133}{rdbuf}()\textcolor{keyword}{ const}
00263 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}\hyperlink{classgzfilebuf}{gzfilebuf}*\textcolor{keyword}{>}(&sb); \}
00264 
00269   \textcolor{keywordtype}{bool}
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00270}\hyperlink{classgzifstream_a8e9de13b311b698ef0ccc276b71c7941}{00270}   \hyperlink{classgzifstream_a8e9de13b311b698ef0ccc276b71c7941}{is\_open}() \{ \textcolor{keywordflow}{return} sb.is\_open(); \}
00271 
00284   \textcolor{keywordtype}{void}
00285   open(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name,
00286        std::ios\_base::openmode mode = std::ios\_base::in);
00287 
00296   \textcolor{keywordtype}{void}
00297   attach(\textcolor{keywordtype}{int} fd,
00298          std::ios\_base::openmode mode = std::ios\_base::in);
00299 
00305   \textcolor{keywordtype}{void}
00306   close();
00307 
00308 \textcolor{keyword}{private}:
00312   \hyperlink{classgzfilebuf}{gzfilebuf} sb;
00313 \};
00314 
00315 \textcolor{comment}{/*****************************************************************************/}
00316 
00323 \textcolor{keyword}{class }\hyperlink{classgzofstream}{gzofstream} : \textcolor{keyword}{public} std::ostream
00324 \{
00325 \textcolor{keyword}{public}:
00326   \textcolor{comment}{//  Default constructor}
00327   \hyperlink{classgzofstream}{gzofstream}();
00328 
00334   \textcolor{keyword}{explicit}
00335   \hyperlink{classgzofstream}{gzofstream}(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name,
00336              std::ios\_base::openmode mode = std::ios\_base::out);
00337 
00343   \textcolor{keyword}{explicit}
00344   \hyperlink{classgzofstream}{gzofstream}(\textcolor{keywordtype}{int} fd,
00345              std::ios\_base::openmode mode = std::ios\_base::out);
00346 
00350   \hyperlink{classgzfilebuf}{gzfilebuf}*
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00351}\hyperlink{classgzofstream_a2fef74202b114357f41cfeb28f1d2acc}{00351}   \hyperlink{classgzofstream_a2fef74202b114357f41cfeb28f1d2acc}{rdbuf}()\textcolor{keyword}{ const}
00352 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \textcolor{keyword}{const\_cast<}\hyperlink{classgzfilebuf}{gzfilebuf}*\textcolor{keyword}{>}(&sb); \}
00353 
00358   \textcolor{keywordtype}{bool}
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00359}\hyperlink{classgzofstream_acb1c9c6dccaf41bc5e44c2263ea48de3}{00359}   \hyperlink{classgzofstream_acb1c9c6dccaf41bc5e44c2263ea48de3}{is\_open}() \{ \textcolor{keywordflow}{return} sb.is\_open(); \}
00360 
00373   \textcolor{keywordtype}{void}
00374   open(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* name,
00375        std::ios\_base::openmode mode = std::ios\_base::out);
00376 
00385   \textcolor{keywordtype}{void}
00386   attach(\textcolor{keywordtype}{int} fd,
00387          std::ios\_base::openmode mode = std::ios\_base::out);
00388 
00394   \textcolor{keywordtype}{void}
00395   close();
00396 
00397 \textcolor{keyword}{private}:
00401   \hyperlink{classgzfilebuf}{gzfilebuf} sb;
00402 \};
00403 
00404 \textcolor{comment}{/*****************************************************************************/}
00405 
00412 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>
\Hypertarget{visual__studio_2zlib_2contrib_2iostream3_2zfstream_8h_source_l00413}\hyperlink{classgzomanip2}{00413}   \textcolor{keyword}{class }\hyperlink{classgzomanip2}{gzomanip2}
00414   \{
00415   \textcolor{keyword}{public}:
00416     \textcolor{comment}{// Allows insertor to peek at internals}
00417     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Ta, \textcolor{keyword}{typename} Tb>
00418       \textcolor{keyword}{friend} \hyperlink{classgzofstream}{gzofstream}&
00419       operator<<(\hyperlink{classgzofstream}{gzofstream}&,
00420                  \textcolor{keyword}{const} \hyperlink{classgzomanip2}{gzomanip2<Ta,Tb>}&);
00421 
00422     \textcolor{comment}{// Constructor}
00423     \hyperlink{classgzomanip2}{gzomanip2}(\hyperlink{classgzofstream}{gzofstream}& (*f)(\hyperlink{classgzofstream}{gzofstream}&, T1, T2),
00424               T1 v1,
00425               T2 v2);
00426   \textcolor{keyword}{private}:
00427     \textcolor{comment}{// Underlying manipulator function}
00428     \hyperlink{classgzofstream}{gzofstream}&
00429     (*func)(\hyperlink{classgzofstream}{gzofstream}&, T1, T2);
00430 
00431     \textcolor{comment}{// Arguments for manipulator function}
00432     T1 val1;
00433     T2 val2;
00434   \};
00435 
00436 \textcolor{comment}{/*****************************************************************************/}
00437 
00438 \textcolor{comment}{// Manipulator function thunks through to stream buffer}
00439 \textcolor{keyword}{inline} \hyperlink{classgzofstream}{gzofstream}&
00440 \hyperlink{classgzfilebuf_ad109ea4fc4ca7cc19d8014b53375255d}{setcompression}(\hyperlink{classgzofstream}{gzofstream} &gzs, \textcolor{keywordtype}{int} l, \textcolor{keywordtype}{int} s = Z\_DEFAULT\_STRATEGY)
00441 \{
00442   (gzs.\hyperlink{classgzofstream_a2fef74202b114357f41cfeb28f1d2acc}{rdbuf}())->\hyperlink{classgzfilebuf_ad109ea4fc4ca7cc19d8014b53375255d}{setcompression}(l, s);
00443   \textcolor{keywordflow}{return} gzs;
00444 \}
00445 
00446 \textcolor{comment}{// Manipulator constructor stores arguments}
00447 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>
00448   \textcolor{keyword}{inline}
00449   \hyperlink{classgzomanip2}{gzomanip2<T1,T2>::gzomanip2}(\hyperlink{classgzofstream}{gzofstream} &(*f)(
      \hyperlink{classgzofstream}{gzofstream} &, T1, T2),
00450                               T1 v1,
00451                               T2 v2)
00452   : \hyperlink{structfunc}{func}(f), val1(v1), val2(v2)
00453   \{ \}
00454 
00455 \textcolor{comment}{// Insertor applies underlying manipulator function to stream}
00456 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T1, \textcolor{keyword}{typename} T2>
00457   \textcolor{keyword}{inline} \hyperlink{classgzofstream}{gzofstream}&
00458   operator<<(gzofstream& s, const gzomanip2<T1,T2>& m)
00459   \{ \textcolor{keywordflow}{return} (*m.func)(s, m.val1, m.val2); \}
00460 
00461 \textcolor{comment}{// Insert this onto stream to simplify setting of compression level}
00462 \textcolor{keyword}{inline} \hyperlink{classgzomanip2}{gzomanip2<int,int>}
00463 \hyperlink{classgzfilebuf_ad109ea4fc4ca7cc19d8014b53375255d}{setcompression}(\textcolor{keywordtype}{int} l, \textcolor{keywordtype}{int} s = Z\_DEFAULT\_STRATEGY)
00464 \{ \textcolor{keywordflow}{return} \hyperlink{classgzomanip2}{gzomanip2<int,int>}(&\hyperlink{classgzfilebuf_ad109ea4fc4ca7cc19d8014b53375255d}{setcompression}, l, s); \}
00465 
00466 \textcolor{preprocessor}{#endif // ZFSTREAM\_H}
\end{DoxyCode}
