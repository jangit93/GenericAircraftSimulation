\hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source}{}\section{eigen/\+Eigen/src/\+Core/\+Visitor.h}
\label{eigen_2_eigen_2src_2_core_2_visitor_8h_source}\index{Visitor.\+h@{Visitor.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_VISITOR\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_VISITOR\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00017 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Visitor, \textcolor{keyword}{typename} Derived, \textcolor{keywordtype}{int} UnrollCount>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00018}\hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{00018} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{visitor\_impl}
00019 \{
00020   \textcolor{keyword}{enum} \{
00021     col = (UnrollCount-1) / Derived::RowsAtCompileTime,
00022     row = (UnrollCount-1) % Derived::RowsAtCompileTime
00023   \};
00024 
00025   EIGEN\_DEVICE\_FUNC
00026   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} run(\textcolor{keyword}{const} Derived &mat, Visitor& visitor)
00027   \{
00028     \hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{visitor\_impl<Visitor, Derived, UnrollCount-1>::run}(
      mat, visitor);
00029     visitor(mat.coeff(row, col), row, col);
00030   \}
00031 \};
00032 
00033 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Visitor, \textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00034}\hyperlink{struct_eigen_1_1internal_1_1visitor__impl_3_01_visitor_00_01_derived_00_011_01_4}{00034} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{visitor\_impl}<Visitor, Derived, 1>
00035 \{
00036   EIGEN\_DEVICE\_FUNC
00037   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} run(\textcolor{keyword}{const} Derived &mat, Visitor& visitor)
00038   \{
00039     \textcolor{keywordflow}{return} visitor.init(mat.coeff(0, 0), 0, 0);
00040   \}
00041 \};
00042 
00043 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Visitor, \textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00044}\hyperlink{struct_eigen_1_1internal_1_1visitor__impl_3_01_visitor_00_01_derived_00_01_dynamic_01_4}{00044} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{visitor\_impl}<Visitor, Derived, \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}>
00045 \{
00046   EIGEN\_DEVICE\_FUNC
00047   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} run(\textcolor{keyword}{const} Derived& mat, Visitor& visitor)
00048   \{
00049     visitor.init(mat.coeff(0,0), 0, 0);
00050     \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 1; i < mat.rows(); ++i)
00051       visitor(mat.coeff(i, 0), i, 0);
00052     \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = 1; j < mat.cols(); ++j)
00053       \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < mat.rows(); ++i)
00054         visitor(mat.coeff(i, j), i, j);
00055   \}
00056 \};
00057 
00058 \textcolor{comment}{// evaluator adaptor}
00059 \textcolor{keyword}{template}<\textcolor{keyword}{typename} XprType>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00060}\hyperlink{class_eigen_1_1internal_1_1visitor__evaluator}{00060} \textcolor{keyword}{class }\hyperlink{class_eigen_1_1internal_1_1visitor__evaluator}{visitor\_evaluator}
00061 \{
00062 \textcolor{keyword}{public}:
00063   EIGEN\_DEVICE\_FUNC
00064   \textcolor{keyword}{explicit} \hyperlink{class_eigen_1_1internal_1_1visitor__evaluator}{visitor\_evaluator}(\textcolor{keyword}{const} XprType &xpr) : m\_evaluator(xpr), m\_xpr(xpr) \{\}
00065   
00066   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} XprType::Scalar Scalar;
00067   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} XprType::CoeffReturnType CoeffReturnType;
00068   
00069   \textcolor{keyword}{enum} \{
00070     RowsAtCompileTime = XprType::RowsAtCompileTime,
00071     CoeffReadCost = \hyperlink{struct_eigen_1_1internal_1_1evaluator}{internal::evaluator<XprType>::CoeffReadCost}
00072   \};
00073   
00074   EIGEN\_DEVICE\_FUNC \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_xpr.rows(); \}
00075   EIGEN\_DEVICE\_FUNC \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_xpr.cols(); \}
00076   EIGEN\_DEVICE\_FUNC \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_xpr.size(); \}
00077 
00078   EIGEN\_DEVICE\_FUNC CoeffReturnType coeff(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} col)\textcolor{keyword}{ const}
00079 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} m\_evaluator.coeff(row, col); \}
00080   
00081 \textcolor{keyword}{protected}:
00082   \hyperlink{struct_eigen_1_1internal_1_1evaluator}{internal::evaluator<XprType>} m\_evaluator;
00083   \textcolor{keyword}{const} XprType &m\_xpr;
00084 \};
00085 \} \textcolor{comment}{// end namespace internal}
00086 
00104 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00105 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Visitor>
00106 EIGEN\_DEVICE\_FUNC
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00107}\hyperlink{group___core___module_a7f73df3954a09c7ab0dca208b6b23ddd}{00107} \textcolor{keywordtype}{void} \hyperlink{group___core___module_a7f73df3954a09c7ab0dca208b6b23ddd}{DenseBase<Derived>::visit}(Visitor& visitor)\textcolor{keyword}{ const}
00108 \textcolor{keyword}{}\{
00109   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1visitor__evaluator}{internal::visitor\_evaluator<Derived>} ThisEvaluator;
00110   ThisEvaluator thisEval(derived());
00111   
00112   \textcolor{keyword}{enum} \{
00113     unroll =  SizeAtCompileTime != \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}
00114            && SizeAtCompileTime * ThisEvaluator::CoeffReadCost + (SizeAtCompileTime-1) * 
      \hyperlink{struct_eigen_1_1internal_1_1functor__traits}{internal::functor\_traits<Visitor>::Cost} <= EIGEN\_UNROLLING\_LIMIT
00115   \};
00116   \textcolor{keywordflow}{return} 
      \hyperlink{struct_eigen_1_1internal_1_1visitor__impl}{internal::visitor\_impl<Visitor, ThisEvaluator, unroll ? int(SizeAtCompileTime) : Dynamic>::run}
      (thisEval, visitor);
00117 \}
00118 
00119 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00120 
00124 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00125}\hyperlink{struct_eigen_1_1internal_1_1coeff__visitor}{00125} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1coeff__visitor}{coeff\_visitor}
00126 \{
00127   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Derived::Scalar Scalar;
00128   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, col;
00129   Scalar res;
00130   EIGEN\_DEVICE\_FUNC
00131   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{structinit}{init}(\textcolor{keyword}{const} Scalar& value, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j)
00132   \{
00133     res = value;
00134     row = i;
00135     col = j;
00136   \}
00137 \};
00138 
00144 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00145}\hyperlink{struct_eigen_1_1internal_1_1min__coeff__visitor}{00145} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1min__coeff__visitor}{min\_coeff\_visitor} : \hyperlink{struct_eigen_1_1internal_1_1coeff__visitor}{coeff\_visitor}<Derived>
00146 \{
00147   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Derived::Scalar Scalar;
00148   EIGEN\_DEVICE\_FUNC
00149   \textcolor{keywordtype}{void} operator() (\textcolor{keyword}{const} Scalar& value, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j)
00150   \{
00151     \textcolor{keywordflow}{if}(value < this->res)
00152     \{
00153       this->res = value;
00154       this->row = i;
00155       this->col = j;
00156     \}
00157   \}
00158 \};
00159 
00160 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00161}\hyperlink{struct_eigen_1_1internal_1_1functor__traits_3_01min__coeff__visitor_3_01_scalar_01_4_01_4}{00161} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{functor\_traits}<\hyperlink{struct_eigen_1_1internal_1_1min__coeff__visitor}{min\_coeff\_visitor}<Scalar> > \{
00162   \textcolor{keyword}{enum} \{
00163     Cost = \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::AddCost}
00164   \};
00165 \};
00166 
00172 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00173}\hyperlink{struct_eigen_1_1internal_1_1max__coeff__visitor}{00173} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1max__coeff__visitor}{max\_coeff\_visitor} : \hyperlink{struct_eigen_1_1internal_1_1coeff__visitor}{coeff\_visitor}<Derived>
00174 \{
00175   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Derived::Scalar Scalar; 
00176   EIGEN\_DEVICE\_FUNC
00177   \textcolor{keywordtype}{void} operator() (\textcolor{keyword}{const} Scalar& value, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j)
00178   \{
00179     \textcolor{keywordflow}{if}(value > this->res)
00180     \{
00181       this->res = value;
00182       this->row = i;
00183       this->col = j;
00184     \}
00185   \}
00186 \};
00187 
00188 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar>
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00189}\hyperlink{struct_eigen_1_1internal_1_1functor__traits_3_01max__coeff__visitor_3_01_scalar_01_4_01_4}{00189} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1functor__traits}{functor\_traits}<\hyperlink{struct_eigen_1_1internal_1_1max__coeff__visitor}{max\_coeff\_visitor}<Scalar> > \{
00190   \textcolor{keyword}{enum} \{
00191     Cost = \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::AddCost}
00192   \};
00193 \};
00194 
00195 \} \textcolor{comment}{// end namespace internal}
00196 
00203 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00204 \textcolor{keyword}{template}<\textcolor{keyword}{typename} IndexType>
00205 EIGEN\_DEVICE\_FUNC
00206 \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1traits}{internal::traits<Derived>::Scalar}
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00207}\hyperlink{group___core___module_a05044a037125e705d87bd28f678b914c}{00207} \hyperlink{group___core___module_a6634944be3d4fef551b57ffad30467f2}{DenseBase<Derived>::minCoeff}(IndexType* rowId, IndexType* colId)\textcolor{keyword}{ const}
00208 \textcolor{keyword}{}\{
00209   \hyperlink{struct_eigen_1_1internal_1_1min__coeff__visitor}{internal::min\_coeff\_visitor<Derived>} minVisitor;
00210   this->visit(minVisitor);
00211   *rowId = minVisitor.row;
00212   \textcolor{keywordflow}{if} (colId) *colId = minVisitor.col;
00213   \textcolor{keywordflow}{return} minVisitor.res;
00214 \}
00215 
00221 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00222 \textcolor{keyword}{template}<\textcolor{keyword}{typename} IndexType>
00223 EIGEN\_DEVICE\_FUNC
00224 \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1traits}{internal::traits<Derived>::Scalar}
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00225}\hyperlink{group___core___module_a7d6ebd550eaaee24fed7880c39ae3f35}{00225} \hyperlink{group___core___module_a6634944be3d4fef551b57ffad30467f2}{DenseBase<Derived>::minCoeff}(IndexType* index)\textcolor{keyword}{ const}
00226 \textcolor{keyword}{}\{
00227   EIGEN\_STATIC\_ASSERT\_VECTOR\_ONLY(Derived)
00228   \hyperlink{struct_eigen_1_1internal_1_1min__coeff__visitor}{internal::min\_coeff\_visitor<Derived>} minVisitor;
00229   this->visit(minVisitor);
00230   *index = IndexType((RowsAtCompileTime==1) ? minVisitor.col : minVisitor.row);
00231   \textcolor{keywordflow}{return} minVisitor.res;
00232 \}
00233 
00240 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00241 \textcolor{keyword}{template}<\textcolor{keyword}{typename} IndexType>
00242 EIGEN\_DEVICE\_FUNC
00243 \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1traits}{internal::traits<Derived>::Scalar}
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00244}\hyperlink{group___core___module_ab8318ab23b3d421b809fef0cb24f69e3}{00244} \hyperlink{group___core___module_ac0d151ec47eb7a44a3a5ba1587ddbeb4}{DenseBase<Derived>::maxCoeff}(IndexType* rowPtr, IndexType* colPtr)\textcolor{keyword}{ const}
00245 \textcolor{keyword}{}\{
00246   \hyperlink{struct_eigen_1_1internal_1_1max__coeff__visitor}{internal::max\_coeff\_visitor<Derived>} maxVisitor;
00247   this->visit(maxVisitor);
00248   *rowPtr = maxVisitor.row;
00249   \textcolor{keywordflow}{if} (colPtr) *colPtr = maxVisitor.col;
00250   \textcolor{keywordflow}{return} maxVisitor.res;
00251 \}
00252 
00258 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00259 \textcolor{keyword}{template}<\textcolor{keyword}{typename} IndexType>
00260 EIGEN\_DEVICE\_FUNC
00261 \textcolor{keyword}{typename} \hyperlink{struct_eigen_1_1internal_1_1traits}{internal::traits<Derived>::Scalar}
\Hypertarget{eigen_2_eigen_2src_2_core_2_visitor_8h_source_l00262}\hyperlink{group___core___module_ac7f03010f4e0891c90cdcfe123f45223}{00262} \hyperlink{group___core___module_ac0d151ec47eb7a44a3a5ba1587ddbeb4}{DenseBase<Derived>::maxCoeff}(IndexType* index)\textcolor{keyword}{ const}
00263 \textcolor{keyword}{}\{
00264   EIGEN\_STATIC\_ASSERT\_VECTOR\_ONLY(Derived)
00265   \hyperlink{struct_eigen_1_1internal_1_1max__coeff__visitor}{internal::max\_coeff\_visitor<Derived>} maxVisitor;
00266   this->visit(maxVisitor);
00267   *index = (RowsAtCompileTime==1) ? maxVisitor.col : maxVisitor.row;
00268   \textcolor{keywordflow}{return} maxVisitor.res;
00269 \}
00270 
00271 \} \textcolor{comment}{// end namespace Eigen}
00272 
00273 \textcolor{preprocessor}{#endif // EIGEN\_VISITOR\_H}
\end{DoxyCode}
