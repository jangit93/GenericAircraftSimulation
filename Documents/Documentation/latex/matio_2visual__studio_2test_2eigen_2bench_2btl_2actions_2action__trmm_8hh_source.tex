\hypertarget{matio_2visual__studio_2test_2eigen_2bench_2btl_2actions_2action__trmm_8hh_source}{}\section{matio/visual\+\_\+studio/test/eigen/bench/btl/actions/action\+\_\+trmm.hh}
\label{matio_2visual__studio_2test_2eigen_2bench_2btl_2actions_2action__trmm_8hh_source}\index{action\+\_\+trmm.\+hh@{action\+\_\+trmm.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  action\_matrix\_matrix\_product.hh}
00003 \textcolor{comment}{// Author :  L. Plagne <laurent.plagne@edf.fr)>}
00004 \textcolor{comment}{// Copyright (C) EDF R&D,  lun sep 30 14:23:19 CEST 2002}
00005 \textcolor{comment}{//=====================================================}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00008 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00009 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00010 \textcolor{comment}{// of the License, or (at your option) any later version.}
00011 \textcolor{comment}{//}
00012 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00013 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00014 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00015 \textcolor{comment}{// GNU General Public License for more details.}
00016 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00018 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00019 \textcolor{comment}{//}
00020 \textcolor{preprocessor}{#ifndef ACTION\_TRMM}
00021 \textcolor{preprocessor}{#define ACTION\_TRMM}
00022 \textcolor{preprocessor}{#include "utilities.h"}
00023 \textcolor{preprocessor}{#include "STL\_interface.hh"}
00024 \textcolor{preprocessor}{#include <string>}
00025 \textcolor{preprocessor}{#include "init/init\_function.hh"}
00026 \textcolor{preprocessor}{#include "init/init\_vector.hh"}
00027 \textcolor{preprocessor}{#include "init/init\_matrix.hh"}
00028 
00029 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00030 
00031 \textcolor{keyword}{template}<\textcolor{keyword}{class} Interface>
00032 \textcolor{keyword}{class }\hyperlink{class_action__trmm}{Action\_trmm} \{
00033 
00034 public :
00035 
00036   \textcolor{comment}{// Ctor}
00037 
00038   \hyperlink{class_action__trmm}{Action\_trmm}( \textcolor{keywordtype}{int} size ):\_size(size)
00039   \{
00040     MESSAGE(\textcolor{stringliteral}{"Action\_trmm Ctor"});
00041 
00042     \textcolor{comment}{// STL matrix and vector initialization}
00043 
00044     init\_matrix<pseudo\_random>(A\_stl,\_size);
00045     init\_matrix<pseudo\_random>(B\_stl,\_size);
00046     init\_matrix<null\_function>(X\_stl,\_size);
00047     init\_matrix<null\_function>(resu\_stl,\_size);
00048 
00049     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<\_size; ++j)
00050     \{
00051       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<j; ++i)
00052         A\_stl[j][i] = 0;
00053       A\_stl[j][j] += 3;
00054     \}
00055 
00056     \textcolor{comment}{// generic matrix and vector initialization}
00057 
00058     Interface::matrix\_from\_stl(A\_ref,A\_stl);
00059     Interface::matrix\_from\_stl(B\_ref,B\_stl);
00060     Interface::matrix\_from\_stl(X\_ref,X\_stl);
00061 
00062     Interface::matrix\_from\_stl(A,A\_stl);
00063     Interface::matrix\_from\_stl(B,B\_stl);
00064     Interface::matrix\_from\_stl(X,X\_stl);
00065 
00066     \_cost = 0;
00067     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<\_size; ++j)
00068     \{
00069       \_cost += 2*j + 1;
00070     \}
00071     \_cost *= \_size;
00072   \}
00073 
00074   \textcolor{comment}{// invalidate copy ctor}
00075 
00076   \hyperlink{class_action__trmm}{Action\_trmm}( \textcolor{keyword}{const}  \hyperlink{class_action__trmm}{Action\_trmm} & )
00077   \{
00078     INFOS(\textcolor{stringliteral}{"illegal call to Action\_trmm Copy Ctor"});
00079     exit(0);
00080   \}
00081 
00082   \textcolor{comment}{// Dtor}
00083 
00084   ~\hyperlink{class_action__trmm}{Action\_trmm}( \textcolor{keywordtype}{void} )\{
00085 
00086     MESSAGE(\textcolor{stringliteral}{"Action\_trmm Dtor"});
00087 
00088     \textcolor{comment}{// deallocation}
00089 
00090     Interface::free\_matrix(A,\_size);
00091     Interface::free\_matrix(B,\_size);
00092     Interface::free\_matrix(X,\_size);
00093 
00094     Interface::free\_matrix(A\_ref,\_size);
00095     Interface::free\_matrix(B\_ref,\_size);
00096     Interface::free\_matrix(X\_ref,\_size);
00097 
00098   \}
00099 
00100   \textcolor{comment}{// action name}
00101 
00102   \textcolor{keyword}{static} \textcolor{keyword}{inline} std::string name( \textcolor{keywordtype}{void} )
00103   \{
00104     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"trmm\_"}+Interface::name();
00105   \}
00106 
00107   \textcolor{keywordtype}{double} nb\_op\_base( \textcolor{keywordtype}{void} )\{
00108     \textcolor{keywordflow}{return} \_cost;
00109   \}
00110 
00111   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} initialize( \textcolor{keywordtype}{void} )\{
00112 
00113     Interface::copy\_matrix(A\_ref,A,\_size);
00114     Interface::copy\_matrix(B\_ref,B,\_size);
00115     Interface::copy\_matrix(X\_ref,X,\_size);
00116 
00117   \}
00118 
00119   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} calculate( \textcolor{keywordtype}{void} ) \{
00120       Interface::trmm(A,B,X,\_size);
00121   \}
00122 
00123   \textcolor{keywordtype}{void} check\_result( \textcolor{keywordtype}{void} )\{
00124 
00125     \textcolor{comment}{// calculation check}
00126 
00127 \textcolor{comment}{//     Interface::matrix\_to\_stl(X,resu\_stl);}
00128 \textcolor{comment}{//}
00129 \textcolor{comment}{//     STL\_interface<typename Interface::real\_type>::matrix\_matrix\_product(A\_stl,B\_stl,X\_stl,\_size);}
00130 \textcolor{comment}{//}
00131 \textcolor{comment}{//     typename Interface::real\_type error=}
00132 \textcolor{comment}{//       STL\_interface<typename Interface::real\_type>::norm\_diff(X\_stl,resu\_stl);}
00133 \textcolor{comment}{//}
00134 \textcolor{comment}{//     if (error>1.e-6)\{}
00135 \textcolor{comment}{//       INFOS("WRONG CALCULATION...residual=" << error);}
00136 \textcolor{comment}{// //       exit(1);}
00137 \textcolor{comment}{//     \}}
00138 
00139   \}
00140 
00141 private :
00142 
00143   \textcolor{keyword}{typename} Interface::stl\_matrix A\_stl;
00144   \textcolor{keyword}{typename} Interface::stl\_matrix B\_stl;
00145   \textcolor{keyword}{typename} Interface::stl\_matrix X\_stl;
00146   \textcolor{keyword}{typename} Interface::stl\_matrix resu\_stl;
00147 
00148   \textcolor{keyword}{typename} Interface::gene\_matrix A\_ref;
00149   \textcolor{keyword}{typename} Interface::gene\_matrix B\_ref;
00150   \textcolor{keyword}{typename} Interface::gene\_matrix X\_ref;
00151 
00152   \textcolor{keyword}{typename} Interface::gene\_matrix A;
00153   \textcolor{keyword}{typename} Interface::gene\_matrix B;
00154   \textcolor{keyword}{typename} Interface::gene\_matrix X;
00155 
00156   \textcolor{keywordtype}{int} \_size;
00157   \textcolor{keywordtype}{double} \_cost;
00158 
00159 \};
00160 
00161 
00162 \textcolor{preprocessor}{#endif}
00163 
00164 
00165 
\end{DoxyCode}
