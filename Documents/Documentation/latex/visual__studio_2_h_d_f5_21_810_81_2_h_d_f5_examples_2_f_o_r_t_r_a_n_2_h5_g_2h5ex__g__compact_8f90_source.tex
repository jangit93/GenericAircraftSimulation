\hypertarget{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_g_2h5ex__g__compact_8f90_source}{}\section{visual\+\_\+studio/\+H\+D\+F5/1.10.1/\+H\+D\+F5\+Examples/\+F\+O\+R\+T\+R\+A\+N/\+H5\+G/h5ex\+\_\+g\+\_\+compact.f90}
\label{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_g_2h5ex__g__compact_8f90_source}\index{h5ex\+\_\+g\+\_\+compact.\+f90@{h5ex\+\_\+g\+\_\+compact.\+f90}}

\begin{DoxyCode}
00001 \textcolor{comment}{!************************************************************}
00002 \textcolor{comment}{!}
00003 \textcolor{comment}{!  This example shows how to create "compact-or-indexed"}
00004 \textcolor{comment}{!  format groups, new to 1.8.  This example also illustrates}
00005 \textcolor{comment}{!  the space savings of compact groups by creating 2 files}
00006 \textcolor{comment}{!  which are identical except for the group format, and}
00007 \textcolor{comment}{!  displaying the file size of each.  Both files have one}
00008 \textcolor{comment}{!  empty group in the root group.}
00009 \textcolor{comment}{!}
00010 \textcolor{comment}{!  This file is intended for use with HDF5 Library verion 1.8}
00011 \textcolor{comment}{!}
00012 \textcolor{comment}{!************************************************************}
00013 
00014 \textcolor{keyword}{PROGRAM} main
00015 
00016   \textcolor{keywordtype}{USE }hdf5
00017   \textcolor{keywordtype}{IMPLICIT NONE}
00018 
00019   \textcolor{keywordtype}{CHARACTER(LEN=18)}, \textcolor{keywordtype}{PARAMETER} :: filename1 = \textcolor{stringliteral}{"h5ex\_g\_compact1.h5"}
00020   \textcolor{keywordtype}{CHARACTER(LEN=18)}, \textcolor{keywordtype}{PARAMETER} :: filename2 = \textcolor{stringliteral}{"h5ex\_g\_compact2.h5"}
00021   \textcolor{keywordtype}{CHARACTER(LEN=2)} , \textcolor{keywordtype}{PARAMETER} :: groupname  = \textcolor{stringliteral}{"G1"}
00022 
00023   \textcolor{keywordtype}{INTEGER(HID\_T)}   :: \hyperlink{structfile}{file}, group, fapl \textcolor{comment}{! handles}
00024   \textcolor{keywordtype}{INTEGER} :: hdferr
00025   \textcolor{keywordtype}{INTEGER} :: storage\_type \textcolor{comment}{! Type of storage for links in group:}
00026                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_COMPACT: Compact storage}
00027                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_DENSE: Indexed storage}
00028                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE: Symbol tables}
00029   \textcolor{keywordtype}{INTEGER} :: nlinks       \textcolor{comment}{! Number of links in group}
00030   \textcolor{keywordtype}{INTEGER} :: max\_corder   \textcolor{comment}{! Current maximum creation order value for group}
00031   \textcolor{keywordtype}{INTEGER(HSIZE\_T)} :: size
00032   \textcolor{comment}{!}
00033   \textcolor{comment}{! Initialize FORTRAN interface.}
00034   \textcolor{comment}{!}
00035   \textcolor{keyword}{CALL }h5open\_f(hdferr)
00036   \textcolor{comment}{!}
00037   \textcolor{comment}{! Create file 1.  This file will use original format groups.}
00038   \textcolor{comment}{!}
00039   \textcolor{keyword}{CALL }h5fcreate\_f(filename1, h5f\_acc\_trunc\_f, \hyperlink{structfile}{file}, hdferr)
00040   \textcolor{keyword}{CALL }h5gcreate\_f(\hyperlink{structfile}{file}, groupname, group, hdferr)
00041   \textcolor{comment}{!}
00042   \textcolor{comment}{! Obtain the group info and print the group storage type.}
00043   \textcolor{comment}{!}
00044   \textcolor{keyword}{CALL }h5gget\_info\_f(group, storage\_type, nlinks, max\_corder, hdferr)
00045 
00046   \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("Group storage type for ",A," is: ")'}, advance=\textcolor{stringliteral}{'NO'} ) filename1
00047 
00048   \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_compact\_f)\textcolor{keywordflow}{THEN}
00049      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_COMPACT\_F")'}) \textcolor{comment}{! New compact format}
00050   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_dense\_f)\textcolor{keywordflow}{THEN}
00051      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_DENSE\_F")'}) \textcolor{comment}{! New dense (indexed) format}
00052   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_symbol\_table\_f)\textcolor{keywordflow}{THEN}
00053      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE\_F")'}) \textcolor{comment}{! Original format}
00054 \textcolor{keywordflow}{  ENDIF}
00055   \textcolor{comment}{!}
00056   \textcolor{comment}{! Close and re-open file.  Needed to get the correct file size.}
00057   \textcolor{comment}{!}
00058   \textcolor{keyword}{CALL }h5gclose\_f(group, hdferr)
00059   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file} , hdferr)
00060   \textcolor{keyword}{CALL }h5fopen\_f(filename1, h5f\_acc\_rdonly\_f, \hyperlink{structfile}{file}, hdferr)
00061   \textcolor{comment}{!}
00062   \textcolor{comment}{! Obtain and print the file size.}
00063   \textcolor{comment}{!}
00064   \textcolor{keyword}{CALL }h5fget\_filesize\_f(\hyperlink{structfile}{file}, \textcolor{keyword}{size}, hdferr)
00065   \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("File size for ",A," is: ",i6," bytes",/)'}) filename1, \textcolor{keyword}{size}
00066   \textcolor{comment}{!}
00067   \textcolor{comment}{! Close filename1}
00068   \textcolor{comment}{!}
00069   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file}, hdferr)
00070   \textcolor{comment}{!}
00071   \textcolor{comment}{! Set file access property list to allow the latest file format.}
00072   \textcolor{comment}{! This will allow the library to create new compact format groups.}
00073   \textcolor{comment}{!}
00074   \textcolor{keyword}{CALL }h5pcreate\_f (h5p\_file\_access\_f, fapl, hdferr)
00075   \textcolor{keyword}{CALL }h5pset\_libver\_bounds\_f (fapl, h5f\_libver\_latest\_f, h5f\_libver\_latest\_f, hdferr)
00076   \textcolor{comment}{!}
00077   \textcolor{comment}{! Create file 2 using the new file access property list.}
00078   \textcolor{comment}{!}
00079   \textcolor{keyword}{CALL }h5fcreate\_f(filename2, h5f\_acc\_trunc\_f, \hyperlink{structfile}{file}, hdferr, access\_prp=fapl)
00080   \textcolor{keyword}{CALL }h5gcreate\_f(\hyperlink{structfile}{file}, groupname, group, hdferr)
00081   \textcolor{comment}{!}
00082   \textcolor{comment}{! Obtain the group info and print the group storage type.}
00083   \textcolor{comment}{!}
00084   \textcolor{keyword}{CALL }h5gget\_info\_f(group, storage\_type, nlinks, max\_corder, hdferr)
00085 
00086   \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("Group storage type for ",A," is: ")'}, advance=\textcolor{stringliteral}{'NO'} ) filename2
00087 
00088   \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_compact\_f)\textcolor{keywordflow}{THEN}
00089      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_COMPACT\_F")'}) \textcolor{comment}{! New compact format}
00090   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_dense\_f)\textcolor{keywordflow}{THEN}
00091      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_DENSE\_F")'}) \textcolor{comment}{! New dense (indexed) format}
00092   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_symbol\_table\_f)\textcolor{keywordflow}{THEN}
00093      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE\_F")'}) \textcolor{comment}{! Original format}
00094   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_unknown\_f)\textcolor{keywordflow}{THEN}
00095      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_UNKNOWN\_F")'}) \textcolor{comment}{! Unknown format}
00096 \textcolor{keywordflow}{  ENDIF}
00097   \textcolor{comment}{!}
00098   \textcolor{comment}{! Close and re-open file.  Needed to get the correct file size.}
00099   \textcolor{comment}{!}
00100   \textcolor{keyword}{CALL }h5gclose\_f(group, hdferr)
00101   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file} , hdferr)
00102   \textcolor{keyword}{CALL }h5fopen\_f(filename2, h5f\_acc\_rdonly\_f, \hyperlink{structfile}{file}, hdferr, fapl)
00103   \textcolor{comment}{!}
00104   \textcolor{comment}{! Obtain and print the file size.}
00105   \textcolor{comment}{!}
00106   \textcolor{keyword}{CALL }h5fget\_filesize\_f(\hyperlink{structfile}{file}, \textcolor{keyword}{size}, hdferr)
00107   \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("File size for ",A," is: ",i6,"bytes",/)'}) filename2, \textcolor{keyword}{size}
00108   \textcolor{comment}{!}
00109   \textcolor{comment}{! Close and release resources.}
00110   \textcolor{comment}{!}
00111   \textcolor{keyword}{CALL }h5pclose\_f(fapl, hdferr)
00112   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file}, hdferr)
00113 
00114 \textcolor{keyword}{END PROGRAM }main
\end{DoxyCode}
