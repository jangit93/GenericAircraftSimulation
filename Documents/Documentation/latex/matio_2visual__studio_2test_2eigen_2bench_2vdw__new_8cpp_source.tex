\hypertarget{matio_2visual__studio_2test_2eigen_2bench_2vdw__new_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/bench/vdw\+\_\+new.cpp}
\label{matio_2visual__studio_2test_2eigen_2bench_2vdw__new_8cpp_source}\index{vdw\+\_\+new.\+cpp@{vdw\+\_\+new.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include <iostream>}
00002 \textcolor{preprocessor}{#include <Eigen/Core>}
00003 
00004 \textcolor{keyword}{using namespace }\hyperlink{namespace_eigen}{Eigen};
00005 
00006 \textcolor{preprocessor}{#ifndef SCALAR}
00007 \textcolor{preprocessor}{#define SCALAR float}
00008 \textcolor{preprocessor}{#endif}
00009 
00010 \textcolor{preprocessor}{#ifndef SIZE}
00011 \textcolor{preprocessor}{#define SIZE 10000}
00012 \textcolor{preprocessor}{#endif}
00013 
00014 \textcolor{preprocessor}{#ifndef REPEAT}
00015 \textcolor{preprocessor}{#define REPEAT 10000}
00016 \textcolor{preprocessor}{#endif}
00017 
00018 \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<SCALAR, Eigen::Dynamic, 1>} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Vec};
00019 
00020 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00021 
00022 SCALAR E\_VDW(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Vec} &interactions1, \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Vec} &interactions2)
00023 \{
00024   \textcolor{keywordflow}{return} (interactions2.cwise()/interactions1)
00025          .cwise().cube()
00026          .cwise().square()
00027          .cwise().square()
00028          .sum();
00029 \}
00030 
00031 \textcolor{keywordtype}{int} main() 
00032 \{
00033   \textcolor{comment}{//}
00034   \textcolor{comment}{//          1   2   3   4  ... (interactions)}
00035   \textcolor{comment}{// ka       .   .   .   .  ...}
00036   \textcolor{comment}{// rab      .   .   .   .  ...}
00037   \textcolor{comment}{// energy   .   .   .   .  ...}
00038   \textcolor{comment}{// ...     ... ... ... ... ...}
00039   \textcolor{comment}{// (variables}
00040   \textcolor{comment}{//    for}
00041   \textcolor{comment}{// interaction)}
00042   \textcolor{comment}{//}
00043   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Vec} interactions1(SIZE), interactions2(SIZE); \textcolor{comment}{// SIZE is the number of vdw interactions in our system}
00044   \textcolor{comment}{// SetupCalculations()}
00045   SCALAR rab = 1.0;  
00046   interactions1.\hyperlink{class_eigen_1_1_plain_object_base_ac8dea1df3d92b752cc683ff42abf6f9b}{setConstant}(2.4);
00047   interactions2.\hyperlink{class_eigen_1_1_plain_object_base_ac8dea1df3d92b752cc683ff42abf6f9b}{setConstant}(rab);
00048   
00049   \textcolor{comment}{// Energy()}
00050   SCALAR energy = 0.0;
00051   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} i = 0; i<REPEAT; ++i) \{
00052     energy += E\_VDW(interactions1, interactions2);
00053     energy *= 1 + 1e-20 * i; \textcolor{comment}{// prevent compiler from optimizing the loop}
00054   \}
00055   cout << \textcolor{stringliteral}{"energy = "} << energy << endl;
00056 \}
\end{DoxyCode}
