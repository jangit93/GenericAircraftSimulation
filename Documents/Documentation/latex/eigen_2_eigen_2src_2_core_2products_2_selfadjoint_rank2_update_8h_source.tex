\hypertarget{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source}{}\section{eigen/\+Eigen/src/\+Core/products/\+Selfadjoint\+Rank2\+Update.h}
\label{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source}\index{Selfadjoint\+Rank2\+Update.\+h@{Selfadjoint\+Rank2\+Update.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_SELFADJOINTRANK2UPTADE\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_SELFADJOINTRANK2UPTADE\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00017 \textcolor{comment}{/* Optimized selfadjoint matrix += alpha * uv' + conj(alpha)*vu'}
00018 \textcolor{comment}{ * It corresponds to the Level2 syr2 BLAS routine}
00019 \textcolor{comment}{ */}
00020 
00021 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} UType, \textcolor{keyword}{typename} VType, \textcolor{keywordtype}{int} UpLo>
\Hypertarget{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source_l00022}\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector}{00022} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector}{selfadjoint\_rank2\_update\_selector};
00023 
00024 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} UType, \textcolor{keyword}{typename} VType>
\Hypertarget{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source_l00025}\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector_3_01_scalar_00_01_index_00_01_uf491e100c52e514fc778fd2dd4e730f2}{00025} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector}{selfadjoint\_rank2\_update\_selector}<Scalar,
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},UType,VType,\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}>
00026 \{
00027   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Scalar* mat, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride, \textcolor{keyword}{const} UType& u, \textcolor{keyword}{const} VType& v, \textcolor{keyword}{const} Scalar& alpha)
00028   \{
00029     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = u.size();
00030     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i=0; i<size; ++i)
00031     \{
00032       \hyperlink{group___core___module_class_eigen_1_1_map}{Map<Matrix<Scalar,Dynamic,1>} >(mat+stride*i+i, size-i) +=
00033                         (numext::conj(alpha) * numext::conj(u.coeff(i))) * v.tail(size-i)
00034                       + (alpha * numext::conj(v.coeff(i))) * u.tail(size-i);
00035     \}
00036   \}
00037 \};
00038 
00039 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} UType, \textcolor{keyword}{typename} VType>
\Hypertarget{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source_l00040}\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector_3_01_scalar_00_01_index_00_01_uf7a068ce7ab78b9bb81bd0ca858e99d2}{00040} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector}{selfadjoint\_rank2\_update\_selector}<Scalar,
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},UType,VType,\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}>
00041 \{
00042   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Scalar* mat, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride, \textcolor{keyword}{const} UType& u, \textcolor{keyword}{const} VType& v, \textcolor{keyword}{const} Scalar& alpha)
00043   \{
00044     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = u.size();
00045     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i=0; i<size; ++i)
00046       \hyperlink{group___core___module_class_eigen_1_1_map}{Map}<\hyperlink{group___core___module}{Matrix<Scalar,Dynamic,1>} >(mat+stride*i, i+1) +=
00047                         (numext::conj(alpha)  * numext::conj(u.coeff(i))) * v.head(i+1)
00048                       + (alpha * numext::conj(v.coeff(i))) * u.head(i+1);
00049   \}
00050 \};
00051 
\Hypertarget{eigen_2_eigen_2src_2_core_2products_2_selfadjoint_rank2_update_8h_source_l00052}\hyperlink{struct_eigen_1_1internal_1_1conj__expr__if}{00052} \textcolor{keyword}{template}<\textcolor{keywordtype}{bool} Cond, \textcolor{keyword}{typename} T> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__expr__if}{conj\_expr\_if}
00053   : \hyperlink{struct_eigen_1_1internal_1_1conditional}{conditional}<!Cond, const T&,
00054       CwiseUnaryOp<scalar\_conjugate\_op<typename traits<T>::Scalar>,T> > \{\};
00055 
00056 \} \textcolor{comment}{// end namespace internal}
00057 
00058 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} UpLo>
00059 \textcolor{keyword}{template}<\textcolor{keyword}{typename} DerivedU, \textcolor{keyword}{typename} DerivedV>
00060 \hyperlink{group___core___module_class_eigen_1_1_self_adjoint_view}{SelfAdjointView<MatrixType,UpLo>}& 
      \hyperlink{group___core___module_a4739585861baa13b25dcce5ed6658311}{SelfAdjointView<MatrixType,UpLo>}
00061 \hyperlink{group___core___module_a4739585861baa13b25dcce5ed6658311}{::rankUpdate}(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<DerivedU>}& u, \textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<DerivedV>}& v, \textcolor{keyword}{const} Scalar& alpha)
00062 \{
00063   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1blas__traits}{internal::blas\_traits<DerivedU>} UBlasTraits;
00064   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} UBlasTraits::DirectLinearAccessType ActualUType;
00065   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___sparse_core___module}{internal::remove\_all<ActualUType>::type} 
      \_ActualUType;
00066   \textcolor{keyword}{typename} \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<ActualUType>::type}
       actualU = UBlasTraits::extract(u.derived());
00067 
00068   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1blas__traits}{internal::blas\_traits<DerivedV>} VBlasTraits;
00069   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} VBlasTraits::DirectLinearAccessType ActualVType;
00070   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___sparse_core___module}{internal::remove\_all<ActualVType>::type} 
      \_ActualVType;
00071   \textcolor{keyword}{typename} \hyperlink{group___sparse_core___module}{internal::add\_const\_on\_value\_type<ActualVType>::type}
       actualV = VBlasTraits::extract(v.derived());
00072 
00073   \textcolor{comment}{// If MatrixType is row major, then we use the routine for lower triangular in the upper triangular case
       and}
00074   \textcolor{comment}{// vice versa, and take the complex conjugate of all coefficients and vector entries.}
00075 
00076   \textcolor{keyword}{enum} \{ IsRowMajor = (\hyperlink{struct_eigen_1_1internal_1_1traits}{internal::traits<MatrixType>::Flags}&
      \hyperlink{group__flags_gae4f56c2a60bbe4bd2e44c5b19cbe8762}{RowMajorBit}) ? 1 : 0 \};
00077   Scalar actualAlpha = alpha * UBlasTraits::extractScalarFactor(u.derived())
00078                              * numext::conj(VBlasTraits::extractScalarFactor(v.derived()));
00079   \textcolor{keywordflow}{if} (IsRowMajor)
00080     actualAlpha = numext::conj(actualAlpha);
00081 
00082   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} 
      \hyperlink{struct_eigen_1_1internal_1_1remove__all}{internal::remove\_all<typename internal::conj\_expr\_if<IsRowMajor ^
       UBlasTraits::NeedToConjugate,\_ActualUType>::type}
      >\hyperlink{group___sparse_core___module}{::type} UType;
00083   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} 
      \hyperlink{struct_eigen_1_1internal_1_1remove__all}{internal::remove\_all<typename internal::conj\_expr\_if<IsRowMajor ^
       VBlasTraits::NeedToConjugate,\_ActualVType>::type}
      >\hyperlink{group___sparse_core___module}{::type} VType;
00084   \hyperlink{struct_eigen_1_1internal_1_1selfadjoint__rank2__update__selector}{internal::selfadjoint\_rank2\_update\_selector}<Scalar, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}, UType, VType,
00085     (IsRowMajor ? int(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper} ? \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} : \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}) : UpLo)>
00086     ::run(\_expression().const\_cast\_derived().data(),\_expression().outerStride(),UType(actualU),VType(
      actualV),actualAlpha);
00087 
00088   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00089 \}
00090 
00091 \} \textcolor{comment}{// end namespace Eigen}
00092 
00093 \textcolor{preprocessor}{#endif // EIGEN\_SELFADJOINTRANK2UPTADE\_H}
\end{DoxyCode}
