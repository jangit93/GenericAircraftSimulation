\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2sblat1_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/sblat1.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2sblat1_8f_source}\index{sblat1.\+f@{sblat1.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b SBLAT1}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM SBLAT1}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*>    Test program for the REAL Level 1 BLAS.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*>    Based upon the original BLAS test routine together with:}
00022 \textcolor{comment}{*>    F06EAF Example Program Text}
00023 \textcolor{comment}{*> \(\backslash\)endverbatim}
00024 \textcolor{comment}{*}
00025 \textcolor{comment}{*  Authors:}
00026 \textcolor{comment}{*  ========}
00027 \textcolor{comment}{*}
00028 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00029 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00030 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00031 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00032 \textcolor{comment}{*}
00033 \textcolor{comment}{*> \(\backslash\)date April 2012}
00034 \textcolor{comment}{*}
00035 \textcolor{comment}{*> \(\backslash\)ingroup single\_blas\_testing}
00036 \textcolor{comment}{*}
00037 \textcolor{comment}{*  =====================================================================}
00038       \textcolor{keyword}{PROGRAM} sblat1
00039 \textcolor{comment}{*}
00040 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00041 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00042 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00043 \textcolor{comment}{*     April 2012}
00044 \textcolor{comment}{*}
00045 \textcolor{comment}{*  =====================================================================}
00046 \textcolor{comment}{*}
00047 \textcolor{comment}{*     .. Parameters ..}
00048       \textcolor{keywordtype}{INTEGER}          nout
00049       parameter(nout=6)
00050 \textcolor{comment}{*     .. Scalars in Common ..}
00051       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00052       \textcolor{keywordtype}{LOGICAL}          pass
00053 \textcolor{comment}{*     .. Local Scalars ..}
00054       \textcolor{keywordtype}{REAL}             sfac
00055       \textcolor{keywordtype}{INTEGER}          ic
00056 \textcolor{comment}{*     .. External Subroutines ..}
00057       \textcolor{keywordtype}{EXTERNAL}         check0, check1, check2, check3, header
00058 \textcolor{comment}{*     .. Common blocks ..}
00059       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00060 \textcolor{comment}{*     .. Data statements ..}
00061       \textcolor{keyword}{DATA}             sfac/9.765625e-4/
00062 \textcolor{comment}{*     .. Executable Statements ..}
00063       \textcolor{keyword}{WRITE} (nout,99999)
00064       \textcolor{keywordflow}{DO} 20 ic = 1, 13
00065          icase = ic
00066          \textcolor{keyword}{CALL }header
00067 \textcolor{comment}{*}
00068 \textcolor{comment}{*        .. Initialize  PASS,  INCX,  and INCY for a new case. ..}
00069 \textcolor{comment}{*        .. the value 9999 for INCX or INCY will appear in the ..}
00070 \textcolor{comment}{*        .. detailed  output, if any, for cases  that do not involve ..}
00071 \textcolor{comment}{*        .. these parameters ..}
00072 \textcolor{comment}{*}
00073          pass = .true.
00074          incx = 9999
00075          incy = 9999
00076          \textcolor{keywordflow}{IF} (icase.EQ.3 .OR. icase.EQ.11) \textcolor{keywordflow}{THEN}
00077             \textcolor{keyword}{CALL }check0(sfac)
00078          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.7 .OR. icase.EQ.8 .OR. icase.EQ.9 .OR.
00079      +            icase.EQ.10) \textcolor{keywordflow}{THEN}
00080             \textcolor{keyword}{CALL }check1(sfac)
00081          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.1 .OR. icase.EQ.2 .OR. icase.EQ.5 .OR.
00082      +            icase.EQ.6 .OR. icase.EQ.12 .OR. icase.EQ.13) \textcolor{keywordflow}{THEN}
00083             \textcolor{keyword}{CALL }check2(sfac)
00084          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.4) \textcolor{keywordflow}{THEN}
00085             \textcolor{keyword}{CALL }check3(sfac)
00086 \textcolor{keywordflow}{         END IF}
00087 \textcolor{comment}{*        -- Print}
00088          \textcolor{keywordflow}{IF} (pass) \textcolor{keyword}{WRITE} (nout,99998)
00089    20 \textcolor{keywordflow}{CONTINUE}
00090       stop
00091 \textcolor{comment}{*}
00092 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{' Real BLAS Test Program Results'},/1x)
00093 99998 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                    ----- PASS -----'})
00094 \textcolor{keyword}{      END}
00095 \textcolor{keyword}{      SUBROUTINE }header
00096 \textcolor{comment}{*     .. Parameters ..}
00097       \textcolor{keywordtype}{INTEGER}          nout
00098       parameter(nout=6)
00099 \textcolor{comment}{*     .. Scalars in Common ..}
00100       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00101       \textcolor{keywordtype}{LOGICAL}          pass
00102 \textcolor{comment}{*     .. Local Arrays ..}
00103       \textcolor{keywordtype}{CHARACTER*6}      l(13)
00104 \textcolor{comment}{*     .. Common blocks ..}
00105       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00106 \textcolor{comment}{*     .. Data statements ..}
00107       \textcolor{keyword}{DATA}             l(1)/\textcolor{stringliteral}{' SDOT '}/
00108       \textcolor{keyword}{DATA}             l(2)/\textcolor{stringliteral}{'SAXPY '}/
00109       \textcolor{keyword}{DATA}             l(3)/\textcolor{stringliteral}{'SROTG '}/
00110       \textcolor{keyword}{DATA}             l(4)/\textcolor{stringliteral}{' SROT '}/
00111       \textcolor{keyword}{DATA}             l(5)/\textcolor{stringliteral}{'SCOPY '}/
00112       \textcolor{keyword}{DATA}             l(6)/\textcolor{stringliteral}{'SSWAP '}/
00113       \textcolor{keyword}{DATA}             l(7)/\textcolor{stringliteral}{'SNRM2 '}/
00114       \textcolor{keyword}{DATA}             l(8)/\textcolor{stringliteral}{'SASUM '}/
00115       \textcolor{keyword}{DATA}             l(9)/\textcolor{stringliteral}{'SSCAL '}/
00116       \textcolor{keyword}{DATA}             l(10)/\textcolor{stringliteral}{'ISAMAX'}/
00117       \textcolor{keyword}{DATA}             l(11)/\textcolor{stringliteral}{'SROTMG'}/
00118       \textcolor{keyword}{DATA}             l(12)/\textcolor{stringliteral}{'SROTM '}/
00119       \textcolor{keyword}{DATA}             l(13)/\textcolor{stringliteral}{'SDSDOT'}/
00120 \textcolor{comment}{*     .. Executable Statements ..}
00121       \textcolor{keyword}{WRITE} (nout,99999) icase, l(icase)
00122       \textcolor{keywordflow}{RETURN}
00123 \textcolor{comment}{*}
00124 99999 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' Test of subprogram number'},i3,12x,a6)
00125 \textcolor{keyword}{      END}
00126 \textcolor{keyword}{      SUBROUTINE }check0(SFAC)
00127 \textcolor{comment}{*     .. Parameters ..}
00128       \textcolor{keywordtype}{INTEGER}           nout
00129       parameter(nout=6)
00130 \textcolor{comment}{*     .. Scalar Arguments ..}
00131       \textcolor{keywordtype}{REAL}              sfac
00132 \textcolor{comment}{*     .. Scalars in Common ..}
00133       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00134       \textcolor{keywordtype}{LOGICAL}           pass
00135 \textcolor{comment}{*     .. Local Scalars ..}
00136       \textcolor{keywordtype}{REAL}              d12, sa, sb, sc, ss
00137       \textcolor{keywordtype}{INTEGER}           i, k
00138 \textcolor{comment}{*     .. Local Arrays ..}
00139       \textcolor{keywordtype}{REAL}              da1(8), datrue(8), db1(8), dbtrue(8), dc1(8),
00140      +                  ds1(8), dab(4,9), dtemp(9), dtrue(9,9)
00141 \textcolor{comment}{*     .. External Subroutines ..}
00142       \textcolor{keywordtype}{EXTERNAL}          srotg, srotmg, stest1
00143 \textcolor{comment}{*     .. Common blocks ..}
00144       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00145 \textcolor{comment}{*     .. Data statements ..}
00146       \textcolor{keyword}{DATA}              da1/0.3e0, 0.4e0, -0.3e0, -0.4e0, -0.3e0, 0.0e0,
00147      +                  0.0e0, 1.0e0/
00148       \textcolor{keyword}{DATA}              db1/0.4e0, 0.3e0, 0.4e0, 0.3e0, -0.4e0, 0.0e0,
00149      +                  1.0e0, 0.0e0/
00150       \textcolor{keyword}{DATA}              dc1/0.6e0, 0.8e0, -0.6e0, 0.8e0, 0.6e0, 1.0e0,
00151      +                  0.0e0, 1.0e0/
00152       \textcolor{keyword}{DATA}              ds1/0.8e0, 0.6e0, 0.8e0, -0.6e0, 0.8e0, 0.0e0,
00153      +                  1.0e0, 0.0e0/
00154       \textcolor{keyword}{DATA}              datrue/0.5e0, 0.5e0, 0.5e0, -0.5e0, -0.5e0,
00155      +                  0.0e0, 1.0e0, 1.0e0/
00156       \textcolor{keyword}{DATA}              dbtrue/0.0e0, 0.6e0, 0.0e0, -0.6e0, 0.0e0,
00157      +                  0.0e0, 1.0e0, 0.0e0/
00158 \textcolor{comment}{*     INPUT FOR MODIFIED GIVENS}
00159       \textcolor{keyword}{DATA} dab/ .1e0,.3e0,1.2e0,.2e0,
00160      a          .7e0, .2e0, .6e0, 4.2e0,
00161      b          0.e0,0.e0,0.e0,0.e0,
00162      c          4.e0, -1.e0, 2.e0, 4.e0,
00163      d          6.e-10, 2.e-2, 1.e5, 10.e0,
00164      e          4.e10, 2.e-2, 1.e-5, 10.e0,
00165      f          2.e-10, 4.e-2, 1.e5, 10.e0,
00166      g          2.e10, 4.e-2, 1.e-5, 10.e0,
00167      h          4.e0, -2.e0, 8.e0, 4.e0    /
00168 \textcolor{comment}{*    TRUE RESULTS FOR MODIFIED GIVENS}
00169       \textcolor{keyword}{DATA} dtrue/0.e0,0.e0, 1.3e0, .2e0, 0.e0,0.e0,0.e0, .5e0, 0.e0,
00170      a           0.e0,0.e0, 4.5e0, 4.2e0, 1.e0, .5e0, 0.e0,0.e0,0.e0,
00171      b           0.e0,0.e0,0.e0,0.e0, -2.e0, 0.e0,0.e0,0.e0,0.e0,
00172      c           0.e0,0.e0,0.e0, 4.e0, -1.e0, 0.e0,0.e0,0.e0,0.e0,
00173      d           0.e0, 15.e-3, 0.e0, 10.e0, -1.e0, 0.e0, -1.e-4,
00174      e           0.e0, 1.e0,
00175      f           0.e0,0.e0, 6144.e-5, 10.e0, -1.e0, 4096.e0, -1.e6,
00176      g           0.e0, 1.e0,
00177      h           0.e0,0.e0,15.e0,10.e0,-1.e0, 5.e-5, 0.e0,1.e0,0.e0,
00178      i           0.e0,0.e0, 15.e0, 10.e0, -1. e0, 5.e5, -4096.e0,
00179      j           1.e0, 4096.e-6,
00180      k           0.e0,0.e0, 7.e0, 4.e0, 0.e0,0.e0, -.5e0, -.25e0, 0.e0/
00181 \textcolor{comment}{*                   4096 = 2 ** 12}
00182       \textcolor{keyword}{DATA} d12  /4096.e0/
00183       dtrue(1,1) = 12.e0 / 130.e0
00184       dtrue(2,1) = 36.e0 / 130.e0
00185       dtrue(7,1) = -1.e0 / 6.e0
00186       dtrue(1,2) = 14.e0 / 75.e0
00187       dtrue(2,2) = 49.e0 / 75.e0
00188       dtrue(9,2) = 1.e0 / 7.e0
00189       dtrue(1,5) = 45.e-11 * (d12 * d12)
00190       dtrue(3,5) = 4.e5 / (3.e0 * d12)
00191       dtrue(6,5) = 1.e0 / d12
00192       dtrue(8,5) = 1.e4 / (3.e0 * d12)
00193       dtrue(1,6) = 4.e10 / (1.5e0 * d12 * d12)
00194       dtrue(2,6) = 2.e-2 / 1.5e0
00195       dtrue(8,6) = 5.e-7 * d12
00196       dtrue(1,7) = 4.e0 / 150.e0
00197       dtrue(2,7) = (2.e-10 / 1.5e0) * (d12 * d12)
00198       dtrue(7,7) = -dtrue(6,5)
00199       dtrue(9,7) = 1.e4 / d12
00200       dtrue(1,8) = dtrue(1,7)
00201       dtrue(2,8) = 2.e10 / (1.5e0 * d12 * d12)
00202       dtrue(1,9) = 32.e0 / 7.e0
00203       dtrue(2,9) = -16.e0 / 7.e0
00204 \textcolor{comment}{*     .. Executable Statements ..}
00205 \textcolor{comment}{*}
00206 \textcolor{comment}{*     Compute true values which cannot be prestored}
00207 \textcolor{comment}{*     in decimal notation}
00208 \textcolor{comment}{*}
00209       dbtrue(1) = 1.0e0/0.6e0
00210       dbtrue(3) = -1.0e0/0.6e0
00211       dbtrue(5) = 1.0e0/0.6e0
00212 \textcolor{comment}{*}
00213       \textcolor{keywordflow}{DO} 20 k = 1, 8
00214 \textcolor{comment}{*        .. Set N=K for identification in output if any ..}
00215          n = k
00216          \textcolor{keywordflow}{IF} (icase.EQ.3) \textcolor{keywordflow}{THEN}
00217 \textcolor{comment}{*           .. SROTG ..}
00218             \textcolor{keywordflow}{IF} (k.GT.8) \textcolor{keywordflow}{GO TO} 40
00219             sa = da1(k)
00220             sb = db1(k)
00221             \textcolor{keyword}{CALL }srotg(sa,sb,sc,ss)
00222             \textcolor{keyword}{CALL }stest1(sa,datrue(k),datrue(k),sfac)
00223             \textcolor{keyword}{CALL }stest1(sb,dbtrue(k),dbtrue(k),sfac)
00224             \textcolor{keyword}{CALL }stest1(sc,dc1(k),dc1(k),sfac)
00225             \textcolor{keyword}{CALL }stest1(ss,ds1(k),ds1(k),sfac)
00226          \textcolor{keywordflow}{ELSEIF} (icase.EQ.11) \textcolor{keywordflow}{THEN}
00227 \textcolor{comment}{*           .. SROTMG ..}
00228             \textcolor{keywordflow}{DO} i=1,4
00229                dtemp(i)= dab(i,k)
00230                dtemp(i+4) = 0.0
00231 \textcolor{keywordflow}{            END DO}
00232             dtemp(9) = 0.0
00233             \textcolor{keyword}{CALL }srotmg(dtemp(1),dtemp(2),dtemp(3),dtemp(4),dtemp(5))
00234             \textcolor{keyword}{CALL }stest(9,dtemp,dtrue(1,k),dtrue(1,k),sfac)
00235          \textcolor{keywordflow}{ELSE}
00236             \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK0'}
00237             stop
00238 \textcolor{keywordflow}{         END IF}
00239    20 \textcolor{keywordflow}{CONTINUE}
00240    40 \textcolor{keywordflow}{RETURN}
00241 \textcolor{keyword}{      END}
00242 \textcolor{keyword}{      SUBROUTINE }check1(SFAC)
00243 \textcolor{comment}{*     .. Parameters ..}
00244       \textcolor{keywordtype}{INTEGER}           nout
00245       parameter(nout=6)
00246 \textcolor{comment}{*     .. Scalar Arguments ..}
00247       \textcolor{keywordtype}{REAL}              sfac
00248 \textcolor{comment}{*     .. Scalars in Common ..}
00249       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00250       \textcolor{keywordtype}{LOGICAL}           pass
00251 \textcolor{comment}{*     .. Local Scalars ..}
00252       \textcolor{keywordtype}{INTEGER}           i, len, np1
00253 \textcolor{comment}{*     .. Local Arrays ..}
00254       \textcolor{keywordtype}{REAL}              dtrue1(5), dtrue3(5), dtrue5(8,5,2), dv(8,5,2),
00255      +                  sa(10), stemp(1), strue(8), sx(8)
00256       \textcolor{keywordtype}{INTEGER}           itrue2(5)
00257 \textcolor{comment}{*     .. External Functions ..}
00258       \textcolor{keywordtype}{REAL}              sasum, snrm2
00259       \textcolor{keywordtype}{INTEGER}           isamax
00260       \textcolor{keywordtype}{EXTERNAL}          sasum, snrm2, isamax
00261 \textcolor{comment}{*     .. External Subroutines ..}
00262       \textcolor{keywordtype}{EXTERNAL}          itest1, sscal, stest, stest1
00263 \textcolor{comment}{*     .. Intrinsic Functions ..}
00264       \textcolor{keywordtype}{INTRINSIC}         max
00265 \textcolor{comment}{*     .. Common blocks ..}
00266       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00267 \textcolor{comment}{*     .. Data statements ..}
00268       \textcolor{keyword}{DATA}              sa/0.3e0, -1.0e0, 0.0e0, 1.0e0, 0.3e0, 0.3e0,
00269      +                  0.3e0, 0.3e0, 0.3e0, 0.3e0/
00270       \textcolor{keyword}{DATA}              dv/0.1e0, 2.0e0, 2.0e0, 2.0e0, 2.0e0, 2.0e0,
00271      +                  2.0e0, 2.0e0, 0.3e0, 3.0e0, 3.0e0, 3.0e0, 3.0e0,
00272      +                  3.0e0, 3.0e0, 3.0e0, 0.3e0, -0.4e0, 4.0e0,
00273      +                  4.0e0, 4.0e0, 4.0e0, 4.0e0, 4.0e0, 0.2e0,
00274      +                  -0.6e0, 0.3e0, 5.0e0, 5.0e0, 5.0e0, 5.0e0,
00275      +                  5.0e0, 0.1e0, -0.3e0, 0.5e0, -0.1e0, 6.0e0,
00276      +                  6.0e0, 6.0e0, 6.0e0, 0.1e0, 8.0e0, 8.0e0, 8.0e0,
00277      +                  8.0e0, 8.0e0, 8.0e0, 8.0e0, 0.3e0, 9.0e0, 9.0e0,
00278      +                  9.0e0, 9.0e0, 9.0e0, 9.0e0, 9.0e0, 0.3e0, 2.0e0,
00279      +                  -0.4e0, 2.0e0, 2.0e0, 2.0e0, 2.0e0, 2.0e0,
00280      +                  0.2e0, 3.0e0, -0.6e0, 5.0e0, 0.3e0, 2.0e0,
00281      +                  2.0e0, 2.0e0, 0.1e0, 4.0e0, -0.3e0, 6.0e0,
00282      +                  -0.5e0, 7.0e0, -0.1e0, 3.0e0/
00283       \textcolor{keyword}{DATA}              dtrue1/0.0e0, 0.3e0, 0.5e0, 0.7e0, 0.6e0/
00284       \textcolor{keyword}{DATA}              dtrue3/0.0e0, 0.3e0, 0.7e0, 1.1e0, 1.0e0/
00285       \textcolor{keyword}{DATA}              dtrue5/0.10e0, 2.0e0, 2.0e0, 2.0e0, 2.0e0,
00286      +                  2.0e0, 2.0e0, 2.0e0, -0.3e0, 3.0e0, 3.0e0,
00287      +                  3.0e0, 3.0e0, 3.0e0, 3.0e0, 3.0e0, 0.0e0, 0.0e0,
00288      +                  4.0e0, 4.0e0, 4.0e0, 4.0e0, 4.0e0, 4.0e0,
00289      +                  0.20e0, -0.60e0, 0.30e0, 5.0e0, 5.0e0, 5.0e0,
00290      +                  5.0e0, 5.0e0, 0.03e0, -0.09e0, 0.15e0, -0.03e0,
00291      +                  6.0e0, 6.0e0, 6.0e0, 6.0e0, 0.10e0, 8.0e0,
00292      +                  8.0e0, 8.0e0, 8.0e0, 8.0e0, 8.0e0, 8.0e0,
00293      +                  0.09e0, 9.0e0, 9.0e0, 9.0e0, 9.0e0, 9.0e0,
00294      +                  9.0e0, 9.0e0, 0.09e0, 2.0e0, -0.12e0, 2.0e0,
00295      +                  2.0e0, 2.0e0, 2.0e0, 2.0e0, 0.06e0, 3.0e0,
00296      +                  -0.18e0, 5.0e0, 0.09e0, 2.0e0, 2.0e0, 2.0e0,
00297      +                  0.03e0, 4.0e0, -0.09e0, 6.0e0, -0.15e0, 7.0e0,
00298      +                  -0.03e0, 3.0e0/
00299       \textcolor{keyword}{DATA}              itrue2/0, 1, 2, 2, 3/
00300 \textcolor{comment}{*     .. Executable Statements ..}
00301       \textcolor{keywordflow}{DO} 80 incx = 1, 2
00302          \textcolor{keywordflow}{DO} 60 np1 = 1, 5
00303             n = np1 - 1
00304             len = 2*max(n,1)
00305 \textcolor{comment}{*           .. Set vector arguments ..}
00306             \textcolor{keywordflow}{DO} 20 i = 1, len
00307                sx(i) = dv(i,np1,incx)
00308    20       \textcolor{keywordflow}{CONTINUE}
00309 \textcolor{comment}{*}
00310             \textcolor{keywordflow}{IF} (icase.EQ.7) \textcolor{keywordflow}{THEN}
00311 \textcolor{comment}{*              .. SNRM2 ..}
00312                stemp(1) = dtrue1(np1)
00313                \textcolor{keyword}{CALL }stest1(snrm2(n,sx,incx),stemp(1),stemp,sfac)
00314             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.8) \textcolor{keywordflow}{THEN}
00315 \textcolor{comment}{*              .. SASUM ..}
00316                stemp(1) = dtrue3(np1)
00317                \textcolor{keyword}{CALL }stest1(sasum(n,sx,incx),stemp(1),stemp,sfac)
00318             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.9) \textcolor{keywordflow}{THEN}
00319 \textcolor{comment}{*              .. SSCAL ..}
00320                \textcolor{keyword}{CALL }sscal(n,sa((incx-1)*5+np1),sx,incx)
00321                \textcolor{keywordflow}{DO} 40 i = 1, len
00322                   strue(i) = dtrue5(i,np1,incx)
00323    40          \textcolor{keywordflow}{CONTINUE}
00324                \textcolor{keyword}{CALL }stest(len,sx,strue,strue,sfac)
00325             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.10) \textcolor{keywordflow}{THEN}
00326 \textcolor{comment}{*              .. ISAMAX ..}
00327                \textcolor{keyword}{CALL }itest1(isamax(n,sx,incx),itrue2(np1))
00328             \textcolor{keywordflow}{ELSE}
00329                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK1'}
00330                stop
00331 \textcolor{keywordflow}{            END IF}
00332    60    \textcolor{keywordflow}{CONTINUE}
00333    80 \textcolor{keywordflow}{CONTINUE}
00334       \textcolor{keywordflow}{RETURN}
00335 \textcolor{keyword}{      END}
00336 \textcolor{keyword}{      SUBROUTINE }check2(SFAC)
00337 \textcolor{comment}{*     .. Parameters ..}
00338       \textcolor{keywordtype}{INTEGER}           nout
00339       parameter(nout=6)
00340 \textcolor{comment}{*     .. Scalar Arguments ..}
00341       \textcolor{keywordtype}{REAL}              sfac
00342 \textcolor{comment}{*     .. Scalars in Common ..}
00343       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00344       \textcolor{keywordtype}{LOGICAL}           pass
00345 \textcolor{comment}{*     .. Local Scalars ..}
00346       \textcolor{keywordtype}{REAL}              sa
00347       \textcolor{keywordtype}{INTEGER}           i, j, ki, kn, kni, kpar, ksize, lenx, leny,
00348      $                  mx, my 
00349 \textcolor{comment}{*     .. Local Arrays ..}
00350       \textcolor{keywordtype}{REAL}              dt10x(7,4,4), dt10y(7,4,4), dt7(4,4),
00351      $                  dt8(7,4,4), dx1(7),
00352      $                  dy1(7), ssize1(4), ssize2(14,2), ssize3(4),
00353      $                  ssize(7), stx(7), sty(7), sx(7), sy(7),
00354      $                  dpar(5,4), dt19x(7,4,16),dt19xa(7,4,4),
00355      $                  dt19xb(7,4,4), dt19xc(7,4,4),dt19xd(7,4,4),
00356      $                  dt19y(7,4,16), dt19ya(7,4,4),dt19yb(7,4,4),
00357      $                  dt19yc(7,4,4), dt19yd(7,4,4), dtemp(5),
00358      $                  st7b(4,4)
00359       \textcolor{keywordtype}{INTEGER}           incxs(4), incys(4), lens(4,2), ns(4)
00360 \textcolor{comment}{*     .. External Functions ..}
00361       \textcolor{keywordtype}{REAL}              sdot, sdsdot
00362       \textcolor{keywordtype}{EXTERNAL}          sdot, sdsdot
00363 \textcolor{comment}{*     .. External Subroutines ..}
00364       \textcolor{keywordtype}{EXTERNAL}          saxpy, scopy, srotm, sswap, stest, stest1
00365 \textcolor{comment}{*     .. Intrinsic Functions ..}
00366       \textcolor{keywordtype}{INTRINSIC}         abs, min
00367 \textcolor{comment}{*     .. Common blocks ..}
00368       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00369 \textcolor{comment}{*     .. Data statements ..}
00370       equivalence(dt19x(1,1,1),dt19xa(1,1,1)),(dt19x(1,1,5),
00371      a   dt19xb(1,1,1)),(dt19x(1,1,9),dt19xc(1,1,1)),
00372      b   (dt19x(1,1,13),dt19xd(1,1,1))
00373       equivalence(dt19y(1,1,1),dt19ya(1,1,1)),(dt19y(1,1,5),
00374      a   dt19yb(1,1,1)),(dt19y(1,1,9),dt19yc(1,1,1)),
00375      b   (dt19y(1,1,13),dt19yd(1,1,1))
00376 
00377       \textcolor{keyword}{DATA}              sa/0.3e0/
00378       \textcolor{keyword}{DATA}              incxs/1, 2, -2, -1/
00379       \textcolor{keyword}{DATA}              incys/1, -2, 1, -2/
00380       \textcolor{keyword}{DATA}              lens/1, 1, 2, 4, 1, 1, 3, 7/
00381       \textcolor{keyword}{DATA}              ns/0, 1, 2, 4/
00382       \textcolor{keyword}{DATA}              dx1/0.6e0, 0.1e0, -0.5e0, 0.8e0, 0.9e0, -0.3e0,
00383      +                  -0.4e0/
00384       \textcolor{keyword}{DATA}              dy1/0.5e0, -0.9e0, 0.3e0, 0.7e0, -0.6e0, 0.2e0,
00385      +                  0.8e0/
00386       \textcolor{keyword}{DATA}              dt7/0.0e0, 0.30e0, 0.21e0, 0.62e0, 0.0e0,
00387      +                  0.30e0, -0.07e0, 0.85e0, 0.0e0, 0.30e0, -0.79e0,
00388      +                  -0.74e0, 0.0e0, 0.30e0, 0.33e0, 1.27e0/
00389       \textcolor{keyword}{DATA}              st7b/ .1, .4, .31, .72,     .1, .4, .03, .95,
00390      +                  .1, .4, -.69, -.64,   .1, .4, .43, 1.37/
00391       \textcolor{keyword}{DATA}              dt8/0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00392      +                  0.0e0, 0.68e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00393      +                  0.0e0, 0.0e0, 0.68e0, -0.87e0, 0.0e0, 0.0e0,
00394      +                  0.0e0, 0.0e0, 0.0e0, 0.68e0, -0.87e0, 0.15e0,
00395      +                  0.94e0, 0.0e0, 0.0e0, 0.0e0, 0.5e0, 0.0e0,
00396      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.68e0,
00397      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00398      +                  0.35e0, -0.9e0, 0.48e0, 0.0e0, 0.0e0, 0.0e0,
00399      +                  0.0e0, 0.38e0, -0.9e0, 0.57e0, 0.7e0, -0.75e0,
00400      +                  0.2e0, 0.98e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0,
00401      +                  0.0e0, 0.0e0, 0.0e0, 0.68e0, 0.0e0, 0.0e0,
00402      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.35e0, -0.72e0,
00403      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.38e0,
00404      +                  -0.63e0, 0.15e0, 0.88e0, 0.0e0, 0.0e0, 0.0e0,
00405      +                  0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00406      +                  0.68e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00407      +                  0.0e0, 0.68e0, -0.9e0, 0.33e0, 0.0e0, 0.0e0,
00408      +                  0.0e0, 0.0e0, 0.68e0, -0.9e0, 0.33e0, 0.7e0,
00409      +                  -0.75e0, 0.2e0, 1.04e0/
00410       \textcolor{keyword}{DATA}              dt10x/0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00411      +                  0.0e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00412      +                  0.0e0, 0.5e0, -0.9e0, 0.0e0, 0.0e0, 0.0e0,
00413      +                  0.0e0, 0.0e0, 0.5e0, -0.9e0, 0.3e0, 0.7e0,
00414      +                  0.0e0, 0.0e0, 0.0e0, 0.6e0, 0.0e0, 0.0e0, 0.0e0,
00415      +                  0.0e0, 0.0e0, 0.0e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0,
00416      +                  0.0e0, 0.0e0, 0.0e0, 0.3e0, 0.1e0, 0.5e0, 0.0e0,
00417      +                  0.0e0, 0.0e0, 0.0e0, 0.8e0, 0.1e0, -0.6e0,
00418      +                  0.8e0, 0.3e0, -0.3e0, 0.5e0, 0.6e0, 0.0e0,
00419      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.5e0, 0.0e0,
00420      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, -0.9e0,
00421      +                  0.1e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.7e0,
00422      +                  0.1e0, 0.3e0, 0.8e0, -0.9e0, -0.3e0, 0.5e0,
00423      +                  0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00424      +                  0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00425      +                  0.5e0, 0.3e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00426      +                  0.5e0, 0.3e0, -0.6e0, 0.8e0, 0.0e0, 0.0e0,
00427      +                  0.0e0/
00428       \textcolor{keyword}{DATA}              dt10y/0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00429      +                  0.0e0, 0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00430      +                  0.0e0, 0.6e0, 0.1e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00431      +                  0.0e0, 0.6e0, 0.1e0, -0.5e0, 0.8e0, 0.0e0,
00432      +                  0.0e0, 0.0e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00433      +                  0.0e0, 0.0e0, 0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00434      +                  0.0e0, 0.0e0, -0.5e0, -0.9e0, 0.6e0, 0.0e0,
00435      +                  0.0e0, 0.0e0, 0.0e0, -0.4e0, -0.9e0, 0.9e0,
00436      +                  0.7e0, -0.5e0, 0.2e0, 0.6e0, 0.5e0, 0.0e0,
00437      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.6e0, 0.0e0,
00438      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, -0.5e0,
00439      +                  0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00440      +                  -0.4e0, 0.9e0, -0.5e0, 0.6e0, 0.0e0, 0.0e0,
00441      +                  0.0e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00442      +                  0.0e0, 0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00443      +                  0.0e0, 0.6e0, -0.9e0, 0.1e0, 0.0e0, 0.0e0,
00444      +                  0.0e0, 0.0e0, 0.6e0, -0.9e0, 0.1e0, 0.7e0,
00445      +                  -0.5e0, 0.2e0, 0.8e0/
00446       \textcolor{keyword}{DATA}              ssize1/0.0e0, 0.3e0, 1.6e0, 3.2e0/
00447       \textcolor{keyword}{DATA}              ssize2/0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00448      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00449      +                  0.0e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0,
00450      +                  1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0,
00451      +                  1.17e0, 1.17e0, 1.17e0/
00452       \textcolor{keyword}{DATA}              ssize3/ .1, .4, 1.7, 3.3 /
00453 \textcolor{comment}{*}
00454 \textcolor{comment}{*                         FOR DROTM}
00455 \textcolor{comment}{*}
00456       \textcolor{keyword}{DATA} dpar/-2.e0,  0.e0,0.e0,0.e0,0.e0,
00457      a          -1.e0,  2.e0, -3.e0, -4.e0,  5.e0,
00458      b           0.e0,  0.e0,  2.e0, -3.e0,  0.e0,
00459      c           1.e0,  5.e0,  2.e0,  0.e0, -4.e0/
00460 \textcolor{comment}{*                        TRUE X RESULTS F0R ROTATIONS DROTM}
00461       \textcolor{keyword}{DATA} dt19xa/.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00462      a            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00463      b            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00464      c            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00465      d            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00466      e           -.8e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00467      f           -.9e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00468      g           3.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00469      h            .6e0,   .1e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00470      i           -.8e0,  3.8e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00471      j           -.9e0,  2.8e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00472      k           3.5e0,  -.4e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00473      l            .6e0,   .1e0,  -.5e0,   .8e0,          0.e0,0.e0,0.e0,
00474      m           -.8e0,  3.8e0, -2.2e0, -1.2e0,          0.e0,0.e0,0.e0,
00475      n           -.9e0,  2.8e0, -1.4e0, -1.3e0,          0.e0,0.e0,0.e0,
00476      o           3.5e0,  -.4e0, -2.2e0,  4.7e0,          0.e0,0.e0,0.e0/
00477 \textcolor{comment}{*}
00478       \textcolor{keyword}{DATA} dt19xb/.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00479      a            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00480      b            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00481      c            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00482      d            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00483      e           -.8e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00484      f           -.9e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00485      g           3.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00486      h            .6e0,   .1e0,  -.5e0,             0.e0,0.e0,0.e0,0.e0,
00487      i           0.e0,    .1e0, -3.0e0,             0.e0,0.e0,0.e0,0.e0,
00488      j           -.3e0,   .1e0, -2.0e0,             0.e0,0.e0,0.e0,0.e0,
00489      k           3.3e0,   .1e0, -2.0e0,             0.e0,0.e0,0.e0,0.e0,
00490      l            .6e0,   .1e0,  -.5e0,   .8e0,   .9e0,  -.3e0,  -.4e0,
00491      m          -2.0e0,   .1e0,  1.4e0,   .8e0,   .6e0,  -.3e0, -2.8e0,
00492      n          -1.8e0,   .1e0,  1.3e0,   .8e0,  0.e0,   -.3e0, -1.9e0,
00493      o           3.8e0,   .1e0, -3.1e0,   .8e0,  4.8e0,  -.3e0, -1.5e0 /
00494 \textcolor{comment}{*}
00495       \textcolor{keyword}{DATA} dt19xc/.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00496      a            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00497      b            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00498      c            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00499      d            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00500      e           -.8e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00501      f           -.9e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00502      g           3.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00503      h            .6e0,   .1e0,  -.5e0,             0.e0,0.e0,0.e0,0.e0,
00504      i           4.8e0,   .1e0, -3.0e0,             0.e0,0.e0,0.e0,0.e0,
00505      j           3.3e0,   .1e0, -2.0e0,             0.e0,0.e0,0.e0,0.e0,
00506      k           2.1e0,   .1e0, -2.0e0,             0.e0,0.e0,0.e0,0.e0,
00507      l            .6e0,   .1e0,  -.5e0,   .8e0,   .9e0,  -.3e0,  -.4e0,
00508      m          -1.6e0,   .1e0, -2.2e0,   .8e0,  5.4e0,  -.3e0, -2.8e0,
00509      n          -1.5e0,   .1e0, -1.4e0,   .8e0,  3.6e0,  -.3e0, -1.9e0,
00510      o           3.7e0,   .1e0, -2.2e0,   .8e0,  3.6e0,  -.3e0, -1.5e0 /
00511 \textcolor{comment}{*}
00512       \textcolor{keyword}{DATA} dt19xd/.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00513      a            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00514      b            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00515      c            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00516      d            .6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00517      e           -.8e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00518      f           -.9e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00519      g           3.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00520      h            .6e0,   .1e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00521      i           -.8e0, -1.0e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00522      j           -.9e0,  -.8e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00523      k           3.5e0,   .8e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00524      l            .6e0,   .1e0,  -.5e0,   .8e0,          0.e0,0.e0,0.e0,
00525      m           -.8e0, -1.0e0,  1.4e0, -1.6e0,          0.e0,0.e0,0.e0,
00526      n           -.9e0,  -.8e0,  1.3e0, -1.6e0,          0.e0,0.e0,0.e0,
00527      o           3.5e0,   .8e0, -3.1e0,  4.8e0,          0.e0,0.e0,0.e0/
00528 \textcolor{comment}{*                        TRUE Y RESULTS FOR ROTATIONS DROTM}
00529       \textcolor{keyword}{DATA} dt19ya/.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00530      a            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00531      b            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00532      c            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00533      d            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00534      e            .7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00535      f           1.7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00536      g          -2.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00537      h            .5e0,  -.9e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00538      i            .7e0, -4.8e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00539      j           1.7e0,  -.7e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00540      k          -2.6e0,  3.5e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00541      l            .5e0,  -.9e0,   .3e0,   .7e0,          0.e0,0.e0,0.e0,
00542      m            .7e0, -4.8e0,  3.0e0,  1.1e0,          0.e0,0.e0,0.e0,
00543      n           1.7e0,  -.7e0,  -.7e0,  2.3e0,          0.e0,0.e0,0.e0,
00544      o          -2.6e0,  3.5e0,  -.7e0, -3.6e0,          0.e0,0.e0,0.e0/
00545 \textcolor{comment}{*}
00546       \textcolor{keyword}{DATA} dt19yb/.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00547      a            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00548      b            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00549      c            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00550      d            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00551      e            .7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00552      f           1.7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00553      g          -2.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00554      h            .5e0,  -.9e0,   .3e0,             0.e0,0.e0,0.e0,0.e0,
00555      i           4.0e0,  -.9e0,  -.3e0,             0.e0,0.e0,0.e0,0.e0,
00556      j           -.5e0,  -.9e0,  1.5e0,             0.e0,0.e0,0.e0,0.e0,
00557      k          -1.5e0,  -.9e0, -1.8e0,             0.e0,0.e0,0.e0,0.e0,
00558      l            .5e0,  -.9e0,   .3e0,   .7e0,  -.6e0,   .2e0,   .8e0,
00559      m           3.7e0,  -.9e0, -1.2e0,   .7e0, -1.5e0,   .2e0,  2.2e0,
00560      n           -.3e0,  -.9e0,  2.1e0,   .7e0, -1.6e0,   .2e0,  2.0e0,
00561      o          -1.6e0,  -.9e0, -2.1e0,   .7e0,  2.9e0,   .2e0, -3.8e0 /
00562 \textcolor{comment}{*}
00563       \textcolor{keyword}{DATA} dt19yc/.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00564      a            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00565      b            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00566      c            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00567      d            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00568      e            .7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00569      f           1.7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00570      g          -2.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00571      h            .5e0,  -.9e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00572      i           4.0e0, -6.3e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00573      j           -.5e0,   .3e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00574      k          -1.5e0,  3.0e0,             0.e0,0.e0,0.e0,0.e0,0.e0,
00575      l            .5e0,  -.9e0,   .3e0,   .7e0,          0.e0,0.e0,0.e0,
00576      m           3.7e0, -7.2e0,  3.0e0,  1.7e0,          0.e0,0.e0,0.e0,
00577      n           -.3e0,   .9e0,  -.7e0,  1.9e0,          0.e0,0.e0,0.e0,
00578      o          -1.6e0,  2.7e0,  -.7e0, -3.4e0,          0.e0,0.e0,0.e0/
00579 \textcolor{comment}{*}
00580       \textcolor{keyword}{DATA} dt19yd/.5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00581      a            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00582      b            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00583      c            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00584      d            .5e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00585      e            .7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00586      f           1.7e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00587      g          -2.6e0,                  0.e0,0.e0,0.e0,0.e0,0.e0,0.e0,
00588      h            .5e0,  -.9e0,   .3e0,             0.e0,0.e0,0.e0,0.e0,
00589      i            .7e0,  -.9e0,  1.2e0,             0.e0,0.e0,0.e0,0.e0,
00590      j           1.7e0,  -.9e0,   .5e0,             0.e0,0.e0,0.e0,0.e0,
00591      k          -2.6e0,  -.9e0, -1.3e0,             0.e0,0.e0,0.e0,0.e0,
00592      l            .5e0,  -.9e0,   .3e0,   .7e0,  -.6e0,   .2e0,   .8e0,
00593      m            .7e0,  -.9e0,  1.2e0,   .7e0, -1.5e0,   .2e0,  1.6e0,
00594      n           1.7e0,  -.9e0,   .5e0,   .7e0, -1.6e0,   .2e0,  2.4e0,
00595      o          -2.6e0,  -.9e0, -1.3e0,   .7e0,  2.9e0,   .2e0, -4.0e0 /
00596 \textcolor{comment}{*}
00597 \textcolor{comment}{*     .. Executable Statements ..}
00598 \textcolor{comment}{*}
00599       \textcolor{keywordflow}{DO} 120 ki = 1, 4
00600          incx = incxs(ki)
00601          incy = incys(ki)
00602          mx = abs(incx)
00603          my = abs(incy)
00604 \textcolor{comment}{*}
00605          \textcolor{keywordflow}{DO} 100 kn = 1, 4
00606             n = ns(kn)
00607             ksize = min(2,kn)
00608             lenx = lens(kn,mx)
00609             leny = lens(kn,my)
00610 \textcolor{comment}{*           .. Initialize all argument arrays ..}
00611             \textcolor{keywordflow}{DO} 20 i = 1, 7
00612                sx(i) = dx1(i)
00613                sy(i) = dy1(i)
00614    20       \textcolor{keywordflow}{CONTINUE}
00615 \textcolor{comment}{*}
00616             \textcolor{keywordflow}{IF} (icase.EQ.1) \textcolor{keywordflow}{THEN}
00617 \textcolor{comment}{*              .. SDOT ..}
00618                \textcolor{keyword}{CALL }stest1(sdot(n,sx,incx,sy,incy),dt7(kn,ki),ssize1(kn)
00619      +                     ,sfac)
00620             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.2) \textcolor{keywordflow}{THEN}
00621 \textcolor{comment}{*              .. SAXPY ..}
00622                \textcolor{keyword}{CALL }saxpy(n,sa,sx,incx,sy,incy)
00623                \textcolor{keywordflow}{DO} 40 j = 1, leny
00624                   sty(j) = dt8(j,kn,ki)
00625    40          \textcolor{keywordflow}{CONTINUE}
00626                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,ksize),sfac)
00627             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.5) \textcolor{keywordflow}{THEN}
00628 \textcolor{comment}{*              .. SCOPY ..}
00629                \textcolor{keywordflow}{DO} 60 i = 1, 7
00630                   sty(i) = dt10y(i,kn,ki)
00631    60          \textcolor{keywordflow}{CONTINUE}
00632                \textcolor{keyword}{CALL }scopy(n,sx,incx,sy,incy)
00633                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,1),1.0e0)
00634             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.6) \textcolor{keywordflow}{THEN}
00635 \textcolor{comment}{*              .. SSWAP ..}
00636                \textcolor{keyword}{CALL }sswap(n,sx,incx,sy,incy)
00637                \textcolor{keywordflow}{DO} 80 i = 1, 7
00638                   stx(i) = dt10x(i,kn,ki)
00639                   sty(i) = dt10y(i,kn,ki)
00640    80          \textcolor{keywordflow}{CONTINUE}
00641                \textcolor{keyword}{CALL }stest(lenx,sx,stx,ssize2(1,1),1.0e0)
00642                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,1),1.0e0)
00643             \textcolor{keywordflow}{ELSEIF} (icase.EQ.12) \textcolor{keywordflow}{THEN}
00644 \textcolor{comment}{*              .. SROTM ..}
00645                kni=kn+4*(ki-1)
00646                \textcolor{keywordflow}{DO} kpar=1,4
00647                   \textcolor{keywordflow}{DO} i=1,7
00648                      sx(i) = dx1(i)
00649                      sy(i) = dy1(i)
00650                      stx(i)= dt19x(i,kpar,kni)
00651                      sty(i)= dt19y(i,kpar,kni)
00652 \textcolor{keywordflow}{                  END DO}
00653 \textcolor{comment}{*}
00654                   \textcolor{keywordflow}{DO} i=1,5
00655                      dtemp(i) = dpar(i,kpar)
00656 \textcolor{keywordflow}{                  END DO}
00657 \textcolor{comment}{*}
00658                   \textcolor{keywordflow}{DO}  i=1,lenx
00659                      ssize(i)=stx(i)
00660 \textcolor{keywordflow}{                  END DO}
00661 \textcolor{comment}{*                   SEE REMARK ABOVE ABOUT DT11X(1,2,7)}
00662 \textcolor{comment}{*                       AND DT11X(5,3,8).}
00663                   \textcolor{keywordflow}{IF} ((kpar .EQ. 2) .AND. (kni .EQ. 7))
00664      $               ssize(1) = 2.4e0
00665                   \textcolor{keywordflow}{IF} ((kpar .EQ. 3) .AND. (kni .EQ. 8))
00666      $               ssize(5) = 1.8e0
00667 \textcolor{comment}{*}
00668                   \textcolor{keyword}{CALL   }srotm(n,sx,incx,sy,incy,dtemp)
00669                   \textcolor{keyword}{CALL   }stest(lenx,sx,stx,ssize,sfac)
00670                   \textcolor{keyword}{CALL   }stest(leny,sy,sty,sty,sfac)
00671 \textcolor{keywordflow}{               END DO}
00672             \textcolor{keywordflow}{ELSEIF} (icase.EQ.13) \textcolor{keywordflow}{THEN}
00673 \textcolor{comment}{*              .. SDSROT ..}
00674                \textcolor{keyword}{CALL }stest1 (sdsdot(n,.1,sx,incx,sy,incy),
00675      $                 st7b(kn,ki),ssize3(kn),sfac)
00676             \textcolor{keywordflow}{ELSE}
00677                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK2'}
00678                stop
00679 \textcolor{keywordflow}{            END IF}
00680   100    \textcolor{keywordflow}{CONTINUE}
00681   120 \textcolor{keywordflow}{CONTINUE}
00682       \textcolor{keywordflow}{RETURN}
00683 \textcolor{keyword}{      END}
00684 \textcolor{keyword}{      SUBROUTINE }check3(SFAC)
00685 \textcolor{comment}{*     .. Parameters ..}
00686       \textcolor{keywordtype}{INTEGER}           nout
00687       parameter(nout=6)
00688 \textcolor{comment}{*     .. Scalar Arguments ..}
00689       \textcolor{keywordtype}{REAL}              sfac
00690 \textcolor{comment}{*     .. Scalars in Common ..}
00691       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00692       \textcolor{keywordtype}{LOGICAL}           pass
00693 \textcolor{comment}{*     .. Local Scalars ..}
00694       \textcolor{keywordtype}{REAL}              sc, ss
00695       \textcolor{keywordtype}{INTEGER}           i, k, ki, kn, ksize, lenx, leny, mx, my
00696 \textcolor{comment}{*     .. Local Arrays ..}
00697       \textcolor{keywordtype}{REAL}              copyx(5), copyy(5), dt9x(7,4,4), dt9y(7,4,4),
00698      +                  dx1(7), dy1(7), mwpc(11), mwps(11), mwpstx(5),
00699      +                  mwpsty(5), mwptx(11,5), mwpty(11,5), mwpx(5),
00700      +                  mwpy(5), ssize2(14,2), stx(7), sty(7), sx(7),
00701      +                  sy(7)
00702       \textcolor{keywordtype}{INTEGER}           incxs(4), incys(4), lens(4,2), mwpinx(11),
00703      +                  mwpiny(11), mwpn(11), ns(4)
00704 \textcolor{comment}{*     .. External Subroutines ..}
00705       \textcolor{keywordtype}{EXTERNAL}          srot, stest
00706 \textcolor{comment}{*     .. Intrinsic Functions ..}
00707       \textcolor{keywordtype}{INTRINSIC}         abs, min
00708 \textcolor{comment}{*     .. Common blocks ..}
00709       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
00710 \textcolor{comment}{*     .. Data statements ..}
00711       \textcolor{keyword}{DATA}              incxs/1, 2, -2, -1/
00712       \textcolor{keyword}{DATA}              incys/1, -2, 1, -2/
00713       \textcolor{keyword}{DATA}              lens/1, 1, 2, 4, 1, 1, 3, 7/
00714       \textcolor{keyword}{DATA}              ns/0, 1, 2, 4/
00715       \textcolor{keyword}{DATA}              dx1/0.6e0, 0.1e0, -0.5e0, 0.8e0, 0.9e0, -0.3e0,
00716      +                  -0.4e0/
00717       \textcolor{keyword}{DATA}              dy1/0.5e0, -0.9e0, 0.3e0, 0.7e0, -0.6e0, 0.2e0,
00718      +                  0.8e0/
00719       \textcolor{keyword}{DATA}              sc, ss/0.8e0, 0.6e0/
00720       \textcolor{keyword}{DATA}              dt9x/0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00721      +                  0.0e0, 0.78e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00722      +                  0.0e0, 0.0e0, 0.78e0, -0.46e0, 0.0e0, 0.0e0,
00723      +                  0.0e0, 0.0e0, 0.0e0, 0.78e0, -0.46e0, -0.22e0,
00724      +                  1.06e0, 0.0e0, 0.0e0, 0.0e0, 0.6e0, 0.0e0,
00725      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.78e0,
00726      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00727      +                  0.66e0, 0.1e0, -0.1e0, 0.0e0, 0.0e0, 0.0e0,
00728      +                  0.0e0, 0.96e0, 0.1e0, -0.76e0, 0.8e0, 0.90e0,
00729      +                  -0.3e0, -0.02e0, 0.6e0, 0.0e0, 0.0e0, 0.0e0,
00730      +                  0.0e0, 0.0e0, 0.0e0, 0.78e0, 0.0e0, 0.0e0,
00731      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, -0.06e0, 0.1e0,
00732      +                  -0.1e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.90e0,
00733      +                  0.1e0, -0.22e0, 0.8e0, 0.18e0, -0.3e0, -0.02e0,
00734      +                  0.6e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00735      +                  0.78e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00736      +                  0.0e0, 0.78e0, 0.26e0, 0.0e0, 0.0e0, 0.0e0,
00737      +                  0.0e0, 0.0e0, 0.78e0, 0.26e0, -0.76e0, 1.12e0,
00738      +                  0.0e0, 0.0e0, 0.0e0/
00739       \textcolor{keyword}{DATA}              dt9y/0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00740      +                  0.0e0, 0.04e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00741      +                  0.0e0, 0.0e0, 0.04e0, -0.78e0, 0.0e0, 0.0e0,
00742      +                  0.0e0, 0.0e0, 0.0e0, 0.04e0, -0.78e0, 0.54e0,
00743      +                  0.08e0, 0.0e0, 0.0e0, 0.0e0, 0.5e0, 0.0e0,
00744      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.04e0,
00745      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.7e0,
00746      +                  -0.9e0, -0.12e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00747      +                  0.64e0, -0.9e0, -0.30e0, 0.7e0, -0.18e0, 0.2e0,
00748      +                  0.28e0, 0.5e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00749      +                  0.0e0, 0.0e0, 0.04e0, 0.0e0, 0.0e0, 0.0e0,
00750      +                  0.0e0, 0.0e0, 0.0e0, 0.7e0, -1.08e0, 0.0e0,
00751      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.64e0, -1.26e0,
00752      +                  0.54e0, 0.20e0, 0.0e0, 0.0e0, 0.0e0, 0.5e0,
00753      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00754      +                  0.04e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00755      +                  0.0e0, 0.04e0, -0.9e0, 0.18e0, 0.0e0, 0.0e0,
00756      +                  0.0e0, 0.0e0, 0.04e0, -0.9e0, 0.18e0, 0.7e0,
00757      +                  -0.18e0, 0.2e0, 0.16e0/
00758       \textcolor{keyword}{DATA}              ssize2/0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00759      +                  0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0, 0.0e0,
00760      +                  0.0e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0,
00761      +                  1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0, 1.17e0,
00762      +                  1.17e0, 1.17e0, 1.17e0/
00763 \textcolor{comment}{*     .. Executable Statements ..}
00764 \textcolor{comment}{*}
00765       \textcolor{keywordflow}{DO} 60 ki = 1, 4
00766          incx = incxs(ki)
00767          incy = incys(ki)
00768          mx = abs(incx)
00769          my = abs(incy)
00770 \textcolor{comment}{*}
00771          \textcolor{keywordflow}{DO} 40 kn = 1, 4
00772             n = ns(kn)
00773             ksize = min(2,kn)
00774             lenx = lens(kn,mx)
00775             leny = lens(kn,my)
00776 \textcolor{comment}{*}
00777             \textcolor{keywordflow}{IF} (icase.EQ.4) \textcolor{keywordflow}{THEN}
00778 \textcolor{comment}{*              .. SROT ..}
00779                \textcolor{keywordflow}{DO} 20 i = 1, 7
00780                   sx(i) = dx1(i)
00781                   sy(i) = dy1(i)
00782                   stx(i) = dt9x(i,kn,ki)
00783                   sty(i) = dt9y(i,kn,ki)
00784    20          \textcolor{keywordflow}{CONTINUE}
00785                \textcolor{keyword}{CALL }srot(n,sx,incx,sy,incy,sc,ss)
00786                \textcolor{keyword}{CALL }stest(lenx,sx,stx,ssize2(1,ksize),sfac)
00787                \textcolor{keyword}{CALL }stest(leny,sy,sty,ssize2(1,ksize),sfac)
00788             \textcolor{keywordflow}{ELSE}
00789                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK3'}
00790                stop
00791 \textcolor{keywordflow}{            END IF}
00792    40    \textcolor{keywordflow}{CONTINUE}
00793    60 \textcolor{keywordflow}{CONTINUE}
00794 \textcolor{comment}{*}
00795       mwpc(1) = 1
00796       \textcolor{keywordflow}{DO} 80 i = 2, 11
00797          mwpc(i) = 0
00798    80 \textcolor{keywordflow}{CONTINUE}
00799       mwps(1) = 0
00800       \textcolor{keywordflow}{DO} 100 i = 2, 6
00801          mwps(i) = 1
00802   100 \textcolor{keywordflow}{CONTINUE}
00803       \textcolor{keywordflow}{DO} 120 i = 7, 11
00804          mwps(i) = -1
00805   120 \textcolor{keywordflow}{CONTINUE}
00806       mwpinx(1) = 1
00807       mwpinx(2) = 1
00808       mwpinx(3) = 1
00809       mwpinx(4) = -1
00810       mwpinx(5) = 1
00811       mwpinx(6) = -1
00812       mwpinx(7) = 1
00813       mwpinx(8) = 1
00814       mwpinx(9) = -1
00815       mwpinx(10) = 1
00816       mwpinx(11) = -1
00817       mwpiny(1) = 1
00818       mwpiny(2) = 1
00819       mwpiny(3) = -1
00820       mwpiny(4) = -1
00821       mwpiny(5) = 2
00822       mwpiny(6) = 1
00823       mwpiny(7) = 1
00824       mwpiny(8) = -1
00825       mwpiny(9) = -1
00826       mwpiny(10) = 2
00827       mwpiny(11) = 1
00828       \textcolor{keywordflow}{DO} 140 i = 1, 11
00829          mwpn(i) = 5
00830   140 \textcolor{keywordflow}{CONTINUE}
00831       mwpn(5) = 3
00832       mwpn(10) = 3
00833       \textcolor{keywordflow}{DO} 160 i = 1, 5
00834          mwpx(i) = i
00835          mwpy(i) = i
00836          mwptx(1,i) = i
00837          mwpty(1,i) = i
00838          mwptx(2,i) = i
00839          mwpty(2,i) = -i
00840          mwptx(3,i) = 6 - i
00841          mwpty(3,i) = i - 6
00842          mwptx(4,i) = i
00843          mwpty(4,i) = -i
00844          mwptx(6,i) = 6 - i
00845          mwpty(6,i) = i - 6
00846          mwptx(7,i) = -i
00847          mwpty(7,i) = i
00848          mwptx(8,i) = i - 6
00849          mwpty(8,i) = 6 - i
00850          mwptx(9,i) = -i
00851          mwpty(9,i) = i
00852          mwptx(11,i) = i - 6
00853          mwpty(11,i) = 6 - i
00854   160 \textcolor{keywordflow}{CONTINUE}
00855       mwptx(5,1) = 1
00856       mwptx(5,2) = 3
00857       mwptx(5,3) = 5
00858       mwptx(5,4) = 4
00859       mwptx(5,5) = 5
00860       mwpty(5,1) = -1
00861       mwpty(5,2) = 2
00862       mwpty(5,3) = -2
00863       mwpty(5,4) = 4
00864       mwpty(5,5) = -3
00865       mwptx(10,1) = -1
00866       mwptx(10,2) = -3
00867       mwptx(10,3) = -5
00868       mwptx(10,4) = 4
00869       mwptx(10,5) = 5
00870       mwpty(10,1) = 1
00871       mwpty(10,2) = 2
00872       mwpty(10,3) = 2
00873       mwpty(10,4) = 4
00874       mwpty(10,5) = 3
00875       \textcolor{keywordflow}{DO} 200 i = 1, 11
00876          incx = mwpinx(i)
00877          incy = mwpiny(i)
00878          \textcolor{keywordflow}{DO} 180 k = 1, 5
00879             copyx(k) = mwpx(k)
00880             copyy(k) = mwpy(k)
00881             mwpstx(k) = mwptx(i,k)
00882             mwpsty(k) = mwpty(i,k)
00883   180    \textcolor{keywordflow}{CONTINUE}
00884          \textcolor{keyword}{CALL }srot(mwpn(i),copyx,incx,copyy,incy,mwpc(i),mwps(i))
00885          \textcolor{keyword}{CALL }stest(5,copyx,mwpstx,mwpstx,sfac)
00886          \textcolor{keyword}{CALL }stest(5,copyy,mwpsty,mwpsty,sfac)
00887   200 \textcolor{keywordflow}{CONTINUE}
00888       \textcolor{keywordflow}{RETURN}
00889 \textcolor{keyword}{      END}
00890 \textcolor{keyword}{      SUBROUTINE }stest(LEN,SCOMP,STRUE,SSIZE,SFAC)
00891 \textcolor{comment}{*     ********************************* STEST **************************}
00892 \textcolor{comment}{*}
00893 \textcolor{comment}{*     THIS SUBR COMPARES ARRAYS  SCOMP() AND STRUE() OF LENGTH LEN TO}
00894 \textcolor{comment}{*     SEE IF THE TERM BY TERM DIFFERENCES, MULTIPLIED BY SFAC, ARE}
00895 \textcolor{comment}{*     NEGLIGIBLE.}
00896 \textcolor{comment}{*}
00897 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00898 \textcolor{comment}{*}
00899 \textcolor{comment}{*     .. Parameters ..}
00900       \textcolor{keywordtype}{INTEGER}          nout
00901       \textcolor{keywordtype}{REAL}             zero
00902       parameter(nout=6, zero=0.0e0)
00903 \textcolor{comment}{*     .. Scalar Arguments ..}
00904       \textcolor{keywordtype}{REAL}             sfac
00905       \textcolor{keywordtype}{INTEGER}          len
00906 \textcolor{comment}{*     .. Array Arguments ..}
00907       \textcolor{keywordtype}{REAL}             scomp(len), ssize(len), strue(len)
00908 \textcolor{comment}{*     .. Scalars in Common ..}
00909       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, n
00910       \textcolor{keywordtype}{LOGICAL}          pass
00911 \textcolor{comment}{*     .. Local Scalars ..}
00912       \textcolor{keywordtype}{REAL}             sd
00913       \textcolor{keywordtype}{INTEGER}          i
00914 \textcolor{comment}{*     .. External Functions ..}
00915       \textcolor{keywordtype}{REAL}             sdiff
00916       \textcolor{keywordtype}{EXTERNAL}         sdiff
00917 \textcolor{comment}{*     .. Intrinsic Functions ..}
00918       \textcolor{keywordtype}{INTRINSIC}        abs
00919 \textcolor{comment}{*     .. Common blocks ..}
00920       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, pass
00921 \textcolor{comment}{*     .. Executable Statements ..}
00922 \textcolor{comment}{*}
00923       \textcolor{keywordflow}{DO} 40 i = 1, len
00924          sd = scomp(i) - strue(i)
00925          \textcolor{keywordflow}{IF} (abs(sfac*sd) .LE. abs(ssize(i))*epsilon(zero))
00926      +       \textcolor{keywordflow}{GO TO} 40
00927 \textcolor{comment}{*}
00928 \textcolor{comment}{*                             HERE    SCOMP(I) IS NOT CLOSE TO STRUE(I).}
00929 \textcolor{comment}{*}
00930          \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
00931 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
00932          pass = .false.
00933          \textcolor{keyword}{WRITE} (nout,99999)
00934          \textcolor{keyword}{WRITE} (nout,99998)
00935    20    \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, i, scomp(i),
00936      +     strue(i), sd, ssize(i)
00937    40 \textcolor{keywordflow}{CONTINUE}
00938       \textcolor{keywordflow}{RETURN}
00939 \textcolor{comment}{*}
00940 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
00941 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY  I                            '},
00942      +       \textcolor{stringliteral}{' COMP(I)                             TRUE(I)  DIFFERENCE'},
00943      +       \textcolor{stringliteral}{'     SIZE(I)'},/1x)
00944 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,2i5,i3,2e36.8,2e12.4)
00945 \textcolor{keyword}{      END}
00946 \textcolor{keyword}{      SUBROUTINE }stest1(SCOMP1,STRUE1,SSIZE,SFAC)
00947 \textcolor{comment}{*     ************************* STEST1 *****************************}
00948 \textcolor{comment}{*}
00949 \textcolor{comment}{*     THIS IS AN INTERFACE SUBROUTINE TO ACCOMODATE THE FORTRAN}
00950 \textcolor{comment}{*     REQUIREMENT THAT WHEN A DUMMY ARGUMENT IS AN ARRAY, THE}
00951 \textcolor{comment}{*     ACTUAL ARGUMENT MUST ALSO BE AN ARRAY OR AN ARRAY ELEMENT.}
00952 \textcolor{comment}{*}
00953 \textcolor{comment}{*     C.L. LAWSON, JPL, 1978 DEC 6}
00954 \textcolor{comment}{*}
00955 \textcolor{comment}{*     .. Scalar Arguments ..}
00956       \textcolor{keywordtype}{REAL}              scomp1, sfac, strue1
00957 \textcolor{comment}{*     .. Array Arguments ..}
00958       \textcolor{keywordtype}{REAL}              ssize(*)
00959 \textcolor{comment}{*     .. Local Arrays ..}
00960       \textcolor{keywordtype}{REAL}              scomp(1), strue(1)
00961 \textcolor{comment}{*     .. External Subroutines ..}
00962       \textcolor{keywordtype}{EXTERNAL}          stest
00963 \textcolor{comment}{*     .. Executable Statements ..}
00964 \textcolor{comment}{*}
00965       scomp(1) = scomp1
00966       strue(1) = strue1
00967       \textcolor{keyword}{CALL }stest(1,scomp,strue,ssize,sfac)
00968 \textcolor{comment}{*}
00969       \textcolor{keywordflow}{RETURN}
00970 \textcolor{keyword}{      END}
00971 \textcolor{keyword}{      REAL             }\textcolor{keyword}{FUNCTION }sdiff(SA,SB)
00972 \textcolor{comment}{*     ********************************* SDIFF **************************}
00973 \textcolor{comment}{*     COMPUTES DIFFERENCE OF TWO NUMBERS.  C. L. LAWSON, JPL 1974 FEB 15}
00974 \textcolor{comment}{*}
00975 \textcolor{comment}{*     .. Scalar Arguments ..}
00976       \textcolor{keywordtype}{REAL}                            sa, sb
00977 \textcolor{comment}{*     .. Executable Statements ..}
00978       sdiff = sa - sb
00979       \textcolor{keywordflow}{RETURN}
00980 \textcolor{keyword}{      END}
00981 \textcolor{keyword}{      SUBROUTINE }itest1(ICOMP,ITRUE)
00982 \textcolor{comment}{*     ********************************* ITEST1 *************************}
00983 \textcolor{comment}{*}
00984 \textcolor{comment}{*     THIS SUBROUTINE COMPARES THE VARIABLES ICOMP AND ITRUE FOR}
00985 \textcolor{comment}{*     EQUALITY.}
00986 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00987 \textcolor{comment}{*}
00988 \textcolor{comment}{*     .. Parameters ..}
00989       \textcolor{keywordtype}{INTEGER}           nout
00990       parameter(nout=6)
00991 \textcolor{comment}{*     .. Scalar Arguments ..}
00992       \textcolor{keywordtype}{INTEGER}           icomp, itrue
00993 \textcolor{comment}{*     .. Scalars in Common ..}
00994       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, n
00995       \textcolor{keywordtype}{LOGICAL}           pass
00996 \textcolor{comment}{*     .. Local Scalars ..}
00997       \textcolor{keywordtype}{INTEGER}           id
00998 \textcolor{comment}{*     .. Common blocks ..}
00999       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, pass
01000 \textcolor{comment}{*     .. Executable Statements ..}
01001 \textcolor{comment}{*}
01002       \textcolor{keywordflow}{IF} (icomp.EQ.itrue) \textcolor{keywordflow}{GO TO} 40
01003 \textcolor{comment}{*}
01004 \textcolor{comment}{*                            HERE ICOMP IS NOT EQUAL TO ITRUE.}
01005 \textcolor{comment}{*}
01006       \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
01007 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
01008       pass = .false.
01009       \textcolor{keyword}{WRITE} (nout,99999)
01010       \textcolor{keyword}{WRITE} (nout,99998)
01011    20 id = icomp - itrue
01012       \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, icomp, itrue, id
01013    40 \textcolor{keywordflow}{CONTINUE}
01014       \textcolor{keywordflow}{RETURN}
01015 \textcolor{comment}{*}
01016 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
01017 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY                               '},
01018      +       \textcolor{stringliteral}{' COMP                                TRUE     DIFFERENCE'},
01019      +       /1x)
01020 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,2i5,2i36,i12)
01021 \textcolor{keyword}{      END}
\end{DoxyCode}
