\hypertarget{eigen_2unsupported_2_eigen_2src_2_non_linear_optimization_2fdjac1_8h_source}{}\section{eigen/unsupported/\+Eigen/src/\+Non\+Linear\+Optimization/fdjac1.h}
\label{eigen_2unsupported_2_eigen_2src_2_non_linear_optimization_2fdjac1_8h_source}\index{fdjac1.\+h@{fdjac1.\+h}}

\begin{DoxyCode}
00001 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00002 
00003 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00004 
00005 \textcolor{keyword}{template}<\textcolor{keyword}{typename} FunctorType, \textcolor{keyword}{typename} Scalar>
00006 DenseIndex fdjac1(
00007         \textcolor{keyword}{const} FunctorType &\hyperlink{struct_functor}{Functor},
00008         \hyperlink{group___core___module}{Matrix< Scalar, Dynamic, 1 >}  &x,
00009         \hyperlink{group___core___module}{Matrix< Scalar, Dynamic, 1 >}  &fvec,
00010         \hyperlink{group___core___module}{Matrix< Scalar, Dynamic, Dynamic >} &fjac,
00011         DenseIndex ml, DenseIndex mu,
00012         Scalar epsfcn)
00013 \{
00014     \textcolor{keyword}{using} std::sqrt;
00015     \textcolor{keyword}{using} std::abs;
00016     
00017     \textcolor{keyword}{typedef} DenseIndex \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00018 
00019     \textcolor{comment}{/* Local variables */}
00020     Scalar h;
00021     Index j, k;
00022     Scalar eps, temp;
00023     Index msum;
00024     \textcolor{keywordtype}{int} iflag;
00025     Index start, length;
00026 
00027     \textcolor{comment}{/* Function Body */}
00028     \textcolor{keyword}{const} Scalar epsmch = NumTraits<Scalar>::epsilon();
00029     \textcolor{keyword}{const} Index n = x.size();
00030     eigen\_assert(fvec.size()==n);
00031     \hyperlink{group___core___module}{Matrix< Scalar, Dynamic, 1 >}  wa1(n);
00032     \hyperlink{group___core___module}{Matrix< Scalar, Dynamic, 1 >}  wa2(n);
00033 
00034     eps = sqrt((std::max)(epsfcn,epsmch));
00035     msum = ml + mu + 1;
00036     \textcolor{keywordflow}{if} (msum >= n) \{
00037         \textcolor{comment}{/* computation of dense approximate jacobian. */}
00038         \textcolor{keywordflow}{for} (j = 0; j < n; ++j) \{
00039             temp = x[j];
00040             h = eps * abs(temp);
00041             \textcolor{keywordflow}{if} (h == 0.)
00042                 h = eps;
00043             x[j] = temp + h;
00044             iflag = Functor(x, wa1);
00045             \textcolor{keywordflow}{if} (iflag < 0)
00046                 \textcolor{keywordflow}{return} iflag;
00047             x[j] = temp;
00048             fjac.col(j) = (wa1-fvec)/h;
00049         \}
00050 
00051     \}\textcolor{keywordflow}{else} \{
00052         \textcolor{comment}{/* computation of banded approximate jacobian. */}
00053         \textcolor{keywordflow}{for} (k = 0; k < msum; ++k) \{
00054             \textcolor{keywordflow}{for} (j = k; (msum<0) ? (j>n): (j<n); j += msum) \{
00055                 wa2[j] = x[j];
00056                 h = eps * abs(wa2[j]);
00057                 \textcolor{keywordflow}{if} (h == 0.) h = eps;
00058                 x[j] = wa2[j] + h;
00059             \}
00060             iflag = Functor(x, wa1);
00061             \textcolor{keywordflow}{if} (iflag < 0)
00062                 \textcolor{keywordflow}{return} iflag;
00063             \textcolor{keywordflow}{for} (j = k; (msum<0) ? (j>n): (j<n); j += msum) \{
00064                 x[j] = wa2[j];
00065                 h = eps * abs(wa2[j]);
00066                 \textcolor{keywordflow}{if} (h == 0.) h = eps;
00067                 fjac.col(j).\hyperlink{class_eigen_1_1_plain_object_base_ac21ad5f989f320e46958b75ac8d9a1da}{setZero}();
00068                 start = std::max<Index>(0,j-mu);
00069                 length = (std::min)(n-1, j+ml) - start + 1;
00070                 fjac.col(j).segment(start, length) = ( wa1.segment(start, length)-fvec.segment(start, 
      length))/h;
00071             \}
00072         \}
00073     \}
00074     \textcolor{keywordflow}{return} 0;
00075 \}
00076 
00077 \} \textcolor{comment}{// end namespace internal}
00078 
00079 \} \textcolor{comment}{// end namespace Eigen}
\end{DoxyCode}
