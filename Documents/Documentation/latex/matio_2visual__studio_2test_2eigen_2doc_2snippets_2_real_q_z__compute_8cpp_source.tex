\hypertarget{matio_2visual__studio_2test_2eigen_2doc_2snippets_2_real_q_z__compute_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/doc/snippets/\+Real\+Q\+Z\+\_\+compute.cpp}
\label{matio_2visual__studio_2test_2eigen_2doc_2snippets_2_real_q_z__compute_8cpp_source}\index{Real\+Q\+Z\+\_\+compute.\+cpp@{Real\+Q\+Z\+\_\+compute.\+cpp}}

\begin{DoxyCode}
00001 MatrixXf A = MatrixXf::Random(4,4);
00002 MatrixXf B = MatrixXf::Random(4,4);
00003 RealQZ<MatrixXf> qz(4); \textcolor{comment}{// preallocate space for 4x4 matrices}
00004 qz.compute(A,B);  \textcolor{comment}{// A = Q S Z,  B = Q T Z}
00005 
00006 \textcolor{comment}{// print original matrices and result of decomposition}
00007 cout << \textcolor{stringliteral}{"A:\(\backslash\)n"} << A << \textcolor{stringliteral}{"\(\backslash\)n"} << \textcolor{stringliteral}{"B:\(\backslash\)n"} << B << \textcolor{stringliteral}{"\(\backslash\)n"};
00008 cout << \textcolor{stringliteral}{"S:\(\backslash\)n"} << qz.matrixS() << \textcolor{stringliteral}{"\(\backslash\)n"} << \textcolor{stringliteral}{"T:\(\backslash\)n"} << qz.matrixT() << \textcolor{stringliteral}{"\(\backslash\)n"};
00009 cout << \textcolor{stringliteral}{"Q:\(\backslash\)n"} << qz.matrixQ() << \textcolor{stringliteral}{"\(\backslash\)n"} << \textcolor{stringliteral}{"Z:\(\backslash\)n"} << qz.matrixZ() << \textcolor{stringliteral}{"\(\backslash\)n"};
00010 
00011 \textcolor{comment}{// verify precision}
00012 cout << \textcolor{stringliteral}{"\(\backslash\)nErrors:"}
00013   << \textcolor{stringliteral}{"\(\backslash\)n|A-QSZ|: "} << (A-qz.matrixQ()*qz.matrixS()*qz.matrixZ()).norm()
00014   << \textcolor{stringliteral}{", |B-QTZ|: "} << (B-qz.matrixQ()*qz.matrixT()*qz.matrixZ()).norm()
00015   << \textcolor{stringliteral}{"\(\backslash\)n|QQ* - I|: "} << (qz.matrixQ()*qz.matrixQ().adjoint() - MatrixXf::Identity(4,4)).norm()
00016   << \textcolor{stringliteral}{", |ZZ* - I|: "} << (qz.matrixZ()*qz.matrixZ().adjoint() - MatrixXf::Identity(4,4)).norm()
00017   << \textcolor{stringliteral}{"\(\backslash\)n"};
\end{DoxyCode}
