\hypertarget{eigen_2lapack_2clarfb_8f_source}{}\section{eigen/lapack/clarfb.f}
\label{eigen_2lapack_2clarfb_8f_source}\index{clarfb.\+f@{clarfb.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b CLARFB}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download CLARFB + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/clarfb.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/clarfb.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/clarfb.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE CLARFB( SIDE, TRANS, DIRECT, STOREV, M, N, K, V, LDV,}
00022 \textcolor{comment}{*                          T, LDT, C, LDC, WORK, LDWORK )}
00023 \textcolor{comment}{* }
00024 \textcolor{comment}{*       .. Scalar Arguments ..}
00025 \textcolor{comment}{*       CHARACTER          DIRECT, SIDE, STOREV, TRANS}
00026 \textcolor{comment}{*       INTEGER            K, LDC, LDT, LDV, LDWORK, M, N}
00027 \textcolor{comment}{*       ..}
00028 \textcolor{comment}{*       .. Array Arguments ..}
00029 \textcolor{comment}{*       COMPLEX            C( LDC, * ), T( LDT, * ), V( LDV, * ),}
00030 \textcolor{comment}{*      $                   WORK( LDWORK, * )}
00031 \textcolor{comment}{*       ..}
00032 \textcolor{comment}{*  }
00033 \textcolor{comment}{*}
00034 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00035 \textcolor{comment}{*  =============}
00036 \textcolor{comment}{*>}
00037 \textcolor{comment}{*> \(\backslash\)verbatim}
00038 \textcolor{comment}{*>}
00039 \textcolor{comment}{*> CLARFB applies a complex block reflector H or its transpose H**H to a}
00040 \textcolor{comment}{*> complex M-by-N matrix C, from either the left or the right.}
00041 \textcolor{comment}{*> \(\backslash\)endverbatim}
00042 \textcolor{comment}{*}
00043 \textcolor{comment}{*  Arguments:}
00044 \textcolor{comment}{*  ==========}
00045 \textcolor{comment}{*}
00046 \textcolor{comment}{*> \(\backslash\)param[in] SIDE}
00047 \textcolor{comment}{*> \(\backslash\)verbatim}
00048 \textcolor{comment}{*>          SIDE is CHARACTER*1}
00049 \textcolor{comment}{*>          = 'L': apply H or H**H from the Left}
00050 \textcolor{comment}{*>          = 'R': apply H or H**H from the Right}
00051 \textcolor{comment}{*> \(\backslash\)endverbatim}
00052 \textcolor{comment}{*>}
00053 \textcolor{comment}{*> \(\backslash\)param[in] TRANS}
00054 \textcolor{comment}{*> \(\backslash\)verbatim}
00055 \textcolor{comment}{*>          TRANS is CHARACTER*1}
00056 \textcolor{comment}{*>          = 'N': apply H (No transpose)}
00057 \textcolor{comment}{*>          = 'C': apply H**H (Conjugate transpose)}
00058 \textcolor{comment}{*> \(\backslash\)endverbatim}
00059 \textcolor{comment}{*>}
00060 \textcolor{comment}{*> \(\backslash\)param[in] DIRECT}
00061 \textcolor{comment}{*> \(\backslash\)verbatim}
00062 \textcolor{comment}{*>          DIRECT is CHARACTER*1}
00063 \textcolor{comment}{*>          Indicates how H is formed from a product of elementary}
00064 \textcolor{comment}{*>          reflectors}
00065 \textcolor{comment}{*>          = 'F': H = H(1) H(2) . . . H(k) (Forward)}
00066 \textcolor{comment}{*>          = 'B': H = H(k) . . . H(2) H(1) (Backward)}
00067 \textcolor{comment}{*> \(\backslash\)endverbatim}
00068 \textcolor{comment}{*>}
00069 \textcolor{comment}{*> \(\backslash\)param[in] STOREV}
00070 \textcolor{comment}{*> \(\backslash\)verbatim}
00071 \textcolor{comment}{*>          STOREV is CHARACTER*1}
00072 \textcolor{comment}{*>          Indicates how the vectors which define the elementary}
00073 \textcolor{comment}{*>          reflectors are stored:}
00074 \textcolor{comment}{*>          = 'C': Columnwise}
00075 \textcolor{comment}{*>          = 'R': Rowwise}
00076 \textcolor{comment}{*> \(\backslash\)endverbatim}
00077 \textcolor{comment}{*>}
00078 \textcolor{comment}{*> \(\backslash\)param[in] M}
00079 \textcolor{comment}{*> \(\backslash\)verbatim}
00080 \textcolor{comment}{*>          M is INTEGER}
00081 \textcolor{comment}{*>          The number of rows of the matrix C.}
00082 \textcolor{comment}{*> \(\backslash\)endverbatim}
00083 \textcolor{comment}{*>}
00084 \textcolor{comment}{*> \(\backslash\)param[in] N}
00085 \textcolor{comment}{*> \(\backslash\)verbatim}
00086 \textcolor{comment}{*>          N is INTEGER}
00087 \textcolor{comment}{*>          The number of columns of the matrix C.}
00088 \textcolor{comment}{*> \(\backslash\)endverbatim}
00089 \textcolor{comment}{*>}
00090 \textcolor{comment}{*> \(\backslash\)param[in] K}
00091 \textcolor{comment}{*> \(\backslash\)verbatim}
00092 \textcolor{comment}{*>          K is INTEGER}
00093 \textcolor{comment}{*>          The order of the matrix T (= the number of elementary}
00094 \textcolor{comment}{*>          reflectors whose product defines the block reflector).}
00095 \textcolor{comment}{*> \(\backslash\)endverbatim}
00096 \textcolor{comment}{*>}
00097 \textcolor{comment}{*> \(\backslash\)param[in] V}
00098 \textcolor{comment}{*> \(\backslash\)verbatim}
00099 \textcolor{comment}{*>          V is COMPLEX array, dimension}
00100 \textcolor{comment}{*>                                (LDV,K) if STOREV = 'C'}
00101 \textcolor{comment}{*>                                (LDV,M) if STOREV = 'R' and SIDE = 'L'}
00102 \textcolor{comment}{*>                                (LDV,N) if STOREV = 'R' and SIDE = 'R'}
00103 \textcolor{comment}{*>          The matrix V. See Further Details.}
00104 \textcolor{comment}{*> \(\backslash\)endverbatim}
00105 \textcolor{comment}{*>}
00106 \textcolor{comment}{*> \(\backslash\)param[in] LDV}
00107 \textcolor{comment}{*> \(\backslash\)verbatim}
00108 \textcolor{comment}{*>          LDV is INTEGER}
00109 \textcolor{comment}{*>          The leading dimension of the array V.}
00110 \textcolor{comment}{*>          If STOREV = 'C' and SIDE = 'L', LDV >= max(1,M);}
00111 \textcolor{comment}{*>          if STOREV = 'C' and SIDE = 'R', LDV >= max(1,N);}
00112 \textcolor{comment}{*>          if STOREV = 'R', LDV >= K.}
00113 \textcolor{comment}{*> \(\backslash\)endverbatim}
00114 \textcolor{comment}{*>}
00115 \textcolor{comment}{*> \(\backslash\)param[in] T}
00116 \textcolor{comment}{*> \(\backslash\)verbatim}
00117 \textcolor{comment}{*>          T is COMPLEX array, dimension (LDT,K)}
00118 \textcolor{comment}{*>          The triangular K-by-K matrix T in the representation of the}
00119 \textcolor{comment}{*>          block reflector.}
00120 \textcolor{comment}{*> \(\backslash\)endverbatim}
00121 \textcolor{comment}{*>}
00122 \textcolor{comment}{*> \(\backslash\)param[in] LDT}
00123 \textcolor{comment}{*> \(\backslash\)verbatim}
00124 \textcolor{comment}{*>          LDT is INTEGER}
00125 \textcolor{comment}{*>          The leading dimension of the array T. LDT >= K.}
00126 \textcolor{comment}{*> \(\backslash\)endverbatim}
00127 \textcolor{comment}{*>}
00128 \textcolor{comment}{*> \(\backslash\)param[in,out] C}
00129 \textcolor{comment}{*> \(\backslash\)verbatim}
00130 \textcolor{comment}{*>          C is COMPLEX array, dimension (LDC,N)}
00131 \textcolor{comment}{*>          On entry, the M-by-N matrix C.}
00132 \textcolor{comment}{*>          On exit, C is overwritten by H*C or H**H*C or C*H or C*H**H.}
00133 \textcolor{comment}{*> \(\backslash\)endverbatim}
00134 \textcolor{comment}{*>}
00135 \textcolor{comment}{*> \(\backslash\)param[in] LDC}
00136 \textcolor{comment}{*> \(\backslash\)verbatim}
00137 \textcolor{comment}{*>          LDC is INTEGER}
00138 \textcolor{comment}{*>          The leading dimension of the array C. LDC >= max(1,M).}
00139 \textcolor{comment}{*> \(\backslash\)endverbatim}
00140 \textcolor{comment}{*>}
00141 \textcolor{comment}{*> \(\backslash\)param[out] WORK}
00142 \textcolor{comment}{*> \(\backslash\)verbatim}
00143 \textcolor{comment}{*>          WORK is COMPLEX array, dimension (LDWORK,K)}
00144 \textcolor{comment}{*> \(\backslash\)endverbatim}
00145 \textcolor{comment}{*>}
00146 \textcolor{comment}{*> \(\backslash\)param[in] LDWORK}
00147 \textcolor{comment}{*> \(\backslash\)verbatim}
00148 \textcolor{comment}{*>          LDWORK is INTEGER}
00149 \textcolor{comment}{*>          The leading dimension of the array WORK.}
00150 \textcolor{comment}{*>          If SIDE = 'L', LDWORK >= max(1,N);}
00151 \textcolor{comment}{*>          if SIDE = 'R', LDWORK >= max(1,M).}
00152 \textcolor{comment}{*> \(\backslash\)endverbatim}
00153 \textcolor{comment}{*}
00154 \textcolor{comment}{*  Authors:}
00155 \textcolor{comment}{*  ========}
00156 \textcolor{comment}{*}
00157 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00158 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00159 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00160 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00161 \textcolor{comment}{*}
00162 \textcolor{comment}{*> \(\backslash\)date November 2011}
00163 \textcolor{comment}{*}
00164 \textcolor{comment}{*> \(\backslash\)ingroup complexOTHERauxiliary}
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*> \(\backslash\)par Further Details:}
00167 \textcolor{comment}{*  =====================}
00168 \textcolor{comment}{*>}
00169 \textcolor{comment}{*> \(\backslash\)verbatim}
00170 \textcolor{comment}{*>}
00171 \textcolor{comment}{*>  The shape of the matrix V and the storage of the vectors which define}
00172 \textcolor{comment}{*>  the H(i) is best illustrated by the following example with n = 5 and}
00173 \textcolor{comment}{*>  k = 3. The elements equal to 1 are not stored; the corresponding}
00174 \textcolor{comment}{*>  array elements are modified but restored on exit. The rest of the}
00175 \textcolor{comment}{*>  array is not used.}
00176 \textcolor{comment}{*>}
00177 \textcolor{comment}{*>  DIRECT = 'F' and STOREV = 'C':         DIRECT = 'F' and STOREV = 'R':}
00178 \textcolor{comment}{*>}
00179 \textcolor{comment}{*>               V = (  1       )                 V = (  1 v1 v1 v1 v1 )}
00180 \textcolor{comment}{*>                   ( v1  1    )                     (     1 v2 v2 v2 )}
00181 \textcolor{comment}{*>                   ( v1 v2  1 )                     (        1 v3 v3 )}
00182 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00183 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00184 \textcolor{comment}{*>}
00185 \textcolor{comment}{*>  DIRECT = 'B' and STOREV = 'C':         DIRECT = 'B' and STOREV = 'R':}
00186 \textcolor{comment}{*>}
00187 \textcolor{comment}{*>               V = ( v1 v2 v3 )                 V = ( v1 v1  1       )}
00188 \textcolor{comment}{*>                   ( v1 v2 v3 )                     ( v2 v2 v2  1    )}
00189 \textcolor{comment}{*>                   (  1 v2 v3 )                     ( v3 v3 v3 v3  1 )}
00190 \textcolor{comment}{*>                   (     1 v3 )}
00191 \textcolor{comment}{*>                   (        1 )}
00192 \textcolor{comment}{*> \(\backslash\)endverbatim}
00193 \textcolor{comment}{*>}
00194 \textcolor{comment}{*  =====================================================================}
00195 \textcolor{keyword}{      SUBROUTINE }clarfb( SIDE, TRANS, DIRECT, STOREV, M, N, K, V, LDV,
00196      $                   T, LDT, C, LDC, WORK, LDWORK )
00197 \textcolor{comment}{*}
00198 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.0) --}
00199 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00200 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00201 \textcolor{comment}{*     November 2011}
00202 \textcolor{comment}{*}
00203 \textcolor{comment}{*     .. Scalar Arguments ..}
00204       \textcolor{keywordtype}{CHARACTER}          direct, side, storev, trans
00205       \textcolor{keywordtype}{INTEGER}            k, ldc, ldt, ldv, ldwork, m, n
00206 \textcolor{comment}{*     ..}
00207 \textcolor{comment}{*     .. Array Arguments ..}
00208       \textcolor{keywordtype}{COMPLEX}            c( ldc, * ), t( ldt, * ), v( ldv, * ),
00209      $                   work( ldwork, * )
00210 \textcolor{comment}{*     ..}
00211 \textcolor{comment}{*}
00212 \textcolor{comment}{*  =====================================================================}
00213 \textcolor{comment}{*}
00214 \textcolor{comment}{*     .. Parameters ..}
00215       \textcolor{keywordtype}{COMPLEX}            one
00216       parameter( one = ( 1.0e+0, 0.0e+0 ) )
00217 \textcolor{comment}{*     ..}
00218 \textcolor{comment}{*     .. Local Scalars ..}
00219       \textcolor{keywordtype}{CHARACTER}          transt
00220       \textcolor{keywordtype}{INTEGER}            i, j, lastv, lastc
00221 \textcolor{comment}{*     ..}
00222 \textcolor{comment}{*     .. External Functions ..}
00223       \textcolor{keywordtype}{LOGICAL}            lsame
00224       \textcolor{keywordtype}{INTEGER}            ilaclr, ilaclc
00225       \textcolor{keywordtype}{EXTERNAL}           lsame, ilaclr, ilaclc
00226 \textcolor{comment}{*     ..}
00227 \textcolor{comment}{*     .. External Subroutines ..}
00228       \textcolor{keywordtype}{EXTERNAL}           ccopy, cgemm, clacgv, ctrmm
00229 \textcolor{comment}{*     ..}
00230 \textcolor{comment}{*     .. Intrinsic Functions ..}
00231       \textcolor{keywordtype}{INTRINSIC}          conjg
00232 \textcolor{comment}{*     ..}
00233 \textcolor{comment}{*     .. Executable Statements ..}
00234 \textcolor{comment}{*}
00235 \textcolor{comment}{*     Quick return if possible}
00236 \textcolor{comment}{*}
00237       \textcolor{keywordflow}{IF}( m.LE.0 .OR. n.LE.0 )
00238      $   \textcolor{keywordflow}{RETURN}
00239 \textcolor{comment}{*}
00240       \textcolor{keywordflow}{IF}( lsame( trans, \textcolor{stringliteral}{'N'} ) ) \textcolor{keywordflow}{THEN}
00241          transt = \textcolor{stringliteral}{'C'}
00242       \textcolor{keywordflow}{ELSE}
00243          transt = \textcolor{stringliteral}{'N'}
00244 \textcolor{keywordflow}{      END IF}
00245 \textcolor{comment}{*}
00246       \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00247 \textcolor{comment}{*}
00248          \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00249 \textcolor{comment}{*}
00250 \textcolor{comment}{*           Let  V =  ( V1 )    (first K rows)}
00251 \textcolor{comment}{*                     ( V2 )}
00252 \textcolor{comment}{*           where  V1  is unit lower triangular.}
00253 \textcolor{comment}{*}
00254             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00255 \textcolor{comment}{*}
00256 \textcolor{comment}{*              Form  H * C  or  H**H * C  where  C = ( C1 )}
00257 \textcolor{comment}{*                                                    ( C2 )}
00258 \textcolor{comment}{*}
00259                lastv = max( k, ilaclr( m, k, v, ldv ) )
00260                lastc = ilaclc( lastv, n, c, ldc )
00261 \textcolor{comment}{*}
00262 \textcolor{comment}{*              W := C**H * V  =  (C1**H * V1 + C2**H * V2)  (stored in WORK)}
00263 \textcolor{comment}{*}
00264 \textcolor{comment}{*              W := C1**H}
00265 \textcolor{comment}{*}
00266                \textcolor{keywordflow}{DO} 10 j = 1, k
00267                   \textcolor{keyword}{CALL }ccopy( lastc, c( j, 1 ), ldc, work( 1, j ), 1 )
00268                   \textcolor{keyword}{CALL }clacgv( lastc, work( 1, j ), 1 )
00269    10          \textcolor{keywordflow}{CONTINUE}
00270 \textcolor{comment}{*}
00271 \textcolor{comment}{*              W := W * V1}
00272 \textcolor{comment}{*}
00273                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00274      $              lastc, k, one, v, ldv, work, ldwork )
00275                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00276 \textcolor{comment}{*}
00277 \textcolor{comment}{*                 W := W + C2**H *V2}
00278 \textcolor{comment}{*}
00279                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'}, \textcolor{stringliteral}{'No transpose'},
00280      $                 lastc, k, lastv-k, one, c( k+1, 1 ), ldc,
00281      $                 v( k+1, 1 ), ldv, one, work, ldwork )
00282 \textcolor{keywordflow}{               END IF}
00283 \textcolor{comment}{*}
00284 \textcolor{comment}{*              W := W * T**H  or  W * T}
00285 \textcolor{comment}{*}
00286                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, transt, \textcolor{stringliteral}{'Non-unit'},
00287      $              lastc, k, one, t, ldt, work, ldwork )
00288 \textcolor{comment}{*}
00289 \textcolor{comment}{*              C := C - V * W**H}
00290 \textcolor{comment}{*}
00291                \textcolor{keywordflow}{IF}( m.GT.k ) \textcolor{keywordflow}{THEN}
00292 \textcolor{comment}{*}
00293 \textcolor{comment}{*                 C2 := C2 - V2 * W**H}
00294 \textcolor{comment}{*}
00295                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00296      $                 lastv-k, lastc, k, -one, v( k+1, 1 ), ldv,
00297      $                 work, ldwork, one, c( k+1, 1 ), ldc )
00298 \textcolor{keywordflow}{               END IF}
00299 \textcolor{comment}{*}
00300 \textcolor{comment}{*              W := W * V1**H}
00301 \textcolor{comment}{*}
00302                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Conjugate transpose'},
00303      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v, ldv, work, ldwork )
00304 \textcolor{comment}{*}
00305 \textcolor{comment}{*              C1 := C1 - W**H}
00306 \textcolor{comment}{*}
00307                \textcolor{keywordflow}{DO} 30 j = 1, k
00308                   \textcolor{keywordflow}{DO} 20 i = 1, lastc
00309                      c( j, i ) = c( j, i ) - conjg( work( i, j ) )
00310    20             \textcolor{keywordflow}{CONTINUE}
00311    30          \textcolor{keywordflow}{CONTINUE}
00312 \textcolor{comment}{*}
00313             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00314 \textcolor{comment}{*}
00315 \textcolor{comment}{*              Form  C * H  or  C * H**H  where  C = ( C1  C2 )}
00316 \textcolor{comment}{*}
00317                lastv = max( k, ilaclr( n, k, v, ldv ) )
00318                lastc = ilaclr( m, lastv, c, ldc )
00319 \textcolor{comment}{*}
00320 \textcolor{comment}{*              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)}
00321 \textcolor{comment}{*}
00322 \textcolor{comment}{*              W := C1}
00323 \textcolor{comment}{*}
00324                \textcolor{keywordflow}{DO} 40 j = 1, k
00325                   \textcolor{keyword}{CALL }ccopy( lastc, c( 1, j ), 1, work( 1, j ), 1 )
00326    40          \textcolor{keywordflow}{CONTINUE}
00327 \textcolor{comment}{*}
00328 \textcolor{comment}{*              W := W * V1}
00329 \textcolor{comment}{*}
00330                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00331      $              lastc, k, one, v, ldv, work, ldwork )
00332                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00333 \textcolor{comment}{*}
00334 \textcolor{comment}{*                 W := W + C2 * V2}
00335 \textcolor{comment}{*}
00336                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00337      $                 lastc, k, lastv-k,
00338      $                 one, c( 1, k+1 ), ldc, v( k+1, 1 ), ldv,
00339      $                 one, work, ldwork )
00340 \textcolor{keywordflow}{               END IF}
00341 \textcolor{comment}{*}
00342 \textcolor{comment}{*              W := W * T  or  W * T**H}
00343 \textcolor{comment}{*}
00344                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, trans, \textcolor{stringliteral}{'Non-unit'},
00345      $              lastc, k, one, t, ldt, work, ldwork )
00346 \textcolor{comment}{*}
00347 \textcolor{comment}{*              C := C - W * V**H}
00348 \textcolor{comment}{*}
00349                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00350 \textcolor{comment}{*}
00351 \textcolor{comment}{*                 C2 := C2 - W * V2**H}
00352 \textcolor{comment}{*}
00353                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00354      $                 lastc, lastv-k, k,
00355      $                 -one, work, ldwork, v( k+1, 1 ), ldv,
00356      $                 one, c( 1, k+1 ), ldc )
00357 \textcolor{keywordflow}{               END IF}
00358 \textcolor{comment}{*}
00359 \textcolor{comment}{*              W := W * V1**H}
00360 \textcolor{comment}{*}
00361                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Conjugate transpose'},
00362      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v, ldv, work, ldwork )
00363 \textcolor{comment}{*}
00364 \textcolor{comment}{*              C1 := C1 - W}
00365 \textcolor{comment}{*}
00366                \textcolor{keywordflow}{DO} 60 j = 1, k
00367                   \textcolor{keywordflow}{DO} 50 i = 1, lastc
00368                      c( i, j ) = c( i, j ) - work( i, j )
00369    50             \textcolor{keywordflow}{CONTINUE}
00370    60          \textcolor{keywordflow}{CONTINUE}
00371 \textcolor{keywordflow}{            END IF}
00372 \textcolor{comment}{*}
00373          \textcolor{keywordflow}{ELSE}
00374 \textcolor{comment}{*}
00375 \textcolor{comment}{*           Let  V =  ( V1 )}
00376 \textcolor{comment}{*                     ( V2 )    (last K rows)}
00377 \textcolor{comment}{*           where  V2  is unit upper triangular.}
00378 \textcolor{comment}{*}
00379             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00380 \textcolor{comment}{*}
00381 \textcolor{comment}{*              Form  H * C  or  H**H * C  where  C = ( C1 )}
00382 \textcolor{comment}{*                                                    ( C2 )}
00383 \textcolor{comment}{*}
00384                lastv = max( k, ilaclr( m, k, v, ldv ) )
00385                lastc = ilaclc( lastv, n, c, ldc )
00386 \textcolor{comment}{*}
00387 \textcolor{comment}{*              W := C**H * V  =  (C1**H * V1 + C2**H * V2)  (stored in WORK)}
00388 \textcolor{comment}{*}
00389 \textcolor{comment}{*              W := C2**H}
00390 \textcolor{comment}{*}
00391                \textcolor{keywordflow}{DO} 70 j = 1, k
00392                   \textcolor{keyword}{CALL }ccopy( lastc, c( lastv-k+j, 1 ), ldc,
00393      $                 work( 1, j ), 1 )
00394                   \textcolor{keyword}{CALL }clacgv( lastc, work( 1, j ), 1 )
00395    70          \textcolor{keywordflow}{CONTINUE}
00396 \textcolor{comment}{*}
00397 \textcolor{comment}{*              W := W * V2}
00398 \textcolor{comment}{*}
00399                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00400      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00401      $              work, ldwork )
00402                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00403 \textcolor{comment}{*}
00404 \textcolor{comment}{*                 W := W + C1**H*V1}
00405 \textcolor{comment}{*}
00406                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'}, \textcolor{stringliteral}{'No transpose'},
00407      $                 lastc, k, lastv-k, one, c, ldc, v, ldv,
00408      $                 one, work, ldwork )
00409 \textcolor{keywordflow}{               END IF}
00410 \textcolor{comment}{*}
00411 \textcolor{comment}{*              W := W * T**H  or  W * T}
00412 \textcolor{comment}{*}
00413                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, transt, \textcolor{stringliteral}{'Non-unit'},
00414      $              lastc, k, one, t, ldt, work, ldwork )
00415 \textcolor{comment}{*}
00416 \textcolor{comment}{*              C := C - V * W**H}
00417 \textcolor{comment}{*}
00418                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00419 \textcolor{comment}{*}
00420 \textcolor{comment}{*                 C1 := C1 - V1 * W**H}
00421 \textcolor{comment}{*}
00422                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00423      $                 lastv-k, lastc, k, -one, v, ldv, work, ldwork,
00424      $                 one, c, ldc )
00425 \textcolor{keywordflow}{               END IF}
00426 \textcolor{comment}{*}
00427 \textcolor{comment}{*              W := W * V2**H}
00428 \textcolor{comment}{*}
00429                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Conjugate transpose'},
00430      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v( lastv-k+1, 1 ), ldv,
00431      $              work, ldwork )
00432 \textcolor{comment}{*}
00433 \textcolor{comment}{*              C2 := C2 - W**H}
00434 \textcolor{comment}{*}
00435                \textcolor{keywordflow}{DO} 90 j = 1, k
00436                   \textcolor{keywordflow}{DO} 80 i = 1, lastc
00437                      c( lastv-k+j, i ) = c( lastv-k+j, i ) -
00438      $                               conjg( work( i, j ) )
00439    80             \textcolor{keywordflow}{CONTINUE}
00440    90          \textcolor{keywordflow}{CONTINUE}
00441 \textcolor{comment}{*}
00442             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00443 \textcolor{comment}{*}
00444 \textcolor{comment}{*              Form  C * H  or  C * H**H  where  C = ( C1  C2 )}
00445 \textcolor{comment}{*}
00446                lastv = max( k, ilaclr( n, k, v, ldv ) )
00447                lastc = ilaclr( m, lastv, c, ldc )
00448 \textcolor{comment}{*}
00449 \textcolor{comment}{*              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)}
00450 \textcolor{comment}{*}
00451 \textcolor{comment}{*              W := C2}
00452 \textcolor{comment}{*}
00453                \textcolor{keywordflow}{DO} 100 j = 1, k
00454                   \textcolor{keyword}{CALL }ccopy( lastc, c( 1, lastv-k+j ), 1,
00455      $                 work( 1, j ), 1 )
00456   100          \textcolor{keywordflow}{CONTINUE}
00457 \textcolor{comment}{*}
00458 \textcolor{comment}{*              W := W * V2}
00459 \textcolor{comment}{*}
00460                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00461      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00462      $              work, ldwork )
00463                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00464 \textcolor{comment}{*}
00465 \textcolor{comment}{*                 W := W + C1 * V1}
00466 \textcolor{comment}{*}
00467                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00468      $                 lastc, k, lastv-k,
00469      $                 one, c, ldc, v, ldv, one, work, ldwork )
00470 \textcolor{keywordflow}{               END IF}
00471 \textcolor{comment}{*}
00472 \textcolor{comment}{*              W := W * T  or  W * T**H}
00473 \textcolor{comment}{*}
00474                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, trans, \textcolor{stringliteral}{'Non-unit'},
00475      $              lastc, k, one, t, ldt, work, ldwork )
00476 \textcolor{comment}{*}
00477 \textcolor{comment}{*              C := C - W * V**H}
00478 \textcolor{comment}{*}
00479                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00480 \textcolor{comment}{*}
00481 \textcolor{comment}{*                 C1 := C1 - W * V1**H}
00482 \textcolor{comment}{*}
00483                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00484      $                 lastc, lastv-k, k, -one, work, ldwork, v, ldv,
00485      $                 one, c, ldc )
00486 \textcolor{keywordflow}{               END IF}
00487 \textcolor{comment}{*}
00488 \textcolor{comment}{*              W := W * V2**H}
00489 \textcolor{comment}{*}
00490                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Conjugate transpose'},
00491      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v( lastv-k+1, 1 ), ldv,
00492      $              work, ldwork )
00493 \textcolor{comment}{*}
00494 \textcolor{comment}{*              C2 := C2 - W}
00495 \textcolor{comment}{*}
00496                \textcolor{keywordflow}{DO} 120 j = 1, k
00497                   \textcolor{keywordflow}{DO} 110 i = 1, lastc
00498                      c( i, lastv-k+j ) = c( i, lastv-k+j )
00499      $                    - work( i, j )
00500   110             \textcolor{keywordflow}{CONTINUE}
00501   120          \textcolor{keywordflow}{CONTINUE}
00502 \textcolor{keywordflow}{            END IF}
00503 \textcolor{keywordflow}{         END IF}
00504 \textcolor{comment}{*}
00505       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00506 \textcolor{comment}{*}
00507          \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00508 \textcolor{comment}{*}
00509 \textcolor{comment}{*           Let  V =  ( V1  V2 )    (V1: first K columns)}
00510 \textcolor{comment}{*           where  V1  is unit upper triangular.}
00511 \textcolor{comment}{*}
00512             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00513 \textcolor{comment}{*}
00514 \textcolor{comment}{*              Form  H * C  or  H**H * C  where  C = ( C1 )}
00515 \textcolor{comment}{*                                                    ( C2 )}
00516 \textcolor{comment}{*}
00517                lastv = max( k, ilaclc( k, m, v, ldv ) )
00518                lastc = ilaclc( lastv, n, c, ldc )
00519 \textcolor{comment}{*}
00520 \textcolor{comment}{*              W := C**H * V**H  =  (C1**H * V1**H + C2**H * V2**H) (stored in WORK)}
00521 \textcolor{comment}{*}
00522 \textcolor{comment}{*              W := C1**H}
00523 \textcolor{comment}{*}
00524                \textcolor{keywordflow}{DO} 130 j = 1, k
00525                   \textcolor{keyword}{CALL }ccopy( lastc, c( j, 1 ), ldc, work( 1, j ), 1 )
00526                   \textcolor{keyword}{CALL }clacgv( lastc, work( 1, j ), 1 )
00527   130          \textcolor{keywordflow}{CONTINUE}
00528 \textcolor{comment}{*}
00529 \textcolor{comment}{*              W := W * V1**H}
00530 \textcolor{comment}{*}
00531                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Conjugate transpose'},
00532      $                     \textcolor{stringliteral}{'Unit'}, lastc, k, one, v, ldv, work, ldwork )
00533                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00534 \textcolor{comment}{*}
00535 \textcolor{comment}{*                 W := W + C2**H*V2**H}
00536 \textcolor{comment}{*}
00537                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'},
00538      $                 \textcolor{stringliteral}{'Conjugate transpose'}, lastc, k, lastv-k,
00539      $                 one, c( k+1, 1 ), ldc, v( 1, k+1 ), ldv,
00540      $                 one, work, ldwork )
00541 \textcolor{keywordflow}{               END IF}
00542 \textcolor{comment}{*}
00543 \textcolor{comment}{*              W := W * T**H  or  W * T}
00544 \textcolor{comment}{*}
00545                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, transt, \textcolor{stringliteral}{'Non-unit'},
00546      $              lastc, k, one, t, ldt, work, ldwork )
00547 \textcolor{comment}{*}
00548 \textcolor{comment}{*              C := C - V**H * W**H}
00549 \textcolor{comment}{*}
00550                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00551 \textcolor{comment}{*}
00552 \textcolor{comment}{*                 C2 := C2 - V2**H * W**H}
00553 \textcolor{comment}{*}
00554                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'},
00555      $                 \textcolor{stringliteral}{'Conjugate transpose'}, lastv-k, lastc, k,
00556      $                 -one, v( 1, k+1 ), ldv, work, ldwork,
00557      $                 one, c( k+1, 1 ), ldc )
00558 \textcolor{keywordflow}{               END IF}
00559 \textcolor{comment}{*}
00560 \textcolor{comment}{*              W := W * V1}
00561 \textcolor{comment}{*}
00562                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00563      $              lastc, k, one, v, ldv, work, ldwork )
00564 \textcolor{comment}{*}
00565 \textcolor{comment}{*              C1 := C1 - W**H}
00566 \textcolor{comment}{*}
00567                \textcolor{keywordflow}{DO} 150 j = 1, k
00568                   \textcolor{keywordflow}{DO} 140 i = 1, lastc
00569                      c( j, i ) = c( j, i ) - conjg( work( i, j ) )
00570   140             \textcolor{keywordflow}{CONTINUE}
00571   150          \textcolor{keywordflow}{CONTINUE}
00572 \textcolor{comment}{*}
00573             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00574 \textcolor{comment}{*}
00575 \textcolor{comment}{*              Form  C * H  or  C * H**H  where  C = ( C1  C2 )}
00576 \textcolor{comment}{*}
00577                lastv = max( k, ilaclc( k, n, v, ldv ) )
00578                lastc = ilaclr( m, lastv, c, ldc )
00579 \textcolor{comment}{*}
00580 \textcolor{comment}{*              W := C * V**H  =  (C1*V1**H + C2*V2**H)  (stored in WORK)}
00581 \textcolor{comment}{*}
00582 \textcolor{comment}{*              W := C1}
00583 \textcolor{comment}{*}
00584                \textcolor{keywordflow}{DO} 160 j = 1, k
00585                   \textcolor{keyword}{CALL }ccopy( lastc, c( 1, j ), 1, work( 1, j ), 1 )
00586   160          \textcolor{keywordflow}{CONTINUE}
00587 \textcolor{comment}{*}
00588 \textcolor{comment}{*              W := W * V1**H}
00589 \textcolor{comment}{*}
00590                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Conjugate transpose'},
00591      $                     \textcolor{stringliteral}{'Unit'}, lastc, k, one, v, ldv, work, ldwork )
00592                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00593 \textcolor{comment}{*}
00594 \textcolor{comment}{*                 W := W + C2 * V2**H}
00595 \textcolor{comment}{*}
00596                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00597      $                 lastc, k, lastv-k, one, c( 1, k+1 ), ldc,
00598      $                 v( 1, k+1 ), ldv, one, work, ldwork )
00599 \textcolor{keywordflow}{               END IF}
00600 \textcolor{comment}{*}
00601 \textcolor{comment}{*              W := W * T  or  W * T**H}
00602 \textcolor{comment}{*}
00603                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, trans, \textcolor{stringliteral}{'Non-unit'},
00604      $              lastc, k, one, t, ldt, work, ldwork )
00605 \textcolor{comment}{*}
00606 \textcolor{comment}{*              C := C - W * V}
00607 \textcolor{comment}{*}
00608                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00609 \textcolor{comment}{*}
00610 \textcolor{comment}{*                 C2 := C2 - W * V2}
00611 \textcolor{comment}{*}
00612                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00613      $                 lastc, lastv-k, k,
00614      $                 -one, work, ldwork, v( 1, k+1 ), ldv,
00615      $                 one, c( 1, k+1 ), ldc )
00616 \textcolor{keywordflow}{               END IF}
00617 \textcolor{comment}{*}
00618 \textcolor{comment}{*              W := W * V1}
00619 \textcolor{comment}{*}
00620                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00621      $              lastc, k, one, v, ldv, work, ldwork )
00622 \textcolor{comment}{*}
00623 \textcolor{comment}{*              C1 := C1 - W}
00624 \textcolor{comment}{*}
00625                \textcolor{keywordflow}{DO} 180 j = 1, k
00626                   \textcolor{keywordflow}{DO} 170 i = 1, lastc
00627                      c( i, j ) = c( i, j ) - work( i, j )
00628   170             \textcolor{keywordflow}{CONTINUE}
00629   180          \textcolor{keywordflow}{CONTINUE}
00630 \textcolor{comment}{*}
00631 \textcolor{keywordflow}{            END IF}
00632 \textcolor{comment}{*}
00633          \textcolor{keywordflow}{ELSE}
00634 \textcolor{comment}{*}
00635 \textcolor{comment}{*           Let  V =  ( V1  V2 )    (V2: last K columns)}
00636 \textcolor{comment}{*           where  V2  is unit lower triangular.}
00637 \textcolor{comment}{*}
00638             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00639 \textcolor{comment}{*}
00640 \textcolor{comment}{*              Form  H * C  or  H**H * C  where  C = ( C1 )}
00641 \textcolor{comment}{*                                                    ( C2 )}
00642 \textcolor{comment}{*}
00643                lastv = max( k, ilaclc( k, m, v, ldv ) )
00644                lastc = ilaclc( lastv, n, c, ldc )
00645 \textcolor{comment}{*}
00646 \textcolor{comment}{*              W := C**H * V**H  =  (C1**H * V1**H + C2**H * V2**H) (stored in WORK)}
00647 \textcolor{comment}{*}
00648 \textcolor{comment}{*              W := C2**H}
00649 \textcolor{comment}{*}
00650                \textcolor{keywordflow}{DO} 190 j = 1, k
00651                   \textcolor{keyword}{CALL }ccopy( lastc, c( lastv-k+j, 1 ), ldc,
00652      $                 work( 1, j ), 1 )
00653                   \textcolor{keyword}{CALL }clacgv( lastc, work( 1, j ), 1 )
00654   190          \textcolor{keywordflow}{CONTINUE}
00655 \textcolor{comment}{*}
00656 \textcolor{comment}{*              W := W * V2**H}
00657 \textcolor{comment}{*}
00658                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Conjugate transpose'},
00659      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v( 1, lastv-k+1 ), ldv,
00660      $              work, ldwork )
00661                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00662 \textcolor{comment}{*}
00663 \textcolor{comment}{*                 W := W + C1**H * V1**H}
00664 \textcolor{comment}{*}
00665                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'},
00666      $                 \textcolor{stringliteral}{'Conjugate transpose'}, lastc, k, lastv-k,
00667      $                 one, c, ldc, v, ldv, one, work, ldwork )
00668 \textcolor{keywordflow}{               END IF}
00669 \textcolor{comment}{*}
00670 \textcolor{comment}{*              W := W * T**H  or  W * T}
00671 \textcolor{comment}{*}
00672                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, transt, \textcolor{stringliteral}{'Non-unit'},
00673      $              lastc, k, one, t, ldt, work, ldwork )
00674 \textcolor{comment}{*}
00675 \textcolor{comment}{*              C := C - V**H * W**H}
00676 \textcolor{comment}{*}
00677                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00678 \textcolor{comment}{*}
00679 \textcolor{comment}{*                 C1 := C1 - V1**H * W**H}
00680 \textcolor{comment}{*}
00681                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'Conjugate transpose'},
00682      $                 \textcolor{stringliteral}{'Conjugate transpose'}, lastv-k, lastc, k,
00683      $                 -one, v, ldv, work, ldwork, one, c, ldc )
00684 \textcolor{keywordflow}{               END IF}
00685 \textcolor{comment}{*}
00686 \textcolor{comment}{*              W := W * V2}
00687 \textcolor{comment}{*}
00688                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00689      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00690      $              work, ldwork )
00691 \textcolor{comment}{*}
00692 \textcolor{comment}{*              C2 := C2 - W**H}
00693 \textcolor{comment}{*}
00694                \textcolor{keywordflow}{DO} 210 j = 1, k
00695                   \textcolor{keywordflow}{DO} 200 i = 1, lastc
00696                      c( lastv-k+j, i ) = c( lastv-k+j, i ) -
00697      $                               conjg( work( i, j ) )
00698   200             \textcolor{keywordflow}{CONTINUE}
00699   210          \textcolor{keywordflow}{CONTINUE}
00700 \textcolor{comment}{*}
00701             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00702 \textcolor{comment}{*}
00703 \textcolor{comment}{*              Form  C * H  or  C * H**H  where  C = ( C1  C2 )}
00704 \textcolor{comment}{*}
00705                lastv = max( k, ilaclc( k, n, v, ldv ) )
00706                lastc = ilaclr( m, lastv, c, ldc )
00707 \textcolor{comment}{*}
00708 \textcolor{comment}{*              W := C * V**H  =  (C1*V1**H + C2*V2**H)  (stored in WORK)}
00709 \textcolor{comment}{*}
00710 \textcolor{comment}{*              W := C2}
00711 \textcolor{comment}{*}
00712                \textcolor{keywordflow}{DO} 220 j = 1, k
00713                   \textcolor{keyword}{CALL }ccopy( lastc, c( 1, lastv-k+j ), 1,
00714      $                 work( 1, j ), 1 )
00715   220          \textcolor{keywordflow}{CONTINUE}
00716 \textcolor{comment}{*}
00717 \textcolor{comment}{*              W := W * V2**H}
00718 \textcolor{comment}{*}
00719                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Conjugate transpose'},
00720      $              \textcolor{stringliteral}{'Unit'}, lastc, k, one, v( 1, lastv-k+1 ), ldv,
00721      $              work, ldwork )
00722                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00723 \textcolor{comment}{*}
00724 \textcolor{comment}{*                 W := W + C1 * V1**H}
00725 \textcolor{comment}{*}
00726                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Conjugate transpose'},
00727      $                 lastc, k, lastv-k, one, c, ldc, v, ldv, one,
00728      $                 work, ldwork )
00729 \textcolor{keywordflow}{               END IF}
00730 \textcolor{comment}{*}
00731 \textcolor{comment}{*              W := W * T  or  W * T**H}
00732 \textcolor{comment}{*}
00733                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, trans, \textcolor{stringliteral}{'Non-unit'},
00734      $              lastc, k, one, t, ldt, work, ldwork )
00735 \textcolor{comment}{*}
00736 \textcolor{comment}{*              C := C - W * V}
00737 \textcolor{comment}{*}
00738                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00739 \textcolor{comment}{*}
00740 \textcolor{comment}{*                 C1 := C1 - W * V1}
00741 \textcolor{comment}{*}
00742                   \textcolor{keyword}{CALL }cgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00743      $                 lastc, lastv-k, k, -one, work, ldwork, v, ldv,
00744      $                 one, c, ldc )
00745 \textcolor{keywordflow}{               END IF}
00746 \textcolor{comment}{*}
00747 \textcolor{comment}{*              W := W * V2}
00748 \textcolor{comment}{*}
00749                \textcolor{keyword}{CALL }ctrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00750      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00751      $              work, ldwork )
00752 \textcolor{comment}{*}
00753 \textcolor{comment}{*              C1 := C1 - W}
00754 \textcolor{comment}{*}
00755                \textcolor{keywordflow}{DO} 240 j = 1, k
00756                   \textcolor{keywordflow}{DO} 230 i = 1, lastc
00757                      c( i, lastv-k+j ) = c( i, lastv-k+j )
00758      $                    - work( i, j )
00759   230             \textcolor{keywordflow}{CONTINUE}
00760   240          \textcolor{keywordflow}{CONTINUE}
00761 \textcolor{comment}{*}
00762 \textcolor{keywordflow}{            END IF}
00763 \textcolor{comment}{*}
00764 \textcolor{keywordflow}{         END IF}
00765 \textcolor{keywordflow}{      END IF}
00766 \textcolor{comment}{*}
00767       \textcolor{keywordflow}{RETURN}
00768 \textcolor{comment}{*}
00769 \textcolor{comment}{*     End of CLARFB}
00770 \textcolor{comment}{*}
00771 \textcolor{keyword}{      END}
\end{DoxyCode}
