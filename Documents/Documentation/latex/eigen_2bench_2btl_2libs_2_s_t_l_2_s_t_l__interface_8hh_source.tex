\hypertarget{eigen_2bench_2btl_2libs_2_s_t_l_2_s_t_l__interface_8hh_source}{}\section{eigen/bench/btl/libs/\+S\+T\+L/\+S\+T\+L\+\_\+interface.hh}
\label{eigen_2bench_2btl_2libs_2_s_t_l_2_s_t_l__interface_8hh_source}\index{S\+T\+L\+\_\+interface.\+hh@{S\+T\+L\+\_\+interface.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  STL\_interface.hh}
00003 \textcolor{comment}{// Author :  L. Plagne <laurent.plagne@edf.fr)>}
00004 \textcolor{comment}{// Copyright (C) EDF R&D,  lun sep 30 14:23:24 CEST 2002}
00005 \textcolor{comment}{//=====================================================}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00008 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00009 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00010 \textcolor{comment}{// of the License, or (at your option) any later version.}
00011 \textcolor{comment}{//}
00012 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00013 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00014 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00015 \textcolor{comment}{// GNU General Public License for more details.}
00016 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00018 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00019 \textcolor{comment}{//}
00020 \textcolor{preprocessor}{#ifndef STL\_INTERFACE\_HH}
00021 \textcolor{preprocessor}{#define STL\_INTERFACE\_HH}
00022 \textcolor{preprocessor}{#include <string>}
00023 \textcolor{preprocessor}{#include <vector>}
00024 \textcolor{preprocessor}{#include "utilities.h"}
00025 
00026 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00027 
00028 \textcolor{keyword}{template}<\textcolor{keyword}{class} real>
\Hypertarget{eigen_2bench_2btl_2libs_2_s_t_l_2_s_t_l__interface_8hh_source_l00029}\hyperlink{class_s_t_l__interface}{00029} \textcolor{keyword}{class }\hyperlink{class_s_t_l__interface}{STL\_interface}\{
00030 
00031 public :
00032 
00033   \textcolor{keyword}{typedef} real real\_type ;
00034 
00035   \textcolor{keyword}{typedef} std::vector<real>  stl\_vector;
00036   \textcolor{keyword}{typedef} std::vector<stl\_vector > stl\_matrix;
00037 
00038   \textcolor{keyword}{typedef} stl\_matrix gene\_matrix;
00039 
00040   \textcolor{keyword}{typedef} stl\_vector gene\_vector;
00041 
00042   \textcolor{keyword}{static} \textcolor{keyword}{inline} std::string name( \textcolor{keywordtype}{void} )
00043   \{
00044     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"STL"};
00045   \}
00046 
00047   \textcolor{keyword}{static} \textcolor{keywordtype}{void} free\_matrix(gene\_matrix & \textcolor{comment}{/*A*/}, \textcolor{keywordtype}{int} \textcolor{comment}{/*N*/})\{\}
00048 
00049   \textcolor{keyword}{static} \textcolor{keywordtype}{void} free\_vector(gene\_vector & \textcolor{comment}{/*B*/})\{\}
00050 
00051   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} matrix\_from\_stl(gene\_matrix & \hyperlink{group___core___module_class_eigen_1_1_matrix}{A}, stl\_matrix & A\_stl)\{
00052     A = A\_stl;
00053   \}
00054 
00055   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vector\_from\_stl(gene\_vector & \hyperlink{group___core___module_class_eigen_1_1_matrix}{B}, stl\_vector & B\_stl)\{
00056     B = B\_stl;
00057   \}
00058 
00059   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} vector\_to\_stl(gene\_vector & B, stl\_vector & B\_stl)\{
00060     B\_stl = B ;
00061   \}
00062 
00063 
00064   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} matrix\_to\_stl(gene\_matrix & A, stl\_matrix & A\_stl)\{
00065     A\_stl = A ;
00066   \}
00067 
00068   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} copy\_vector(\textcolor{keyword}{const} gene\_vector & source, gene\_vector & cible, \textcolor{keywordtype}{int} N)\{
00069     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00070       cible[i]=source[i];
00071     \}
00072   \}
00073 
00074 
00075   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} copy\_matrix(\textcolor{keyword}{const} gene\_matrix & source, gene\_matrix & cible, \textcolor{keywordtype}{int} N)\{
00076     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)
00077       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)
00078         cible[i][j]=source[i][j];
00079   \}
00080 
00081 \textcolor{comment}{//   static inline void ata\_product(const gene\_matrix & A, gene\_matrix & X, int N)}
00082 \textcolor{comment}{//   \{}
00083 \textcolor{comment}{//     real somme;}
00084 \textcolor{comment}{//     for (int j=0;j<N;j++)\{}
00085 \textcolor{comment}{//       for (int i=0;i<N;i++)\{}
00086 \textcolor{comment}{//         somme=0.0;}
00087 \textcolor{comment}{//         for (int k=0;k<N;k++)}
00088 \textcolor{comment}{//           somme += A[i][k]*A[j][k];}
00089 \textcolor{comment}{//         X[j][i]=somme;}
00090 \textcolor{comment}{//       \}}
00091 \textcolor{comment}{//     \}}
00092 \textcolor{comment}{//   \}}
00093 
00094   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} aat\_product(\textcolor{keyword}{const} gene\_matrix & A, gene\_matrix & X, \textcolor{keywordtype}{int} N)
00095   \{
00096     real somme;
00097     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)\{
00098       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00099         somme=0.0;
00100         \textcolor{keywordflow}{if}(i>=j)
00101         \{
00102           \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k=0;k<N;k++)\{
00103             somme+=A[k][i]*A[k][j];
00104           \}
00105           X[j][i]=somme;
00106         \}
00107       \}
00108     \}
00109   \}
00110 
00111 
00112   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} matrix\_matrix\_product(\textcolor{keyword}{const} gene\_matrix & A, \textcolor{keyword}{const} gene\_matrix & B, gene\_matrix & X, \textcolor{keywordtype}{
      int} N)
00113   \{
00114     real somme;
00115     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)\{
00116       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00117         somme=0.0;
00118         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k=0;k<N;k++)
00119           somme+=A[k][i]*B[j][k];
00120         X[j][i]=somme;
00121       \}
00122     \}
00123   \}
00124 
00125   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} matrix\_vector\_product(gene\_matrix & A, gene\_vector & B, gene\_vector & X, \textcolor{keywordtype}{int} N)
00126   \{
00127     real somme;
00128     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00129       somme=0.0;
00130       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)
00131         somme+=A[j][i]*B[j];
00132       X[i]=somme;
00133     \}
00134   \}
00135 
00136   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} symv(gene\_matrix & A, gene\_vector & B, gene\_vector & X, \textcolor{keywordtype}{int} N)
00137   \{
00138     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<N; ++j)
00139       X[j] = 0;
00140     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<N; ++j)
00141     \{
00142       real t1 = B[j];
00143       real t2 = 0;
00144       X[j] += t1 * A[j][j];
00145       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=j+1; i<N; ++i) \{
00146         X[i] += t1 * A[j][i];
00147         t2 += A[j][i] * B[i];
00148       \}
00149       X[j] += t2;
00150     \}
00151   \}
00152   
00153   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} syr2(gene\_matrix & A, gene\_vector & B, gene\_vector & X, \textcolor{keywordtype}{int} N)
00154   \{
00155     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<N; ++j)
00156     \{
00157       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=j; i<N; ++i)
00158         A[j][i] += B[i]*X[j] + B[j]*X[i];
00159     \}
00160   \}
00161 
00162   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} ger(gene\_matrix & A, gene\_vector & X, gene\_vector & Y, \textcolor{keywordtype}{int} N)
00163   \{
00164     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0; j<N; ++j)
00165     \{
00166       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=j; i<N; ++i)
00167         A[j][i] += X[i]*Y[j];
00168     \}
00169   \}
00170 
00171   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} atv\_product(gene\_matrix & A, gene\_vector & B, gene\_vector & X, \textcolor{keywordtype}{int} N)
00172   \{
00173     real somme;
00174     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00175       somme = 0.0;
00176       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)
00177         somme += A[i][j]*B[j];
00178       X[i] = somme;
00179     \}
00180   \}
00181 
00182   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} axpy(real coef, \textcolor{keyword}{const} gene\_vector & X, gene\_vector & Y, \textcolor{keywordtype}{int} N)\{
00183     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)
00184       Y[i]+=coef*X[i];
00185   \}
00186 
00187   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} axpby(real a, \textcolor{keyword}{const} gene\_vector & X, real b, gene\_vector & Y, \textcolor{keywordtype}{int} N)\{
00188     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)
00189       Y[i] = a*X[i] + b*Y[i];
00190   \}
00191 
00192   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} trisolve\_lower(\textcolor{keyword}{const} gene\_matrix & L, \textcolor{keyword}{const} gene\_vector & B, gene\_vector & X, \textcolor{keywordtype}{int} N)\{
00193     copy\_vector(B,X,N);
00194     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i=0; i<N; ++i)
00195     \{
00196       X[i] /= L[i][i];
00197       real tmp = X[i];
00198       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=i+1; j<N; ++j)
00199         X[j] -= tmp * L[i][j];
00200     \}
00201   \}
00202 
00203   \textcolor{keyword}{static} \textcolor{keyword}{inline} real norm\_diff(\textcolor{keyword}{const} stl\_vector & A, \textcolor{keyword}{const} stl\_vector & B)
00204   \{
00205     \textcolor{keywordtype}{int} N=A.size();
00206     real somme=0.0;
00207     real somme2=0.0;
00208 
00209     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00210       real diff=A[i]-B[i];
00211       somme+=diff*diff;
00212       somme2+=A[i]*A[i];
00213     \}
00214     \textcolor{keywordflow}{return} somme/somme2;
00215   \}
00216 
00217   \textcolor{keyword}{static} \textcolor{keyword}{inline} real norm\_diff(\textcolor{keyword}{const} stl\_matrix & A, \textcolor{keyword}{const} stl\_matrix & B)
00218   \{
00219     \textcolor{keywordtype}{int} N=A[0].size();
00220     real somme=0.0;
00221     real somme2=0.0;
00222 
00223     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00224       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j=0;j<N;j++)\{
00225         real diff=A[i][j] - B[i][j];
00226         somme += diff*diff;
00227         somme2 += A[i][j]*A[i][j];
00228       \}
00229     \}
00230 
00231     \textcolor{keywordflow}{return} somme/somme2;
00232   \}
00233 
00234   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keywordtype}{void} display\_vector(\textcolor{keyword}{const} stl\_vector & A)
00235   \{
00236     \textcolor{keywordtype}{int} N=A.size();
00237     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0;i<N;i++)\{
00238       INFOS(\textcolor{stringliteral}{"A["}<<i<<\textcolor{stringliteral}{"]="}<<A[i]<<endl);
00239     \}
00240   \}
00241 
00242 \};
00243 
00244 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
