\hypertarget{matio_2visual__studio_2test_2eigen_2lapack_2clarfg_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/lapack/clarfg.f}
\label{matio_2visual__studio_2test_2eigen_2lapack_2clarfg_8f_source}\index{clarfg.\+f@{clarfg.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b CLARFG}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download CLARFG + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/clarfg.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/clarfg.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/clarfg.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE CLARFG( N, ALPHA, X, INCX, TAU )}
00022 \textcolor{comment}{* }
00023 \textcolor{comment}{*       .. Scalar Arguments ..}
00024 \textcolor{comment}{*       INTEGER            INCX, N}
00025 \textcolor{comment}{*       COMPLEX            ALPHA, TAU}
00026 \textcolor{comment}{*       ..}
00027 \textcolor{comment}{*       .. Array Arguments ..}
00028 \textcolor{comment}{*       COMPLEX            X( * )}
00029 \textcolor{comment}{*       ..}
00030 \textcolor{comment}{*  }
00031 \textcolor{comment}{*}
00032 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00033 \textcolor{comment}{*  =============}
00034 \textcolor{comment}{*>}
00035 \textcolor{comment}{*> \(\backslash\)verbatim}
00036 \textcolor{comment}{*>}
00037 \textcolor{comment}{*> CLARFG generates a complex elementary reflector H of order n, such}
00038 \textcolor{comment}{*> that}
00039 \textcolor{comment}{*>}
00040 \textcolor{comment}{*>       H**H * ( alpha ) = ( beta ),   H**H * H = I.}
00041 \textcolor{comment}{*>              (   x   )   (   0  )}
00042 \textcolor{comment}{*>}
00043 \textcolor{comment}{*> where alpha and beta are scalars, with beta real, and x is an}
00044 \textcolor{comment}{*> (n-1)-element complex vector. H is represented in the form}
00045 \textcolor{comment}{*>}
00046 \textcolor{comment}{*>       H = I - tau * ( 1 ) * ( 1 v**H ) ,}
00047 \textcolor{comment}{*>                     ( v )}
00048 \textcolor{comment}{*>}
00049 \textcolor{comment}{*> where tau is a complex scalar and v is a complex (n-1)-element}
00050 \textcolor{comment}{*> vector. Note that H is not hermitian.}
00051 \textcolor{comment}{*>}
00052 \textcolor{comment}{*> If the elements of x are all zero and alpha is real, then tau = 0}
00053 \textcolor{comment}{*> and H is taken to be the unit matrix.}
00054 \textcolor{comment}{*>}
00055 \textcolor{comment}{*> Otherwise  1 <= real(tau) <= 2  and  abs(tau-1) <= 1 .}
00056 \textcolor{comment}{*> \(\backslash\)endverbatim}
00057 \textcolor{comment}{*}
00058 \textcolor{comment}{*  Arguments:}
00059 \textcolor{comment}{*  ==========}
00060 \textcolor{comment}{*}
00061 \textcolor{comment}{*> \(\backslash\)param[in] N}
00062 \textcolor{comment}{*> \(\backslash\)verbatim}
00063 \textcolor{comment}{*>          N is INTEGER}
00064 \textcolor{comment}{*>          The order of the elementary reflector.}
00065 \textcolor{comment}{*> \(\backslash\)endverbatim}
00066 \textcolor{comment}{*>}
00067 \textcolor{comment}{*> \(\backslash\)param[in,out] ALPHA}
00068 \textcolor{comment}{*> \(\backslash\)verbatim}
00069 \textcolor{comment}{*>          ALPHA is COMPLEX}
00070 \textcolor{comment}{*>          On entry, the value alpha.}
00071 \textcolor{comment}{*>          On exit, it is overwritten with the value beta.}
00072 \textcolor{comment}{*> \(\backslash\)endverbatim}
00073 \textcolor{comment}{*>}
00074 \textcolor{comment}{*> \(\backslash\)param[in,out] X}
00075 \textcolor{comment}{*> \(\backslash\)verbatim}
00076 \textcolor{comment}{*>          X is COMPLEX array, dimension}
00077 \textcolor{comment}{*>                         (1+(N-2)*abs(INCX))}
00078 \textcolor{comment}{*>          On entry, the vector x.}
00079 \textcolor{comment}{*>          On exit, it is overwritten with the vector v.}
00080 \textcolor{comment}{*> \(\backslash\)endverbatim}
00081 \textcolor{comment}{*>}
00082 \textcolor{comment}{*> \(\backslash\)param[in] INCX}
00083 \textcolor{comment}{*> \(\backslash\)verbatim}
00084 \textcolor{comment}{*>          INCX is INTEGER}
00085 \textcolor{comment}{*>          The increment between elements of X. INCX > 0.}
00086 \textcolor{comment}{*> \(\backslash\)endverbatim}
00087 \textcolor{comment}{*>}
00088 \textcolor{comment}{*> \(\backslash\)param[out] TAU}
00089 \textcolor{comment}{*> \(\backslash\)verbatim}
00090 \textcolor{comment}{*>          TAU is COMPLEX}
00091 \textcolor{comment}{*>          The value tau.}
00092 \textcolor{comment}{*> \(\backslash\)endverbatim}
00093 \textcolor{comment}{*}
00094 \textcolor{comment}{*  Authors:}
00095 \textcolor{comment}{*  ========}
00096 \textcolor{comment}{*}
00097 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00098 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00099 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00100 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00101 \textcolor{comment}{*}
00102 \textcolor{comment}{*> \(\backslash\)date November 2011}
00103 \textcolor{comment}{*}
00104 \textcolor{comment}{*> \(\backslash\)ingroup complexOTHERauxiliary}
00105 \textcolor{comment}{*}
00106 \textcolor{comment}{*  =====================================================================}
00107 \textcolor{keyword}{      SUBROUTINE }clarfg( N, ALPHA, X, INCX, TAU )
00108 \textcolor{comment}{*}
00109 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.0) --}
00110 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00111 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00112 \textcolor{comment}{*     November 2011}
00113 \textcolor{comment}{*}
00114 \textcolor{comment}{*     .. Scalar Arguments ..}
00115       \textcolor{keywordtype}{INTEGER}            incx, n
00116       \textcolor{keywordtype}{COMPLEX}            alpha, tau
00117 \textcolor{comment}{*     ..}
00118 \textcolor{comment}{*     .. Array Arguments ..}
00119       \textcolor{keywordtype}{COMPLEX}            x( * )
00120 \textcolor{comment}{*     ..}
00121 \textcolor{comment}{*}
00122 \textcolor{comment}{*  =====================================================================}
00123 \textcolor{comment}{*}
00124 \textcolor{comment}{*     .. Parameters ..}
00125       \textcolor{keywordtype}{REAL}               one, zero
00126       parameter( one = 1.0e+0, zero = 0.0e+0 )
00127 \textcolor{comment}{*     ..}
00128 \textcolor{comment}{*     .. Local Scalars ..}
00129       \textcolor{keywordtype}{INTEGER}            j, knt
00130       \textcolor{keywordtype}{REAL}               alphi, alphr, beta, rsafmn, safmin, xnorm
00131 \textcolor{comment}{*     ..}
00132 \textcolor{comment}{*     .. External Functions ..}
00133       \textcolor{keywordtype}{REAL}               scnrm2, slamch, slapy3
00134       \textcolor{keywordtype}{COMPLEX}            cladiv
00135       \textcolor{keywordtype}{EXTERNAL}           scnrm2, slamch, slapy3, cladiv
00136 \textcolor{comment}{*     ..}
00137 \textcolor{comment}{*     .. Intrinsic Functions ..}
00138       \textcolor{keywordtype}{INTRINSIC}          abs, aimag, cmplx, \textcolor{keywordtype}{REAL}, sign
00139 \textcolor{comment}{*     ..}
00140 \textcolor{comment}{*     .. External Subroutines ..}
00141       \textcolor{keywordtype}{EXTERNAL}           cscal, csscal
00142 \textcolor{comment}{*     ..}
00143 \textcolor{comment}{*     .. Executable Statements ..}
00144 \textcolor{comment}{*}
00145       \textcolor{keywordflow}{IF}( n.LE.0 ) \textcolor{keywordflow}{THEN}
00146          tau = zero
00147          \textcolor{keywordflow}{RETURN}
00148 \textcolor{keywordflow}{      END IF}
00149 \textcolor{comment}{*}
00150       xnorm = scnrm2( n-1, x, incx )
00151       alphr = \textcolor{keywordtype}{REAL}( alpha )
00152       alphi = aimag( alpha )
00153 \textcolor{comment}{*}
00154       \textcolor{keywordflow}{IF}( xnorm.EQ.zero .AND. alphi.EQ.zero ) \textcolor{keywordflow}{THEN}
00155 \textcolor{comment}{*}
00156 \textcolor{comment}{*        H  =  I}
00157 \textcolor{comment}{*}
00158          tau = zero
00159       \textcolor{keywordflow}{ELSE}
00160 \textcolor{comment}{*}
00161 \textcolor{comment}{*        general case}
00162 \textcolor{comment}{*}
00163          beta = -sign( slapy3( alphr, alphi, xnorm ), alphr )
00164          safmin = slamch( \textcolor{stringliteral}{'S'} ) / slamch( \textcolor{stringliteral}{'E'} )
00165          rsafmn = one / safmin
00166 \textcolor{comment}{*}
00167          knt = 0
00168          \textcolor{keywordflow}{IF}( abs( beta ).LT.safmin ) \textcolor{keywordflow}{THEN}
00169 \textcolor{comment}{*}
00170 \textcolor{comment}{*           XNORM, BETA may be inaccurate; scale X and recompute them}
00171 \textcolor{comment}{*}
00172    10       \textcolor{keywordflow}{CONTINUE}
00173             knt = knt + 1
00174             \textcolor{keyword}{CALL }csscal( n-1, rsafmn, x, incx )
00175             beta = beta*rsafmn
00176             alphi = alphi*rsafmn
00177             alphr = alphr*rsafmn
00178             \textcolor{keywordflow}{IF}( abs( beta ).LT.safmin )
00179      $         \textcolor{keywordflow}{GO TO} 10
00180 \textcolor{comment}{*}
00181 \textcolor{comment}{*           New BETA is at most 1, at least SAFMIN}
00182 \textcolor{comment}{*}
00183             xnorm = scnrm2( n-1, x, incx )
00184             alpha = cmplx( alphr, alphi )
00185             beta = -sign( slapy3( alphr, alphi, xnorm ), alphr )
00186 \textcolor{keywordflow}{         END IF}
00187          tau = cmplx( ( beta-alphr ) / beta, -alphi / beta )
00188          alpha = cladiv( cmplx( one ), alpha-beta )
00189          \textcolor{keyword}{CALL }cscal( n-1, alpha, x, incx )
00190 \textcolor{comment}{*}
00191 \textcolor{comment}{*        If ALPHA is subnormal, it may lose relative accuracy}
00192 \textcolor{comment}{*}
00193          \textcolor{keywordflow}{DO} 20 j = 1, knt
00194             beta = beta*safmin
00195  20      \textcolor{keywordflow}{CONTINUE}
00196          alpha = beta
00197 \textcolor{keywordflow}{      END IF}
00198 \textcolor{comment}{*}
00199       \textcolor{keywordflow}{RETURN}
00200 \textcolor{comment}{*}
00201 \textcolor{comment}{*     End of CLARFG}
00202 \textcolor{comment}{*}
00203 \textcolor{keyword}{      END}
\end{DoxyCode}
