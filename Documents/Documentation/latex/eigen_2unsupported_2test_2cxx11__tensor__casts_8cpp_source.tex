\hypertarget{eigen_2unsupported_2test_2cxx11__tensor__casts_8cpp_source}{}\section{eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+casts.cpp}
\label{eigen_2unsupported_2test_2cxx11__tensor__casts_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+casts.\+cpp@{cxx11\+\_\+tensor\+\_\+casts.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1array}{Eigen::array};
00016 
00017 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_simple\_cast()
00018 \{
00019   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2>} ftensor(20,30);
00020   ftensor = ftensor.random() * 100.f;
00021   \hyperlink{class_eigen_1_1_tensor}{Tensor<char, 2>} chartensor(20,30);
00022   chartensor.setRandom();
00023   \hyperlink{class_eigen_1_1_tensor}{Tensor<std::complex<float>}, 2> cplextensor(20,30);
00024   cplextensor.setRandom();
00025 
00026   chartensor = ftensor.cast<\textcolor{keywordtype}{char}>();
00027   cplextensor = ftensor.cast<std::complex<float> >();
00028 
00029   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; ++i) \{
00030     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 30; ++j) \{
00031       VERIFY\_IS\_EQUAL(chartensor(i,j), static\_cast<char>(ftensor(i,j)));
00032       VERIFY\_IS\_EQUAL(cplextensor(i,j), \textcolor{keyword}{static\_cast<}std::complex<float> \textcolor{keyword}{>}(ftensor(i,j)));
00033     \}
00034   \}
00035 \}
00036 
00037 
00038 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_vectorized\_cast()
00039 \{
00040   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 2>} itensor(20,30);
00041   itensor = itensor.random() / 1000;
00042   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2>} ftensor(20,30);
00043   ftensor.setRandom();
00044   \hyperlink{class_eigen_1_1_tensor}{Tensor<double, 2>} dtensor(20,30);
00045   dtensor.setRandom();
00046 
00047   ftensor = itensor.cast<\textcolor{keywordtype}{float}>();
00048   dtensor = itensor.cast<\textcolor{keywordtype}{double}>();
00049 
00050   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; ++i) \{
00051     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 30; ++j) \{
00052       VERIFY\_IS\_EQUAL(itensor(i,j), static\_cast<int>(ftensor(i,j)));
00053       VERIFY\_IS\_EQUAL(dtensor(i,j), static\_cast<double>(ftensor(i,j)));
00054     \}
00055   \}
00056 \}
00057 
00058 
00059 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_float\_to\_int\_cast()
00060 \{
00061   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2>} ftensor(20,30);
00062   ftensor = ftensor.random() * 1000.0f;
00063   \hyperlink{class_eigen_1_1_tensor}{Tensor<double, 2>} dtensor(20,30);
00064   dtensor = dtensor.random() * 1000.0;
00065 
00066   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 2>} i1tensor = ftensor.cast<\textcolor{keywordtype}{int}>();
00067   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 2>} i2tensor = dtensor.cast<\textcolor{keywordtype}{int}>();
00068 
00069   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; ++i) \{
00070     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 30; ++j) \{
00071       VERIFY\_IS\_EQUAL(i1tensor(i,j), static\_cast<int>(ftensor(i,j)));
00072       VERIFY\_IS\_EQUAL(i2tensor(i,j), static\_cast<int>(dtensor(i,j)));
00073     \}
00074   \}
00075 \}
00076 
00077 
00078 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_big\_to\_small\_type\_cast()
00079 \{
00080   \hyperlink{class_eigen_1_1_tensor}{Tensor<double, 2>} dtensor(20, 30);
00081   dtensor.setRandom();
00082   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2>} ftensor(20, 30);
00083   ftensor = dtensor.cast<\textcolor{keywordtype}{float}>();
00084 
00085   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; ++i) \{
00086     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 30; ++j) \{
00087       VERIFY\_IS\_APPROX(dtensor(i,j), static\_cast<double>(ftensor(i,j)));
00088     \}
00089   \}
00090 \}
00091 
00092 
00093 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_small\_to\_big\_type\_cast()
00094 \{
00095   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2>} ftensor(20, 30);
00096   ftensor.setRandom();
00097   \hyperlink{class_eigen_1_1_tensor}{Tensor<double, 2>} dtensor(20, 30);
00098   dtensor = ftensor.cast<\textcolor{keywordtype}{double}>();
00099 
00100   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 20; ++i) \{
00101     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 30; ++j) \{
00102       VERIFY\_IS\_APPROX(dtensor(i,j), static\_cast<double>(ftensor(i,j)));
00103     \}
00104   \}
00105 \}
00106 
00107 
00108 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_casts()
00109 \{
00110    CALL\_SUBTEST(test\_simple\_cast());
00111    CALL\_SUBTEST(test\_vectorized\_cast());
00112    CALL\_SUBTEST(test\_float\_to\_int\_cast());
00113    CALL\_SUBTEST(test\_big\_to\_small\_type\_cast());
00114    CALL\_SUBTEST(test\_small\_to\_big\_type\_cast());
00115 \}
\end{DoxyCode}
