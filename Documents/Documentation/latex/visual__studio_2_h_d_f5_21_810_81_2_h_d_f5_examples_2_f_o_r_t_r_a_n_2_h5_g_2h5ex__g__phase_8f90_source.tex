\hypertarget{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_g_2h5ex__g__phase_8f90_source}{}\section{visual\+\_\+studio/\+H\+D\+F5/1.10.1/\+H\+D\+F5\+Examples/\+F\+O\+R\+T\+R\+A\+N/\+H5\+G/h5ex\+\_\+g\+\_\+phase.f90}
\label{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_g_2h5ex__g__phase_8f90_source}\index{h5ex\+\_\+g\+\_\+phase.\+f90@{h5ex\+\_\+g\+\_\+phase.\+f90}}

\begin{DoxyCode}
00001 \textcolor{comment}{!************************************************************}
00002 \textcolor{comment}{!}
00003 \textcolor{comment}{!  This example shows how to set the conditions for}
00004 \textcolor{comment}{!  conversion between compact and dense (indexed) groups.}
00005 \textcolor{comment}{!}
00006 \textcolor{comment}{!  This file is intended for use with HDF5 Library verion 1.8}
00007 \textcolor{comment}{!}
00008 \textcolor{comment}{!************************************************************}
00009 \textcolor{keyword}{PROGRAM} main
00010 
00011   \textcolor{keywordtype}{USE }hdf5
00012   \textcolor{keywordtype}{IMPLICIT NONE}
00013 
00014   \textcolor{keywordtype}{CHARACTER(LEN=15)}, \textcolor{keywordtype}{PARAMETER} :: filename  = \textcolor{stringliteral}{"h5ex\_g\_phase.h5"}
00015   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: max\_groups  = 7
00016   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: max\_compact = 5
00017   \textcolor{keywordtype}{INTEGER}, \textcolor{keywordtype}{PARAMETER} :: min\_dense   = 3
00018 
00019   \textcolor{keywordtype}{INTEGER(HID\_T)}   :: \hyperlink{structfile}{file}, group, subgroup, fapl, gcpl \textcolor{comment}{! handles}
00020   \textcolor{keywordtype}{INTEGER} :: hdferr
00021   \textcolor{keywordtype}{INTEGER} :: storage\_type \textcolor{comment}{! Type of storage for links in group:}
00022                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_COMPACT\_F: Compact storage}
00023                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_DENSE\_F: Indexed storage}
00024                           \textcolor{comment}{!   H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE\_F: Symbol tables}
00025   \textcolor{keywordtype}{INTEGER} :: nlinks       \textcolor{comment}{! Number of links in group}
00026   \textcolor{keywordtype}{INTEGER} :: max\_corder   \textcolor{comment}{! Current maximum creation order value for group}
00027   \textcolor{keywordtype}{CHARACTER(LEN=2)} :: name = \textcolor{stringliteral}{"G0"} \textcolor{comment}{! Name of subgroup}
00028   \textcolor{keywordtype}{INTEGER} :: i
00029   \textcolor{comment}{!}
00030   \textcolor{comment}{! Initialize FORTRAN interface.}
00031   \textcolor{comment}{!}
00032   \textcolor{keyword}{CALL }h5open\_f(hdferr)
00033   \textcolor{comment}{!}
00034   \textcolor{comment}{! Set file access property list to allow the latest file format.}
00035   \textcolor{comment}{! This will allow the library to create new format groups.}
00036   \textcolor{comment}{!}
00037   \textcolor{keyword}{CALL }h5pcreate\_f (h5p\_file\_access\_f, fapl, hdferr)
00038   \textcolor{keyword}{CALL }h5pset\_libver\_bounds\_f (fapl, h5f\_libver\_latest\_f, h5f\_libver\_latest\_f, hdferr)
00039   \textcolor{comment}{!}
00040   \textcolor{comment}{! Create group access property list and set the phase change}
00041   \textcolor{comment}{! conditions.  In this example we lowered the conversion threshold}
00042   \textcolor{comment}{! to simplify the output, though this may not be optimal.}
00043   \textcolor{comment}{!}
00044   \textcolor{keyword}{CALL }h5pcreate\_f (h5p\_group\_create\_f, gcpl, hdferr)
00045   \textcolor{keyword}{CALL }h5pset\_link\_phase\_change\_f (gcpl, max\_compact, min\_dense, hdferr)
00046   \textcolor{comment}{!}
00047   \textcolor{comment}{! Create a new file using the default properties.}
00048   \textcolor{comment}{!}
00049   \textcolor{keyword}{CALL }h5fcreate\_f(filename, h5f\_acc\_trunc\_f, \hyperlink{structfile}{file}, hdferr, access\_prp=fapl )
00050   \textcolor{comment}{!}
00051   \textcolor{comment}{! Create primary group.}
00052   \textcolor{comment}{!}
00053   \textcolor{keyword}{CALL }h5gcreate\_f(\hyperlink{structfile}{file}, name, group, hdferr, gcpl\_id=gcpl)
00054   \textcolor{comment}{!}
00055   \textcolor{comment}{! Add subgroups to "group" one at a time, print the storage type}
00056   \textcolor{comment}{! for "group" after each subgroup is created.}
00057   \textcolor{comment}{!}
00058   \textcolor{keywordflow}{DO} i = 1, max\_groups
00059      \textcolor{comment}{!}
00060      \textcolor{comment}{! Define the subgroup name and create the subgroup.}
00061      \textcolor{comment}{!}
00062      \textcolor{keyword}{WRITE}(name,\textcolor{stringliteral}{'(A,I1)'}) \textcolor{stringliteral}{"G"},i \textcolor{comment}{! G1, G2, G3 etc.}
00063 
00064      \textcolor{keyword}{CALL }h5gcreate\_f(group, name, subgroup, hdferr)
00065      \textcolor{keyword}{CALL }h5gclose\_f(subgroup, hdferr)
00066      \textcolor{comment}{!}
00067      \textcolor{comment}{! Obtain the group info and print the group storage type}
00068      \textcolor{comment}{!}
00069      \textcolor{keyword}{CALL }h5gget\_info\_f(group, storage\_type, nlinks, max\_corder, hdferr)
00070      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'(I1," Groups: Storage type is ")'}, advance=\textcolor{stringliteral}{'NO'}) nlinks
00071      \textcolor{keywordflow}{IF}(storage\_type.EQ. h5g\_storage\_type\_compact\_f)\textcolor{keywordflow}{THEN}
00072         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_COMPACT\_F")'})  \textcolor{comment}{! New compact format}
00073      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_dense\_f)\textcolor{keywordflow}{THEN}
00074         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_DENSE\_F")'}) \textcolor{comment}{! New dense (indexed) format}
00075      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_symbol\_table\_f)\textcolor{keywordflow}{THEN}
00076         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE")'}) \textcolor{comment}{! Original format}
00077      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_unknown\_f)\textcolor{keywordflow}{THEN}
00078         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_UNKNOWN\_F")'}) \textcolor{comment}{! Unknown format}
00079 \textcolor{keywordflow}{     END IF}
00080 \textcolor{keywordflow}{  ENDDO}
00081   \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'()'})
00082   \textcolor{comment}{!}
00083   \textcolor{comment}{! Delete subgroups one at a time, print the storage type for}
00084   \textcolor{comment}{!"group" after each subgroup is deleted.}
00085   \textcolor{comment}{!}
00086   \textcolor{keywordflow}{DO} i = max\_groups,1, -1
00087      \textcolor{comment}{!}
00088      \textcolor{comment}{! Define the subgroup name and delete the subgroup.}
00089      \textcolor{comment}{!}
00090      \textcolor{keyword}{WRITE}(name,\textcolor{stringliteral}{'(A,I1)'}) \textcolor{stringliteral}{"G"},i \textcolor{comment}{! G1, G2, G3 etc.}
00091      \textcolor{keyword}{CALL }h5ldelete\_f(group, name, hdferr)
00092      \textcolor{comment}{!}
00093      \textcolor{comment}{! Obtain the group info and print the group storage type}
00094      \textcolor{comment}{!}
00095      \textcolor{keyword}{CALL }h5gget\_info\_f(group, storage\_type, nlinks, max\_corder, hdferr)
00096      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'(I1," Groups: Storage type is ")'}, advance=\textcolor{stringliteral}{'NO'}) nlinks
00097      \textcolor{keywordflow}{IF}(storage\_type.EQ. h5g\_storage\_type\_compact\_f)\textcolor{keywordflow}{THEN}
00098         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_COMPACT\_F")'})  \textcolor{comment}{! New compact format}
00099      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_dense\_f)\textcolor{keywordflow}{THEN}
00100         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_DENSE\_F")'}) \textcolor{comment}{! New dense (indexed) format}
00101      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}(storage\_type.EQ.h5g\_storage\_type\_symbol\_table\_f)\textcolor{keywordflow}{THEN}
00102         \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'("H5G\_STORAGE\_TYPE\_SYMBOL\_TABLE")'}) \textcolor{comment}{! Original format}
00103 \textcolor{keywordflow}{     END IF}
00104 \textcolor{keywordflow}{  ENDDO}
00105   \textcolor{comment}{!}
00106   \textcolor{comment}{! Close and release resources.}
00107   \textcolor{comment}{!}
00108   \textcolor{keyword}{CALL }h5pclose\_f(fapl, hdferr)
00109   \textcolor{keyword}{CALL }h5pclose\_f(gcpl, hdferr)
00110   \textcolor{keyword}{CALL }h5gclose\_f(group, hdferr)
00111   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file}, hdferr)
00112 
00113 \textcolor{keyword}{END PROGRAM }main
\end{DoxyCode}
