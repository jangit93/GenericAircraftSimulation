\hypertarget{_executive_8cpp_source}{}\section{Executive.\+cpp}
\label{_executive_8cpp_source}\index{Executive.\+cpp@{Executive.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{preprocessor}{#include"readInData.h"}
00002 \textcolor{preprocessor}{#include"LinearInterpolation.h"}
00003 \textcolor{preprocessor}{#include"Atmosphere.h"}
00004 \textcolor{preprocessor}{#include"DataLogger.h"}
00005 \textcolor{preprocessor}{#include"DataCloud.h"}
00006 \textcolor{preprocessor}{#include"Engine.h"}
00007 \textcolor{preprocessor}{#include<Map>}
00008 \textcolor{preprocessor}{#include<math.h>}
00009 \textcolor{preprocessor}{#include <iostream>}
00010 \textcolor{preprocessor}{#include<ctime>}
00011 \textcolor{preprocessor}{#include"Aerodynamic.h"}
00012 \textcolor{preprocessor}{#include"Airframe.h"}
00013 \textcolor{preprocessor}{#include"Trajectory.h"}
00014 \textcolor{preprocessor}{#include"ODESolver.cpp"}
00015 \textcolor{preprocessor}{#include"Transformation.h"}
00016 
00017 \textcolor{keywordtype}{int} main(\textcolor{keywordtype}{int} argv, \textcolor{keywordtype}{char}* argc[])
00018 \{
00019     \textcolor{keywordtype}{double} time1 = 0.0, tstart;      \textcolor{comment}{// time measurment variable}
00020 
00021 \textcolor{comment}{//#pragma omp parallel }
00022         tstart = clock();              \textcolor{comment}{// start }
00023 
00024 
00025         std::cout << \textcolor{stringliteral}{"---------Aircraft Simulation----------"} << std::endl;
00026 
00027         SimDPreference check;
00028         \hyperlink{group___trajectory_class_trajectory}{Trajectory} *Test = \textcolor{keyword}{new} \hyperlink{group___trajectory_class_trajectory}{Trajectory}(check);
00029         \hyperlink{group___atmosphere_class_atmopshere}{Atmopshere} *Atmo = \textcolor{keyword}{new} \hyperlink{group___atmosphere_class_atmopshere}{Atmopshere};
00030         \hyperlink{class_transformation}{Transformation} *Trafo = \textcolor{keyword}{new} \hyperlink{class_transformation}{Transformation};
00031         \hyperlink{group___tools_ga3f1431cb9f76da10f59246d1d743dc2c}{Float64}              FlightTime = 1;
00032         AtmosphereStruct    AtmoData;
00033         AerodynamicStruct   AeroData;
00034         AirframeStruct      AirframeData;
00035         ThrustStruct        ThrustData;
00036         AircraftStruct      AircraftData;
00037         GuidanceStruct      GuidamceData;
00038 
00039         \hyperlink{class_mat_file_reader}{MatFileReader} test(\textcolor{stringliteral}{"../Autopilot.mat"});
00040 
00041         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} MatFileData = test.getMatFileInfo(\textcolor{stringliteral}{"AutopilotData"});
00042         \textcolor{keywordtype}{int} Fields = MatFileData.\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0] * MatFileData.\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[1];
00043 
00044         AutopilotStruct * AutopilotData = \textcolor{keyword}{new} AutopilotStruct[Fields];
00045 
00046         \textcolor{keywordtype}{int} start, stride, edge, copy\_field = 0;
00047         stride = 0;
00048         edge = 9;
00049 
00050         \textcolor{keywordflow}{for} (start = 0; start < Fields; start++) \{
00051             AutopilotData[start].Alt = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Alt"}, start, stride, edge, 
      copy\_field));
00052             AutopilotData[start].Vel = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Vel"}, start, stride, edge, 
      copy\_field));
00053             AutopilotData[start].x\_bar = std::get<1>(test.readMatFileStructure(\textcolor{stringliteral}{"x\_bar"}, start, stride, edge
      , copy\_field));
00054             AutopilotData[start].u\_bar = std::get<1>(test.readMatFileStructure(\textcolor{stringliteral}{"u\_bar"}, start, stride, edge
      , copy\_field));
00055             AutopilotData[start].Kx\_pitch = std::get<1>(test.readMatFileStructure(\textcolor{stringliteral}{"Kx\_pitch"}, start, stride
      , edge, copy\_field));
00056             AutopilotData[start].Ke\_pitch = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Ke\_pitch"}, start, stride
      , edge, copy\_field));
00057             AutopilotData[start].Kv\_pitch = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Kv\_pitch"}, start, stride
      , edge, copy\_field));
00058             AutopilotData[start].Kx\_Vel = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Kx\_Vel"}, start, stride, 
      edge, copy\_field));
00059             AutopilotData[start].Ke\_Vel = std::get<2>(test.readMatFileStructure(\textcolor{stringliteral}{"Ke\_Vel"}, start, stride, 
      edge, copy\_field));
00060             AutopilotData[start].Kx\_lat = std::get<0>(test.readMatFileStructure(\textcolor{stringliteral}{"Kx\_lat"}, start, stride, 
      edge, copy\_field));
00061             AutopilotData[start].Ke\_lat = std::get<0>(test.readMatFileStructure(\textcolor{stringliteral}{"Ke\_lat"}, start, stride, 
      edge, copy\_field));
00062         \}
00063 
00064 
00065 
00066         
00067         Test->initTrajectory(AeroData,
00068                             AirframeData,
00069                             ThrustData,
00070                             AircraftData,
00071                             GuidamceData);
00072 
00073         Atmo->\hyperlink{group___atmosphere_a6e1d5763fbb6631784c99ee3c88911bd}{initAtmosphere}();
00074 
00075         AirframeData.Eta = AutopilotData[0].u\_bar(1);
00076         AirframeData.posNED(2) = -AutopilotData[0].Alt;
00077         AirframeData.velNED(0) = AutopilotData[0].Vel;
00078         AirframeData.StickPosition = AutopilotData[0].u\_bar(3);
00079         AirframeData.EulerAngles(1) = AutopilotData[0].x\_bar(1);
00080         std::cout << \textcolor{stringliteral}{"--------------------------------------"} << std::endl;
00081         system(\textcolor{stringliteral}{"pause"});
00082 
00083         AirframeData.velNED          = EulerIntegration(AirframeData.velNED, AirframeData.accTransNED, 0.01
      );
00084         AirframeData.posNED          = EulerIntegration(AirframeData.posNED, AirframeData.velNED, 0.01);
00085         AirframeData.rotRatesBody    = EulerIntegration(AirframeData.rotRatesBody, AirframeData.accRotBody,
      0.01);
00086         AirframeData.EulerAngles     = EulerIntegration(AirframeData.EulerAngles, AirframeData.Eulerdot, 0.
      01);
00087 
00088         AirframeData.Gamma = atan2(-AirframeData.velNED(2), sqrt(AirframeData.velNED(0)*AirframeData.velNED
      (0) + AirframeData.velNED(0)*AirframeData.velNED(0)));
00089 
00090         AirframeData.Chi = atan2(AirframeData.velNED(1), AirframeData.velNED(0));
00091 
00092         AirframeData.matNEDToBody = Trafo->MatNedToBody(AirframeData.EulerAngles(0), AirframeData.
      EulerAngles(1), AirframeData.EulerAngles(2));
00093         AirframeData.matBodyToNED = Trafo->MatBodyToNED(AirframeData.matNEDToBody);
00094         AirframeData.matNEDToTraj = Trafo->MatBodyToTrajectory(AirframeData.Gamma, AirframeData.Chi);
00095 
00096         Atmo->\hyperlink{group___atmosphere_a2bd97471d32725d6196ee6816ea36c99}{updateAtmosphere}(AirframeData.posNED(2), AtmoData);
00097         Test->updateTrajectory(FlightTime,
00098                                 AtmoData,
00099                                 AeroData,
00100                                 AirframeData,
00101                                 ThrustData,
00102                                 GuidamceData);
00103 
00104     time1 += clock() - tstart;     \textcolor{comment}{// end}
00105     time1 = time1 / CLOCKS\_PER\_SEC;  \textcolor{comment}{// rescale to seconds}
00106 
00107     std::cout << \textcolor{stringliteral}{"Simulationszeit = "} << time1 << \textcolor{stringliteral}{" sec."} << std::endl;
00108 
00109     system(\textcolor{stringliteral}{"Pause"});
00110 
00111 \}
\end{DoxyCode}
