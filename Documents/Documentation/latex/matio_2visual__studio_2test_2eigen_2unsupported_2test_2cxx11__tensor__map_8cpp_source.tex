\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__map_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+map.cpp}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__map_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+map.\+cpp@{cxx11\+\_\+tensor\+\_\+map.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 \textcolor{keyword}{using} \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{Eigen::RowMajor};
00016 
00017 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_0d()
00018 \{
00019   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 0>} scalar1;
00020   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 0, RowMajor>} scalar2;
00021 
00022   TensorMap<Tensor<const int, 0> > scalar3(scalar1.data());
00023   TensorMap<Tensor<const int, 0, RowMajor> > scalar4(scalar2.data());
00024 
00025   scalar1() = 7;
00026   scalar2() = 13;
00027 
00028   VERIFY\_IS\_EQUAL(scalar1.rank(), 0);
00029   VERIFY\_IS\_EQUAL(scalar1.size(), 1);
00030 
00031   VERIFY\_IS\_EQUAL(scalar3(), 7);
00032   VERIFY\_IS\_EQUAL(scalar4(), 13);
00033 \}
00034 
00035 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_1d()
00036 \{
00037   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 1>} vec1(6);
00038   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 1, RowMajor>} vec2(6);
00039 
00040   TensorMap<Tensor<const int, 1> > vec3(vec1.data(), 6);
00041   TensorMap<Tensor<const int, 1, RowMajor> > vec4(vec2.data(), 6);
00042 
00043   vec1(0) = 4;  vec2(0) = 0;
00044   vec1(1) = 8;  vec2(1) = 1;
00045   vec1(2) = 15; vec2(2) = 2;
00046   vec1(3) = 16; vec2(3) = 3;
00047   vec1(4) = 23; vec2(4) = 4;
00048   vec1(5) = 42; vec2(5) = 5;
00049 
00050   VERIFY\_IS\_EQUAL(vec1.rank(), 1);
00051   VERIFY\_IS\_EQUAL(vec1.size(), 6);
00052   VERIFY\_IS\_EQUAL(vec1.dimension(0), 6);
00053 
00054   VERIFY\_IS\_EQUAL(vec3(0), 4);
00055   VERIFY\_IS\_EQUAL(vec3(1), 8);
00056   VERIFY\_IS\_EQUAL(vec3(2), 15);
00057   VERIFY\_IS\_EQUAL(vec3(3), 16);
00058   VERIFY\_IS\_EQUAL(vec3(4), 23);
00059   VERIFY\_IS\_EQUAL(vec3(5), 42);
00060 
00061   VERIFY\_IS\_EQUAL(vec4(0), 0);
00062   VERIFY\_IS\_EQUAL(vec4(1), 1);
00063   VERIFY\_IS\_EQUAL(vec4(2), 2);
00064   VERIFY\_IS\_EQUAL(vec4(3), 3);
00065   VERIFY\_IS\_EQUAL(vec4(4), 4);
00066   VERIFY\_IS\_EQUAL(vec4(5), 5);
00067 \}
00068 
00069 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_2d()
00070 \{
00071   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 2>} mat1(2,3);
00072   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 2, RowMajor>} mat2(2,3);
00073 
00074   mat1(0,0) = 0;
00075   mat1(0,1) = 1;
00076   mat1(0,2) = 2;
00077   mat1(1,0) = 3;
00078   mat1(1,1) = 4;
00079   mat1(1,2) = 5;
00080 
00081   mat2(0,0) = 0;
00082   mat2(0,1) = 1;
00083   mat2(0,2) = 2;
00084   mat2(1,0) = 3;
00085   mat2(1,1) = 4;
00086   mat2(1,2) = 5;
00087 
00088   TensorMap<Tensor<const int, 2> > mat3(mat1.data(), 2, 3);
00089   TensorMap<Tensor<const int, 2, RowMajor> > mat4(mat2.data(), 2, 3);
00090 
00091   VERIFY\_IS\_EQUAL(mat3.rank(), 2);
00092   VERIFY\_IS\_EQUAL(mat3.size(), 6);
00093   VERIFY\_IS\_EQUAL(mat3.dimension(0), 2);
00094   VERIFY\_IS\_EQUAL(mat3.dimension(1), 3);
00095 
00096   VERIFY\_IS\_EQUAL(mat4.rank(), 2);
00097   VERIFY\_IS\_EQUAL(mat4.size(), 6);
00098   VERIFY\_IS\_EQUAL(mat4.dimension(0), 2);
00099   VERIFY\_IS\_EQUAL(mat4.dimension(1), 3);
00100 
00101   VERIFY\_IS\_EQUAL(mat3(0,0), 0);
00102   VERIFY\_IS\_EQUAL(mat3(0,1), 1);
00103   VERIFY\_IS\_EQUAL(mat3(0,2), 2);
00104   VERIFY\_IS\_EQUAL(mat3(1,0), 3);
00105   VERIFY\_IS\_EQUAL(mat3(1,1), 4);
00106   VERIFY\_IS\_EQUAL(mat3(1,2), 5);
00107 
00108   VERIFY\_IS\_EQUAL(mat4(0,0), 0);
00109   VERIFY\_IS\_EQUAL(mat4(0,1), 1);
00110   VERIFY\_IS\_EQUAL(mat4(0,2), 2);
00111   VERIFY\_IS\_EQUAL(mat4(1,0), 3);
00112   VERIFY\_IS\_EQUAL(mat4(1,1), 4);
00113   VERIFY\_IS\_EQUAL(mat4(1,2), 5);
00114 \}
00115 
00116 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_3d()
00117 \{
00118   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3>} mat1(2,3,7);
00119   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3, RowMajor>} mat2(2,3,7);
00120 
00121   \textcolor{keywordtype}{int} val = 0;
00122   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00123     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00124       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00125         mat1(i,j,k) = val;
00126         mat2(i,j,k) = val;
00127         val++;
00128       \}
00129     \}
00130   \}
00131 
00132   TensorMap<Tensor<const int, 3> > mat3(mat1.data(), 2, 3, 7);
00133   TensorMap<Tensor<const int, 3, RowMajor> > mat4(mat2.data(), 2, 3, 7);
00134 
00135   VERIFY\_IS\_EQUAL(mat3.rank(), 3);
00136   VERIFY\_IS\_EQUAL(mat3.size(), 2*3*7);
00137   VERIFY\_IS\_EQUAL(mat3.dimension(0), 2);
00138   VERIFY\_IS\_EQUAL(mat3.dimension(1), 3);
00139   VERIFY\_IS\_EQUAL(mat3.dimension(2), 7);
00140 
00141   VERIFY\_IS\_EQUAL(mat4.rank(), 3);
00142   VERIFY\_IS\_EQUAL(mat4.size(), 2*3*7);
00143   VERIFY\_IS\_EQUAL(mat4.dimension(0), 2);
00144   VERIFY\_IS\_EQUAL(mat4.dimension(1), 3);
00145   VERIFY\_IS\_EQUAL(mat4.dimension(2), 7);
00146 
00147   val = 0;
00148   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00149     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00150       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00151         VERIFY\_IS\_EQUAL(mat3(i,j,k), val);
00152         VERIFY\_IS\_EQUAL(mat4(i,j,k), val);
00153         val++;
00154       \}
00155     \}
00156   \}
00157 \}
00158 
00159 
00160 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_from\_tensor()
00161 \{
00162   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3>} mat1(2,3,7);
00163   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3, RowMajor>} mat2(2,3,7);
00164 
00165   \textcolor{keywordtype}{int} val = 0;
00166   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00167     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00168       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00169         mat1(i,j,k) = val;
00170         mat2(i,j,k) = val;
00171         val++;
00172       \}
00173     \}
00174   \}
00175 
00176   TensorMap<Tensor<int, 3> > mat3(mat1);
00177   TensorMap<Tensor<int, 3, RowMajor> > mat4(mat2);
00178 
00179   VERIFY\_IS\_EQUAL(mat3.rank(), 3);
00180   VERIFY\_IS\_EQUAL(mat3.size(), 2*3*7);
00181   VERIFY\_IS\_EQUAL(mat3.dimension(0), 2);
00182   VERIFY\_IS\_EQUAL(mat3.dimension(1), 3);
00183   VERIFY\_IS\_EQUAL(mat3.dimension(2), 7);
00184 
00185   VERIFY\_IS\_EQUAL(mat4.rank(), 3);
00186   VERIFY\_IS\_EQUAL(mat4.size(), 2*3*7);
00187   VERIFY\_IS\_EQUAL(mat4.dimension(0), 2);
00188   VERIFY\_IS\_EQUAL(mat4.dimension(1), 3);
00189   VERIFY\_IS\_EQUAL(mat4.dimension(2), 7);
00190 
00191   val = 0;
00192   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00193     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00194       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00195         VERIFY\_IS\_EQUAL(mat3(i,j,k), val);
00196         VERIFY\_IS\_EQUAL(mat4(i,j,k), val);
00197         val++;
00198       \}
00199     \}
00200   \}
00201 
00202   TensorFixedSize<int, Sizes<2,3,7> > mat5;
00203 
00204   val = 0;
00205   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00206     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00207       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00208         array<ptrdiff\_t, 3> coords;
00209         coords[0] = i;
00210         coords[1] = j;
00211         coords[2] = k;
00212         mat5(coords) = val;
00213         val++;
00214       \}
00215     \}
00216   \}
00217 
00218   TensorMap<TensorFixedSize<int, Sizes<2,3,7> > > mat6(mat5);
00219 
00220   VERIFY\_IS\_EQUAL(mat6.rank(), 3);
00221   VERIFY\_IS\_EQUAL(mat6.size(), 2*3*7);
00222   VERIFY\_IS\_EQUAL(mat6.dimension(0), 2);
00223   VERIFY\_IS\_EQUAL(mat6.dimension(1), 3);
00224   VERIFY\_IS\_EQUAL(mat6.dimension(2), 7);
00225 
00226   val = 0;
00227   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00228     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00229       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00230         VERIFY\_IS\_EQUAL(mat6(i,j,k), val);
00231         val++;
00232       \}
00233     \}
00234   \}
00235 \}
00236 
00237 
00238 \textcolor{keyword}{static} \textcolor{keywordtype}{int} f(\textcolor{keyword}{const} TensorMap<\hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3>} >& tensor) \{
00239   \textcolor{comment}{//  Size<0> empty;}
00240   EIGEN\_STATIC\_ASSERT((internal::array\_size<Sizes<> >::value == 0), YOU\_MADE\_A\_PROGRAMMING\_MISTAKE);
00241   EIGEN\_STATIC\_ASSERT((internal::array\_size<DSizes<int, 0> >::value == 0), YOU\_MADE\_A\_PROGRAMMING\_MISTAKE);
00242   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 0>} result = tensor.sum();
00243   \textcolor{keywordflow}{return} result();
00244 \}
00245 
00246 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_casting()
00247 \{
00248   \hyperlink{class_eigen_1_1_tensor}{Tensor<int, 3>} tensor(2,3,7);
00249 
00250   \textcolor{keywordtype}{int} val = 0;
00251   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00252     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00253       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00254         tensor(i,j,k) = val;
00255         val++;
00256       \}
00257     \}
00258   \}
00259 
00260   TensorMap<Tensor<int, 3> > map(tensor);
00261   \textcolor{keywordtype}{int} sum1 = f(map);
00262   \textcolor{keywordtype}{int} sum2 = f(tensor);
00263 
00264   VERIFY\_IS\_EQUAL(sum1, sum2);
00265   VERIFY\_IS\_EQUAL(sum1, 861);
00266 \}
00267 
00268 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_map()
00269 \{
00270   CALL\_SUBTEST(test\_0d());
00271   CALL\_SUBTEST(test\_1d());
00272   CALL\_SUBTEST(test\_2d());
00273   CALL\_SUBTEST(test\_3d());
00274 
00275   CALL\_SUBTEST(test\_from\_tensor());
00276   CALL\_SUBTEST(test\_casting());
00277 \}
\end{DoxyCode}
