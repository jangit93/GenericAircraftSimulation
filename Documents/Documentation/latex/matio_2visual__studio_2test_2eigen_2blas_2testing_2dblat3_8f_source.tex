\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat3_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/dblat3.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat3_8f_source}\index{dblat3.\+f@{dblat3.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b DBLAT3}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM DBLAT3}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*> Test program for the DOUBLE PRECISION Level 3 Blas.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*> The program must be driven by a short data file. The first 14 records}
00022 \textcolor{comment}{*> of the file are read using list-directed input, the last 6 records}
00023 \textcolor{comment}{*> are read using the format ( A6, L2 ). An annotated example of a data}
00024 \textcolor{comment}{*> file can be obtained by deleting the first 3 characters from the}
00025 \textcolor{comment}{*> following 20 lines:}
00026 \textcolor{comment}{*> 'dblat3.out'      NAME OF SUMMARY OUTPUT FILE}
00027 \textcolor{comment}{*> 6                 UNIT NUMBER OF SUMMARY FILE}
00028 \textcolor{comment}{*> 'DBLAT3.SNAP'     NAME OF SNAPSHOT OUTPUT FILE}
00029 \textcolor{comment}{*> -1                UNIT NUMBER OF SNAPSHOT FILE (NOT USED IF .LT. 0)}
00030 \textcolor{comment}{*> F        LOGICAL FLAG, T TO REWIND SNAPSHOT FILE AFTER EACH RECORD.}
00031 \textcolor{comment}{*> F        LOGICAL FLAG, T TO STOP ON FAILURES.}
00032 \textcolor{comment}{*> T        LOGICAL FLAG, T TO TEST ERROR EXITS.}
00033 \textcolor{comment}{*> 16.0     THRESHOLD VALUE OF TEST RATIO}
00034 \textcolor{comment}{*> 6                 NUMBER OF VALUES OF N}
00035 \textcolor{comment}{*> 0 1 2 3 5 9       VALUES OF N}
00036 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF ALPHA}
00037 \textcolor{comment}{*> 0.0 1.0 0.7       VALUES OF ALPHA}
00038 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF BETA}
00039 \textcolor{comment}{*> 0.0 1.0 1.3       VALUES OF BETA}
00040 \textcolor{comment}{*> DGEMM  T PUT F FOR NO TEST. SAME COLUMNS.}
00041 \textcolor{comment}{*> DSYMM  T PUT F FOR NO TEST. SAME COLUMNS.}
00042 \textcolor{comment}{*> DTRMM  T PUT F FOR NO TEST. SAME COLUMNS.}
00043 \textcolor{comment}{*> DTRSM  T PUT F FOR NO TEST. SAME COLUMNS.}
00044 \textcolor{comment}{*> DSYRK  T PUT F FOR NO TEST. SAME COLUMNS.}
00045 \textcolor{comment}{*> DSYR2K T PUT F FOR NO TEST. SAME COLUMNS.}
00046 \textcolor{comment}{*>}
00047 \textcolor{comment}{*> Further Details}
00048 \textcolor{comment}{*> ===============}
00049 \textcolor{comment}{*>}
00050 \textcolor{comment}{*> See:}
00051 \textcolor{comment}{*>}
00052 \textcolor{comment}{*>    Dongarra J. J., Du Croz J. J., Duff I. S. and Hammarling S.}
00053 \textcolor{comment}{*>    A Set of Level 3 Basic Linear Algebra Subprograms.}
00054 \textcolor{comment}{*>}
00055 \textcolor{comment}{*>    Technical Memorandum No.88 (Revision 1), Mathematics and}
00056 \textcolor{comment}{*>    Computer Science Division, Argonne National Laboratory, 9700}
00057 \textcolor{comment}{*>    South Cass Avenue, Argonne, Illinois 60439, US.}
00058 \textcolor{comment}{*>}
00059 \textcolor{comment}{*> -- Written on 8-February-1989.}
00060 \textcolor{comment}{*>    Jack Dongarra, Argonne National Laboratory.}
00061 \textcolor{comment}{*>    Iain Duff, AERE Harwell.}
00062 \textcolor{comment}{*>    Jeremy Du Croz, Numerical Algorithms Group Ltd.}
00063 \textcolor{comment}{*>    Sven Hammarling, Numerical Algorithms Group Ltd.}
00064 \textcolor{comment}{*>}
00065 \textcolor{comment}{*>    10-9-00:  Change STATUS='NEW' to 'UNKNOWN' so that the testers}
00066 \textcolor{comment}{*>              can be run multiple times without deleting generated}
00067 \textcolor{comment}{*>              output files (susan)}
00068 \textcolor{comment}{*> \(\backslash\)endverbatim}
00069 \textcolor{comment}{*}
00070 \textcolor{comment}{*  Authors:}
00071 \textcolor{comment}{*  ========}
00072 \textcolor{comment}{*}
00073 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00074 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00075 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00076 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00077 \textcolor{comment}{*}
00078 \textcolor{comment}{*> \(\backslash\)date April 2012}
00079 \textcolor{comment}{*}
00080 \textcolor{comment}{*> \(\backslash\)ingroup double\_blas\_testing}
00081 \textcolor{comment}{*}
00082 \textcolor{comment}{*  =====================================================================}
00083       \textcolor{keyword}{PROGRAM} dblat3
00084 \textcolor{comment}{*}
00085 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00086 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00087 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00088 \textcolor{comment}{*     April 2012}
00089 \textcolor{comment}{*}
00090 \textcolor{comment}{*  =====================================================================}
00091 \textcolor{comment}{*}
00092 \textcolor{comment}{*     .. Parameters ..}
00093       \textcolor{keywordtype}{INTEGER}            nin
00094       parameter( nin = 5 )
00095       \textcolor{keywordtype}{INTEGER}            nsubs
00096       parameter( nsubs = 6 )
00097       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
00098       parameter( zero = 0.0d0, one = 1.0d0 )
00099       \textcolor{keywordtype}{INTEGER}            nmax
00100       parameter( nmax = 65 )
00101       \textcolor{keywordtype}{INTEGER}            nidmax, nalmax, nbemax
00102       parameter( nidmax = 9, nalmax = 7, nbemax = 7 )
00103 \textcolor{comment}{*     .. Local Scalars ..}
00104       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, err, thresh
00105       \textcolor{keywordtype}{INTEGER}            i, isnum, j, n, nalf, nbet, nidim, nout, ntra
00106       \textcolor{keywordtype}{LOGICAL}            fatal, ltestt, rewi, same, sfatal, trace,
00107      $                   tsterr
00108       \textcolor{keywordtype}{CHARACTER*1}        transa, transb
00109       \textcolor{keywordtype}{CHARACTER*6}        snamet
00110       \textcolor{keywordtype}{CHARACTER*32}       snaps, summry
00111 \textcolor{comment}{*     .. Local Arrays ..}
00112       \textcolor{keywordtype}{DOUBLE PRECISION}   aa( nmax*nmax ), ab( nmax, 2*nmax ),
00113      $                   alf( nalmax ), as( nmax*nmax ),
00114      $                   bb( nmax*nmax ), bet( nbemax ),
00115      $                   bs( nmax*nmax ), c( nmax, nmax ),
00116      $                   cc( nmax*nmax ), cs( nmax*nmax ), ct( nmax ),
00117      $                   g( nmax ), w( 2*nmax )
00118       \textcolor{keywordtype}{INTEGER}            idim( nidmax )
00119       \textcolor{keywordtype}{LOGICAL}            ltest( nsubs )
00120       \textcolor{keywordtype}{CHARACTER*6}        snames( nsubs )
00121 \textcolor{comment}{*     .. External Functions ..}
00122       \textcolor{keywordtype}{DOUBLE PRECISION}   ddiff
00123       \textcolor{keywordtype}{LOGICAL}            lde
00124       \textcolor{keywordtype}{EXTERNAL}           ddiff, lde
00125 \textcolor{comment}{*     .. External Subroutines ..}
00126       \textcolor{keywordtype}{EXTERNAL}           dchk1, dchk2, dchk3, dchk4, dchk5, dchke, dmmch
00127 \textcolor{comment}{*     .. Intrinsic Functions ..}
00128       \textcolor{keywordtype}{INTRINSIC}          max, min
00129 \textcolor{comment}{*     .. Scalars in Common ..}
00130       \textcolor{keywordtype}{INTEGER}            infot, noutc
00131       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00132       \textcolor{keywordtype}{CHARACTER*6}        srnamt
00133 \textcolor{comment}{*     .. Common blocks ..}
00134       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00135       \textcolor{keyword}{COMMON}             /srnamc/srnamt
00136 \textcolor{comment}{*     .. Data statements ..}
00137       \textcolor{keyword}{DATA}               snames/\textcolor{stringliteral}{'DGEMM '}, \textcolor{stringliteral}{'DSYMM '}, \textcolor{stringliteral}{'DTRMM '}, \textcolor{stringliteral}{'DTRSM '},
00138      $                   \textcolor{stringliteral}{'DSYRK '}, \textcolor{stringliteral}{'DSYR2K'}/
00139 \textcolor{comment}{*     .. Executable Statements ..}
00140 \textcolor{comment}{*}
00141 \textcolor{comment}{*     Read name and unit number for summary output file and open file.}
00142 \textcolor{comment}{*}
00143       \textcolor{keyword}{READ}( nin, fmt = * )summry
00144       \textcolor{keyword}{READ}( nin, fmt = * )nout
00145       \textcolor{keyword}{OPEN}( nout, \hyperlink{structfile}{file} = summry, status = \textcolor{stringliteral}{'UNKNOWN'} )
00146       noutc = nout
00147 \textcolor{comment}{*}
00148 \textcolor{comment}{*     Read name and unit number for snapshot output file and open file.}
00149 \textcolor{comment}{*}
00150       \textcolor{keyword}{READ}( nin, fmt = * )snaps
00151       \textcolor{keyword}{READ}( nin, fmt = * )ntra
00152       trace = ntra.GE.0
00153       \textcolor{keywordflow}{IF}( trace )\textcolor{keywordflow}{THEN}
00154          \textcolor{keyword}{OPEN}( ntra, \hyperlink{structfile}{file} = snaps, status = \textcolor{stringliteral}{'UNKNOWN'} )
00155 \textcolor{keywordflow}{      END IF}
00156 \textcolor{comment}{*     Read the flag that directs rewinding of the snapshot file.}
00157       \textcolor{keyword}{READ}( nin, fmt = * )rewi
00158       rewi = rewi.AND.trace
00159 \textcolor{comment}{*     Read the flag that directs stopping on any failure.}
00160       \textcolor{keyword}{READ}( nin, fmt = * )sfatal
00161 \textcolor{comment}{*     Read the flag that indicates whether error exits are to be tested.}
00162       \textcolor{keyword}{READ}( nin, fmt = * )tsterr
00163 \textcolor{comment}{*     Read the threshold value of the test ratio}
00164       \textcolor{keyword}{READ}( nin, fmt = * )thresh
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*     Read and check the parameter values for the tests.}
00167 \textcolor{comment}{*}
00168 \textcolor{comment}{*     Values of N}
00169       \textcolor{keyword}{READ}( nin, fmt = * )nidim
00170       \textcolor{keywordflow}{IF}( nidim.LT.1.OR.nidim.GT.nidmax )\textcolor{keywordflow}{THEN}
00171          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'N'}, nidmax
00172          \textcolor{keywordflow}{GO TO} 220
00173 \textcolor{keywordflow}{      END IF}
00174       \textcolor{keyword}{READ}( nin, fmt = * )( idim( i ), i = 1, nidim )
00175       \textcolor{keywordflow}{DO} 10 i = 1, nidim
00176          \textcolor{keywordflow}{IF}( idim( i ).LT.0.OR.idim( i ).GT.nmax )\textcolor{keywordflow}{THEN}
00177             \textcolor{keyword}{WRITE}( nout, fmt = 9996 )nmax
00178             \textcolor{keywordflow}{GO TO} 220
00179 \textcolor{keywordflow}{         END IF}
00180    10 \textcolor{keywordflow}{CONTINUE}
00181 \textcolor{comment}{*     Values of ALPHA}
00182       \textcolor{keyword}{READ}( nin, fmt = * )nalf
00183       \textcolor{keywordflow}{IF}( nalf.LT.1.OR.nalf.GT.nalmax )\textcolor{keywordflow}{THEN}
00184          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'ALPHA'}, nalmax
00185          \textcolor{keywordflow}{GO TO} 220
00186 \textcolor{keywordflow}{      END IF}
00187       \textcolor{keyword}{READ}( nin, fmt = * )( alf( i ), i = 1, nalf )
00188 \textcolor{comment}{*     Values of BETA}
00189       \textcolor{keyword}{READ}( nin, fmt = * )nbet
00190       \textcolor{keywordflow}{IF}( nbet.LT.1.OR.nbet.GT.nbemax )\textcolor{keywordflow}{THEN}
00191          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'BETA'}, nbemax
00192          \textcolor{keywordflow}{GO TO} 220
00193 \textcolor{keywordflow}{      END IF}
00194       \textcolor{keyword}{READ}( nin, fmt = * )( bet( i ), i = 1, nbet )
00195 \textcolor{comment}{*}
00196 \textcolor{comment}{*     Report values of parameters.}
00197 \textcolor{comment}{*}
00198       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )
00199       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )( idim( i ), i = 1, nidim )
00200       \textcolor{keyword}{WRITE}( nout, fmt = 9993 )( alf( i ), i = 1, nalf )
00201       \textcolor{keyword}{WRITE}( nout, fmt = 9992 )( bet( i ), i = 1, nbet )
00202       \textcolor{keywordflow}{IF}( .NOT.tsterr )\textcolor{keywordflow}{THEN}
00203          \textcolor{keyword}{WRITE}( nout, fmt = * )
00204          \textcolor{keyword}{WRITE}( nout, fmt = 9984 )
00205 \textcolor{keywordflow}{      END IF}
00206       \textcolor{keyword}{WRITE}( nout, fmt = * )
00207       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )thresh
00208       \textcolor{keyword}{WRITE}( nout, fmt = * )
00209 \textcolor{comment}{*}
00210 \textcolor{comment}{*     Read names of subroutines and flags which indicate}
00211 \textcolor{comment}{*     whether they are to be tested.}
00212 \textcolor{comment}{*}
00213       \textcolor{keywordflow}{DO} 20 i = 1, nsubs
00214          ltest( i ) = .false.
00215    20 \textcolor{keywordflow}{CONTINUE}
00216    30 \textcolor{keyword}{READ}( nin, fmt = 9988, end = 60 )snamet, ltestt
00217       \textcolor{keywordflow}{DO} 40 i = 1, nsubs
00218          \textcolor{keywordflow}{IF}( snamet.EQ.snames( i ) )
00219      $      \textcolor{keywordflow}{GO TO} 50
00220    40 \textcolor{keywordflow}{CONTINUE}
00221       \textcolor{keyword}{WRITE}( nout, fmt = 9990 )snamet
00222       stop
00223    50 ltest( i ) = ltestt
00224       \textcolor{keywordflow}{GO TO} 30
00225 \textcolor{comment}{*}
00226    60 \textcolor{keywordflow}{CONTINUE}
00227       \textcolor{keyword}{CLOSE} ( nin )
00228 \textcolor{comment}{*}
00229 \textcolor{comment}{*     Compute EPS (the machine precision).}
00230 \textcolor{comment}{*}
00231       eps = epsilon(zero)
00232       \textcolor{keyword}{WRITE}( nout, fmt = 9998 )eps
00233 \textcolor{comment}{*}
00234 \textcolor{comment}{*     Check the reliability of DMMCH using exact data.}
00235 \textcolor{comment}{*}
00236       n = min( 32, nmax )
00237       \textcolor{keywordflow}{DO} 100 j = 1, n
00238          \textcolor{keywordflow}{DO} 90 i = 1, n
00239             ab( i, j ) = max( i - j + 1, 0 )
00240    90    \textcolor{keywordflow}{CONTINUE}
00241          ab( j, nmax + 1 ) = j
00242          ab( 1, nmax + j ) = j
00243          c( j, 1 ) = zero
00244   100 \textcolor{keywordflow}{CONTINUE}
00245       \textcolor{keywordflow}{DO} 110 j = 1, n
00246          cc( j ) = j*( ( j + 1 )*j )/2 - ( ( j + 1 )*j*( j - 1 ) )/3
00247   110 \textcolor{keywordflow}{CONTINUE}
00248 \textcolor{comment}{*     CC holds the exact result. On exit from DMMCH CT holds}
00249 \textcolor{comment}{*     the result computed by DMMCH.}
00250       transa = \textcolor{stringliteral}{'N'}
00251       transb = \textcolor{stringliteral}{'N'}
00252       \textcolor{keyword}{CALL }dmmch( transa, transb, n, 1, n, one, ab, nmax,
00253      $            ab( 1, nmax + 1 ), nmax, zero, c, nmax, ct, g, cc,
00254      $            nmax, eps, err, fatal, nout, .true. )
00255       same = lde( cc, ct, n )
00256       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00257          \textcolor{keyword}{WRITE}( nout, fmt = 9989 )transa, transb, same, err
00258          stop
00259 \textcolor{keywordflow}{      END IF}
00260       transb = \textcolor{stringliteral}{'T'}
00261       \textcolor{keyword}{CALL }dmmch( transa, transb, n, 1, n, one, ab, nmax,
00262      $            ab( 1, nmax + 1 ), nmax, zero, c, nmax, ct, g, cc,
00263      $            nmax, eps, err, fatal, nout, .true. )
00264       same = lde( cc, ct, n )
00265       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00266          \textcolor{keyword}{WRITE}( nout, fmt = 9989 )transa, transb, same, err
00267          stop
00268 \textcolor{keywordflow}{      END IF}
00269       \textcolor{keywordflow}{DO} 120 j = 1, n
00270          ab( j, nmax + 1 ) = n - j + 1
00271          ab( 1, nmax + j ) = n - j + 1
00272   120 \textcolor{keywordflow}{CONTINUE}
00273       \textcolor{keywordflow}{DO} 130 j = 1, n
00274          cc( n - j + 1 ) = j*( ( j + 1 )*j )/2 -
00275      $                     ( ( j + 1 )*j*( j - 1 ) )/3
00276   130 \textcolor{keywordflow}{CONTINUE}
00277       transa = \textcolor{stringliteral}{'T'}
00278       transb = \textcolor{stringliteral}{'N'}
00279       \textcolor{keyword}{CALL }dmmch( transa, transb, n, 1, n, one, ab, nmax,
00280      $            ab( 1, nmax + 1 ), nmax, zero, c, nmax, ct, g, cc,
00281      $            nmax, eps, err, fatal, nout, .true. )
00282       same = lde( cc, ct, n )
00283       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00284          \textcolor{keyword}{WRITE}( nout, fmt = 9989 )transa, transb, same, err
00285          stop
00286 \textcolor{keywordflow}{      END IF}
00287       transb = \textcolor{stringliteral}{'T'}
00288       \textcolor{keyword}{CALL }dmmch( transa, transb, n, 1, n, one, ab, nmax,
00289      $            ab( 1, nmax + 1 ), nmax, zero, c, nmax, ct, g, cc,
00290      $            nmax, eps, err, fatal, nout, .true. )
00291       same = lde( cc, ct, n )
00292       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00293          \textcolor{keyword}{WRITE}( nout, fmt = 9989 )transa, transb, same, err
00294          stop
00295 \textcolor{keywordflow}{      END IF}
00296 \textcolor{comment}{*}
00297 \textcolor{comment}{*     Test each subroutine in turn.}
00298 \textcolor{comment}{*}
00299       \textcolor{keywordflow}{DO} 200 isnum = 1, nsubs
00300          \textcolor{keyword}{WRITE}( nout, fmt = * )
00301          \textcolor{keywordflow}{IF}( .NOT.ltest( isnum ) )\textcolor{keywordflow}{THEN}
00302 \textcolor{comment}{*           Subprogram is not to be tested.}
00303             \textcolor{keyword}{WRITE}( nout, fmt = 9987 )snames( isnum )
00304          \textcolor{keywordflow}{ELSE}
00305             srnamt = snames( isnum )
00306 \textcolor{comment}{*           Test error exits.}
00307             \textcolor{keywordflow}{IF}( tsterr )\textcolor{keywordflow}{THEN}
00308                \textcolor{keyword}{CALL }dchke( isnum, snames( isnum ), nout )
00309                \textcolor{keyword}{WRITE}( nout, fmt = * )
00310 \textcolor{keywordflow}{            END IF}
00311 \textcolor{comment}{*           Test computations.}
00312             infot = 0
00313             ok = .true.
00314             fatal = .false.
00315             \textcolor{keywordflow}{GO TO} ( 140, 150, 160, 160, 170, 180 )isnum
00316 \textcolor{comment}{*           Test DGEMM, 01.}
00317   140       \textcolor{keyword}{CALL }dchk1( snames( isnum ), eps, thresh, nout, ntra, trace,
00318      $                  rewi, fatal, nidim, idim, nalf, alf, nbet, bet,
00319      $                  nmax, ab, aa, as, ab( 1, nmax + 1 ), bb, bs, c,
00320      $                  cc, cs, ct, g )
00321             \textcolor{keywordflow}{GO TO} 190
00322 \textcolor{comment}{*           Test DSYMM, 02.}
00323   150       \textcolor{keyword}{CALL }dchk2( snames( isnum ), eps, thresh, nout, ntra, trace,
00324      $                  rewi, fatal, nidim, idim, nalf, alf, nbet, bet,
00325      $                  nmax, ab, aa, as, ab( 1, nmax + 1 ), bb, bs, c,
00326      $                  cc, cs, ct, g )
00327             \textcolor{keywordflow}{GO TO} 190
00328 \textcolor{comment}{*           Test DTRMM, 03, DTRSM, 04.}
00329   160       \textcolor{keyword}{CALL }dchk3( snames( isnum ), eps, thresh, nout, ntra, trace,
00330      $                  rewi, fatal, nidim, idim, nalf, alf, nmax, ab,
00331      $                  aa, as, ab( 1, nmax + 1 ), bb, bs, ct, g, c )
00332             \textcolor{keywordflow}{GO TO} 190
00333 \textcolor{comment}{*           Test DSYRK, 05.}
00334   170       \textcolor{keyword}{CALL }dchk4( snames( isnum ), eps, thresh, nout, ntra, trace,
00335      $                  rewi, fatal, nidim, idim, nalf, alf, nbet, bet,
00336      $                  nmax, ab, aa, as, ab( 1, nmax + 1 ), bb, bs, c,
00337      $                  cc, cs, ct, g )
00338             \textcolor{keywordflow}{GO TO} 190
00339 \textcolor{comment}{*           Test DSYR2K, 06.}
00340   180       \textcolor{keyword}{CALL }dchk5( snames( isnum ), eps, thresh, nout, ntra, trace,
00341      $                  rewi, fatal, nidim, idim, nalf, alf, nbet, bet,
00342      $                  nmax, ab, aa, as, bb, bs, c, cc, cs, ct, g, w )
00343             \textcolor{keywordflow}{GO TO} 190
00344 \textcolor{comment}{*}
00345   190       \textcolor{keywordflow}{IF}( fatal.AND.sfatal )
00346      $         \textcolor{keywordflow}{GO TO} 210
00347 \textcolor{keywordflow}{         END IF}
00348   200 \textcolor{keywordflow}{CONTINUE}
00349       \textcolor{keyword}{WRITE}( nout, fmt = 9986 )
00350       \textcolor{keywordflow}{GO TO} 230
00351 \textcolor{comment}{*}
00352   210 \textcolor{keywordflow}{CONTINUE}
00353       \textcolor{keyword}{WRITE}( nout, fmt = 9985 )
00354       \textcolor{keywordflow}{GO TO} 230
00355 \textcolor{comment}{*}
00356   220 \textcolor{keywordflow}{CONTINUE}
00357       \textcolor{keyword}{WRITE}( nout, fmt = 9991 )
00358 \textcolor{comment}{*}
00359   230 \textcolor{keywordflow}{CONTINUE}
00360       \textcolor{keywordflow}{IF}( trace )
00361      $   \textcolor{keyword}{CLOSE} ( ntra )
00362       \textcolor{keyword}{CLOSE} ( nout )
00363       stop
00364 \textcolor{comment}{*}
00365  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ROUTINES PASS COMPUTATIONAL TESTS IF TEST RATIO IS LES'},
00366      $      \textcolor{stringliteral}{'S THAN'}, f8.2 )
00367  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' RELATIVE MACHINE PRECISION IS TAKEN TO BE'}, 1p, d9.1 )
00368  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' NUMBER OF VALUES OF '}, a, \textcolor{stringliteral}{' IS LESS THAN 1 OR GREATER '},
00369      $      \textcolor{stringliteral}{'THAN '}, i2 )
00370  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF N IS LESS THAN 0 OR GREATER THAN '}, i2 )
00371  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' TESTS OF THE DOUBLE PRECISION LEVEL 3 BLAS'}, //\textcolor{stringliteral}{' THE F'},
00372      $      \textcolor{stringliteral}{'OLLOWING PARAMETER VALUES WILL BE USED:'} )
00373  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR N              '}, 9i6 )
00374  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR ALPHA          '}, 7f6.1 )
00375  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR BETA           '}, 7f6.1 )
00376  9991 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' AMEND DATA FILE OR INCREASE ARRAY SIZES IN PROGRAM'},
00377      $      /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00378  9990 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' SUBPROGRAM NAME '}, a6, \textcolor{stringliteral}{' NOT RECOGNIZED'}, /\textcolor{stringliteral}{' ******* T'},
00379      $      \textcolor{stringliteral}{'ESTS ABANDONED *******'} )
00380  9989 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR IN DMMCH -  IN-LINE DOT PRODUCTS ARE BEING EVALU'},
00381      $      \textcolor{stringliteral}{'ATED WRONGLY.'}, /\textcolor{stringliteral}{' DMMCH WAS CALLED WITH TRANSA = '}, a1,
00382      $      \textcolor{stringliteral}{' AND TRANSB = '}, a1, /\textcolor{stringliteral}{' AND RETURNED SAME = '}, l1, \textcolor{stringliteral}{' AND '},
00383      $      \textcolor{stringliteral}{'ERR = '}, f12.3, \textcolor{stringliteral}{'.'}, /\textcolor{stringliteral}{' THIS MAY BE DUE TO FAULTS IN THE '},
00384      $      \textcolor{stringliteral}{'ARITHMETIC OR THE COMPILER.'}, /\textcolor{stringliteral}{' ******* TESTS ABANDONED '},
00385      $      \textcolor{stringliteral}{'*******'} )
00386  9988 \textcolor{keyword}{FORMAT}( a6, l2 )
00387  9987 \textcolor{keyword}{FORMAT}( 1x, a6, \textcolor{stringliteral}{' WAS NOT TESTED'} )
00388  9986 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' END OF TESTS'} )
00389  9985 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' ******* FATAL ERROR - TESTS ABANDONED *******'} )
00390  9984 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR-EXITS WILL NOT BE TESTED'} )
00391 \textcolor{comment}{*}
00392 \textcolor{comment}{*     End of DBLAT3.}
00393 \textcolor{comment}{*}
00394 \textcolor{keyword}{      END}
00395 \textcolor{keyword}{      SUBROUTINE }dchk1( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00396      $                  FATAL, NIDIM, IDIM, NALF, ALF, NBET, BET, NMAX,
00397      $                  A, AA, AS, B, BB, BS, C, CC, CS, CT, G )
00398 \textcolor{comment}{*}
00399 \textcolor{comment}{*  Tests DGEMM.}
00400 \textcolor{comment}{*}
00401 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
00402 \textcolor{comment}{*}
00403 \textcolor{comment}{*  -- Written on 8-February-1989.}
00404 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
00405 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
00406 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
00407 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
00408 \textcolor{comment}{*}
00409 \textcolor{comment}{*     .. Parameters ..}
00410       \textcolor{keywordtype}{DOUBLE PRECISION}   zero
00411       parameter( zero = 0.0d0 )
00412 \textcolor{comment}{*     .. Scalar Arguments ..}
00413       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00414       \textcolor{keywordtype}{INTEGER}            nalf, nbet, nidim, nmax, nout, ntra
00415       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00416       \textcolor{keywordtype}{CHARACTER*6}        sname
00417 \textcolor{comment}{*     .. Array Arguments ..}
00418       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00419      $                   as( nmax*nmax ), b( nmax, nmax ),
00420      $                   bb( nmax*nmax ), bet( nbet ), bs( nmax*nmax ),
00421      $                   c( nmax, nmax ), cc( nmax*nmax ),
00422      $                   cs( nmax*nmax ), ct( nmax ), g( nmax )
00423       \textcolor{keywordtype}{INTEGER}            idim( nidim )
00424 \textcolor{comment}{*     .. Local Scalars ..}
00425       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bls, err, errmax
00426       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ica, icb, ik, im, in, k, ks, laa,
00427      $                   lbb, lcc, lda, ldas, ldb, ldbs, ldc, ldcs, m,
00428      $                   ma, mb, ms, n, na, nargs, nb, nc, ns
00429       \textcolor{keywordtype}{LOGICAL}            null, reset, same, trana, tranb
00430       \textcolor{keywordtype}{CHARACTER*1}        tranas, tranbs, transa, transb
00431       \textcolor{keywordtype}{CHARACTER*3}        ich
00432 \textcolor{comment}{*     .. Local Arrays ..}
00433       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00434 \textcolor{comment}{*     .. External Functions ..}
00435       \textcolor{keywordtype}{LOGICAL}            lde, lderes
00436       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
00437 \textcolor{comment}{*     .. External Subroutines ..}
00438       \textcolor{keywordtype}{EXTERNAL}           dgemm, dmake, dmmch
00439 \textcolor{comment}{*     .. Intrinsic Functions ..}
00440       \textcolor{keywordtype}{INTRINSIC}          max
00441 \textcolor{comment}{*     .. Scalars in Common ..}
00442       \textcolor{keywordtype}{INTEGER}            infot, noutc
00443       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00444 \textcolor{comment}{*     .. Common blocks ..}
00445       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00446 \textcolor{comment}{*     .. Data statements ..}
00447       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'NTC'}/
00448 \textcolor{comment}{*     .. Executable Statements ..}
00449 \textcolor{comment}{*}
00450       nargs = 13
00451       nc = 0
00452       reset = .true.
00453       errmax = zero
00454 \textcolor{comment}{*}
00455       \textcolor{keywordflow}{DO} 110 im = 1, nidim
00456          m = idim( im )
00457 \textcolor{comment}{*}
00458          \textcolor{keywordflow}{DO} 100 in = 1, nidim
00459             n = idim( in )
00460 \textcolor{comment}{*           Set LDC to 1 more than minimum value if room.}
00461             ldc = m
00462             \textcolor{keywordflow}{IF}( ldc.LT.nmax )
00463      $         ldc = ldc + 1
00464 \textcolor{comment}{*           Skip tests if not enough room.}
00465             \textcolor{keywordflow}{IF}( ldc.GT.nmax )
00466      $         \textcolor{keywordflow}{GO TO} 100
00467             lcc = ldc*n
00468             null = n.LE.0.OR.m.LE.0
00469 \textcolor{comment}{*}
00470             \textcolor{keywordflow}{DO} 90 ik = 1, nidim
00471                k = idim( ik )
00472 \textcolor{comment}{*}
00473                \textcolor{keywordflow}{DO} 80 ica = 1, 3
00474                   transa = ich( ica: ica )
00475                   trana = transa.EQ.\textcolor{stringliteral}{'T'}.OR.transa.EQ.\textcolor{stringliteral}{'C'}
00476 \textcolor{comment}{*}
00477                   \textcolor{keywordflow}{IF}( trana )\textcolor{keywordflow}{THEN}
00478                      ma = k
00479                      na = m
00480                   \textcolor{keywordflow}{ELSE}
00481                      ma = m
00482                      na = k
00483 \textcolor{keywordflow}{                  END IF}
00484 \textcolor{comment}{*                 Set LDA to 1 more than minimum value if room.}
00485                   lda = ma
00486                   \textcolor{keywordflow}{IF}( lda.LT.nmax )
00487      $               lda = lda + 1
00488 \textcolor{comment}{*                 Skip tests if not enough room.}
00489                   \textcolor{keywordflow}{IF}( lda.GT.nmax )
00490      $               \textcolor{keywordflow}{GO TO} 80
00491                   laa = lda*na
00492 \textcolor{comment}{*}
00493 \textcolor{comment}{*                 Generate the matrix A.}
00494 \textcolor{comment}{*}
00495                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, a, nmax, aa, lda,
00496      $                        reset, zero )
00497 \textcolor{comment}{*}
00498                   \textcolor{keywordflow}{DO} 70 icb = 1, 3
00499                      transb = ich( icb: icb )
00500                      tranb = transb.EQ.\textcolor{stringliteral}{'T'}.OR.transb.EQ.\textcolor{stringliteral}{'C'}
00501 \textcolor{comment}{*}
00502                      \textcolor{keywordflow}{IF}( tranb )\textcolor{keywordflow}{THEN}
00503                         mb = n
00504                         nb = k
00505                      \textcolor{keywordflow}{ELSE}
00506                         mb = k
00507                         nb = n
00508 \textcolor{keywordflow}{                     END IF}
00509 \textcolor{comment}{*                    Set LDB to 1 more than minimum value if room.}
00510                      ldb = mb
00511                      \textcolor{keywordflow}{IF}( ldb.LT.nmax )
00512      $                  ldb = ldb + 1
00513 \textcolor{comment}{*                    Skip tests if not enough room.}
00514                      \textcolor{keywordflow}{IF}( ldb.GT.nmax )
00515      $                  \textcolor{keywordflow}{GO TO} 70
00516                      lbb = ldb*nb
00517 \textcolor{comment}{*}
00518 \textcolor{comment}{*                    Generate the matrix B.}
00519 \textcolor{comment}{*}
00520                      \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, mb, nb, b, nmax, bb,
00521      $                           ldb, reset, zero )
00522 \textcolor{comment}{*}
00523                      \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00524                         alpha = alf( ia )
00525 \textcolor{comment}{*}
00526                         \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00527                            beta = bet( ib )
00528 \textcolor{comment}{*}
00529 \textcolor{comment}{*                          Generate the matrix C.}
00530 \textcolor{comment}{*}
00531                            \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, c, nmax,
00532      $                                 cc, ldc, reset, zero )
00533 \textcolor{comment}{*}
00534                            nc = nc + 1
00535 \textcolor{comment}{*}
00536 \textcolor{comment}{*                          Save every datum before calling the}
00537 \textcolor{comment}{*                          subroutine.}
00538 \textcolor{comment}{*}
00539                            tranas = transa
00540                            tranbs = transb
00541                            ms = m
00542                            ns = n
00543                            ks = k
00544                            als = alpha
00545                            \textcolor{keywordflow}{DO} 10 i = 1, laa
00546                               as( i ) = aa( i )
00547    10                      \textcolor{keywordflow}{CONTINUE}
00548                            ldas = lda
00549                            \textcolor{keywordflow}{DO} 20 i = 1, lbb
00550                               bs( i ) = bb( i )
00551    20                      \textcolor{keywordflow}{CONTINUE}
00552                            ldbs = ldb
00553                            bls = beta
00554                            \textcolor{keywordflow}{DO} 30 i = 1, lcc
00555                               cs( i ) = cc( i )
00556    30                      \textcolor{keywordflow}{CONTINUE}
00557                            ldcs = ldc
00558 \textcolor{comment}{*}
00559 \textcolor{comment}{*                          Call the subroutine.}
00560 \textcolor{comment}{*}
00561                            \textcolor{keywordflow}{IF}( trace )
00562      $                        \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00563      $                        transa, transb, m, n, k, alpha, lda, ldb,
00564      $                        beta, ldc
00565                            \textcolor{keywordflow}{IF}( rewi )
00566      $                        rewind ntra
00567                            \textcolor{keyword}{CALL }dgemm( transa, transb, m, n, k, alpha,
00568      $                                 aa, lda, bb, ldb, beta, cc, ldc )
00569 \textcolor{comment}{*}
00570 \textcolor{comment}{*                          Check if error-exit was taken incorrectly.}
00571 \textcolor{comment}{*}
00572                            \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00573                               \textcolor{keyword}{WRITE}( nout, fmt = 9994 )
00574                               fatal = .true.
00575                               \textcolor{keywordflow}{GO TO} 120
00576 \textcolor{keywordflow}{                           END IF}
00577 \textcolor{comment}{*}
00578 \textcolor{comment}{*                          See what data changed inside subroutines.}
00579 \textcolor{comment}{*}
00580                            isame( 1 ) = transa.EQ.tranas
00581                            isame( 2 ) = transb.EQ.tranbs
00582                            isame( 3 ) = ms.EQ.m
00583                            isame( 4 ) = ns.EQ.n
00584                            isame( 5 ) = ks.EQ.k
00585                            isame( 6 ) = als.EQ.alpha
00586                            isame( 7 ) = lde( as, aa, laa )
00587                            isame( 8 ) = ldas.EQ.lda
00588                            isame( 9 ) = lde( bs, bb, lbb )
00589                            isame( 10 ) = ldbs.EQ.ldb
00590                            isame( 11 ) = bls.EQ.beta
00591                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00592                               isame( 12 ) = lde( cs, cc, lcc )
00593                            \textcolor{keywordflow}{ELSE}
00594                               isame( 12 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, cs,
00595      $                                      cc, ldc )
00596 \textcolor{keywordflow}{                           END IF}
00597                            isame( 13 ) = ldcs.EQ.ldc
00598 \textcolor{comment}{*}
00599 \textcolor{comment}{*                          If data was incorrectly changed, report}
00600 \textcolor{comment}{*                          and return.}
00601 \textcolor{comment}{*}
00602                            same = .true.
00603                            \textcolor{keywordflow}{DO} 40 i = 1, nargs
00604                               same = same.AND.isame( i )
00605                               \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
00606      $                           \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
00607    40                      \textcolor{keywordflow}{CONTINUE}
00608                            \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
00609                               fatal = .true.
00610                               \textcolor{keywordflow}{GO TO} 120
00611 \textcolor{keywordflow}{                           END IF}
00612 \textcolor{comment}{*}
00613                            \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
00614 \textcolor{comment}{*}
00615 \textcolor{comment}{*                             Check the result.}
00616 \textcolor{comment}{*}
00617                               \textcolor{keyword}{CALL }dmmch( transa, transb, m, n, k,
00618      $                                    alpha, a, nmax, b, nmax, beta,
00619      $                                    c, nmax, ct, g, cc, ldc, eps,
00620      $                                    err, fatal, nout, .true. )
00621                               errmax = max( errmax, err )
00622 \textcolor{comment}{*                             If got really bad answer, report and}
00623 \textcolor{comment}{*                             return.}
00624                               \textcolor{keywordflow}{IF}( fatal )
00625      $                           \textcolor{keywordflow}{GO TO} 120
00626 \textcolor{keywordflow}{                           END IF}
00627 \textcolor{comment}{*}
00628    50                   \textcolor{keywordflow}{CONTINUE}
00629 \textcolor{comment}{*}
00630    60                \textcolor{keywordflow}{CONTINUE}
00631 \textcolor{comment}{*}
00632    70             \textcolor{keywordflow}{CONTINUE}
00633 \textcolor{comment}{*}
00634    80          \textcolor{keywordflow}{CONTINUE}
00635 \textcolor{comment}{*}
00636    90       \textcolor{keywordflow}{CONTINUE}
00637 \textcolor{comment}{*}
00638   100    \textcolor{keywordflow}{CONTINUE}
00639 \textcolor{comment}{*}
00640   110 \textcolor{keywordflow}{CONTINUE}
00641 \textcolor{comment}{*}
00642 \textcolor{comment}{*     Report result.}
00643 \textcolor{comment}{*}
00644       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
00645          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
00646       \textcolor{keywordflow}{ELSE}
00647          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
00648 \textcolor{keywordflow}{      END IF}
00649       \textcolor{keywordflow}{GO TO} 130
00650 \textcolor{comment}{*}
00651   120 \textcolor{keywordflow}{CONTINUE}
00652       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
00653       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, transa, transb, m, n, k,
00654      $   alpha, lda, ldb, beta, ldc
00655 \textcolor{comment}{*}
00656   130 \textcolor{keywordflow}{CONTINUE}
00657       \textcolor{keywordflow}{RETURN}
00658 \textcolor{comment}{*}
00659  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
00660      $      \textcolor{stringliteral}{'S)'} )
00661  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
00662      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
00663  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
00664      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
00665      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
00666  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
00667  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','},
00668      $      3( i3, \textcolor{stringliteral}{','} ), f4.1, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', B,'}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', '},
00669      $      \textcolor{stringliteral}{'C,'}, i3, \textcolor{stringliteral}{').'} )
00670  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
00671      $      \textcolor{stringliteral}{'******'} )
00672 \textcolor{comment}{*}
00673 \textcolor{comment}{*     End of DCHK1.}
00674 \textcolor{comment}{*}
00675 \textcolor{keyword}{      END}
00676 \textcolor{keyword}{      SUBROUTINE }dchk2( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00677      $                  FATAL, NIDIM, IDIM, NALF, ALF, NBET, BET, NMAX,
00678      $                  A, AA, AS, B, BB, BS, C, CC, CS, CT, G )
00679 \textcolor{comment}{*}
00680 \textcolor{comment}{*  Tests DSYMM.}
00681 \textcolor{comment}{*}
00682 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
00683 \textcolor{comment}{*}
00684 \textcolor{comment}{*  -- Written on 8-February-1989.}
00685 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
00686 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
00687 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
00688 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
00689 \textcolor{comment}{*}
00690 \textcolor{comment}{*     .. Parameters ..}
00691       \textcolor{keywordtype}{DOUBLE PRECISION}   zero
00692       parameter( zero = 0.0d0 )
00693 \textcolor{comment}{*     .. Scalar Arguments ..}
00694       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00695       \textcolor{keywordtype}{INTEGER}            nalf, nbet, nidim, nmax, nout, ntra
00696       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00697       \textcolor{keywordtype}{CHARACTER*6}        sname
00698 \textcolor{comment}{*     .. Array Arguments ..}
00699       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00700      $                   as( nmax*nmax ), b( nmax, nmax ),
00701      $                   bb( nmax*nmax ), bet( nbet ), bs( nmax*nmax ),
00702      $                   c( nmax, nmax ), cc( nmax*nmax ),
00703      $                   cs( nmax*nmax ), ct( nmax ), g( nmax )
00704       \textcolor{keywordtype}{INTEGER}            idim( nidim )
00705 \textcolor{comment}{*     .. Local Scalars ..}
00706       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bls, err, errmax
00707       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ics, icu, im, in, laa, lbb, lcc,
00708      $                   lda, ldas, ldb, ldbs, ldc, ldcs, m, ms, n, na,
00709      $                   nargs, nc, ns
00710       \textcolor{keywordtype}{LOGICAL}            left, null, reset, same
00711       \textcolor{keywordtype}{CHARACTER*1}        side, sides, uplo, uplos
00712       \textcolor{keywordtype}{CHARACTER*2}        ichs, ichu
00713 \textcolor{comment}{*     .. Local Arrays ..}
00714       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00715 \textcolor{comment}{*     .. External Functions ..}
00716       \textcolor{keywordtype}{LOGICAL}            lde, lderes
00717       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
00718 \textcolor{comment}{*     .. External Subroutines ..}
00719       \textcolor{keywordtype}{EXTERNAL}           dmake, dmmch, dsymm
00720 \textcolor{comment}{*     .. Intrinsic Functions ..}
00721       \textcolor{keywordtype}{INTRINSIC}          max
00722 \textcolor{comment}{*     .. Scalars in Common ..}
00723       \textcolor{keywordtype}{INTEGER}            infot, noutc
00724       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00725 \textcolor{comment}{*     .. Common blocks ..}
00726       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00727 \textcolor{comment}{*     .. Data statements ..}
00728       \textcolor{keyword}{DATA}               ichs/\textcolor{stringliteral}{'LR'}/, ichu/\textcolor{stringliteral}{'UL'}/
00729 \textcolor{comment}{*     .. Executable Statements ..}
00730 \textcolor{comment}{*}
00731       nargs = 12
00732       nc = 0
00733       reset = .true.
00734       errmax = zero
00735 \textcolor{comment}{*}
00736       \textcolor{keywordflow}{DO} 100 im = 1, nidim
00737          m = idim( im )
00738 \textcolor{comment}{*}
00739          \textcolor{keywordflow}{DO} 90 in = 1, nidim
00740             n = idim( in )
00741 \textcolor{comment}{*           Set LDC to 1 more than minimum value if room.}
00742             ldc = m
00743             \textcolor{keywordflow}{IF}( ldc.LT.nmax )
00744      $         ldc = ldc + 1
00745 \textcolor{comment}{*           Skip tests if not enough room.}
00746             \textcolor{keywordflow}{IF}( ldc.GT.nmax )
00747      $         \textcolor{keywordflow}{GO TO} 90
00748             lcc = ldc*n
00749             null = n.LE.0.OR.m.LE.0
00750 \textcolor{comment}{*}
00751 \textcolor{comment}{*           Set LDB to 1 more than minimum value if room.}
00752             ldb = m
00753             \textcolor{keywordflow}{IF}( ldb.LT.nmax )
00754      $         ldb = ldb + 1
00755 \textcolor{comment}{*           Skip tests if not enough room.}
00756             \textcolor{keywordflow}{IF}( ldb.GT.nmax )
00757      $         \textcolor{keywordflow}{GO TO} 90
00758             lbb = ldb*n
00759 \textcolor{comment}{*}
00760 \textcolor{comment}{*           Generate the matrix B.}
00761 \textcolor{comment}{*}
00762             \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, b, nmax, bb, ldb, reset,
00763      $                  zero )
00764 \textcolor{comment}{*}
00765             \textcolor{keywordflow}{DO} 80 ics = 1, 2
00766                side = ichs( ics: ics )
00767                left = side.EQ.\textcolor{stringliteral}{'L'}
00768 \textcolor{comment}{*}
00769                \textcolor{keywordflow}{IF}( left )\textcolor{keywordflow}{THEN}
00770                   na = m
00771                \textcolor{keywordflow}{ELSE}
00772                   na = n
00773 \textcolor{keywordflow}{               END IF}
00774 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
00775                lda = na
00776                \textcolor{keywordflow}{IF}( lda.LT.nmax )
00777      $            lda = lda + 1
00778 \textcolor{comment}{*              Skip tests if not enough room.}
00779                \textcolor{keywordflow}{IF}( lda.GT.nmax )
00780      $            \textcolor{keywordflow}{GO TO} 80
00781                laa = lda*na
00782 \textcolor{comment}{*}
00783                \textcolor{keywordflow}{DO} 70 icu = 1, 2
00784                   uplo = ichu( icu: icu )
00785 \textcolor{comment}{*}
00786 \textcolor{comment}{*                 Generate the symmetric matrix A.}
00787 \textcolor{comment}{*}
00788                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'SY'}, uplo, \textcolor{stringliteral}{' '}, na, na, a, nmax, aa, lda,
00789      $                        reset, zero )
00790 \textcolor{comment}{*}
00791                   \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00792                      alpha = alf( ia )
00793 \textcolor{comment}{*}
00794                      \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00795                         beta = bet( ib )
00796 \textcolor{comment}{*}
00797 \textcolor{comment}{*                       Generate the matrix C.}
00798 \textcolor{comment}{*}
00799                         \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, c, nmax, cc,
00800      $                              ldc, reset, zero )
00801 \textcolor{comment}{*}
00802                         nc = nc + 1
00803 \textcolor{comment}{*}
00804 \textcolor{comment}{*                       Save every datum before calling the}
00805 \textcolor{comment}{*                       subroutine.}
00806 \textcolor{comment}{*}
00807                         sides = side
00808                         uplos = uplo
00809                         ms = m
00810                         ns = n
00811                         als = alpha
00812                         \textcolor{keywordflow}{DO} 10 i = 1, laa
00813                            as( i ) = aa( i )
00814    10                   \textcolor{keywordflow}{CONTINUE}
00815                         ldas = lda
00816                         \textcolor{keywordflow}{DO} 20 i = 1, lbb
00817                            bs( i ) = bb( i )
00818    20                   \textcolor{keywordflow}{CONTINUE}
00819                         ldbs = ldb
00820                         bls = beta
00821                         \textcolor{keywordflow}{DO} 30 i = 1, lcc
00822                            cs( i ) = cc( i )
00823    30                   \textcolor{keywordflow}{CONTINUE}
00824                         ldcs = ldc
00825 \textcolor{comment}{*}
00826 \textcolor{comment}{*                       Call the subroutine.}
00827 \textcolor{comment}{*}
00828                         \textcolor{keywordflow}{IF}( trace )
00829      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname, side,
00830      $                     uplo, m, n, alpha, lda, ldb, beta, ldc
00831                         \textcolor{keywordflow}{IF}( rewi )
00832      $                     rewind ntra
00833                         \textcolor{keyword}{CALL }dsymm( side, uplo, m, n, alpha, aa, lda,
00834      $                              bb, ldb, beta, cc, ldc )
00835 \textcolor{comment}{*}
00836 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
00837 \textcolor{comment}{*}
00838                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00839                            \textcolor{keyword}{WRITE}( nout, fmt = 9994 )
00840                            fatal = .true.
00841                            \textcolor{keywordflow}{GO TO} 110
00842 \textcolor{keywordflow}{                        END IF}
00843 \textcolor{comment}{*}
00844 \textcolor{comment}{*                       See what data changed inside subroutines.}
00845 \textcolor{comment}{*}
00846                         isame( 1 ) = sides.EQ.side
00847                         isame( 2 ) = uplos.EQ.uplo
00848                         isame( 3 ) = ms.EQ.m
00849                         isame( 4 ) = ns.EQ.n
00850                         isame( 5 ) = als.EQ.alpha
00851                         isame( 6 ) = lde( as, aa, laa )
00852                         isame( 7 ) = ldas.EQ.lda
00853                         isame( 8 ) = lde( bs, bb, lbb )
00854                         isame( 9 ) = ldbs.EQ.ldb
00855                         isame( 10 ) = bls.EQ.beta
00856                         \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00857                            isame( 11 ) = lde( cs, cc, lcc )
00858                         \textcolor{keywordflow}{ELSE}
00859                            isame( 11 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, cs,
00860      $                                   cc, ldc )
00861 \textcolor{keywordflow}{                        END IF}
00862                         isame( 12 ) = ldcs.EQ.ldc
00863 \textcolor{comment}{*}
00864 \textcolor{comment}{*                       If data was incorrectly changed, report and}
00865 \textcolor{comment}{*                       return.}
00866 \textcolor{comment}{*}
00867                         same = .true.
00868                         \textcolor{keywordflow}{DO} 40 i = 1, nargs
00869                            same = same.AND.isame( i )
00870                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
00871      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
00872    40                   \textcolor{keywordflow}{CONTINUE}
00873                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
00874                            fatal = .true.
00875                            \textcolor{keywordflow}{GO TO} 110
00876 \textcolor{keywordflow}{                        END IF}
00877 \textcolor{comment}{*}
00878                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
00879 \textcolor{comment}{*}
00880 \textcolor{comment}{*                          Check the result.}
00881 \textcolor{comment}{*}
00882                            \textcolor{keywordflow}{IF}( left )\textcolor{keywordflow}{THEN}
00883                               \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, m, n, m, alpha, a,
00884      $                                    nmax, b, nmax, beta, c, nmax,
00885      $                                    ct, g, cc, ldc, eps, err,
00886      $                                    fatal, nout, .true. )
00887                            \textcolor{keywordflow}{ELSE}
00888                               \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, m, n, n, alpha, b,
00889      $                                    nmax, a, nmax, beta, c, nmax,
00890      $                                    ct, g, cc, ldc, eps, err,
00891      $                                    fatal, nout, .true. )
00892 \textcolor{keywordflow}{                           END IF}
00893                            errmax = max( errmax, err )
00894 \textcolor{comment}{*                          If got really bad answer, report and}
00895 \textcolor{comment}{*                          return.}
00896                            \textcolor{keywordflow}{IF}( fatal )
00897      $                        \textcolor{keywordflow}{GO TO} 110
00898 \textcolor{keywordflow}{                        END IF}
00899 \textcolor{comment}{*}
00900    50                \textcolor{keywordflow}{CONTINUE}
00901 \textcolor{comment}{*}
00902    60             \textcolor{keywordflow}{CONTINUE}
00903 \textcolor{comment}{*}
00904    70          \textcolor{keywordflow}{CONTINUE}
00905 \textcolor{comment}{*}
00906    80       \textcolor{keywordflow}{CONTINUE}
00907 \textcolor{comment}{*}
00908    90    \textcolor{keywordflow}{CONTINUE}
00909 \textcolor{comment}{*}
00910   100 \textcolor{keywordflow}{CONTINUE}
00911 \textcolor{comment}{*}
00912 \textcolor{comment}{*     Report result.}
00913 \textcolor{comment}{*}
00914       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
00915          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
00916       \textcolor{keywordflow}{ELSE}
00917          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
00918 \textcolor{keywordflow}{      END IF}
00919       \textcolor{keywordflow}{GO TO} 120
00920 \textcolor{comment}{*}
00921   110 \textcolor{keywordflow}{CONTINUE}
00922       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
00923       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, side, uplo, m, n, alpha, lda,
00924      $   ldb, beta, ldc
00925 \textcolor{comment}{*}
00926   120 \textcolor{keywordflow}{CONTINUE}
00927       \textcolor{keywordflow}{RETURN}
00928 \textcolor{comment}{*}
00929  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
00930      $      \textcolor{stringliteral}{'S)'} )
00931  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
00932      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
00933  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
00934      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
00935      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
00936  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
00937  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
00938      $      f4.1, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', B,'}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', C,'}, i3, \textcolor{stringliteral}{')   '},
00939      $      \textcolor{stringliteral}{' .'} )
00940  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
00941      $      \textcolor{stringliteral}{'******'} )
00942 \textcolor{comment}{*}
00943 \textcolor{comment}{*     End of DCHK2.}
00944 \textcolor{comment}{*}
00945 \textcolor{keyword}{      END}
00946 \textcolor{keyword}{      SUBROUTINE }dchk3( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00947      $                  FATAL, NIDIM, IDIM, NALF, ALF, NMAX, A, AA, AS,
00948      $                  B, BB, BS, CT, G, C )
00949 \textcolor{comment}{*}
00950 \textcolor{comment}{*  Tests DTRMM and DTRSM.}
00951 \textcolor{comment}{*}
00952 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
00953 \textcolor{comment}{*}
00954 \textcolor{comment}{*  -- Written on 8-February-1989.}
00955 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
00956 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
00957 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
00958 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
00959 \textcolor{comment}{*}
00960 \textcolor{comment}{*     .. Parameters ..}
00961       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
00962       parameter( zero = 0.0d0, one = 1.0d0 )
00963 \textcolor{comment}{*     .. Scalar Arguments ..}
00964       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00965       \textcolor{keywordtype}{INTEGER}            nalf, nidim, nmax, nout, ntra
00966       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00967       \textcolor{keywordtype}{CHARACTER*6}        sname
00968 \textcolor{comment}{*     .. Array Arguments ..}
00969       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00970      $                   as( nmax*nmax ), b( nmax, nmax ),
00971      $                   bb( nmax*nmax ), bs( nmax*nmax ),
00972      $                   c( nmax, nmax ), ct( nmax ), g( nmax )
00973       \textcolor{keywordtype}{INTEGER}            idim( nidim )
00974 \textcolor{comment}{*     .. Local Scalars ..}
00975       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, err, errmax
00976       \textcolor{keywordtype}{INTEGER}            i, ia, icd, ics, ict, icu, im, in, j, laa, lbb,
00977      $                   lda, ldas, ldb, ldbs, m, ms, n, na, nargs, nc,
00978      $                   ns
00979       \textcolor{keywordtype}{LOGICAL}            left, null, reset, same
00980       \textcolor{keywordtype}{CHARACTER*1}        diag, diags, side, sides, tranas, transa, uplo,
00981      $                   uplos
00982       \textcolor{keywordtype}{CHARACTER*2}        ichd, ichs, ichu
00983       \textcolor{keywordtype}{CHARACTER*3}        icht
00984 \textcolor{comment}{*     .. Local Arrays ..}
00985       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00986 \textcolor{comment}{*     .. External Functions ..}
00987       \textcolor{keywordtype}{LOGICAL}            lde, lderes
00988       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
00989 \textcolor{comment}{*     .. External Subroutines ..}
00990       \textcolor{keywordtype}{EXTERNAL}           dmake, dmmch, dtrmm, dtrsm
00991 \textcolor{comment}{*     .. Intrinsic Functions ..}
00992       \textcolor{keywordtype}{INTRINSIC}          max
00993 \textcolor{comment}{*     .. Scalars in Common ..}
00994       \textcolor{keywordtype}{INTEGER}            infot, noutc
00995       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00996 \textcolor{comment}{*     .. Common blocks ..}
00997       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00998 \textcolor{comment}{*     .. Data statements ..}
00999       \textcolor{keyword}{DATA}               ichu/\textcolor{stringliteral}{'UL'}/, icht/\textcolor{stringliteral}{'NTC'}/, ichd/\textcolor{stringliteral}{'UN'}/, ichs/\textcolor{stringliteral}{'LR'}/
01000 \textcolor{comment}{*     .. Executable Statements ..}
01001 \textcolor{comment}{*}
01002       nargs = 11
01003       nc = 0
01004       reset = .true.
01005       errmax = zero
01006 \textcolor{comment}{*     Set up zero matrix for DMMCH.}
01007       \textcolor{keywordflow}{DO} 20 j = 1, nmax
01008          \textcolor{keywordflow}{DO} 10 i = 1, nmax
01009             c( i, j ) = zero
01010    10    \textcolor{keywordflow}{CONTINUE}
01011    20 \textcolor{keywordflow}{CONTINUE}
01012 \textcolor{comment}{*}
01013       \textcolor{keywordflow}{DO} 140 im = 1, nidim
01014          m = idim( im )
01015 \textcolor{comment}{*}
01016          \textcolor{keywordflow}{DO} 130 in = 1, nidim
01017             n = idim( in )
01018 \textcolor{comment}{*           Set LDB to 1 more than minimum value if room.}
01019             ldb = m
01020             \textcolor{keywordflow}{IF}( ldb.LT.nmax )
01021      $         ldb = ldb + 1
01022 \textcolor{comment}{*           Skip tests if not enough room.}
01023             \textcolor{keywordflow}{IF}( ldb.GT.nmax )
01024      $         \textcolor{keywordflow}{GO TO} 130
01025             lbb = ldb*n
01026             null = m.LE.0.OR.n.LE.0
01027 \textcolor{comment}{*}
01028             \textcolor{keywordflow}{DO} 120 ics = 1, 2
01029                side = ichs( ics: ics )
01030                left = side.EQ.\textcolor{stringliteral}{'L'}
01031                \textcolor{keywordflow}{IF}( left )\textcolor{keywordflow}{THEN}
01032                   na = m
01033                \textcolor{keywordflow}{ELSE}
01034                   na = n
01035 \textcolor{keywordflow}{               END IF}
01036 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
01037                lda = na
01038                \textcolor{keywordflow}{IF}( lda.LT.nmax )
01039      $            lda = lda + 1
01040 \textcolor{comment}{*              Skip tests if not enough room.}
01041                \textcolor{keywordflow}{IF}( lda.GT.nmax )
01042      $            \textcolor{keywordflow}{GO TO} 130
01043                laa = lda*na
01044 \textcolor{comment}{*}
01045                \textcolor{keywordflow}{DO} 110 icu = 1, 2
01046                   uplo = ichu( icu: icu )
01047 \textcolor{comment}{*}
01048                   \textcolor{keywordflow}{DO} 100 ict = 1, 3
01049                      transa = icht( ict: ict )
01050 \textcolor{comment}{*}
01051                      \textcolor{keywordflow}{DO} 90 icd = 1, 2
01052                         diag = ichd( icd: icd )
01053 \textcolor{comment}{*}
01054                         \textcolor{keywordflow}{DO} 80 ia = 1, nalf
01055                            alpha = alf( ia )
01056 \textcolor{comment}{*}
01057 \textcolor{comment}{*                          Generate the matrix A.}
01058 \textcolor{comment}{*}
01059                            \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'TR'}, uplo, diag, na, na, a,
01060      $                                 nmax, aa, lda, reset, zero )
01061 \textcolor{comment}{*}
01062 \textcolor{comment}{*                          Generate the matrix B.}
01063 \textcolor{comment}{*}
01064                            \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, b, nmax,
01065      $                                 bb, ldb, reset, zero )
01066 \textcolor{comment}{*}
01067                            nc = nc + 1
01068 \textcolor{comment}{*}
01069 \textcolor{comment}{*                          Save every datum before calling the}
01070 \textcolor{comment}{*                          subroutine.}
01071 \textcolor{comment}{*}
01072                            sides = side
01073                            uplos = uplo
01074                            tranas = transa
01075                            diags = diag
01076                            ms = m
01077                            ns = n
01078                            als = alpha
01079                            \textcolor{keywordflow}{DO} 30 i = 1, laa
01080                               as( i ) = aa( i )
01081    30                      \textcolor{keywordflow}{CONTINUE}
01082                            ldas = lda
01083                            \textcolor{keywordflow}{DO} 40 i = 1, lbb
01084                               bs( i ) = bb( i )
01085    40                      \textcolor{keywordflow}{CONTINUE}
01086                            ldbs = ldb
01087 \textcolor{comment}{*}
01088 \textcolor{comment}{*                          Call the subroutine.}
01089 \textcolor{comment}{*}
01090                            \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MM'} )\textcolor{keywordflow}{THEN}
01091                               \textcolor{keywordflow}{IF}( trace )
01092      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01093      $                           side, uplo, transa, diag, m, n, alpha,
01094      $                           lda, ldb
01095                               \textcolor{keywordflow}{IF}( rewi )
01096      $                           rewind ntra
01097                               \textcolor{keyword}{CALL }dtrmm( side, uplo, transa, diag, m,
01098      $                                    n, alpha, aa, lda, bb, ldb )
01099                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SM'} )\textcolor{keywordflow}{THEN}
01100                               \textcolor{keywordflow}{IF}( trace )
01101      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01102      $                           side, uplo, transa, diag, m, n, alpha,
01103      $                           lda, ldb
01104                               \textcolor{keywordflow}{IF}( rewi )
01105      $                           rewind ntra
01106                               \textcolor{keyword}{CALL }dtrsm( side, uplo, transa, diag, m,
01107      $                                    n, alpha, aa, lda, bb, ldb )
01108 \textcolor{keywordflow}{                           END IF}
01109 \textcolor{comment}{*}
01110 \textcolor{comment}{*                          Check if error-exit was taken incorrectly.}
01111 \textcolor{comment}{*}
01112                            \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01113                               \textcolor{keyword}{WRITE}( nout, fmt = 9994 )
01114                               fatal = .true.
01115                               \textcolor{keywordflow}{GO TO} 150
01116 \textcolor{keywordflow}{                           END IF}
01117 \textcolor{comment}{*}
01118 \textcolor{comment}{*                          See what data changed inside subroutines.}
01119 \textcolor{comment}{*}
01120                            isame( 1 ) = sides.EQ.side
01121                            isame( 2 ) = uplos.EQ.uplo
01122                            isame( 3 ) = tranas.EQ.transa
01123                            isame( 4 ) = diags.EQ.diag
01124                            isame( 5 ) = ms.EQ.m
01125                            isame( 6 ) = ns.EQ.n
01126                            isame( 7 ) = als.EQ.alpha
01127                            isame( 8 ) = lde( as, aa, laa )
01128                            isame( 9 ) = ldas.EQ.lda
01129                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01130                               isame( 10 ) = lde( bs, bb, lbb )
01131                            \textcolor{keywordflow}{ELSE}
01132                               isame( 10 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, bs,
01133      $                                      bb, ldb )
01134 \textcolor{keywordflow}{                           END IF}
01135                            isame( 11 ) = ldbs.EQ.ldb
01136 \textcolor{comment}{*}
01137 \textcolor{comment}{*                          If data was incorrectly changed, report and}
01138 \textcolor{comment}{*                          return.}
01139 \textcolor{comment}{*}
01140                            same = .true.
01141                            \textcolor{keywordflow}{DO} 50 i = 1, nargs
01142                               same = same.AND.isame( i )
01143                               \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01144      $                           \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01145    50                      \textcolor{keywordflow}{CONTINUE}
01146                            \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01147                               fatal = .true.
01148                               \textcolor{keywordflow}{GO TO} 150
01149 \textcolor{keywordflow}{                           END IF}
01150 \textcolor{comment}{*}
01151                            \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01152                               \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MM'} )\textcolor{keywordflow}{THEN}
01153 \textcolor{comment}{*}
01154 \textcolor{comment}{*                                Check the result.}
01155 \textcolor{comment}{*}
01156                                  \textcolor{keywordflow}{IF}( left )\textcolor{keywordflow}{THEN}
01157                                     \textcolor{keyword}{CALL }dmmch( transa, \textcolor{stringliteral}{'N'}, m, n, m,
01158      $                                          alpha, a, nmax, b, nmax,
01159      $                                          zero, c, nmax, ct, g,
01160      $                                          bb, ldb, eps, err,
01161      $                                          fatal, nout, .true. )
01162                                  \textcolor{keywordflow}{ELSE}
01163                                     \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, transa, m, n, n,
01164      $                                          alpha, b, nmax, a, nmax,
01165      $                                          zero, c, nmax, ct, g,
01166      $                                          bb, ldb, eps, err,
01167      $                                          fatal, nout, .true. )
01168 \textcolor{keywordflow}{                                 END IF}
01169                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SM'} )\textcolor{keywordflow}{THEN}
01170 \textcolor{comment}{*}
01171 \textcolor{comment}{*                                Compute approximation to original}
01172 \textcolor{comment}{*                                matrix.}
01173 \textcolor{comment}{*}
01174                                  \textcolor{keywordflow}{DO} 70 j = 1, n
01175                                     \textcolor{keywordflow}{DO} 60 i = 1, m
01176                                        c( i, j ) = bb( i + ( j - 1 )*
01177      $                                             ldb )
01178                                        bb( i + ( j - 1 )*ldb ) = alpha*
01179      $                                    b( i, j )
01180    60                               \textcolor{keywordflow}{CONTINUE}
01181    70                            \textcolor{keywordflow}{CONTINUE}
01182 \textcolor{comment}{*}
01183                                  \textcolor{keywordflow}{IF}( left )\textcolor{keywordflow}{THEN}
01184                                     \textcolor{keyword}{CALL }dmmch( transa, \textcolor{stringliteral}{'N'}, m, n, m,
01185      $                                          one, a, nmax, c, nmax,
01186      $                                          zero, b, nmax, ct, g,
01187      $                                          bb, ldb, eps, err,
01188      $                                          fatal, nout, .false. )
01189                                  \textcolor{keywordflow}{ELSE}
01190                                     \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, transa, m, n, n,
01191      $                                          one, c, nmax, a, nmax,
01192      $                                          zero, b, nmax, ct, g,
01193      $                                          bb, ldb, eps, err,
01194      $                                          fatal, nout, .false. )
01195 \textcolor{keywordflow}{                                 END IF}
01196 \textcolor{keywordflow}{                              END IF}
01197                               errmax = max( errmax, err )
01198 \textcolor{comment}{*                             If got really bad answer, report and}
01199 \textcolor{comment}{*                             return.}
01200                               \textcolor{keywordflow}{IF}( fatal )
01201      $                           \textcolor{keywordflow}{GO TO} 150
01202 \textcolor{keywordflow}{                           END IF}
01203 \textcolor{comment}{*}
01204    80                   \textcolor{keywordflow}{CONTINUE}
01205 \textcolor{comment}{*}
01206    90                \textcolor{keywordflow}{CONTINUE}
01207 \textcolor{comment}{*}
01208   100             \textcolor{keywordflow}{CONTINUE}
01209 \textcolor{comment}{*}
01210   110          \textcolor{keywordflow}{CONTINUE}
01211 \textcolor{comment}{*}
01212   120       \textcolor{keywordflow}{CONTINUE}
01213 \textcolor{comment}{*}
01214   130    \textcolor{keywordflow}{CONTINUE}
01215 \textcolor{comment}{*}
01216   140 \textcolor{keywordflow}{CONTINUE}
01217 \textcolor{comment}{*}
01218 \textcolor{comment}{*     Report result.}
01219 \textcolor{comment}{*}
01220       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01221          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01222       \textcolor{keywordflow}{ELSE}
01223          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01224 \textcolor{keywordflow}{      END IF}
01225       \textcolor{keywordflow}{GO TO} 160
01226 \textcolor{comment}{*}
01227   150 \textcolor{keywordflow}{CONTINUE}
01228       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01229       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, side, uplo, transa, diag, m,
01230      $   n, alpha, lda, ldb
01231 \textcolor{comment}{*}
01232   160 \textcolor{keywordflow}{CONTINUE}
01233       \textcolor{keywordflow}{RETURN}
01234 \textcolor{comment}{*}
01235  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01236      $      \textcolor{stringliteral}{'S)'} )
01237  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01238      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01239  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01240      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01241      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01242  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01243  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 4( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01244      $      f4.1, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', B,'}, i3, \textcolor{stringliteral}{')        .'} )
01245  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01246      $      \textcolor{stringliteral}{'******'} )
01247 \textcolor{comment}{*}
01248 \textcolor{comment}{*     End of DCHK3.}
01249 \textcolor{comment}{*}
01250 \textcolor{keyword}{      END}
01251 \textcolor{keyword}{      SUBROUTINE }dchk4( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01252      $                  FATAL, NIDIM, IDIM, NALF, ALF, NBET, BET, NMAX,
01253      $                  A, AA, AS, B, BB, BS, C, CC, CS, CT, G )
01254 \textcolor{comment}{*}
01255 \textcolor{comment}{*  Tests DSYRK.}
01256 \textcolor{comment}{*}
01257 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
01258 \textcolor{comment}{*}
01259 \textcolor{comment}{*  -- Written on 8-February-1989.}
01260 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
01261 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
01262 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
01263 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
01264 \textcolor{comment}{*}
01265 \textcolor{comment}{*     .. Parameters ..}
01266       \textcolor{keywordtype}{DOUBLE PRECISION}   zero
01267       parameter( zero = 0.0d0 )
01268 \textcolor{comment}{*     .. Scalar Arguments ..}
01269       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01270       \textcolor{keywordtype}{INTEGER}            nalf, nbet, nidim, nmax, nout, ntra
01271       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01272       \textcolor{keywordtype}{CHARACTER*6}        sname
01273 \textcolor{comment}{*     .. Array Arguments ..}
01274       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01275      $                   as( nmax*nmax ), b( nmax, nmax ),
01276      $                   bb( nmax*nmax ), bet( nbet ), bs( nmax*nmax ),
01277      $                   c( nmax, nmax ), cc( nmax*nmax ),
01278      $                   cs( nmax*nmax ), ct( nmax ), g( nmax )
01279       \textcolor{keywordtype}{INTEGER}            idim( nidim )
01280 \textcolor{comment}{*     .. Local Scalars ..}
01281       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bets, err, errmax
01282       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ict, icu, ik, in, j, jc, jj, k, ks,
01283      $                   laa, lcc, lda, ldas, ldc, ldcs, lj, ma, n, na,
01284      $                   nargs, nc, ns
01285       \textcolor{keywordtype}{LOGICAL}            null, reset, same, tran, upper
01286       \textcolor{keywordtype}{CHARACTER*1}        trans, transs, uplo, uplos
01287       \textcolor{keywordtype}{CHARACTER*2}        ichu
01288       \textcolor{keywordtype}{CHARACTER*3}        icht
01289 \textcolor{comment}{*     .. Local Arrays ..}
01290       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01291 \textcolor{comment}{*     .. External Functions ..}
01292       \textcolor{keywordtype}{LOGICAL}            lde, lderes
01293       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
01294 \textcolor{comment}{*     .. External Subroutines ..}
01295       \textcolor{keywordtype}{EXTERNAL}           dmake, dmmch, dsyrk
01296 \textcolor{comment}{*     .. Intrinsic Functions ..}
01297       \textcolor{keywordtype}{INTRINSIC}          max
01298 \textcolor{comment}{*     .. Scalars in Common ..}
01299       \textcolor{keywordtype}{INTEGER}            infot, noutc
01300       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01301 \textcolor{comment}{*     .. Common blocks ..}
01302       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01303 \textcolor{comment}{*     .. Data statements ..}
01304       \textcolor{keyword}{DATA}               icht/\textcolor{stringliteral}{'NTC'}/, ichu/\textcolor{stringliteral}{'UL'}/
01305 \textcolor{comment}{*     .. Executable Statements ..}
01306 \textcolor{comment}{*}
01307       nargs = 10
01308       nc = 0
01309       reset = .true.
01310       errmax = zero
01311 \textcolor{comment}{*}
01312       \textcolor{keywordflow}{DO} 100 in = 1, nidim
01313          n = idim( in )
01314 \textcolor{comment}{*        Set LDC to 1 more than minimum value if room.}
01315          ldc = n
01316          \textcolor{keywordflow}{IF}( ldc.LT.nmax )
01317      $      ldc = ldc + 1
01318 \textcolor{comment}{*        Skip tests if not enough room.}
01319          \textcolor{keywordflow}{IF}( ldc.GT.nmax )
01320      $      \textcolor{keywordflow}{GO TO} 100
01321          lcc = ldc*n
01322          null = n.LE.0
01323 \textcolor{comment}{*}
01324          \textcolor{keywordflow}{DO} 90 ik = 1, nidim
01325             k = idim( ik )
01326 \textcolor{comment}{*}
01327             \textcolor{keywordflow}{DO} 80 ict = 1, 3
01328                trans = icht( ict: ict )
01329                tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
01330                \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01331                   ma = k
01332                   na = n
01333                \textcolor{keywordflow}{ELSE}
01334                   ma = n
01335                   na = k
01336 \textcolor{keywordflow}{               END IF}
01337 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
01338                lda = ma
01339                \textcolor{keywordflow}{IF}( lda.LT.nmax )
01340      $            lda = lda + 1
01341 \textcolor{comment}{*              Skip tests if not enough room.}
01342                \textcolor{keywordflow}{IF}( lda.GT.nmax )
01343      $            \textcolor{keywordflow}{GO TO} 80
01344                laa = lda*na
01345 \textcolor{comment}{*}
01346 \textcolor{comment}{*              Generate the matrix A.}
01347 \textcolor{comment}{*}
01348                \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, a, nmax, aa, lda,
01349      $                     reset, zero )
01350 \textcolor{comment}{*}
01351                \textcolor{keywordflow}{DO} 70 icu = 1, 2
01352                   uplo = ichu( icu: icu )
01353                   upper = uplo.EQ.\textcolor{stringliteral}{'U'}
01354 \textcolor{comment}{*}
01355                   \textcolor{keywordflow}{DO} 60 ia = 1, nalf
01356                      alpha = alf( ia )
01357 \textcolor{comment}{*}
01358                      \textcolor{keywordflow}{DO} 50 ib = 1, nbet
01359                         beta = bet( ib )
01360 \textcolor{comment}{*}
01361 \textcolor{comment}{*                       Generate the matrix C.}
01362 \textcolor{comment}{*}
01363                         \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'SY'}, uplo, \textcolor{stringliteral}{' '}, n, n, c, nmax, cc,
01364      $                              ldc, reset, zero )
01365 \textcolor{comment}{*}
01366                         nc = nc + 1
01367 \textcolor{comment}{*}
01368 \textcolor{comment}{*                       Save every datum before calling the subroutine.}
01369 \textcolor{comment}{*}
01370                         uplos = uplo
01371                         transs = trans
01372                         ns = n
01373                         ks = k
01374                         als = alpha
01375                         \textcolor{keywordflow}{DO} 10 i = 1, laa
01376                            as( i ) = aa( i )
01377    10                   \textcolor{keywordflow}{CONTINUE}
01378                         ldas = lda
01379                         bets = beta
01380                         \textcolor{keywordflow}{DO} 20 i = 1, lcc
01381                            cs( i ) = cc( i )
01382    20                   \textcolor{keywordflow}{CONTINUE}
01383                         ldcs = ldc
01384 \textcolor{comment}{*}
01385 \textcolor{comment}{*                       Call the subroutine.}
01386 \textcolor{comment}{*}
01387                         \textcolor{keywordflow}{IF}( trace )
01388      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo,
01389      $                     trans, n, k, alpha, lda, beta, ldc
01390                         \textcolor{keywordflow}{IF}( rewi )
01391      $                     rewind ntra
01392                         \textcolor{keyword}{CALL }dsyrk( uplo, trans, n, k, alpha, aa, lda,
01393      $                              beta, cc, ldc )
01394 \textcolor{comment}{*}
01395 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
01396 \textcolor{comment}{*}
01397                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01398                            \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
01399                            fatal = .true.
01400                            \textcolor{keywordflow}{GO TO} 120
01401 \textcolor{keywordflow}{                        END IF}
01402 \textcolor{comment}{*}
01403 \textcolor{comment}{*                       See what data changed inside subroutines.}
01404 \textcolor{comment}{*}
01405                         isame( 1 ) = uplos.EQ.uplo
01406                         isame( 2 ) = transs.EQ.trans
01407                         isame( 3 ) = ns.EQ.n
01408                         isame( 4 ) = ks.EQ.k
01409                         isame( 5 ) = als.EQ.alpha
01410                         isame( 6 ) = lde( as, aa, laa )
01411                         isame( 7 ) = ldas.EQ.lda
01412                         isame( 8 ) = bets.EQ.beta
01413                         \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01414                            isame( 9 ) = lde( cs, cc, lcc )
01415                         \textcolor{keywordflow}{ELSE}
01416                            isame( 9 ) = lderes( \textcolor{stringliteral}{'SY'}, uplo, n, n, cs,
01417      $                                  cc, ldc )
01418 \textcolor{keywordflow}{                        END IF}
01419                         isame( 10 ) = ldcs.EQ.ldc
01420 \textcolor{comment}{*}
01421 \textcolor{comment}{*                       If data was incorrectly changed, report and}
01422 \textcolor{comment}{*                       return.}
01423 \textcolor{comment}{*}
01424                         same = .true.
01425                         \textcolor{keywordflow}{DO} 30 i = 1, nargs
01426                            same = same.AND.isame( i )
01427                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01428      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01429    30                   \textcolor{keywordflow}{CONTINUE}
01430                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01431                            fatal = .true.
01432                            \textcolor{keywordflow}{GO TO} 120
01433 \textcolor{keywordflow}{                        END IF}
01434 \textcolor{comment}{*}
01435                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01436 \textcolor{comment}{*}
01437 \textcolor{comment}{*                          Check the result column by column.}
01438 \textcolor{comment}{*}
01439                            jc = 1
01440                            \textcolor{keywordflow}{DO} 40 j = 1, n
01441                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01442                                  jj = 1
01443                                  lj = j
01444                               \textcolor{keywordflow}{ELSE}
01445                                  jj = j
01446                                  lj = n - j + 1
01447 \textcolor{keywordflow}{                              END IF}
01448                               \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01449                                  \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, lj, 1, k, alpha,
01450      $                                       a( 1, jj ), nmax,
01451      $                                       a( 1, j ), nmax, beta,
01452      $                                       c( jj, j ), nmax, ct, g,
01453      $                                       cc( jc ), ldc, eps, err,
01454      $                                       fatal, nout, .true. )
01455                               \textcolor{keywordflow}{ELSE}
01456                                  \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, lj, 1, k, alpha,
01457      $                                       a( jj, 1 ), nmax,
01458      $                                       a( j, 1 ), nmax, beta,
01459      $                                       c( jj, j ), nmax, ct, g,
01460      $                                       cc( jc ), ldc, eps, err,
01461      $                                       fatal, nout, .true. )
01462 \textcolor{keywordflow}{                              END IF}
01463                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01464                                  jc = jc + ldc
01465                               \textcolor{keywordflow}{ELSE}
01466                                  jc = jc + ldc + 1
01467 \textcolor{keywordflow}{                              END IF}
01468                               errmax = max( errmax, err )
01469 \textcolor{comment}{*                             If got really bad answer, report and}
01470 \textcolor{comment}{*                             return.}
01471                               \textcolor{keywordflow}{IF}( fatal )
01472      $                           \textcolor{keywordflow}{GO TO} 110
01473    40                      \textcolor{keywordflow}{CONTINUE}
01474 \textcolor{keywordflow}{                        END IF}
01475 \textcolor{comment}{*}
01476    50                \textcolor{keywordflow}{CONTINUE}
01477 \textcolor{comment}{*}
01478    60             \textcolor{keywordflow}{CONTINUE}
01479 \textcolor{comment}{*}
01480    70          \textcolor{keywordflow}{CONTINUE}
01481 \textcolor{comment}{*}
01482    80       \textcolor{keywordflow}{CONTINUE}
01483 \textcolor{comment}{*}
01484    90    \textcolor{keywordflow}{CONTINUE}
01485 \textcolor{comment}{*}
01486   100 \textcolor{keywordflow}{CONTINUE}
01487 \textcolor{comment}{*}
01488 \textcolor{comment}{*     Report result.}
01489 \textcolor{comment}{*}
01490       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01491          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01492       \textcolor{keywordflow}{ELSE}
01493          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01494 \textcolor{keywordflow}{      END IF}
01495       \textcolor{keywordflow}{GO TO} 130
01496 \textcolor{comment}{*}
01497   110 \textcolor{keywordflow}{CONTINUE}
01498       \textcolor{keywordflow}{IF}( n.GT.1 )
01499      $   \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01500 \textcolor{comment}{*}
01501   120 \textcolor{keywordflow}{CONTINUE}
01502       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01503       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, trans, n, k, alpha,
01504      $   lda, beta, ldc
01505 \textcolor{comment}{*}
01506   130 \textcolor{keywordflow}{CONTINUE}
01507       \textcolor{keywordflow}{RETURN}
01508 \textcolor{comment}{*}
01509  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01510      $      \textcolor{stringliteral}{'S)'} )
01511  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01512      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01513  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01514      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01515      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01516  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01517  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
01518  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01519      $      f4.1, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', C,'}, i3, \textcolor{stringliteral}{')           .'} )
01520  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01521      $      \textcolor{stringliteral}{'******'} )
01522 \textcolor{comment}{*}
01523 \textcolor{comment}{*     End of DCHK4.}
01524 \textcolor{comment}{*}
01525 \textcolor{keyword}{      END}
01526 \textcolor{keyword}{      SUBROUTINE }dchk5( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01527      $                  FATAL, NIDIM, IDIM, NALF, ALF, NBET, BET, NMAX,
01528      $                  AB, AA, AS, BB, BS, C, CC, CS, CT, G, W )
01529 \textcolor{comment}{*}
01530 \textcolor{comment}{*  Tests DSYR2K.}
01531 \textcolor{comment}{*}
01532 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
01533 \textcolor{comment}{*}
01534 \textcolor{comment}{*  -- Written on 8-February-1989.}
01535 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
01536 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
01537 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
01538 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
01539 \textcolor{comment}{*}
01540 \textcolor{comment}{*     .. Parameters ..}
01541       \textcolor{keywordtype}{DOUBLE PRECISION}   zero
01542       parameter( zero = 0.0d0 )
01543 \textcolor{comment}{*     .. Scalar Arguments ..}
01544       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01545       \textcolor{keywordtype}{INTEGER}            nalf, nbet, nidim, nmax, nout, ntra
01546       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01547       \textcolor{keywordtype}{CHARACTER*6}        sname
01548 \textcolor{comment}{*     .. Array Arguments ..}
01549       \textcolor{keywordtype}{DOUBLE PRECISION}   aa( nmax*nmax ), ab( 2*nmax*nmax ),
01550      $                   alf( nalf ), as( nmax*nmax ), bb( nmax*nmax ),
01551      $                   bet( nbet ), bs( nmax*nmax ), c( nmax, nmax ),
01552      $                   cc( nmax*nmax ), cs( nmax*nmax ), ct( nmax ),
01553      $                   g( nmax ), w( 2*nmax )
01554       \textcolor{keywordtype}{INTEGER}            idim( nidim )
01555 \textcolor{comment}{*     .. Local Scalars ..}
01556       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bets, err, errmax
01557       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ict, icu, ik, in, j, jc, jj, jjab,
01558      $                   k, ks, laa, lbb, lcc, lda, ldas, ldb, ldbs,
01559      $                   ldc, ldcs, lj, ma, n, na, nargs, nc, ns
01560       \textcolor{keywordtype}{LOGICAL}            null, reset, same, tran, upper
01561       \textcolor{keywordtype}{CHARACTER*1}        trans, transs, uplo, uplos
01562       \textcolor{keywordtype}{CHARACTER*2}        ichu
01563       \textcolor{keywordtype}{CHARACTER*3}        icht
01564 \textcolor{comment}{*     .. Local Arrays ..}
01565       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01566 \textcolor{comment}{*     .. External Functions ..}
01567       \textcolor{keywordtype}{LOGICAL}            lde, lderes
01568       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
01569 \textcolor{comment}{*     .. External Subroutines ..}
01570       \textcolor{keywordtype}{EXTERNAL}           dmake, dmmch, dsyr2k
01571 \textcolor{comment}{*     .. Intrinsic Functions ..}
01572       \textcolor{keywordtype}{INTRINSIC}          max
01573 \textcolor{comment}{*     .. Scalars in Common ..}
01574       \textcolor{keywordtype}{INTEGER}            infot, noutc
01575       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01576 \textcolor{comment}{*     .. Common blocks ..}
01577       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01578 \textcolor{comment}{*     .. Data statements ..}
01579       \textcolor{keyword}{DATA}               icht/\textcolor{stringliteral}{'NTC'}/, ichu/\textcolor{stringliteral}{'UL'}/
01580 \textcolor{comment}{*     .. Executable Statements ..}
01581 \textcolor{comment}{*}
01582       nargs = 12
01583       nc = 0
01584       reset = .true.
01585       errmax = zero
01586 \textcolor{comment}{*}
01587       \textcolor{keywordflow}{DO} 130 in = 1, nidim
01588          n = idim( in )
01589 \textcolor{comment}{*        Set LDC to 1 more than minimum value if room.}
01590          ldc = n
01591          \textcolor{keywordflow}{IF}( ldc.LT.nmax )
01592      $      ldc = ldc + 1
01593 \textcolor{comment}{*        Skip tests if not enough room.}
01594          \textcolor{keywordflow}{IF}( ldc.GT.nmax )
01595      $      \textcolor{keywordflow}{GO TO} 130
01596          lcc = ldc*n
01597          null = n.LE.0
01598 \textcolor{comment}{*}
01599          \textcolor{keywordflow}{DO} 120 ik = 1, nidim
01600             k = idim( ik )
01601 \textcolor{comment}{*}
01602             \textcolor{keywordflow}{DO} 110 ict = 1, 3
01603                trans = icht( ict: ict )
01604                tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
01605                \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01606                   ma = k
01607                   na = n
01608                \textcolor{keywordflow}{ELSE}
01609                   ma = n
01610                   na = k
01611 \textcolor{keywordflow}{               END IF}
01612 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
01613                lda = ma
01614                \textcolor{keywordflow}{IF}( lda.LT.nmax )
01615      $            lda = lda + 1
01616 \textcolor{comment}{*              Skip tests if not enough room.}
01617                \textcolor{keywordflow}{IF}( lda.GT.nmax )
01618      $            \textcolor{keywordflow}{GO TO} 110
01619                laa = lda*na
01620 \textcolor{comment}{*}
01621 \textcolor{comment}{*              Generate the matrix A.}
01622 \textcolor{comment}{*}
01623                \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01624                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, ab, 2*nmax, aa,
01625      $                        lda, reset, zero )
01626                \textcolor{keywordflow}{ELSE}
01627                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, ab, nmax, aa, lda,
01628      $                        reset, zero )
01629 \textcolor{keywordflow}{               END IF}
01630 \textcolor{comment}{*}
01631 \textcolor{comment}{*              Generate the matrix B.}
01632 \textcolor{comment}{*}
01633                ldb = lda
01634                lbb = laa
01635                \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01636                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, ab( k + 1 ),
01637      $                        2*nmax, bb, ldb, reset, zero )
01638                \textcolor{keywordflow}{ELSE}
01639                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, ma, na, ab( k*nmax + 1 ),
01640      $                        nmax, bb, ldb, reset, zero )
01641 \textcolor{keywordflow}{               END IF}
01642 \textcolor{comment}{*}
01643                \textcolor{keywordflow}{DO} 100 icu = 1, 2
01644                   uplo = ichu( icu: icu )
01645                   upper = uplo.EQ.\textcolor{stringliteral}{'U'}
01646 \textcolor{comment}{*}
01647                   \textcolor{keywordflow}{DO} 90 ia = 1, nalf
01648                      alpha = alf( ia )
01649 \textcolor{comment}{*}
01650                      \textcolor{keywordflow}{DO} 80 ib = 1, nbet
01651                         beta = bet( ib )
01652 \textcolor{comment}{*}
01653 \textcolor{comment}{*                       Generate the matrix C.}
01654 \textcolor{comment}{*}
01655                         \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'SY'}, uplo, \textcolor{stringliteral}{' '}, n, n, c, nmax, cc,
01656      $                              ldc, reset, zero )
01657 \textcolor{comment}{*}
01658                         nc = nc + 1
01659 \textcolor{comment}{*}
01660 \textcolor{comment}{*                       Save every datum before calling the subroutine.}
01661 \textcolor{comment}{*}
01662                         uplos = uplo
01663                         transs = trans
01664                         ns = n
01665                         ks = k
01666                         als = alpha
01667                         \textcolor{keywordflow}{DO} 10 i = 1, laa
01668                            as( i ) = aa( i )
01669    10                   \textcolor{keywordflow}{CONTINUE}
01670                         ldas = lda
01671                         \textcolor{keywordflow}{DO} 20 i = 1, lbb
01672                            bs( i ) = bb( i )
01673    20                   \textcolor{keywordflow}{CONTINUE}
01674                         ldbs = ldb
01675                         bets = beta
01676                         \textcolor{keywordflow}{DO} 30 i = 1, lcc
01677                            cs( i ) = cc( i )
01678    30                   \textcolor{keywordflow}{CONTINUE}
01679                         ldcs = ldc
01680 \textcolor{comment}{*}
01681 \textcolor{comment}{*                       Call the subroutine.}
01682 \textcolor{comment}{*}
01683                         \textcolor{keywordflow}{IF}( trace )
01684      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo,
01685      $                     trans, n, k, alpha, lda, ldb, beta, ldc
01686                         \textcolor{keywordflow}{IF}( rewi )
01687      $                     rewind ntra
01688                         \textcolor{keyword}{CALL }dsyr2k( uplo, trans, n, k, alpha, aa, lda,
01689      $                               bb, ldb, beta, cc, ldc )
01690 \textcolor{comment}{*}
01691 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
01692 \textcolor{comment}{*}
01693                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01694                            \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
01695                            fatal = .true.
01696                            \textcolor{keywordflow}{GO TO} 150
01697 \textcolor{keywordflow}{                        END IF}
01698 \textcolor{comment}{*}
01699 \textcolor{comment}{*                       See what data changed inside subroutines.}
01700 \textcolor{comment}{*}
01701                         isame( 1 ) = uplos.EQ.uplo
01702                         isame( 2 ) = transs.EQ.trans
01703                         isame( 3 ) = ns.EQ.n
01704                         isame( 4 ) = ks.EQ.k
01705                         isame( 5 ) = als.EQ.alpha
01706                         isame( 6 ) = lde( as, aa, laa )
01707                         isame( 7 ) = ldas.EQ.lda
01708                         isame( 8 ) = lde( bs, bb, lbb )
01709                         isame( 9 ) = ldbs.EQ.ldb
01710                         isame( 10 ) = bets.EQ.beta
01711                         \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01712                            isame( 11 ) = lde( cs, cc, lcc )
01713                         \textcolor{keywordflow}{ELSE}
01714                            isame( 11 ) = lderes( \textcolor{stringliteral}{'SY'}, uplo, n, n, cs,
01715      $                                   cc, ldc )
01716 \textcolor{keywordflow}{                        END IF}
01717                         isame( 12 ) = ldcs.EQ.ldc
01718 \textcolor{comment}{*}
01719 \textcolor{comment}{*                       If data was incorrectly changed, report and}
01720 \textcolor{comment}{*                       return.}
01721 \textcolor{comment}{*}
01722                         same = .true.
01723                         \textcolor{keywordflow}{DO} 40 i = 1, nargs
01724                            same = same.AND.isame( i )
01725                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01726      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01727    40                   \textcolor{keywordflow}{CONTINUE}
01728                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01729                            fatal = .true.
01730                            \textcolor{keywordflow}{GO TO} 150
01731 \textcolor{keywordflow}{                        END IF}
01732 \textcolor{comment}{*}
01733                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01734 \textcolor{comment}{*}
01735 \textcolor{comment}{*                          Check the result column by column.}
01736 \textcolor{comment}{*}
01737                            jjab = 1
01738                            jc = 1
01739                            \textcolor{keywordflow}{DO} 70 j = 1, n
01740                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01741                                  jj = 1
01742                                  lj = j
01743                               \textcolor{keywordflow}{ELSE}
01744                                  jj = j
01745                                  lj = n - j + 1
01746 \textcolor{keywordflow}{                              END IF}
01747                               \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
01748                                  \textcolor{keywordflow}{DO} 50 i = 1, k
01749                                     w( i ) = ab( ( j - 1 )*2*nmax + k +
01750      $                                       i )
01751                                     w( k + i ) = ab( ( j - 1 )*2*nmax +
01752      $                                           i )
01753    50                            \textcolor{keywordflow}{CONTINUE}
01754                                  \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, lj, 1, 2*k,
01755      $                                       alpha, ab( jjab ), 2*nmax,
01756      $                                       w, 2*nmax, beta,
01757      $                                       c( jj, j ), nmax, ct, g,
01758      $                                       cc( jc ), ldc, eps, err,
01759      $                                       fatal, nout, .true. )
01760                               \textcolor{keywordflow}{ELSE}
01761                                  \textcolor{keywordflow}{DO} 60 i = 1, k
01762                                     w( i ) = ab( ( k + i - 1 )*nmax +
01763      $                                       j )
01764                                     w( k + i ) = ab( ( i - 1 )*nmax +
01765      $                                           j )
01766    60                            \textcolor{keywordflow}{CONTINUE}
01767                                  \textcolor{keyword}{CALL }dmmch( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, lj, 1, 2*k,
01768      $                                       alpha, ab( jj ), nmax, w,
01769      $                                       2*nmax, beta, c( jj, j ),
01770      $                                       nmax, ct, g, cc( jc ), ldc,
01771      $                                       eps, err, fatal, nout,
01772      $                                       .true. )
01773 \textcolor{keywordflow}{                              END IF}
01774                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01775                                  jc = jc + ldc
01776                               \textcolor{keywordflow}{ELSE}
01777                                  jc = jc + ldc + 1
01778                                  \textcolor{keywordflow}{IF}( tran )
01779      $                              jjab = jjab + 2*nmax
01780 \textcolor{keywordflow}{                              END IF}
01781                               errmax = max( errmax, err )
01782 \textcolor{comment}{*                             If got really bad answer, report and}
01783 \textcolor{comment}{*                             return.}
01784                               \textcolor{keywordflow}{IF}( fatal )
01785      $                           \textcolor{keywordflow}{GO TO} 140
01786    70                      \textcolor{keywordflow}{CONTINUE}
01787 \textcolor{keywordflow}{                        END IF}
01788 \textcolor{comment}{*}
01789    80                \textcolor{keywordflow}{CONTINUE}
01790 \textcolor{comment}{*}
01791    90             \textcolor{keywordflow}{CONTINUE}
01792 \textcolor{comment}{*}
01793   100          \textcolor{keywordflow}{CONTINUE}
01794 \textcolor{comment}{*}
01795   110       \textcolor{keywordflow}{CONTINUE}
01796 \textcolor{comment}{*}
01797   120    \textcolor{keywordflow}{CONTINUE}
01798 \textcolor{comment}{*}
01799   130 \textcolor{keywordflow}{CONTINUE}
01800 \textcolor{comment}{*}
01801 \textcolor{comment}{*     Report result.}
01802 \textcolor{comment}{*}
01803       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01804          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01805       \textcolor{keywordflow}{ELSE}
01806          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01807 \textcolor{keywordflow}{      END IF}
01808       \textcolor{keywordflow}{GO TO} 160
01809 \textcolor{comment}{*}
01810   140 \textcolor{keywordflow}{CONTINUE}
01811       \textcolor{keywordflow}{IF}( n.GT.1 )
01812      $   \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01813 \textcolor{comment}{*}
01814   150 \textcolor{keywordflow}{CONTINUE}
01815       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01816       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, trans, n, k, alpha,
01817      $   lda, ldb, beta, ldc
01818 \textcolor{comment}{*}
01819   160 \textcolor{keywordflow}{CONTINUE}
01820       \textcolor{keywordflow}{RETURN}
01821 \textcolor{comment}{*}
01822  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01823      $      \textcolor{stringliteral}{'S)'} )
01824  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01825      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01826  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01827      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01828      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01829  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01830  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
01831  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01832      $      f4.1, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', B,'}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', C,'}, i3, \textcolor{stringliteral}{')   '},
01833      $      \textcolor{stringliteral}{' .'} )
01834  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01835      $      \textcolor{stringliteral}{'******'} )
01836 \textcolor{comment}{*}
01837 \textcolor{comment}{*     End of DCHK5.}
01838 \textcolor{comment}{*}
01839 \textcolor{keyword}{      END}
01840 \textcolor{keyword}{      SUBROUTINE }dchke( ISNUM, SRNAMT, NOUT )
01841 \textcolor{comment}{*}
01842 \textcolor{comment}{*  Tests the error exits from the Level 3 Blas.}
01843 \textcolor{comment}{*  Requires a special version of the error-handling routine XERBLA.}
01844 \textcolor{comment}{*  A, B and C should not need to be defined.}
01845 \textcolor{comment}{*}
01846 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
01847 \textcolor{comment}{*}
01848 \textcolor{comment}{*  -- Written on 8-February-1989.}
01849 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
01850 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
01851 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
01852 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
01853 \textcolor{comment}{*}
01854 \textcolor{comment}{*  3-19-92:  Initialize ALPHA and BETA  (eca)}
01855 \textcolor{comment}{*  3-19-92:  Fix argument 12 in calls to SSYMM with INFOT = 9  (eca)}
01856 \textcolor{comment}{*}
01857 \textcolor{comment}{*     .. Scalar Arguments ..}
01858       \textcolor{keywordtype}{INTEGER}            isnum, nout
01859       \textcolor{keywordtype}{CHARACTER*6}        srnamt
01860 \textcolor{comment}{*     .. Scalars in Common ..}
01861       \textcolor{keywordtype}{INTEGER}            infot, noutc
01862       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01863 \textcolor{comment}{*     .. Parameters ..}
01864       \textcolor{keywordtype}{DOUBLE PRECISION}   one, two
01865       parameter( one = 1.0d0, two = 2.0d0 )
01866 \textcolor{comment}{*     .. Local Scalars ..}
01867       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, beta
01868 \textcolor{comment}{*     .. Local Arrays ..}
01869       \textcolor{keywordtype}{DOUBLE PRECISION}   a( 2, 1 ), b( 2, 1 ), c( 2, 1 )
01870 \textcolor{comment}{*     .. External Subroutines ..}
01871       \textcolor{keywordtype}{EXTERNAL}           chkxer, dgemm, dsymm, dsyr2k, dsyrk, dtrmm,
01872      $                   dtrsm
01873 \textcolor{comment}{*     .. Common blocks ..}
01874       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01875 \textcolor{comment}{*     .. Executable Statements ..}
01876 \textcolor{comment}{*     OK is set to .FALSE. by the special version of XERBLA or by CHKXER}
01877 \textcolor{comment}{*     if anything is wrong.}
01878       ok = .true.
01879 \textcolor{comment}{*     LERR is set to .TRUE. by the special version of XERBLA each time}
01880 \textcolor{comment}{*     it is called, and is then tested and re-set by CHKXER.}
01881       lerr = .false.
01882 \textcolor{comment}{*}
01883 \textcolor{comment}{*     Initialize ALPHA and BETA.}
01884 \textcolor{comment}{*}
01885       alpha = one
01886       beta = two
01887 \textcolor{comment}{*}
01888       \textcolor{keywordflow}{GO TO} ( 10, 20, 30, 40, 50, 60 )isnum
01889    10 infot = 1
01890       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01891       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01892       infot = 1
01893       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'T'}, 0, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01894       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01895       infot = 2
01896       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01897       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01898       infot = 2
01899       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'/'}, 0, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01900       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01901       infot = 3
01902       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01903       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01904       infot = 3
01905       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, -1, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01906       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01907       infot = 3
01908       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01909       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01910       infot = 3
01911       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, -1, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01912       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01913       infot = 4
01914       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01915       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01916       infot = 4
01917       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, 0, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01918       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01919       infot = 4
01920       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01921       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01922       infot = 4
01923       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, 0, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01924       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01925       infot = 5
01926       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01927       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01928       infot = 5
01929       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, 0, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01930       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01931       infot = 5
01932       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01933       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01934       infot = 5
01935       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, 0, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01936       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01937       infot = 8
01938       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, 0, alpha, a, 1, b, 1, beta, c, 2 )
01939       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01940       infot = 8
01941       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, 2, 0, 0, alpha, a, 1, b, 1, beta, c, 2 )
01942       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01943       infot = 8
01944       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 0, 2, alpha, a, 1, b, 2, beta, c, 1 )
01945       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01946       infot = 8
01947       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, 0, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
01948       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01949       infot = 10
01950       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
01951       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01952       infot = 10
01953       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 0, 2, alpha, a, 2, b, 1, beta, c, 1 )
01954       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01955       infot = 10
01956       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, 0, 2, 0, alpha, a, 1, b, 1, beta, c, 1 )
01957       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01958       infot = 10
01959       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, 0, 2, 0, alpha, a, 1, b, 1, beta, c, 1 )
01960       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01961       infot = 13
01962       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, 0, alpha, a, 2, b, 1, beta, c, 1 )
01963       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01964       infot = 13
01965       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'T'}, 2, 0, 0, alpha, a, 2, b, 1, beta, c, 1 )
01966       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01967       infot = 13
01968       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01969       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01970       infot = 13
01971       \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'T'}, 2, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01972       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01973       \textcolor{keywordflow}{GO TO} 70
01974    20 infot = 1
01975       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01976       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01977       infot = 2
01978       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
01979       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01980       infot = 3
01981       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01982       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01983       infot = 3
01984       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01985       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01986       infot = 3
01987       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01988       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01989       infot = 3
01990       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
01991       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01992       infot = 4
01993       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01994       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01995       infot = 4
01996       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
01997       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
01998       infot = 4
01999       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02000       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02001       infot = 4
02002       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02003       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02004       infot = 7
02005       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, 2, 0, alpha, a, 1, b, 2, beta, c, 2 )
02006       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02007       infot = 7
02008       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
02009       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02010       infot = 7
02011       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, 2, 0, alpha, a, 1, b, 2, beta, c, 2 )
02012       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02013       infot = 7
02014       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
02015       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02016       infot = 9
02017       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, 2, 0, alpha, a, 2, b, 1, beta, c, 2 )
02018       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02019       infot = 9
02020       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, 2, 0, alpha, a, 1, b, 1, beta, c, 2 )
02021       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02022       infot = 9
02023       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, 2, 0, alpha, a, 2, b, 1, beta, c, 2 )
02024       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02025       infot = 9
02026       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, 2, 0, alpha, a, 1, b, 1, beta, c, 2 )
02027       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02028       infot = 12
02029       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, 2, 0, alpha, a, 2, b, 2, beta, c, 1 )
02030       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02031       infot = 12
02032       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, 2, 0, alpha, a, 1, b, 2, beta, c, 1 )
02033       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02034       infot = 12
02035       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, 2, 0, alpha, a, 2, b, 2, beta, c, 1 )
02036       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02037       infot = 12
02038       \textcolor{keyword}{CALL }dsymm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, 2, 0, alpha, a, 1, b, 2, beta, c, 1 )
02039       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02040       \textcolor{keywordflow}{GO TO} 70
02041    30 infot = 1
02042       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02043       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02044       infot = 2
02045       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02046       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02047       infot = 3
02048       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02049       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02050       infot = 4
02051       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, b, 1 )
02052       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02053       infot = 5
02054       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02055       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02056       infot = 5
02057       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02058       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02059       infot = 5
02060       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02061       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02062       infot = 5
02063       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02064       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02065       infot = 5
02066       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02067       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02068       infot = 5
02069       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02070       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02071       infot = 5
02072       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02073       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02074       infot = 5
02075       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02076       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02077       infot = 6
02078       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02079       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02080       infot = 6
02081       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02082       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02083       infot = 6
02084       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02085       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02086       infot = 6
02087       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02088       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02089       infot = 6
02090       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02091       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02092       infot = 6
02093       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02094       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02095       infot = 6
02096       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02097       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02098       infot = 6
02099       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02100       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02101       infot = 9
02102       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02103       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02104       infot = 9
02105       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02106       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02107       infot = 9
02108       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02109       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02110       infot = 9
02111       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02112       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02113       infot = 9
02114       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02115       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02116       infot = 9
02117       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02118       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02119       infot = 9
02120       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02121       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02122       infot = 9
02123       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02124       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02125       infot = 11
02126       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02127       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02128       infot = 11
02129       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02130       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02131       infot = 11
02132       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02133       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02134       infot = 11
02135       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02136       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02137       infot = 11
02138       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02139       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02140       infot = 11
02141       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02142       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02143       infot = 11
02144       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02145       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02146       infot = 11
02147       \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02148       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02149       \textcolor{keywordflow}{GO TO} 70
02150    40 infot = 1
02151       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02152       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02153       infot = 2
02154       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02155       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02156       infot = 3
02157       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1 )
02158       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02159       infot = 4
02160       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, b, 1 )
02161       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02162       infot = 5
02163       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02164       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02165       infot = 5
02166       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02167       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02168       infot = 5
02169       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02170       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02171       infot = 5
02172       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02173       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02174       infot = 5
02175       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02176       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02177       infot = 5
02178       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02179       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02180       infot = 5
02181       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02182       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02183       infot = 5
02184       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1 )
02185       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02186       infot = 6
02187       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02188       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02189       infot = 6
02190       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02191       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02192       infot = 6
02193       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02194       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02195       infot = 6
02196       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02197       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02198       infot = 6
02199       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02200       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02201       infot = 6
02202       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02203       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02204       infot = 6
02205       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02206       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02207       infot = 6
02208       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1 )
02209       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02210       infot = 9
02211       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02212       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02213       infot = 9
02214       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02215       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02216       infot = 9
02217       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02218       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02219       infot = 9
02220       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02221       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02222       infot = 9
02223       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02224       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02225       infot = 9
02226       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 2 )
02227       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02228       infot = 9
02229       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02230       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02231       infot = 9
02232       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 0, 2, alpha, a, 1, b, 1 )
02233       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02234       infot = 11
02235       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02236       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02237       infot = 11
02238       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02239       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02240       infot = 11
02241       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02242       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02243       infot = 11
02244       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02245       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02246       infot = 11
02247       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02248       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02249       infot = 11
02250       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1 )
02251       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02252       infot = 11
02253       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02254       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02255       infot = 11
02256       \textcolor{keyword}{CALL }dtrsm( \textcolor{stringliteral}{'R'}, \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1 )
02257       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02258       \textcolor{keywordflow}{GO TO} 70
02259    50 infot = 1
02260       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, beta, c, 1 )
02261       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02262       infot = 2
02263       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, beta, c, 1 )
02264       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02265       infot = 3
02266       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, beta, c, 1 )
02267       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02268       infot = 3
02269       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, -1, 0, alpha, a, 1, beta, c, 1 )
02270       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02271       infot = 3
02272       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, beta, c, 1 )
02273       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02274       infot = 3
02275       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, -1, 0, alpha, a, 1, beta, c, 1 )
02276       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02277       infot = 4
02278       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, beta, c, 1 )
02279       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02280       infot = 4
02281       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 0, -1, alpha, a, 1, beta, c, 1 )
02282       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02283       infot = 4
02284       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, beta, c, 1 )
02285       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02286       infot = 4
02287       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 0, -1, alpha, a, 1, beta, c, 1 )
02288       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02289       infot = 7
02290       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, beta, c, 2 )
02291       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02292       infot = 7
02293       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 1, beta, c, 1 )
02294       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02295       infot = 7
02296       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, beta, c, 2 )
02297       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02298       infot = 7
02299       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 1, beta, c, 1 )
02300       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02301       infot = 10
02302       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, beta, c, 1 )
02303       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02304       infot = 10
02305       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 2, 0, alpha, a, 1, beta, c, 1 )
02306       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02307       infot = 10
02308       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, beta, c, 1 )
02309       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02310       infot = 10
02311       \textcolor{keyword}{CALL }dsyrk( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 2, 0, alpha, a, 1, beta, c, 1 )
02312       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02313       \textcolor{keywordflow}{GO TO} 70
02314    60 infot = 1
02315       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
02316       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02317       infot = 2
02318       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, b, 1, beta, c, 1 )
02319       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02320       infot = 3
02321       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
02322       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02323       infot = 3
02324       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
02325       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02326       infot = 3
02327       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
02328       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02329       infot = 3
02330       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, -1, 0, alpha, a, 1, b, 1, beta, c, 1 )
02331       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02332       infot = 4
02333       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02334       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02335       infot = 4
02336       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02337       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02338       infot = 4
02339       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02340       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02341       infot = 4
02342       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 0, -1, alpha, a, 1, b, 1, beta, c, 1 )
02343       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02344       infot = 7
02345       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1, beta, c, 2 )
02346       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02347       infot = 7
02348       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
02349       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02350       infot = 7
02351       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, b, 1, beta, c, 2 )
02352       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02353       infot = 7
02354       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 1, b, 1, beta, c, 1 )
02355       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02356       infot = 9
02357       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1, beta, c, 2 )
02358       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02359       infot = 9
02360       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 2, b, 1, beta, c, 1 )
02361       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02362       infot = 9
02363       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 1, beta, c, 2 )
02364       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02365       infot = 9
02366       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 0, 2, alpha, a, 2, b, 1, beta, c, 1 )
02367       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02368       infot = 12
02369       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 2, beta, c, 1 )
02370       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02371       infot = 12
02372       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'T'}, 2, 0, alpha, a, 1, b, 1, beta, c, 1 )
02373       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02374       infot = 12
02375       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 2, b, 2, beta, c, 1 )
02376       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02377       infot = 12
02378       \textcolor{keyword}{CALL }dsyr2k( \textcolor{stringliteral}{'L'}, \textcolor{stringliteral}{'T'}, 2, 0, alpha, a, 1, b, 1, beta, c, 1 )
02379       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02380 \textcolor{comment}{*}
02381    70 \textcolor{keywordflow}{IF}( ok )\textcolor{keywordflow}{THEN}
02382          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )srnamt
02383       \textcolor{keywordflow}{ELSE}
02384          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srnamt
02385 \textcolor{keywordflow}{      END IF}
02386       \textcolor{keywordflow}{RETURN}
02387 \textcolor{comment}{*}
02388  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE TESTS OF ERROR-EXITS'} )
02389  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED THE TESTS OF ERROR-EXITS *****'},
02390      $      \textcolor{stringliteral}{'**'} )
02391 \textcolor{comment}{*}
02392 \textcolor{comment}{*     End of DCHKE.}
02393 \textcolor{comment}{*}
02394 \textcolor{keyword}{      END}
02395 \textcolor{keyword}{      SUBROUTINE }dmake( TYPE, UPLO, DIAG, M, N, A, NMAX, AA, LDA, RESET,
02396      $                  TRANSL )
02397 \textcolor{comment}{*}
02398 \textcolor{comment}{*  Generates values for an M by N matrix A.}
02399 \textcolor{comment}{*  Stores the values in the array AA in the data structure required}
02400 \textcolor{comment}{*  by the routine, with unwanted elements set to rogue value.}
02401 \textcolor{comment}{*}
02402 \textcolor{comment}{*  TYPE is 'GE', 'SY' or 'TR'.}
02403 \textcolor{comment}{*}
02404 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02405 \textcolor{comment}{*}
02406 \textcolor{comment}{*  -- Written on 8-February-1989.}
02407 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02408 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02409 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02410 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02411 \textcolor{comment}{*}
02412 \textcolor{comment}{*     .. Parameters ..}
02413       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
02414       parameter( zero = 0.0d0, one = 1.0d0 )
02415       \textcolor{keywordtype}{DOUBLE PRECISION}   rogue
02416       parameter( rogue = -1.0d10 )
02417 \textcolor{comment}{*     .. Scalar Arguments ..}
02418       \textcolor{keywordtype}{DOUBLE PRECISION}   transl
02419       \textcolor{keywordtype}{INTEGER}            lda, m, n, nmax
02420       \textcolor{keywordtype}{LOGICAL}            reset
02421       \textcolor{keywordtype}{CHARACTER*1}        diag, uplo
02422       \textcolor{keywordtype}{CHARACTER*2}        type
02423 \textcolor{comment}{*     .. Array Arguments ..}
02424       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, * ), aa( * )
02425 \textcolor{comment}{*     .. Local Scalars ..}
02426       \textcolor{keywordtype}{INTEGER}            i, ibeg, iend, j
02427       \textcolor{keywordtype}{LOGICAL}            gen, lower, sym, tri, unit, upper
02428 \textcolor{comment}{*     .. External Functions ..}
02429       \textcolor{keywordtype}{DOUBLE PRECISION}   dbeg
02430       \textcolor{keywordtype}{EXTERNAL}           dbeg
02431 \textcolor{comment}{*     .. Executable Statements ..}
02432       gen = type.EQ.\textcolor{stringliteral}{'GE'}
02433       sym = type.EQ.\textcolor{stringliteral}{'SY'}
02434       tri = type.EQ.\textcolor{stringliteral}{'TR'}
02435       upper = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'U'}
02436       lower = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'L'}
02437       unit = tri.AND.diag.EQ.\textcolor{stringliteral}{'U'}
02438 \textcolor{comment}{*}
02439 \textcolor{comment}{*     Generate data in array A.}
02440 \textcolor{comment}{*}
02441       \textcolor{keywordflow}{DO} 20 j = 1, n
02442          \textcolor{keywordflow}{DO} 10 i = 1, m
02443             \textcolor{keywordflow}{IF}( gen.OR.( upper.AND.i.LE.j ).OR.( lower.AND.i.GE.j ) )
02444      $          \textcolor{keywordflow}{THEN}
02445                a( i, j ) = dbeg( reset ) + transl
02446                \textcolor{keywordflow}{IF}( i.NE.j )\textcolor{keywordflow}{THEN}
02447 \textcolor{comment}{*                 Set some elements to zero}
02448                   \textcolor{keywordflow}{IF}( n.GT.3.AND.j.EQ.n/2 )
02449      $               a( i, j ) = zero
02450                   \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02451                      a( j, i ) = a( i, j )
02452                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( tri )\textcolor{keywordflow}{THEN}
02453                      a( j, i ) = zero
02454 \textcolor{keywordflow}{                  END IF}
02455 \textcolor{keywordflow}{               END IF}
02456 \textcolor{keywordflow}{            END IF}
02457    10    \textcolor{keywordflow}{CONTINUE}
02458          \textcolor{keywordflow}{IF}( tri )
02459      $      a( j, j ) = a( j, j ) + one
02460          \textcolor{keywordflow}{IF}( unit )
02461      $      a( j, j ) = one
02462    20 \textcolor{keywordflow}{CONTINUE}
02463 \textcolor{comment}{*}
02464 \textcolor{comment}{*     Store elements in array AS in data structure required by routine.}
02465 \textcolor{comment}{*}
02466       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02467          \textcolor{keywordflow}{DO} 50 j = 1, n
02468             \textcolor{keywordflow}{DO} 30 i = 1, m
02469                aa( i + ( j - 1 )*lda ) = a( i, j )
02470    30       \textcolor{keywordflow}{CONTINUE}
02471             \textcolor{keywordflow}{DO} 40 i = m + 1, lda
02472                aa( i + ( j - 1 )*lda ) = rogue
02473    40       \textcolor{keywordflow}{CONTINUE}
02474    50    \textcolor{keywordflow}{CONTINUE}
02475       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SY'}.OR.type.EQ.\textcolor{stringliteral}{'TR'} )\textcolor{keywordflow}{THEN}
02476          \textcolor{keywordflow}{DO} 90 j = 1, n
02477             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02478                ibeg = 1
02479                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02480                   iend = j - 1
02481                \textcolor{keywordflow}{ELSE}
02482                   iend = j
02483 \textcolor{keywordflow}{               END IF}
02484             \textcolor{keywordflow}{ELSE}
02485                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02486                   ibeg = j + 1
02487                \textcolor{keywordflow}{ELSE}
02488                   ibeg = j
02489 \textcolor{keywordflow}{               END IF}
02490                iend = n
02491 \textcolor{keywordflow}{            END IF}
02492             \textcolor{keywordflow}{DO} 60 i = 1, ibeg - 1
02493                aa( i + ( j - 1 )*lda ) = rogue
02494    60       \textcolor{keywordflow}{CONTINUE}
02495             \textcolor{keywordflow}{DO} 70 i = ibeg, iend
02496                aa( i + ( j - 1 )*lda ) = a( i, j )
02497    70       \textcolor{keywordflow}{CONTINUE}
02498             \textcolor{keywordflow}{DO} 80 i = iend + 1, lda
02499                aa( i + ( j - 1 )*lda ) = rogue
02500    80       \textcolor{keywordflow}{CONTINUE}
02501    90    \textcolor{keywordflow}{CONTINUE}
02502 \textcolor{keywordflow}{      END IF}
02503       \textcolor{keywordflow}{RETURN}
02504 \textcolor{comment}{*}
02505 \textcolor{comment}{*     End of DMAKE.}
02506 \textcolor{comment}{*}
02507 \textcolor{keyword}{      END}
02508 \textcolor{keyword}{      SUBROUTINE }dmmch( TRANSA, TRANSB, M, N, KK, ALPHA, A, LDA, B, LDB,
02509      $                  BETA, C, LDC, CT, G, CC, LDCC, EPS, ERR, FATAL,
02510      $                  NOUT, MV )
02511 \textcolor{comment}{*}
02512 \textcolor{comment}{*  Checks the results of the computational tests.}
02513 \textcolor{comment}{*}
02514 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02515 \textcolor{comment}{*}
02516 \textcolor{comment}{*  -- Written on 8-February-1989.}
02517 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02518 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02519 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02520 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02521 \textcolor{comment}{*}
02522 \textcolor{comment}{*     .. Parameters ..}
02523       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
02524       parameter( zero = 0.0d0, one = 1.0d0 )
02525 \textcolor{comment}{*     .. Scalar Arguments ..}
02526       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, beta, eps, err
02527       \textcolor{keywordtype}{INTEGER}            kk, lda, ldb, ldc, ldcc, m, n, nout
02528       \textcolor{keywordtype}{LOGICAL}            fatal, mv
02529       \textcolor{keywordtype}{CHARACTER*1}        transa, transb
02530 \textcolor{comment}{*     .. Array Arguments ..}
02531       \textcolor{keywordtype}{DOUBLE PRECISION}   a( lda, * ), b( ldb, * ), c( ldc, * ),
02532      $                   cc( ldcc, * ), ct( * ), g( * )
02533 \textcolor{comment}{*     .. Local Scalars ..}
02534       \textcolor{keywordtype}{DOUBLE PRECISION}   erri
02535       \textcolor{keywordtype}{INTEGER}            i, j, k
02536       \textcolor{keywordtype}{LOGICAL}            trana, tranb
02537 \textcolor{comment}{*     .. Intrinsic Functions ..}
02538       \textcolor{keywordtype}{INTRINSIC}          abs, max, sqrt
02539 \textcolor{comment}{*     .. Executable Statements ..}
02540       trana = transa.EQ.\textcolor{stringliteral}{'T'}.OR.transa.EQ.\textcolor{stringliteral}{'C'}
02541       tranb = transb.EQ.\textcolor{stringliteral}{'T'}.OR.transb.EQ.\textcolor{stringliteral}{'C'}
02542 \textcolor{comment}{*}
02543 \textcolor{comment}{*     Compute expected result, one column at a time, in CT using data}
02544 \textcolor{comment}{*     in A, B and C.}
02545 \textcolor{comment}{*     Compute gauges in G.}
02546 \textcolor{comment}{*}
02547       \textcolor{keywordflow}{DO} 120 j = 1, n
02548 \textcolor{comment}{*}
02549          \textcolor{keywordflow}{DO} 10 i = 1, m
02550             ct( i ) = zero
02551             g( i ) = zero
02552    10    \textcolor{keywordflow}{CONTINUE}
02553          \textcolor{keywordflow}{IF}( .NOT.trana.AND..NOT.tranb )\textcolor{keywordflow}{THEN}
02554             \textcolor{keywordflow}{DO} 30 k = 1, kk
02555                \textcolor{keywordflow}{DO} 20 i = 1, m
02556                   ct( i ) = ct( i ) + a( i, k )*b( k, j )
02557                   g( i ) = g( i ) + abs( a( i, k ) )*abs( b( k, j ) )
02558    20          \textcolor{keywordflow}{CONTINUE}
02559    30       \textcolor{keywordflow}{CONTINUE}
02560          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( trana.AND..NOT.tranb )\textcolor{keywordflow}{THEN}
02561             \textcolor{keywordflow}{DO} 50 k = 1, kk
02562                \textcolor{keywordflow}{DO} 40 i = 1, m
02563                   ct( i ) = ct( i ) + a( k, i )*b( k, j )
02564                   g( i ) = g( i ) + abs( a( k, i ) )*abs( b( k, j ) )
02565    40          \textcolor{keywordflow}{CONTINUE}
02566    50       \textcolor{keywordflow}{CONTINUE}
02567          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( .NOT.trana.AND.tranb )\textcolor{keywordflow}{THEN}
02568             \textcolor{keywordflow}{DO} 70 k = 1, kk
02569                \textcolor{keywordflow}{DO} 60 i = 1, m
02570                   ct( i ) = ct( i ) + a( i, k )*b( j, k )
02571                   g( i ) = g( i ) + abs( a( i, k ) )*abs( b( j, k ) )
02572    60          \textcolor{keywordflow}{CONTINUE}
02573    70       \textcolor{keywordflow}{CONTINUE}
02574          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( trana.AND.tranb )\textcolor{keywordflow}{THEN}
02575             \textcolor{keywordflow}{DO} 90 k = 1, kk
02576                \textcolor{keywordflow}{DO} 80 i = 1, m
02577                   ct( i ) = ct( i ) + a( k, i )*b( j, k )
02578                   g( i ) = g( i ) + abs( a( k, i ) )*abs( b( j, k ) )
02579    80          \textcolor{keywordflow}{CONTINUE}
02580    90       \textcolor{keywordflow}{CONTINUE}
02581 \textcolor{keywordflow}{         END IF}
02582          \textcolor{keywordflow}{DO} 100 i = 1, m
02583             ct( i ) = alpha*ct( i ) + beta*c( i, j )
02584             g( i ) = abs( alpha )*g( i ) + abs( beta )*abs( c( i, j ) )
02585   100    \textcolor{keywordflow}{CONTINUE}
02586 \textcolor{comment}{*}
02587 \textcolor{comment}{*        Compute the error ratio for this result.}
02588 \textcolor{comment}{*}
02589          err = zero
02590          \textcolor{keywordflow}{DO} 110 i = 1, m
02591             erri = abs( ct( i ) - cc( i, j ) )/eps
02592             \textcolor{keywordflow}{IF}( g( i ).NE.zero )
02593      $         erri = erri/g( i )
02594             err = max( err, erri )
02595             \textcolor{keywordflow}{IF}( err*sqrt( eps ).GE.one )
02596      $         \textcolor{keywordflow}{GO TO} 130
02597   110    \textcolor{keywordflow}{CONTINUE}
02598 \textcolor{comment}{*}
02599   120 \textcolor{keywordflow}{CONTINUE}
02600 \textcolor{comment}{*}
02601 \textcolor{comment}{*     If the loop completes, all results are at least half accurate.}
02602       \textcolor{keywordflow}{GO TO} 150
02603 \textcolor{comment}{*}
02604 \textcolor{comment}{*     Report fatal error.}
02605 \textcolor{comment}{*}
02606   130 fatal = .true.
02607       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )
02608       \textcolor{keywordflow}{DO} 140 i = 1, m
02609          \textcolor{keywordflow}{IF}( mv )\textcolor{keywordflow}{THEN}
02610             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i, ct( i ), cc( i, j )
02611          \textcolor{keywordflow}{ELSE}
02612             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i, cc( i, j ), ct( i )
02613 \textcolor{keywordflow}{         END IF}
02614   140 \textcolor{keywordflow}{CONTINUE}
02615       \textcolor{keywordflow}{IF}( n.GT.1 )
02616      $   \textcolor{keyword}{WRITE}( nout, fmt = 9997 )j
02617 \textcolor{comment}{*}
02618   150 \textcolor{keywordflow}{CONTINUE}
02619       \textcolor{keywordflow}{RETURN}
02620 \textcolor{comment}{*}
02621  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - COMPUTED RESULT IS LESS THAN HAL'},
02622      $      \textcolor{stringliteral}{'F ACCURATE *******'}, /\textcolor{stringliteral}{'           EXPECTED RESULT   COMPU'},
02623      $      \textcolor{stringliteral}{'TED RESULT'} )
02624  9998 \textcolor{keyword}{FORMAT}( 1x, i7, 2g18.6 )
02625  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02626 \textcolor{comment}{*}
02627 \textcolor{comment}{*     End of DMMCH.}
02628 \textcolor{comment}{*}
02629 \textcolor{keyword}{      END}
02630 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lde( RI, RJ, LR )
02631 \textcolor{comment}{*}
02632 \textcolor{comment}{*  Tests if two arrays are identical.}
02633 \textcolor{comment}{*}
02634 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02635 \textcolor{comment}{*}
02636 \textcolor{comment}{*  -- Written on 8-February-1989.}
02637 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02638 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02639 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02640 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02641 \textcolor{comment}{*}
02642 \textcolor{comment}{*     .. Scalar Arguments ..}
02643       \textcolor{keywordtype}{INTEGER}            lr
02644 \textcolor{comment}{*     .. Array Arguments ..}
02645       \textcolor{keywordtype}{DOUBLE PRECISION}   ri( * ), rj( * )
02646 \textcolor{comment}{*     .. Local Scalars ..}
02647       \textcolor{keywordtype}{INTEGER}            i
02648 \textcolor{comment}{*     .. Executable Statements ..}
02649       \textcolor{keywordflow}{DO} 10 i = 1, lr
02650          \textcolor{keywordflow}{IF}( ri( i ).NE.rj( i ) )
02651      $      \textcolor{keywordflow}{GO TO} 20
02652    10 \textcolor{keywordflow}{CONTINUE}
02653       lde = .true.
02654       \textcolor{keywordflow}{GO TO} 30
02655    20 \textcolor{keywordflow}{CONTINUE}
02656       lde = .false.
02657    30 \textcolor{keywordflow}{RETURN}
02658 \textcolor{comment}{*}
02659 \textcolor{comment}{*     End of LDE.}
02660 \textcolor{comment}{*}
02661 \textcolor{keyword}{      END}
02662 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lderes( TYPE, UPLO, M, N, AA, AS, LDA )
02663 \textcolor{comment}{*}
02664 \textcolor{comment}{*  Tests if selected elements in two arrays are equal.}
02665 \textcolor{comment}{*}
02666 \textcolor{comment}{*  TYPE is 'GE' or 'SY'.}
02667 \textcolor{comment}{*}
02668 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02669 \textcolor{comment}{*}
02670 \textcolor{comment}{*  -- Written on 8-February-1989.}
02671 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02672 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02673 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02674 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02675 \textcolor{comment}{*}
02676 \textcolor{comment}{*     .. Scalar Arguments ..}
02677       \textcolor{keywordtype}{INTEGER}            lda, m, n
02678       \textcolor{keywordtype}{CHARACTER*1}        uplo
02679       \textcolor{keywordtype}{CHARACTER*2}        type
02680 \textcolor{comment}{*     .. Array Arguments ..}
02681       \textcolor{keywordtype}{DOUBLE PRECISION}   aa( lda, * ), as( lda, * )
02682 \textcolor{comment}{*     .. Local Scalars ..}
02683       \textcolor{keywordtype}{INTEGER}            i, ibeg, iend, j
02684       \textcolor{keywordtype}{LOGICAL}            upper
02685 \textcolor{comment}{*     .. Executable Statements ..}
02686       upper = uplo.EQ.\textcolor{stringliteral}{'U'}
02687       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02688          \textcolor{keywordflow}{DO} 20 j = 1, n
02689             \textcolor{keywordflow}{DO} 10 i = m + 1, lda
02690                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
02691      $            \textcolor{keywordflow}{GO TO} 70
02692    10       \textcolor{keywordflow}{CONTINUE}
02693    20    \textcolor{keywordflow}{CONTINUE}
02694       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SY'} )\textcolor{keywordflow}{THEN}
02695          \textcolor{keywordflow}{DO} 50 j = 1, n
02696             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02697                ibeg = 1
02698                iend = j
02699             \textcolor{keywordflow}{ELSE}
02700                ibeg = j
02701                iend = n
02702 \textcolor{keywordflow}{            END IF}
02703             \textcolor{keywordflow}{DO} 30 i = 1, ibeg - 1
02704                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
02705      $            \textcolor{keywordflow}{GO TO} 70
02706    30       \textcolor{keywordflow}{CONTINUE}
02707             \textcolor{keywordflow}{DO} 40 i = iend + 1, lda
02708                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
02709      $            \textcolor{keywordflow}{GO TO} 70
02710    40       \textcolor{keywordflow}{CONTINUE}
02711    50    \textcolor{keywordflow}{CONTINUE}
02712 \textcolor{keywordflow}{      END IF}
02713 \textcolor{comment}{*}
02714       lderes = .true.
02715       \textcolor{keywordflow}{GO TO} 80
02716    70 \textcolor{keywordflow}{CONTINUE}
02717       lderes = .false.
02718    80 \textcolor{keywordflow}{RETURN}
02719 \textcolor{comment}{*}
02720 \textcolor{comment}{*     End of LDERES.}
02721 \textcolor{comment}{*}
02722 \textcolor{keyword}{      END}
02723 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }dbeg( RESET )
02724 \textcolor{comment}{*}
02725 \textcolor{comment}{*  Generates random numbers uniformly distributed between -0.5 and 0.5.}
02726 \textcolor{comment}{*}
02727 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02728 \textcolor{comment}{*}
02729 \textcolor{comment}{*  -- Written on 8-February-1989.}
02730 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02731 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02732 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02733 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02734 \textcolor{comment}{*}
02735 \textcolor{comment}{*     .. Scalar Arguments ..}
02736       \textcolor{keywordtype}{LOGICAL}            reset
02737 \textcolor{comment}{*     .. Local Scalars ..}
02738       \textcolor{keywordtype}{INTEGER}            i, ic, mi
02739 \textcolor{comment}{*     .. Save statement ..}
02740       \textcolor{keywordtype}{SAVE}               i, ic, mi
02741 \textcolor{comment}{*     .. Executable Statements ..}
02742       \textcolor{keywordflow}{IF}( reset )\textcolor{keywordflow}{THEN}
02743 \textcolor{comment}{*        Initialize local variables.}
02744          mi = 891
02745          i = 7
02746          ic = 0
02747          reset = .false.
02748 \textcolor{keywordflow}{      END IF}
02749 \textcolor{comment}{*}
02750 \textcolor{comment}{*     The sequence of values of I is bounded between 1 and 999.}
02751 \textcolor{comment}{*     If initial I = 1,2,3,6,7 or 9, the period will be 50.}
02752 \textcolor{comment}{*     If initial I = 4 or 8, the period will be 25.}
02753 \textcolor{comment}{*     If initial I = 5, the period will be 10.}
02754 \textcolor{comment}{*     IC is used to break up the period by skipping 1 value of I in 6.}
02755 \textcolor{comment}{*}
02756       ic = ic + 1
02757    10 i = i*mi
02758       i = i - 1000*( i/1000 )
02759       \textcolor{keywordflow}{IF}( ic.GE.5 )\textcolor{keywordflow}{THEN}
02760          ic = 0
02761          \textcolor{keywordflow}{GO TO} 10
02762 \textcolor{keywordflow}{      END IF}
02763       dbeg = ( i - 500 )/1001.0d0
02764       \textcolor{keywordflow}{RETURN}
02765 \textcolor{comment}{*}
02766 \textcolor{comment}{*     End of DBEG.}
02767 \textcolor{comment}{*}
02768 \textcolor{keyword}{      END}
02769 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }ddiff( X, Y )
02770 \textcolor{comment}{*}
02771 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02772 \textcolor{comment}{*}
02773 \textcolor{comment}{*  -- Written on 8-February-1989.}
02774 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02775 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02776 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02777 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02778 \textcolor{comment}{*}
02779 \textcolor{comment}{*     .. Scalar Arguments ..}
02780       \textcolor{keywordtype}{DOUBLE PRECISION}   x, y
02781 \textcolor{comment}{*     .. Executable Statements ..}
02782       ddiff = x - y
02783       \textcolor{keywordflow}{RETURN}
02784 \textcolor{comment}{*}
02785 \textcolor{comment}{*     End of DDIFF.}
02786 \textcolor{comment}{*}
02787 \textcolor{keyword}{      END}
02788 \textcolor{keyword}{      SUBROUTINE }chkxer( SRNAMT, INFOT, NOUT, LERR, OK )
02789 \textcolor{comment}{*}
02790 \textcolor{comment}{*  Tests whether XERBLA has detected an error when it should.}
02791 \textcolor{comment}{*}
02792 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02793 \textcolor{comment}{*}
02794 \textcolor{comment}{*  -- Written on 8-February-1989.}
02795 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02796 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02797 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02798 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02799 \textcolor{comment}{*}
02800 \textcolor{comment}{*     .. Scalar Arguments ..}
02801       \textcolor{keywordtype}{INTEGER}            infot, nout
02802       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02803       \textcolor{keywordtype}{CHARACTER*6}        srnamt
02804 \textcolor{comment}{*     .. Executable Statements ..}
02805       \textcolor{keywordflow}{IF}( .NOT.lerr )\textcolor{keywordflow}{THEN}
02806          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )infot, srnamt
02807          ok = .false.
02808 \textcolor{keywordflow}{      END IF}
02809       lerr = .false.
02810       \textcolor{keywordflow}{RETURN}
02811 \textcolor{comment}{*}
02812  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ***** ILLEGAL VALUE OF PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' NOT D'},
02813      $      \textcolor{stringliteral}{'ETECTED BY '}, a6, \textcolor{stringliteral}{' *****'} )
02814 \textcolor{comment}{*}
02815 \textcolor{comment}{*     End of CHKXER.}
02816 \textcolor{comment}{*}
02817 \textcolor{keyword}{      END}
02818 \textcolor{keyword}{      SUBROUTINE }xerbla( SRNAME, INFO )
02819 \textcolor{comment}{*}
02820 \textcolor{comment}{*  This is a special version of XERBLA to be used only as part of}
02821 \textcolor{comment}{*  the test program for testing error exits from the Level 3 BLAS}
02822 \textcolor{comment}{*  routines.}
02823 \textcolor{comment}{*}
02824 \textcolor{comment}{*  XERBLA  is an error handler for the Level 3 BLAS routines.}
02825 \textcolor{comment}{*}
02826 \textcolor{comment}{*  It is called by the Level 3 BLAS routines if an input parameter is}
02827 \textcolor{comment}{*  invalid.}
02828 \textcolor{comment}{*}
02829 \textcolor{comment}{*  Auxiliary routine for test program for Level 3 Blas.}
02830 \textcolor{comment}{*}
02831 \textcolor{comment}{*  -- Written on 8-February-1989.}
02832 \textcolor{comment}{*     Jack Dongarra, Argonne National Laboratory.}
02833 \textcolor{comment}{*     Iain Duff, AERE Harwell.}
02834 \textcolor{comment}{*     Jeremy Du Croz, Numerical Algorithms Group Ltd.}
02835 \textcolor{comment}{*     Sven Hammarling, Numerical Algorithms Group Ltd.}
02836 \textcolor{comment}{*}
02837 \textcolor{comment}{*     .. Scalar Arguments ..}
02838       \textcolor{keywordtype}{INTEGER}            info
02839       \textcolor{keywordtype}{CHARACTER*6}        srname
02840 \textcolor{comment}{*     .. Scalars in Common ..}
02841       \textcolor{keywordtype}{INTEGER}            infot, nout
02842       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02843       \textcolor{keywordtype}{CHARACTER*6}        srnamt
02844 \textcolor{comment}{*     .. Common blocks ..}
02845       \textcolor{keyword}{COMMON}             /infoc/infot, nout, ok, lerr
02846       \textcolor{keyword}{COMMON}             /srnamc/srnamt
02847 \textcolor{comment}{*     .. Executable Statements ..}
02848       lerr = .true.
02849       \textcolor{keywordflow}{IF}( info.NE.infot )\textcolor{keywordflow}{THEN}
02850          \textcolor{keywordflow}{IF}( infot.NE.0 )\textcolor{keywordflow}{THEN}
02851             \textcolor{keyword}{WRITE}( nout, fmt = 9999 )info, infot
02852          \textcolor{keywordflow}{ELSE}
02853             \textcolor{keyword}{WRITE}( nout, fmt = 9997 )info
02854 \textcolor{keywordflow}{         END IF}
02855          ok = .false.
02856 \textcolor{keywordflow}{      END IF}
02857       \textcolor{keywordflow}{IF}( srname.NE.srnamt )\textcolor{keywordflow}{THEN}
02858          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srname, srnamt
02859          ok = .false.
02860 \textcolor{keywordflow}{      END IF}
02861       \textcolor{keywordflow}{RETURN}
02862 \textcolor{comment}{*}
02863  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6, \textcolor{stringliteral}{' INSTEAD'},
02864      $      \textcolor{stringliteral}{' OF '}, i2, \textcolor{stringliteral}{' *******'} )
02865  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH SRNAME = '}, a6, \textcolor{stringliteral}{' INSTE'},
02866      $      \textcolor{stringliteral}{'AD OF '}, a6, \textcolor{stringliteral}{' *******'} )
02867  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6,
02868      $      \textcolor{stringliteral}{' *******'} )
02869 \textcolor{comment}{*}
02870 \textcolor{comment}{*     End of XERBLA}
02871 \textcolor{comment}{*}
02872 \textcolor{keyword}{      END}
02873 
\end{DoxyCode}
