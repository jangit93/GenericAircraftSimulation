\hypertarget{eigen_2test_2schur__complex_8cpp_source}{}\section{eigen/test/schur\+\_\+complex.cpp}
\label{eigen_2test_2schur__complex_8cpp_source}\index{schur\+\_\+complex.\+cpp@{schur\+\_\+complex.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2010,2012 Jitse Niesen <jitse@maths.leeds.ac.uk>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 \textcolor{preprocessor}{#include <limits>}
00012 \textcolor{preprocessor}{#include <Eigen/Eigenvalues>}
00013 
00014 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keywordtype}{void} schur(\textcolor{keywordtype}{int} size = MatrixType::ColsAtCompileTime)
00015 \{
00016   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___eigenvalues___module_class_eigen_1_1_complex_schur}{ComplexSchur<MatrixType>::ComplexScalar} 
      ComplexScalar;
00017   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___eigenvalues___module_class_eigen_1_1_complex_schur}{ComplexSchur<MatrixType>::ComplexMatrixType} 
      ComplexMatrixType;
00018 
00019   \textcolor{comment}{// Test basic functionality: T is triangular and A = U T U*}
00020   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} counter = 0; counter < g\_repeat; ++counter) \{
00021     MatrixType \hyperlink{group___core___module_class_eigen_1_1_matrix}{A} = MatrixType::Random(size, size);
00022     \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} schurOfA(A);
00023     VERIFY\_IS\_EQUAL(schurOfA.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00024     ComplexMatrixType U = schurOfA.matrixU();
00025     ComplexMatrixType \hyperlink{group___sparse_core___module}{T} = schurOfA.matrixT();
00026     \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} row = 1; row < size; ++row) \{
00027       \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} col = 0; col < row; ++col) \{
00028         VERIFY(T(row,col) == (\textcolor{keyword}{typename} MatrixType::Scalar)0);
00029       \}
00030     \}
00031     VERIFY\_IS\_APPROX(A.template cast<ComplexScalar>(), U * T * U.adjoint());
00032   \}
00033 
00034   \textcolor{comment}{// Test asserts when not initialized}
00035   \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} csUninitialized;
00036   VERIFY\_RAISES\_ASSERT(csUninitialized.matrixT());
00037   VERIFY\_RAISES\_ASSERT(csUninitialized.matrixU());
00038   VERIFY\_RAISES\_ASSERT(csUninitialized.info());
00039   
00040   \textcolor{comment}{// Test whether compute() and constructor returns same result}
00041   MatrixType A = MatrixType::Random(size, size);
00042   \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} cs1;
00043   cs1.\hyperlink{group___eigenvalues___module_a3543d2c286563108cd9ace672bbb1c09}{compute}(A);
00044   \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} cs2(A);
00045   VERIFY\_IS\_EQUAL(cs1.\hyperlink{group___eigenvalues___module_a8c5ee15fecfd126fc362c3f2fd28f51e}{info}(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00046   VERIFY\_IS\_EQUAL(cs2.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00047   VERIFY\_IS\_EQUAL(cs1.\hyperlink{group___eigenvalues___module_add3ab5ed83f7f2f06b79fa910a2d5684}{matrixT}(), cs2.matrixT());
00048   VERIFY\_IS\_EQUAL(cs1.\hyperlink{group___eigenvalues___module_afed8177cf9836f032d42bdb6c6bc6e01}{matrixU}(), cs2.matrixU());
00049 
00050   \textcolor{comment}{// Test maximum number of iterations}
00051   \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} cs3;
00052   cs3.\hyperlink{group___eigenvalues___module_a6ca227fbd5387f3a625351354b8eec44}{setMaxIterations}(
      \hyperlink{group___eigenvalues___module_class_eigen_1_1_complex_schur}{ComplexSchur<MatrixType>::m\_maxIterationsPerRow} * size).
      \hyperlink{group___eigenvalues___module_a3543d2c286563108cd9ace672bbb1c09}{compute}(A);
00053   VERIFY\_IS\_EQUAL(cs3.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00054   VERIFY\_IS\_EQUAL(cs3.matrixT(), cs1.\hyperlink{group___eigenvalues___module_add3ab5ed83f7f2f06b79fa910a2d5684}{matrixT}());
00055   VERIFY\_IS\_EQUAL(cs3.matrixU(), cs1.\hyperlink{group___eigenvalues___module_afed8177cf9836f032d42bdb6c6bc6e01}{matrixU}());
00056   cs3.setMaxIterations(1).compute(A);
00057   VERIFY\_IS\_EQUAL(cs3.info(), size > 1 ? \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5eaba1c8763d1179778070f365ecc4157a8}{NoConvergence} : \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00058   VERIFY\_IS\_EQUAL(cs3.getMaxIterations(), 1);
00059 
00060   MatrixType Atriangular = A;
00061   Atriangular.template triangularView<StrictlyLower>().setZero(); 
00062   cs3.setMaxIterations(1).compute(Atriangular); \textcolor{comment}{// triangular matrices do not need any iterations}
00063   VERIFY\_IS\_EQUAL(cs3.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00064   VERIFY\_IS\_EQUAL(cs3.matrixT(), Atriangular.template cast<ComplexScalar>());
00065   VERIFY\_IS\_EQUAL(cs3.matrixU(), ComplexMatrixType::Identity(size, size));
00066 
00067   \textcolor{comment}{// Test computation of only T, not U}
00068   \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} csOnlyT(A, \textcolor{keyword}{false});
00069   VERIFY\_IS\_EQUAL(csOnlyT.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success});
00070   VERIFY\_IS\_EQUAL(cs1.\hyperlink{group___eigenvalues___module_add3ab5ed83f7f2f06b79fa910a2d5684}{matrixT}(), csOnlyT.matrixT());
00071   VERIFY\_RAISES\_ASSERT(csOnlyT.matrixU());
00072 
00073   \textcolor{keywordflow}{if} (size > 1 && size < 20)
00074   \{
00075     \textcolor{comment}{// Test matrix with NaN}
00076     A(0,0) = std::numeric\_limits<typename MatrixType::RealScalar>::quiet\_NaN();
00077     \hyperlink{group___eigenvalues___module}{ComplexSchur<MatrixType>} csNaN(A);
00078     VERIFY\_IS\_EQUAL(csNaN.info(), \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5eaba1c8763d1179778070f365ecc4157a8}{NoConvergence});
00079   \}
00080 \}
00081 
00082 \textcolor{keywordtype}{void} test\_schur\_complex()
00083 \{
00084   CALL\_SUBTEST\_1(( schur<Matrix4cd>() ));
00085   CALL\_SUBTEST\_2(( schur<MatrixXcf>(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE/4)) ));
00086   CALL\_SUBTEST\_3(( schur<\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix}<std::complex<float>, 1, 1> >() ));
00087   CALL\_SUBTEST\_4(( schur<\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 3, 3, Eigen::RowMajor>} >() ));
00088 
00089   \textcolor{comment}{// Test problem size constructors}
00090   CALL\_SUBTEST\_5(\hyperlink{group___eigenvalues___module_class_eigen_1_1_complex_schur}{ComplexSchur<MatrixXf>}(10));
00091 \}
\end{DoxyCode}
