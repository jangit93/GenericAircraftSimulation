\hypertarget{matio_2visual__studio_2test_2eigen_2lapack_2dlarfb_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/lapack/dlarfb.f}
\label{matio_2visual__studio_2test_2eigen_2lapack_2dlarfb_8f_source}\index{dlarfb.\+f@{dlarfb.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b DLARFB}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download DLARFB + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/dlarfb.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/dlarfb.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/dlarfb.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE DLARFB( SIDE, TRANS, DIRECT, STOREV, M, N, K, V, LDV,}
00022 \textcolor{comment}{*                          T, LDT, C, LDC, WORK, LDWORK )}
00023 \textcolor{comment}{* }
00024 \textcolor{comment}{*       .. Scalar Arguments ..}
00025 \textcolor{comment}{*       CHARACTER          DIRECT, SIDE, STOREV, TRANS}
00026 \textcolor{comment}{*       INTEGER            K, LDC, LDT, LDV, LDWORK, M, N}
00027 \textcolor{comment}{*       ..}
00028 \textcolor{comment}{*       .. Array Arguments ..}
00029 \textcolor{comment}{*       DOUBLE PRECISION   C( LDC, * ), T( LDT, * ), V( LDV, * ),}
00030 \textcolor{comment}{*      $                   WORK( LDWORK, * )}
00031 \textcolor{comment}{*       ..}
00032 \textcolor{comment}{*  }
00033 \textcolor{comment}{*}
00034 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00035 \textcolor{comment}{*  =============}
00036 \textcolor{comment}{*>}
00037 \textcolor{comment}{*> \(\backslash\)verbatim}
00038 \textcolor{comment}{*>}
00039 \textcolor{comment}{*> DLARFB applies a real block reflector H or its transpose H**T to a}
00040 \textcolor{comment}{*> real m by n matrix C, from either the left or the right.}
00041 \textcolor{comment}{*> \(\backslash\)endverbatim}
00042 \textcolor{comment}{*}
00043 \textcolor{comment}{*  Arguments:}
00044 \textcolor{comment}{*  ==========}
00045 \textcolor{comment}{*}
00046 \textcolor{comment}{*> \(\backslash\)param[in] SIDE}
00047 \textcolor{comment}{*> \(\backslash\)verbatim}
00048 \textcolor{comment}{*>          SIDE is CHARACTER*1}
00049 \textcolor{comment}{*>          = 'L': apply H or H**T from the Left}
00050 \textcolor{comment}{*>          = 'R': apply H or H**T from the Right}
00051 \textcolor{comment}{*> \(\backslash\)endverbatim}
00052 \textcolor{comment}{*>}
00053 \textcolor{comment}{*> \(\backslash\)param[in] TRANS}
00054 \textcolor{comment}{*> \(\backslash\)verbatim}
00055 \textcolor{comment}{*>          TRANS is CHARACTER*1}
00056 \textcolor{comment}{*>          = 'N': apply H (No transpose)}
00057 \textcolor{comment}{*>          = 'T': apply H**T (Transpose)}
00058 \textcolor{comment}{*> \(\backslash\)endverbatim}
00059 \textcolor{comment}{*>}
00060 \textcolor{comment}{*> \(\backslash\)param[in] DIRECT}
00061 \textcolor{comment}{*> \(\backslash\)verbatim}
00062 \textcolor{comment}{*>          DIRECT is CHARACTER*1}
00063 \textcolor{comment}{*>          Indicates how H is formed from a product of elementary}
00064 \textcolor{comment}{*>          reflectors}
00065 \textcolor{comment}{*>          = 'F': H = H(1) H(2) . . . H(k) (Forward)}
00066 \textcolor{comment}{*>          = 'B': H = H(k) . . . H(2) H(1) (Backward)}
00067 \textcolor{comment}{*> \(\backslash\)endverbatim}
00068 \textcolor{comment}{*>}
00069 \textcolor{comment}{*> \(\backslash\)param[in] STOREV}
00070 \textcolor{comment}{*> \(\backslash\)verbatim}
00071 \textcolor{comment}{*>          STOREV is CHARACTER*1}
00072 \textcolor{comment}{*>          Indicates how the vectors which define the elementary}
00073 \textcolor{comment}{*>          reflectors are stored:}
00074 \textcolor{comment}{*>          = 'C': Columnwise}
00075 \textcolor{comment}{*>          = 'R': Rowwise}
00076 \textcolor{comment}{*> \(\backslash\)endverbatim}
00077 \textcolor{comment}{*>}
00078 \textcolor{comment}{*> \(\backslash\)param[in] M}
00079 \textcolor{comment}{*> \(\backslash\)verbatim}
00080 \textcolor{comment}{*>          M is INTEGER}
00081 \textcolor{comment}{*>          The number of rows of the matrix C.}
00082 \textcolor{comment}{*> \(\backslash\)endverbatim}
00083 \textcolor{comment}{*>}
00084 \textcolor{comment}{*> \(\backslash\)param[in] N}
00085 \textcolor{comment}{*> \(\backslash\)verbatim}
00086 \textcolor{comment}{*>          N is INTEGER}
00087 \textcolor{comment}{*>          The number of columns of the matrix C.}
00088 \textcolor{comment}{*> \(\backslash\)endverbatim}
00089 \textcolor{comment}{*>}
00090 \textcolor{comment}{*> \(\backslash\)param[in] K}
00091 \textcolor{comment}{*> \(\backslash\)verbatim}
00092 \textcolor{comment}{*>          K is INTEGER}
00093 \textcolor{comment}{*>          The order of the matrix T (= the number of elementary}
00094 \textcolor{comment}{*>          reflectors whose product defines the block reflector).}
00095 \textcolor{comment}{*> \(\backslash\)endverbatim}
00096 \textcolor{comment}{*>}
00097 \textcolor{comment}{*> \(\backslash\)param[in] V}
00098 \textcolor{comment}{*> \(\backslash\)verbatim}
00099 \textcolor{comment}{*>          V is DOUBLE PRECISION array, dimension}
00100 \textcolor{comment}{*>                                (LDV,K) if STOREV = 'C'}
00101 \textcolor{comment}{*>                                (LDV,M) if STOREV = 'R' and SIDE = 'L'}
00102 \textcolor{comment}{*>                                (LDV,N) if STOREV = 'R' and SIDE = 'R'}
00103 \textcolor{comment}{*>          The matrix V. See Further Details.}
00104 \textcolor{comment}{*> \(\backslash\)endverbatim}
00105 \textcolor{comment}{*>}
00106 \textcolor{comment}{*> \(\backslash\)param[in] LDV}
00107 \textcolor{comment}{*> \(\backslash\)verbatim}
00108 \textcolor{comment}{*>          LDV is INTEGER}
00109 \textcolor{comment}{*>          The leading dimension of the array V.}
00110 \textcolor{comment}{*>          If STOREV = 'C' and SIDE = 'L', LDV >= max(1,M);}
00111 \textcolor{comment}{*>          if STOREV = 'C' and SIDE = 'R', LDV >= max(1,N);}
00112 \textcolor{comment}{*>          if STOREV = 'R', LDV >= K.}
00113 \textcolor{comment}{*> \(\backslash\)endverbatim}
00114 \textcolor{comment}{*>}
00115 \textcolor{comment}{*> \(\backslash\)param[in] T}
00116 \textcolor{comment}{*> \(\backslash\)verbatim}
00117 \textcolor{comment}{*>          T is DOUBLE PRECISION array, dimension (LDT,K)}
00118 \textcolor{comment}{*>          The triangular k by k matrix T in the representation of the}
00119 \textcolor{comment}{*>          block reflector.}
00120 \textcolor{comment}{*> \(\backslash\)endverbatim}
00121 \textcolor{comment}{*>}
00122 \textcolor{comment}{*> \(\backslash\)param[in] LDT}
00123 \textcolor{comment}{*> \(\backslash\)verbatim}
00124 \textcolor{comment}{*>          LDT is INTEGER}
00125 \textcolor{comment}{*>          The leading dimension of the array T. LDT >= K.}
00126 \textcolor{comment}{*> \(\backslash\)endverbatim}
00127 \textcolor{comment}{*>}
00128 \textcolor{comment}{*> \(\backslash\)param[in,out] C}
00129 \textcolor{comment}{*> \(\backslash\)verbatim}
00130 \textcolor{comment}{*>          C is DOUBLE PRECISION array, dimension (LDC,N)}
00131 \textcolor{comment}{*>          On entry, the m by n matrix C.}
00132 \textcolor{comment}{*>          On exit, C is overwritten by H*C or H**T*C or C*H or C*H**T.}
00133 \textcolor{comment}{*> \(\backslash\)endverbatim}
00134 \textcolor{comment}{*>}
00135 \textcolor{comment}{*> \(\backslash\)param[in] LDC}
00136 \textcolor{comment}{*> \(\backslash\)verbatim}
00137 \textcolor{comment}{*>          LDC is INTEGER}
00138 \textcolor{comment}{*>          The leading dimension of the array C. LDC >= max(1,M).}
00139 \textcolor{comment}{*> \(\backslash\)endverbatim}
00140 \textcolor{comment}{*>}
00141 \textcolor{comment}{*> \(\backslash\)param[out] WORK}
00142 \textcolor{comment}{*> \(\backslash\)verbatim}
00143 \textcolor{comment}{*>          WORK is DOUBLE PRECISION array, dimension (LDWORK,K)}
00144 \textcolor{comment}{*> \(\backslash\)endverbatim}
00145 \textcolor{comment}{*>}
00146 \textcolor{comment}{*> \(\backslash\)param[in] LDWORK}
00147 \textcolor{comment}{*> \(\backslash\)verbatim}
00148 \textcolor{comment}{*>          LDWORK is INTEGER}
00149 \textcolor{comment}{*>          The leading dimension of the array WORK.}
00150 \textcolor{comment}{*>          If SIDE = 'L', LDWORK >= max(1,N);}
00151 \textcolor{comment}{*>          if SIDE = 'R', LDWORK >= max(1,M).}
00152 \textcolor{comment}{*> \(\backslash\)endverbatim}
00153 \textcolor{comment}{*}
00154 \textcolor{comment}{*  Authors:}
00155 \textcolor{comment}{*  ========}
00156 \textcolor{comment}{*}
00157 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00158 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00159 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00160 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00161 \textcolor{comment}{*}
00162 \textcolor{comment}{*> \(\backslash\)date November 2011}
00163 \textcolor{comment}{*}
00164 \textcolor{comment}{*> \(\backslash\)ingroup doubleOTHERauxiliary}
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*> \(\backslash\)par Further Details:}
00167 \textcolor{comment}{*  =====================}
00168 \textcolor{comment}{*>}
00169 \textcolor{comment}{*> \(\backslash\)verbatim}
00170 \textcolor{comment}{*>}
00171 \textcolor{comment}{*>  The shape of the matrix V and the storage of the vectors which define}
00172 \textcolor{comment}{*>  the H(i) is best illustrated by the following example with n = 5 and}
00173 \textcolor{comment}{*>  k = 3. The elements equal to 1 are not stored; the corresponding}
00174 \textcolor{comment}{*>  array elements are modified but restored on exit. The rest of the}
00175 \textcolor{comment}{*>  array is not used.}
00176 \textcolor{comment}{*>}
00177 \textcolor{comment}{*>  DIRECT = 'F' and STOREV = 'C':         DIRECT = 'F' and STOREV = 'R':}
00178 \textcolor{comment}{*>}
00179 \textcolor{comment}{*>               V = (  1       )                 V = (  1 v1 v1 v1 v1 )}
00180 \textcolor{comment}{*>                   ( v1  1    )                     (     1 v2 v2 v2 )}
00181 \textcolor{comment}{*>                   ( v1 v2  1 )                     (        1 v3 v3 )}
00182 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00183 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00184 \textcolor{comment}{*>}
00185 \textcolor{comment}{*>  DIRECT = 'B' and STOREV = 'C':         DIRECT = 'B' and STOREV = 'R':}
00186 \textcolor{comment}{*>}
00187 \textcolor{comment}{*>               V = ( v1 v2 v3 )                 V = ( v1 v1  1       )}
00188 \textcolor{comment}{*>                   ( v1 v2 v3 )                     ( v2 v2 v2  1    )}
00189 \textcolor{comment}{*>                   (  1 v2 v3 )                     ( v3 v3 v3 v3  1 )}
00190 \textcolor{comment}{*>                   (     1 v3 )}
00191 \textcolor{comment}{*>                   (        1 )}
00192 \textcolor{comment}{*> \(\backslash\)endverbatim}
00193 \textcolor{comment}{*>}
00194 \textcolor{comment}{*  =====================================================================}
00195 \textcolor{keyword}{      SUBROUTINE }dlarfb( SIDE, TRANS, DIRECT, STOREV, M, N, K, V, LDV,
00196      $                   T, LDT, C, LDC, WORK, LDWORK )
00197 \textcolor{comment}{*}
00198 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.0) --}
00199 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00200 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00201 \textcolor{comment}{*     November 2011}
00202 \textcolor{comment}{*}
00203 \textcolor{comment}{*     .. Scalar Arguments ..}
00204       \textcolor{keywordtype}{CHARACTER}          direct, side, storev, trans
00205       \textcolor{keywordtype}{INTEGER}            k, ldc, ldt, ldv, ldwork, m, n
00206 \textcolor{comment}{*     ..}
00207 \textcolor{comment}{*     .. Array Arguments ..}
00208       \textcolor{keywordtype}{DOUBLE PRECISION}   c( ldc, * ), t( ldt, * ), v( ldv, * ),
00209      $                   work( ldwork, * )
00210 \textcolor{comment}{*     ..}
00211 \textcolor{comment}{*}
00212 \textcolor{comment}{*  =====================================================================}
00213 \textcolor{comment}{*}
00214 \textcolor{comment}{*     .. Parameters ..}
00215       \textcolor{keywordtype}{DOUBLE PRECISION}   one
00216       parameter( one = 1.0d+0 )
00217 \textcolor{comment}{*     ..}
00218 \textcolor{comment}{*     .. Local Scalars ..}
00219       \textcolor{keywordtype}{CHARACTER}          transt
00220       \textcolor{keywordtype}{INTEGER}            i, j, lastv, lastc
00221 \textcolor{comment}{*     ..}
00222 \textcolor{comment}{*     .. External Functions ..}
00223       \textcolor{keywordtype}{LOGICAL}            lsame
00224       \textcolor{keywordtype}{INTEGER}            iladlr, iladlc
00225       \textcolor{keywordtype}{EXTERNAL}           lsame, iladlr, iladlc
00226 \textcolor{comment}{*     ..}
00227 \textcolor{comment}{*     .. External Subroutines ..}
00228       \textcolor{keywordtype}{EXTERNAL}           dcopy, dgemm, dtrmm
00229 \textcolor{comment}{*     ..}
00230 \textcolor{comment}{*     .. Executable Statements ..}
00231 \textcolor{comment}{*}
00232 \textcolor{comment}{*     Quick return if possible}
00233 \textcolor{comment}{*}
00234       \textcolor{keywordflow}{IF}( m.LE.0 .OR. n.LE.0 )
00235      $   \textcolor{keywordflow}{RETURN}
00236 \textcolor{comment}{*}
00237       \textcolor{keywordflow}{IF}( lsame( trans, \textcolor{stringliteral}{'N'} ) ) \textcolor{keywordflow}{THEN}
00238          transt = \textcolor{stringliteral}{'T'}
00239       \textcolor{keywordflow}{ELSE}
00240          transt = \textcolor{stringliteral}{'N'}
00241 \textcolor{keywordflow}{      END IF}
00242 \textcolor{comment}{*}
00243       \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00244 \textcolor{comment}{*}
00245          \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00246 \textcolor{comment}{*}
00247 \textcolor{comment}{*           Let  V =  ( V1 )    (first K rows)}
00248 \textcolor{comment}{*                     ( V2 )}
00249 \textcolor{comment}{*           where  V1  is unit lower triangular.}
00250 \textcolor{comment}{*}
00251             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00252 \textcolor{comment}{*}
00253 \textcolor{comment}{*              Form  H * C  or  H**T * C  where  C = ( C1 )}
00254 \textcolor{comment}{*                                                    ( C2 )}
00255 \textcolor{comment}{*}
00256                lastv = max( k, iladlr( m, k, v, ldv ) )
00257                lastc = iladlc( lastv, n, c, ldc )
00258 \textcolor{comment}{*}
00259 \textcolor{comment}{*              W := C**T * V  =  (C1**T * V1 + C2**T * V2)  (stored in WORK)}
00260 \textcolor{comment}{*}
00261 \textcolor{comment}{*              W := C1**T}
00262 \textcolor{comment}{*}
00263                \textcolor{keywordflow}{DO} 10 j = 1, k
00264                   \textcolor{keyword}{CALL }dcopy( lastc, c( j, 1 ), ldc, work( 1, j ), 1 )
00265    10          \textcolor{keywordflow}{CONTINUE}
00266 \textcolor{comment}{*}
00267 \textcolor{comment}{*              W := W * V1}
00268 \textcolor{comment}{*}
00269                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00270      $              lastc, k, one, v, ldv, work, ldwork )
00271                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00272 \textcolor{comment}{*}
00273 \textcolor{comment}{*                 W := W + C2**T *V2}
00274 \textcolor{comment}{*}
00275                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'No transpose'},
00276      $                 lastc, k, lastv-k,
00277      $                 one, c( k+1, 1 ), ldc, v( k+1, 1 ), ldv,
00278      $                 one, work, ldwork )
00279 \textcolor{keywordflow}{               END IF}
00280 \textcolor{comment}{*}
00281 \textcolor{comment}{*              W := W * T**T  or  W * T}
00282 \textcolor{comment}{*}
00283                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, transt, \textcolor{stringliteral}{'Non-unit'},
00284      $              lastc, k, one, t, ldt, work, ldwork )
00285 \textcolor{comment}{*}
00286 \textcolor{comment}{*              C := C - V * W**T}
00287 \textcolor{comment}{*}
00288                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00289 \textcolor{comment}{*}
00290 \textcolor{comment}{*                 C2 := C2 - V2 * W**T}
00291 \textcolor{comment}{*}
00292                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00293      $                 lastv-k, lastc, k,
00294      $                 -one, v( k+1, 1 ), ldv, work, ldwork, one,
00295      $                 c( k+1, 1 ), ldc )
00296 \textcolor{keywordflow}{               END IF}
00297 \textcolor{comment}{*}
00298 \textcolor{comment}{*              W := W * V1**T}
00299 \textcolor{comment}{*}
00300                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00301      $              lastc, k, one, v, ldv, work, ldwork )
00302 \textcolor{comment}{*}
00303 \textcolor{comment}{*              C1 := C1 - W**T}
00304 \textcolor{comment}{*}
00305                \textcolor{keywordflow}{DO} 30 j = 1, k
00306                   \textcolor{keywordflow}{DO} 20 i = 1, lastc
00307                      c( j, i ) = c( j, i ) - work( i, j )
00308    20             \textcolor{keywordflow}{CONTINUE}
00309    30          \textcolor{keywordflow}{CONTINUE}
00310 \textcolor{comment}{*}
00311             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00312 \textcolor{comment}{*}
00313 \textcolor{comment}{*              Form  C * H  or  C * H**T  where  C = ( C1  C2 )}
00314 \textcolor{comment}{*}
00315                lastv = max( k, iladlr( n, k, v, ldv ) )
00316                lastc = iladlr( m, lastv, c, ldc )
00317 \textcolor{comment}{*}
00318 \textcolor{comment}{*              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)}
00319 \textcolor{comment}{*}
00320 \textcolor{comment}{*              W := C1}
00321 \textcolor{comment}{*}
00322                \textcolor{keywordflow}{DO} 40 j = 1, k
00323                   \textcolor{keyword}{CALL }dcopy( lastc, c( 1, j ), 1, work( 1, j ), 1 )
00324    40          \textcolor{keywordflow}{CONTINUE}
00325 \textcolor{comment}{*}
00326 \textcolor{comment}{*              W := W * V1}
00327 \textcolor{comment}{*}
00328                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00329      $              lastc, k, one, v, ldv, work, ldwork )
00330                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00331 \textcolor{comment}{*}
00332 \textcolor{comment}{*                 W := W + C2 * V2}
00333 \textcolor{comment}{*}
00334                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00335      $                 lastc, k, lastv-k,
00336      $                 one, c( 1, k+1 ), ldc, v( k+1, 1 ), ldv,
00337      $                 one, work, ldwork )
00338 \textcolor{keywordflow}{               END IF}
00339 \textcolor{comment}{*}
00340 \textcolor{comment}{*              W := W * T  or  W * T**T}
00341 \textcolor{comment}{*}
00342                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, trans, \textcolor{stringliteral}{'Non-unit'},
00343      $              lastc, k, one, t, ldt, work, ldwork )
00344 \textcolor{comment}{*}
00345 \textcolor{comment}{*              C := C - W * V**T}
00346 \textcolor{comment}{*}
00347                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00348 \textcolor{comment}{*}
00349 \textcolor{comment}{*                 C2 := C2 - W * V2**T}
00350 \textcolor{comment}{*}
00351                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00352      $                 lastc, lastv-k, k,
00353      $                 -one, work, ldwork, v( k+1, 1 ), ldv, one,
00354      $                 c( 1, k+1 ), ldc )
00355 \textcolor{keywordflow}{               END IF}
00356 \textcolor{comment}{*}
00357 \textcolor{comment}{*              W := W * V1**T}
00358 \textcolor{comment}{*}
00359                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00360      $              lastc, k, one, v, ldv, work, ldwork )
00361 \textcolor{comment}{*}
00362 \textcolor{comment}{*              C1 := C1 - W}
00363 \textcolor{comment}{*}
00364                \textcolor{keywordflow}{DO} 60 j = 1, k
00365                   \textcolor{keywordflow}{DO} 50 i = 1, lastc
00366                      c( i, j ) = c( i, j ) - work( i, j )
00367    50             \textcolor{keywordflow}{CONTINUE}
00368    60          \textcolor{keywordflow}{CONTINUE}
00369 \textcolor{keywordflow}{            END IF}
00370 \textcolor{comment}{*}
00371          \textcolor{keywordflow}{ELSE}
00372 \textcolor{comment}{*}
00373 \textcolor{comment}{*           Let  V =  ( V1 )}
00374 \textcolor{comment}{*                     ( V2 )    (last K rows)}
00375 \textcolor{comment}{*           where  V2  is unit upper triangular.}
00376 \textcolor{comment}{*}
00377             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00378 \textcolor{comment}{*}
00379 \textcolor{comment}{*              Form  H * C  or  H**T * C  where  C = ( C1 )}
00380 \textcolor{comment}{*                                                    ( C2 )}
00381 \textcolor{comment}{*}
00382                lastv = max( k, iladlr( m, k, v, ldv ) )
00383                lastc = iladlc( lastv, n, c, ldc )
00384 \textcolor{comment}{*}
00385 \textcolor{comment}{*              W := C**T * V  =  (C1**T * V1 + C2**T * V2)  (stored in WORK)}
00386 \textcolor{comment}{*}
00387 \textcolor{comment}{*              W := C2**T}
00388 \textcolor{comment}{*}
00389                \textcolor{keywordflow}{DO} 70 j = 1, k
00390                   \textcolor{keyword}{CALL }dcopy( lastc, c( lastv-k+j, 1 ), ldc,
00391      $                 work( 1, j ), 1 )
00392    70          \textcolor{keywordflow}{CONTINUE}
00393 \textcolor{comment}{*}
00394 \textcolor{comment}{*              W := W * V2}
00395 \textcolor{comment}{*}
00396                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00397      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00398      $              work, ldwork )
00399                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00400 \textcolor{comment}{*}
00401 \textcolor{comment}{*                 W := W + C1**T*V1}
00402 \textcolor{comment}{*}
00403                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'No transpose'},
00404      $                 lastc, k, lastv-k, one, c, ldc, v, ldv,
00405      $                 one, work, ldwork )
00406 \textcolor{keywordflow}{               END IF}
00407 \textcolor{comment}{*}
00408 \textcolor{comment}{*              W := W * T**T  or  W * T}
00409 \textcolor{comment}{*}
00410                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, transt, \textcolor{stringliteral}{'Non-unit'},
00411      $              lastc, k, one, t, ldt, work, ldwork )
00412 \textcolor{comment}{*}
00413 \textcolor{comment}{*              C := C - V * W**T}
00414 \textcolor{comment}{*}
00415                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00416 \textcolor{comment}{*}
00417 \textcolor{comment}{*                 C1 := C1 - V1 * W**T}
00418 \textcolor{comment}{*}
00419                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00420      $                 lastv-k, lastc, k, -one, v, ldv, work, ldwork,
00421      $                 one, c, ldc )
00422 \textcolor{keywordflow}{               END IF}
00423 \textcolor{comment}{*}
00424 \textcolor{comment}{*              W := W * V2**T}
00425 \textcolor{comment}{*}
00426                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00427      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00428      $              work, ldwork )
00429 \textcolor{comment}{*}
00430 \textcolor{comment}{*              C2 := C2 - W**T}
00431 \textcolor{comment}{*}
00432                \textcolor{keywordflow}{DO} 90 j = 1, k
00433                   \textcolor{keywordflow}{DO} 80 i = 1, lastc
00434                      c( lastv-k+j, i ) = c( lastv-k+j, i ) - work(i, j)
00435    80             \textcolor{keywordflow}{CONTINUE}
00436    90          \textcolor{keywordflow}{CONTINUE}
00437 \textcolor{comment}{*}
00438             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00439 \textcolor{comment}{*}
00440 \textcolor{comment}{*              Form  C * H  or  C * H**T  where  C = ( C1  C2 )}
00441 \textcolor{comment}{*}
00442                lastv = max( k, iladlr( n, k, v, ldv ) )
00443                lastc = iladlr( m, lastv, c, ldc )
00444 \textcolor{comment}{*}
00445 \textcolor{comment}{*              W := C * V  =  (C1*V1 + C2*V2)  (stored in WORK)}
00446 \textcolor{comment}{*}
00447 \textcolor{comment}{*              W := C2}
00448 \textcolor{comment}{*}
00449                \textcolor{keywordflow}{DO} 100 j = 1, k
00450                   \textcolor{keyword}{CALL }dcopy( lastc, c( 1, n-k+j ), 1, work( 1, j ), 1 )
00451   100          \textcolor{keywordflow}{CONTINUE}
00452 \textcolor{comment}{*}
00453 \textcolor{comment}{*              W := W * V2}
00454 \textcolor{comment}{*}
00455                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00456      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00457      $              work, ldwork )
00458                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00459 \textcolor{comment}{*}
00460 \textcolor{comment}{*                 W := W + C1 * V1}
00461 \textcolor{comment}{*}
00462                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00463      $                 lastc, k, lastv-k, one, c, ldc, v, ldv,
00464      $                 one, work, ldwork )
00465 \textcolor{keywordflow}{               END IF}
00466 \textcolor{comment}{*}
00467 \textcolor{comment}{*              W := W * T  or  W * T**T}
00468 \textcolor{comment}{*}
00469                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, trans, \textcolor{stringliteral}{'Non-unit'},
00470      $              lastc, k, one, t, ldt, work, ldwork )
00471 \textcolor{comment}{*}
00472 \textcolor{comment}{*              C := C - W * V**T}
00473 \textcolor{comment}{*}
00474                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00475 \textcolor{comment}{*}
00476 \textcolor{comment}{*                 C1 := C1 - W * V1**T}
00477 \textcolor{comment}{*}
00478                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00479      $                 lastc, lastv-k, k, -one, work, ldwork, v, ldv,
00480      $                 one, c, ldc )
00481 \textcolor{keywordflow}{               END IF}
00482 \textcolor{comment}{*}
00483 \textcolor{comment}{*              W := W * V2**T}
00484 \textcolor{comment}{*}
00485                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00486      $              lastc, k, one, v( lastv-k+1, 1 ), ldv,
00487      $              work, ldwork )
00488 \textcolor{comment}{*}
00489 \textcolor{comment}{*              C2 := C2 - W}
00490 \textcolor{comment}{*}
00491                \textcolor{keywordflow}{DO} 120 j = 1, k
00492                   \textcolor{keywordflow}{DO} 110 i = 1, lastc
00493                      c( i, lastv-k+j ) = c( i, lastv-k+j ) - work(i, j)
00494   110             \textcolor{keywordflow}{CONTINUE}
00495   120          \textcolor{keywordflow}{CONTINUE}
00496 \textcolor{keywordflow}{            END IF}
00497 \textcolor{keywordflow}{         END IF}
00498 \textcolor{comment}{*}
00499       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00500 \textcolor{comment}{*}
00501          \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00502 \textcolor{comment}{*}
00503 \textcolor{comment}{*           Let  V =  ( V1  V2 )    (V1: first K columns)}
00504 \textcolor{comment}{*           where  V1  is unit upper triangular.}
00505 \textcolor{comment}{*}
00506             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00507 \textcolor{comment}{*}
00508 \textcolor{comment}{*              Form  H * C  or  H**T * C  where  C = ( C1 )}
00509 \textcolor{comment}{*                                                    ( C2 )}
00510 \textcolor{comment}{*}
00511                lastv = max( k, iladlc( k, m, v, ldv ) )
00512                lastc = iladlc( lastv, n, c, ldc )
00513 \textcolor{comment}{*}
00514 \textcolor{comment}{*              W := C**T * V**T  =  (C1**T * V1**T + C2**T * V2**T) (stored in WORK)}
00515 \textcolor{comment}{*}
00516 \textcolor{comment}{*              W := C1**T}
00517 \textcolor{comment}{*}
00518                \textcolor{keywordflow}{DO} 130 j = 1, k
00519                   \textcolor{keyword}{CALL }dcopy( lastc, c( j, 1 ), ldc, work( 1, j ), 1 )
00520   130          \textcolor{keywordflow}{CONTINUE}
00521 \textcolor{comment}{*}
00522 \textcolor{comment}{*              W := W * V1**T}
00523 \textcolor{comment}{*}
00524                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00525      $              lastc, k, one, v, ldv, work, ldwork )
00526                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00527 \textcolor{comment}{*}
00528 \textcolor{comment}{*                 W := W + C2**T*V2**T}
00529 \textcolor{comment}{*}
00530                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Transpose'},
00531      $                 lastc, k, lastv-k,
00532      $                 one, c( k+1, 1 ), ldc, v( 1, k+1 ), ldv,
00533      $                 one, work, ldwork )
00534 \textcolor{keywordflow}{               END IF}
00535 \textcolor{comment}{*}
00536 \textcolor{comment}{*              W := W * T**T  or  W * T}
00537 \textcolor{comment}{*}
00538                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, transt, \textcolor{stringliteral}{'Non-unit'},
00539      $              lastc, k, one, t, ldt, work, ldwork )
00540 \textcolor{comment}{*}
00541 \textcolor{comment}{*              C := C - V**T * W**T}
00542 \textcolor{comment}{*}
00543                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00544 \textcolor{comment}{*}
00545 \textcolor{comment}{*                 C2 := C2 - V2**T * W**T}
00546 \textcolor{comment}{*}
00547                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Transpose'},
00548      $                 lastv-k, lastc, k,
00549      $                 -one, v( 1, k+1 ), ldv, work, ldwork,
00550      $                 one, c( k+1, 1 ), ldc )
00551 \textcolor{keywordflow}{               END IF}
00552 \textcolor{comment}{*}
00553 \textcolor{comment}{*              W := W * V1}
00554 \textcolor{comment}{*}
00555                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00556      $              lastc, k, one, v, ldv, work, ldwork )
00557 \textcolor{comment}{*}
00558 \textcolor{comment}{*              C1 := C1 - W**T}
00559 \textcolor{comment}{*}
00560                \textcolor{keywordflow}{DO} 150 j = 1, k
00561                   \textcolor{keywordflow}{DO} 140 i = 1, lastc
00562                      c( j, i ) = c( j, i ) - work( i, j )
00563   140             \textcolor{keywordflow}{CONTINUE}
00564   150          \textcolor{keywordflow}{CONTINUE}
00565 \textcolor{comment}{*}
00566             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00567 \textcolor{comment}{*}
00568 \textcolor{comment}{*              Form  C * H  or  C * H**T  where  C = ( C1  C2 )}
00569 \textcolor{comment}{*}
00570                lastv = max( k, iladlc( k, n, v, ldv ) )
00571                lastc = iladlr( m, lastv, c, ldc )
00572 \textcolor{comment}{*}
00573 \textcolor{comment}{*              W := C * V**T  =  (C1*V1**T + C2*V2**T)  (stored in WORK)}
00574 \textcolor{comment}{*}
00575 \textcolor{comment}{*              W := C1}
00576 \textcolor{comment}{*}
00577                \textcolor{keywordflow}{DO} 160 j = 1, k
00578                   \textcolor{keyword}{CALL }dcopy( lastc, c( 1, j ), 1, work( 1, j ), 1 )
00579   160          \textcolor{keywordflow}{CONTINUE}
00580 \textcolor{comment}{*}
00581 \textcolor{comment}{*              W := W * V1**T}
00582 \textcolor{comment}{*}
00583                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00584      $              lastc, k, one, v, ldv, work, ldwork )
00585                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00586 \textcolor{comment}{*}
00587 \textcolor{comment}{*                 W := W + C2 * V2**T}
00588 \textcolor{comment}{*}
00589                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00590      $                 lastc, k, lastv-k,
00591      $                 one, c( 1, k+1 ), ldc, v( 1, k+1 ), ldv,
00592      $                 one, work, ldwork )
00593 \textcolor{keywordflow}{               END IF}
00594 \textcolor{comment}{*}
00595 \textcolor{comment}{*              W := W * T  or  W * T**T}
00596 \textcolor{comment}{*}
00597                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, trans, \textcolor{stringliteral}{'Non-unit'},
00598      $              lastc, k, one, t, ldt, work, ldwork )
00599 \textcolor{comment}{*}
00600 \textcolor{comment}{*              C := C - W * V}
00601 \textcolor{comment}{*}
00602                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00603 \textcolor{comment}{*}
00604 \textcolor{comment}{*                 C2 := C2 - W * V2}
00605 \textcolor{comment}{*}
00606                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00607      $                 lastc, lastv-k, k,
00608      $                 -one, work, ldwork, v( 1, k+1 ), ldv,
00609      $                 one, c( 1, k+1 ), ldc )
00610 \textcolor{keywordflow}{               END IF}
00611 \textcolor{comment}{*}
00612 \textcolor{comment}{*              W := W * V1}
00613 \textcolor{comment}{*}
00614                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00615      $              lastc, k, one, v, ldv, work, ldwork )
00616 \textcolor{comment}{*}
00617 \textcolor{comment}{*              C1 := C1 - W}
00618 \textcolor{comment}{*}
00619                \textcolor{keywordflow}{DO} 180 j = 1, k
00620                   \textcolor{keywordflow}{DO} 170 i = 1, lastc
00621                      c( i, j ) = c( i, j ) - work( i, j )
00622   170             \textcolor{keywordflow}{CONTINUE}
00623   180          \textcolor{keywordflow}{CONTINUE}
00624 \textcolor{comment}{*}
00625 \textcolor{keywordflow}{            END IF}
00626 \textcolor{comment}{*}
00627          \textcolor{keywordflow}{ELSE}
00628 \textcolor{comment}{*}
00629 \textcolor{comment}{*           Let  V =  ( V1  V2 )    (V2: last K columns)}
00630 \textcolor{comment}{*           where  V2  is unit lower triangular.}
00631 \textcolor{comment}{*}
00632             \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'L'} ) ) \textcolor{keywordflow}{THEN}
00633 \textcolor{comment}{*}
00634 \textcolor{comment}{*              Form  H * C  or  H**T * C  where  C = ( C1 )}
00635 \textcolor{comment}{*                                                    ( C2 )}
00636 \textcolor{comment}{*}
00637                lastv = max( k, iladlc( k, m, v, ldv ) )
00638                lastc = iladlc( lastv, n, c, ldc )
00639 \textcolor{comment}{*}
00640 \textcolor{comment}{*              W := C**T * V**T  =  (C1**T * V1**T + C2**T * V2**T) (stored in WORK)}
00641 \textcolor{comment}{*}
00642 \textcolor{comment}{*              W := C2**T}
00643 \textcolor{comment}{*}
00644                \textcolor{keywordflow}{DO} 190 j = 1, k
00645                   \textcolor{keyword}{CALL }dcopy( lastc, c( lastv-k+j, 1 ), ldc,
00646      $                 work( 1, j ), 1 )
00647   190          \textcolor{keywordflow}{CONTINUE}
00648 \textcolor{comment}{*}
00649 \textcolor{comment}{*              W := W * V2**T}
00650 \textcolor{comment}{*}
00651                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00652      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00653      $              work, ldwork )
00654                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00655 \textcolor{comment}{*}
00656 \textcolor{comment}{*                 W := W + C1**T * V1**T}
00657 \textcolor{comment}{*}
00658                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Transpose'},
00659      $                 lastc, k, lastv-k, one, c, ldc, v, ldv,
00660      $                 one, work, ldwork )
00661 \textcolor{keywordflow}{               END IF}
00662 \textcolor{comment}{*}
00663 \textcolor{comment}{*              W := W * T**T  or  W * T}
00664 \textcolor{comment}{*}
00665                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, transt, \textcolor{stringliteral}{'Non-unit'},
00666      $              lastc, k, one, t, ldt, work, ldwork )
00667 \textcolor{comment}{*}
00668 \textcolor{comment}{*              C := C - V**T * W**T}
00669 \textcolor{comment}{*}
00670                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00671 \textcolor{comment}{*}
00672 \textcolor{comment}{*                 C1 := C1 - V1**T * W**T}
00673 \textcolor{comment}{*}
00674                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Transpose'},
00675      $                 lastv-k, lastc, k, -one, v, ldv, work, ldwork,
00676      $                 one, c, ldc )
00677 \textcolor{keywordflow}{               END IF}
00678 \textcolor{comment}{*}
00679 \textcolor{comment}{*              W := W * V2}
00680 \textcolor{comment}{*}
00681                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00682      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00683      $              work, ldwork )
00684 \textcolor{comment}{*}
00685 \textcolor{comment}{*              C2 := C2 - W**T}
00686 \textcolor{comment}{*}
00687                \textcolor{keywordflow}{DO} 210 j = 1, k
00688                   \textcolor{keywordflow}{DO} 200 i = 1, lastc
00689                      c( lastv-k+j, i ) = c( lastv-k+j, i ) - work(i, j)
00690   200             \textcolor{keywordflow}{CONTINUE}
00691   210          \textcolor{keywordflow}{CONTINUE}
00692 \textcolor{comment}{*}
00693             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( lsame( side, \textcolor{stringliteral}{'R'} ) ) \textcolor{keywordflow}{THEN}
00694 \textcolor{comment}{*}
00695 \textcolor{comment}{*              Form  C * H  or  C * H**T  where  C = ( C1  C2 )}
00696 \textcolor{comment}{*}
00697                lastv = max( k, iladlc( k, n, v, ldv ) )
00698                lastc = iladlr( m, lastv, c, ldc )
00699 \textcolor{comment}{*}
00700 \textcolor{comment}{*              W := C * V**T  =  (C1*V1**T + C2*V2**T)  (stored in WORK)}
00701 \textcolor{comment}{*}
00702 \textcolor{comment}{*              W := C2}
00703 \textcolor{comment}{*}
00704                \textcolor{keywordflow}{DO} 220 j = 1, k
00705                   \textcolor{keyword}{CALL }dcopy( lastc, c( 1, lastv-k+j ), 1,
00706      $                 work( 1, j ), 1 )
00707   220          \textcolor{keywordflow}{CONTINUE}
00708 \textcolor{comment}{*}
00709 \textcolor{comment}{*              W := W * V2**T}
00710 \textcolor{comment}{*}
00711                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'Transpose'}, \textcolor{stringliteral}{'Unit'},
00712      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00713      $              work, ldwork )
00714                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00715 \textcolor{comment}{*}
00716 \textcolor{comment}{*                 W := W + C1 * V1**T}
00717 \textcolor{comment}{*}
00718                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Transpose'},
00719      $                 lastc, k, lastv-k, one, c, ldc, v, ldv,
00720      $                 one, work, ldwork )
00721 \textcolor{keywordflow}{               END IF}
00722 \textcolor{comment}{*}
00723 \textcolor{comment}{*              W := W * T  or  W * T**T}
00724 \textcolor{comment}{*}
00725                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, trans, \textcolor{stringliteral}{'Non-unit'},
00726      $              lastc, k, one, t, ldt, work, ldwork )
00727 \textcolor{comment}{*}
00728 \textcolor{comment}{*              C := C - W * V}
00729 \textcolor{comment}{*}
00730                \textcolor{keywordflow}{IF}( lastv.GT.k ) \textcolor{keywordflow}{THEN}
00731 \textcolor{comment}{*}
00732 \textcolor{comment}{*                 C1 := C1 - W * V1}
00733 \textcolor{comment}{*}
00734                   \textcolor{keyword}{CALL }dgemm( \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'No transpose'},
00735      $                 lastc, lastv-k, k, -one, work, ldwork, v, ldv,
00736      $                 one, c, ldc )
00737 \textcolor{keywordflow}{               END IF}
00738 \textcolor{comment}{*}
00739 \textcolor{comment}{*              W := W * V2}
00740 \textcolor{comment}{*}
00741                \textcolor{keyword}{CALL }dtrmm( \textcolor{stringliteral}{'Right'}, \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Unit'},
00742      $              lastc, k, one, v( 1, lastv-k+1 ), ldv,
00743      $              work, ldwork )
00744 \textcolor{comment}{*}
00745 \textcolor{comment}{*              C1 := C1 - W}
00746 \textcolor{comment}{*}
00747                \textcolor{keywordflow}{DO} 240 j = 1, k
00748                   \textcolor{keywordflow}{DO} 230 i = 1, lastc
00749                      c( i, lastv-k+j ) = c( i, lastv-k+j ) - work(i, j)
00750   230             \textcolor{keywordflow}{CONTINUE}
00751   240          \textcolor{keywordflow}{CONTINUE}
00752 \textcolor{comment}{*}
00753 \textcolor{keywordflow}{            END IF}
00754 \textcolor{comment}{*}
00755 \textcolor{keywordflow}{         END IF}
00756 \textcolor{keywordflow}{      END IF}
00757 \textcolor{comment}{*}
00758       \textcolor{keywordflow}{RETURN}
00759 \textcolor{comment}{*}
00760 \textcolor{comment}{*     End of DLARFB}
00761 \textcolor{comment}{*}
00762 \textcolor{keyword}{      END}
\end{DoxyCode}
