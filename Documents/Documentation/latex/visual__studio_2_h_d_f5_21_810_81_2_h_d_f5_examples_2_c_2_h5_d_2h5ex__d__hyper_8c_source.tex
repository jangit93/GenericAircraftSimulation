\hypertarget{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_c_2_h5_d_2h5ex__d__hyper_8c_source}{}\section{visual\+\_\+studio/\+H\+D\+F5/1.10.1/\+H\+D\+F5\+Examples/\+C/\+H5\+D/h5ex\+\_\+d\+\_\+hyper.c}
\label{visual__studio_2_h_d_f5_21_810_81_2_h_d_f5_examples_2_c_2_h5_d_2h5ex__d__hyper_8c_source}\index{h5ex\+\_\+d\+\_\+hyper.\+c@{h5ex\+\_\+d\+\_\+hyper.\+c}}

\begin{DoxyCode}
00001 \textcolor{comment}{/************************************************************}
00002 \textcolor{comment}{}
00003 \textcolor{comment}{  This example shows how to read and write data to a}
00004 \textcolor{comment}{  dataset by hyberslabs.  The program first writes integers}
00005 \textcolor{comment}{  in a hyperslab selection to a dataset with dataspace}
00006 \textcolor{comment}{  dimensions of DIM0xDIM1, then closes the file.  Next, it}
00007 \textcolor{comment}{  reopens the file, reads back the data, and outputs it to}
00008 \textcolor{comment}{  the screen.  Finally it reads the data again using a}
00009 \textcolor{comment}{  different hyperslab selection, and outputs the result to}
00010 \textcolor{comment}{  the screen.}
00011 \textcolor{comment}{}
00012 \textcolor{comment}{  This file is intended for use with HDF5 Library version 1.8}
00013 \textcolor{comment}{}
00014 \textcolor{comment}{ ************************************************************/}
00015 
00016 \textcolor{preprocessor}{#include "hdf5.h"}
00017 \textcolor{preprocessor}{#include <stdio.h>}
00018 \textcolor{preprocessor}{#include <stdlib.h>}
00019 
00020 \textcolor{preprocessor}{#define FILE            "h5ex\_d\_hyper.h5"}
00021 \textcolor{preprocessor}{#define DATASET         "DS1"}
00022 \textcolor{preprocessor}{#define DIM0            6}
00023 \textcolor{preprocessor}{#define DIM1            8}
00024 
00025 \textcolor{keywordtype}{int}
00026 main (\textcolor{keywordtype}{void})
00027 \{
00028     hid\_t       \hyperlink{structfile}{file}, space, dset;          \textcolor{comment}{/* Handles */}
00029     herr\_t      status;
00030     hsize\_t     dims[2] = \{DIM0, DIM1\},
00031                 start[2],
00032                 stride[2],
00033                 count[2],
00034                 block[2];
00035     \textcolor{keywordtype}{int}         wdata[DIM0][DIM1],          \textcolor{comment}{/* Write buffer */}
00036                 rdata[DIM0][DIM1],          \textcolor{comment}{/* Read buffer */}
00037                 i, j;
00038 
00039     \textcolor{comment}{/*}
00040 \textcolor{comment}{     * Initialize data to "1", to make it easier to see the selections.}
00041 \textcolor{comment}{     */}
00042     \textcolor{keywordflow}{for} (i=0; i<DIM0; i++)
00043         \textcolor{keywordflow}{for} (j=0; j<DIM1; j++)
00044             wdata[i][j] = 1;
00045 
00046     \textcolor{comment}{/*}
00047 \textcolor{comment}{     * Print the data to the screen.}
00048 \textcolor{comment}{     */}
00049     printf (\textcolor{stringliteral}{"Original Data:\(\backslash\)n"});
00050     \textcolor{keywordflow}{for} (i=0; i<DIM0; i++) \{
00051         printf (\textcolor{stringliteral}{" ["});
00052         \textcolor{keywordflow}{for} (j=0; j<DIM1; j++)
00053             printf (\textcolor{stringliteral}{" %3d"}, wdata[i][j]);
00054         printf (\textcolor{stringliteral}{"]\(\backslash\)n"});
00055     \}
00056 
00057     \textcolor{comment}{/*}
00058 \textcolor{comment}{     * Create a new file using the default properties.}
00059 \textcolor{comment}{     */}
00060     file = H5Fcreate (FILE, H5F\_ACC\_TRUNC, H5P\_DEFAULT, H5P\_DEFAULT);
00061 
00062     \textcolor{comment}{/*}
00063 \textcolor{comment}{     * Create dataspace.  Setting maximum size to NULL sets the maximum}
00064 \textcolor{comment}{     * size to be the current size.}
00065 \textcolor{comment}{     */}
00066     space = H5Screate\_simple (2, dims, NULL);
00067 
00068     \textcolor{comment}{/*}
00069 \textcolor{comment}{     * Create the dataset.  We will use all default properties for this}
00070 \textcolor{comment}{     * example.}
00071 \textcolor{comment}{     */}
00072     dset = H5Dcreate (file, DATASET, H5T\_STD\_I32LE, space, H5P\_DEFAULT,
00073                 H5P\_DEFAULT, H5P\_DEFAULT);
00074 
00075     \textcolor{comment}{/*}
00076 \textcolor{comment}{     * Define and select the first part of the hyperslab selection.}
00077 \textcolor{comment}{     */}
00078     start[0] = 0;
00079     start[1] = 0;
00080     stride[0] = 3;
00081     stride[1] = 3;
00082     count[0] = 2;
00083     count[1] = 3;
00084     block[0] = 2;
00085     block[1] = 2;
00086     status = H5Sselect\_hyperslab (space, H5S\_SELECT\_SET, start, stride, count,
00087                 block);
00088 
00089     \textcolor{comment}{/*}
00090 \textcolor{comment}{     * Define and select the second part of the hyperslab selection,}
00091 \textcolor{comment}{     * which is subtracted from the first selection by the use of}
00092 \textcolor{comment}{     * H5S\_SELECT\_NOTB}
00093 \textcolor{comment}{     */}
00094     block[0] = 1;
00095     block[1] = 1;
00096     status = H5Sselect\_hyperslab (space, H5S\_SELECT\_NOTB, start, stride, count,
00097                 block);
00098 
00099     \textcolor{comment}{/*}
00100 \textcolor{comment}{     * Write the data to the dataset.}
00101 \textcolor{comment}{     */}
00102     status = H5Dwrite (dset, H5T\_NATIVE\_INT, H5S\_ALL, space, H5P\_DEFAULT,
00103                 wdata[0]);
00104 
00105     \textcolor{comment}{/*}
00106 \textcolor{comment}{     * Close and release resources.}
00107 \textcolor{comment}{     */}
00108     status = H5Dclose (dset);
00109     status = H5Sclose (space);
00110     status = H5Fclose (file);
00111 
00112 
00113     \textcolor{comment}{/*}
00114 \textcolor{comment}{     * Now we begin the read section of this example.}
00115 \textcolor{comment}{     */}
00116 
00117     \textcolor{comment}{/*}
00118 \textcolor{comment}{     * Open file and dataset using the default properties.}
00119 \textcolor{comment}{     */}
00120     file = H5Fopen (FILE, H5F\_ACC\_RDONLY, H5P\_DEFAULT);
00121     dset = H5Dopen (file, DATASET, H5P\_DEFAULT);
00122 
00123     \textcolor{comment}{/*}
00124 \textcolor{comment}{     * Read the data using the default properties.}
00125 \textcolor{comment}{     */}
00126     status = H5Dread (dset, H5T\_NATIVE\_INT, H5S\_ALL, H5S\_ALL, H5P\_DEFAULT,
00127                 rdata[0]);
00128 
00129     \textcolor{comment}{/*}
00130 \textcolor{comment}{     * Output the data to the screen.}
00131 \textcolor{comment}{     */}
00132     printf (\textcolor{stringliteral}{"\(\backslash\)nData as written to disk by hyberslabs:\(\backslash\)n"});
00133     \textcolor{keywordflow}{for} (i=0; i<DIM0; i++) \{
00134         printf (\textcolor{stringliteral}{" ["});
00135         \textcolor{keywordflow}{for} (j=0; j<DIM1; j++)
00136             printf (\textcolor{stringliteral}{" %3d"}, rdata[i][j]);
00137         printf (\textcolor{stringliteral}{"]\(\backslash\)n"});
00138     \}
00139 
00140     \textcolor{comment}{/*}
00141 \textcolor{comment}{     * Initialize the read array.}
00142 \textcolor{comment}{     */}
00143     \textcolor{keywordflow}{for} (i=0; i<DIM0; i++)
00144         \textcolor{keywordflow}{for} (j=0; j<DIM1; j++)
00145             rdata[i][j] = 0;
00146 
00147     \textcolor{comment}{/*}
00148 \textcolor{comment}{     * Define and select the hyperslab to use for reading.}
00149 \textcolor{comment}{     */}
00150     space = H5Dget\_space (dset);
00151     start[0] = 0;
00152     start[1] = 1;
00153     stride[0] = 4;
00154     stride[1] = 4;
00155     count[0] = 2;
00156     count[1] = 2;
00157     block[0] = 2;
00158     block[1] = 3;
00159     status = H5Sselect\_hyperslab (space, H5S\_SELECT\_SET, start, stride, count, block);
00160 
00161     \textcolor{comment}{/*}
00162 \textcolor{comment}{     * Read the data using the previously defined hyperslab.}
00163 \textcolor{comment}{     */}
00164     status = H5Dread (dset, H5T\_NATIVE\_INT, H5S\_ALL, space, H5P\_DEFAULT,
00165                 rdata[0]);
00166 
00167     \textcolor{comment}{/*}
00168 \textcolor{comment}{     * Output the data to the screen.}
00169 \textcolor{comment}{     */}
00170     printf (\textcolor{stringliteral}{"\(\backslash\)nData as read from disk by hyperslab:\(\backslash\)n"});
00171     \textcolor{keywordflow}{for} (i=0; i<DIM0; i++) \{
00172         printf (\textcolor{stringliteral}{" ["});
00173         \textcolor{keywordflow}{for} (j=0; j<DIM1; j++)
00174             printf (\textcolor{stringliteral}{" %3d"}, rdata[i][j]);
00175         printf (\textcolor{stringliteral}{"]\(\backslash\)n"});
00176     \}
00177 
00178     \textcolor{comment}{/*}
00179 \textcolor{comment}{     * Close and release resources.}
00180 \textcolor{comment}{     */}
00181     status = H5Dclose (dset);
00182     status = H5Sclose (space);
00183     status = H5Fclose (file);
00184 
00185     \textcolor{keywordflow}{return} 0;
00186 \}
\end{DoxyCode}
