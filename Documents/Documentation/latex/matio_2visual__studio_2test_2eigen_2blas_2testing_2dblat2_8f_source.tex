\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat2_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/dblat2.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2dblat2_8f_source}\index{dblat2.\+f@{dblat2.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b DBLAT2}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM DBLAT2}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*> Test program for the DOUBLE PRECISION Level 2 Blas.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*> The program must be driven by a short data file. The first 18 records}
00022 \textcolor{comment}{*> of the file are read using list-directed input, the last 16 records}
00023 \textcolor{comment}{*> are read using the format ( A6, L2 ). An annotated example of a data}
00024 \textcolor{comment}{*> file can be obtained by deleting the first 3 characters from the}
00025 \textcolor{comment}{*> following 34 lines:}
00026 \textcolor{comment}{*> 'dblat2.out'      NAME OF SUMMARY OUTPUT FILE}
00027 \textcolor{comment}{*> 6                 UNIT NUMBER OF SUMMARY FILE}
00028 \textcolor{comment}{*> 'DBLAT2.SNAP'     NAME OF SNAPSHOT OUTPUT FILE}
00029 \textcolor{comment}{*> -1                UNIT NUMBER OF SNAPSHOT FILE (NOT USED IF .LT. 0)}
00030 \textcolor{comment}{*> F        LOGICAL FLAG, T TO REWIND SNAPSHOT FILE AFTER EACH RECORD.}
00031 \textcolor{comment}{*> F        LOGICAL FLAG, T TO STOP ON FAILURES.}
00032 \textcolor{comment}{*> T        LOGICAL FLAG, T TO TEST ERROR EXITS.}
00033 \textcolor{comment}{*> 16.0     THRESHOLD VALUE OF TEST RATIO}
00034 \textcolor{comment}{*> 6                 NUMBER OF VALUES OF N}
00035 \textcolor{comment}{*> 0 1 2 3 5 9       VALUES OF N}
00036 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF K}
00037 \textcolor{comment}{*> 0 1 2 4           VALUES OF K}
00038 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF INCX AND INCY}
00039 \textcolor{comment}{*> 1 2 -1 -2         VALUES OF INCX AND INCY}
00040 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF ALPHA}
00041 \textcolor{comment}{*> 0.0 1.0 0.7       VALUES OF ALPHA}
00042 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF BETA}
00043 \textcolor{comment}{*> 0.0 1.0 0.9       VALUES OF BETAC}
00044 \textcolor{comment}{*> DGEMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00045 \textcolor{comment}{*> DGBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00046 \textcolor{comment}{*> DSYMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00047 \textcolor{comment}{*> DSBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00048 \textcolor{comment}{*> DSPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00049 \textcolor{comment}{*> DTRMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00050 \textcolor{comment}{*> DTBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00051 \textcolor{comment}{*> DTPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00052 \textcolor{comment}{*> DTRSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00053 \textcolor{comment}{*> DTBSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00054 \textcolor{comment}{*> DTPSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00055 \textcolor{comment}{*> DGER   T PUT F FOR NO TEST. SAME COLUMNS.}
00056 \textcolor{comment}{*> DSYR   T PUT F FOR NO TEST. SAME COLUMNS.}
00057 \textcolor{comment}{*> DSPR   T PUT F FOR NO TEST. SAME COLUMNS.}
00058 \textcolor{comment}{*> DSYR2  T PUT F FOR NO TEST. SAME COLUMNS.}
00059 \textcolor{comment}{*> DSPR2  T PUT F FOR NO TEST. SAME COLUMNS.}
00060 \textcolor{comment}{*>}
00061 \textcolor{comment}{*> Further Details}
00062 \textcolor{comment}{*> ===============}
00063 \textcolor{comment}{*>}
00064 \textcolor{comment}{*>    See:}
00065 \textcolor{comment}{*>}
00066 \textcolor{comment}{*>       Dongarra J. J., Du Croz J. J., Hammarling S.  and Hanson R. J..}
00067 \textcolor{comment}{*>       An  extended  set of Fortran  Basic Linear Algebra Subprograms.}
00068 \textcolor{comment}{*>}
00069 \textcolor{comment}{*>       Technical  Memoranda  Nos. 41 (revision 3) and 81,  Mathematics}
00070 \textcolor{comment}{*>       and  Computer Science  Division,  Argonne  National Laboratory,}
00071 \textcolor{comment}{*>       9700 South Cass Avenue, Argonne, Illinois 60439, US.}
00072 \textcolor{comment}{*>}
00073 \textcolor{comment}{*>       Or}
00074 \textcolor{comment}{*>}
00075 \textcolor{comment}{*>       NAG  Technical Reports TR3/87 and TR4/87,  Numerical Algorithms}
00076 \textcolor{comment}{*>       Group  Ltd.,  NAG  Central  Office,  256  Banbury  Road, Oxford}
00077 \textcolor{comment}{*>       OX2 7DE, UK,  and  Numerical Algorithms Group Inc.,  1101  31st}
00078 \textcolor{comment}{*>       Street,  Suite 100,  Downers Grove,  Illinois 60515-1263,  USA.}
00079 \textcolor{comment}{*>}
00080 \textcolor{comment}{*>}
00081 \textcolor{comment}{*> -- Written on 10-August-1987.}
00082 \textcolor{comment}{*>    Richard Hanson, Sandia National Labs.}
00083 \textcolor{comment}{*>    Jeremy Du Croz, NAG Central Office.}
00084 \textcolor{comment}{*>}
00085 \textcolor{comment}{*>    10-9-00:  Change STATUS='NEW' to 'UNKNOWN' so that the testers}
00086 \textcolor{comment}{*>              can be run multiple times without deleting generated}
00087 \textcolor{comment}{*>              output files (susan)}
00088 \textcolor{comment}{*> \(\backslash\)endverbatim}
00089 \textcolor{comment}{*}
00090 \textcolor{comment}{*  Authors:}
00091 \textcolor{comment}{*  ========}
00092 \textcolor{comment}{*}
00093 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00094 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00095 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00096 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00097 \textcolor{comment}{*}
00098 \textcolor{comment}{*> \(\backslash\)date April 2012}
00099 \textcolor{comment}{*}
00100 \textcolor{comment}{*> \(\backslash\)ingroup double\_blas\_testing}
00101 \textcolor{comment}{*}
00102 \textcolor{comment}{*  =====================================================================}
00103       \textcolor{keyword}{PROGRAM} dblat2
00104 \textcolor{comment}{*}
00105 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00106 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00107 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00108 \textcolor{comment}{*     April 2012}
00109 \textcolor{comment}{*}
00110 \textcolor{comment}{*  =====================================================================}
00111 \textcolor{comment}{*}
00112 \textcolor{comment}{*     .. Parameters ..}
00113       \textcolor{keywordtype}{INTEGER}            nin
00114       parameter( nin = 5 )
00115       \textcolor{keywordtype}{INTEGER}            nsubs
00116       parameter( nsubs = 16 )
00117       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
00118       parameter( zero = 0.0d0, one = 1.0d0 )
00119       \textcolor{keywordtype}{INTEGER}            nmax, incmax
00120       parameter( nmax = 65, incmax = 2 )
00121       \textcolor{keywordtype}{INTEGER}            ninmax, nidmax, nkbmax, nalmax, nbemax
00122       parameter( ninmax = 7, nidmax = 9, nkbmax = 7,
00123      $                   nalmax = 7, nbemax = 7 )
00124 \textcolor{comment}{*     .. Local Scalars ..}
00125       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, err, thresh
00126       \textcolor{keywordtype}{INTEGER}            i, isnum, j, n, nalf, nbet, nidim, ninc, nkb,
00127      $                   nout, ntra
00128       \textcolor{keywordtype}{LOGICAL}            fatal, ltestt, rewi, same, sfatal, trace,
00129      $                   tsterr
00130       \textcolor{keywordtype}{CHARACTER*1}        trans
00131       \textcolor{keywordtype}{CHARACTER*6}        snamet
00132       \textcolor{keywordtype}{CHARACTER*32}       snaps, summry
00133 \textcolor{comment}{*     .. Local Arrays ..}
00134       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ),
00135      $                   alf( nalmax ), as( nmax*nmax ), bet( nbemax ),
00136      $                   g( nmax ), x( nmax ), xs( nmax*incmax ),
00137      $                   xx( nmax*incmax ), y( nmax ),
00138      $                   ys( nmax*incmax ), yt( nmax ),
00139      $                   yy( nmax*incmax ), z( 2*nmax )
00140       \textcolor{keywordtype}{INTEGER}            idim( nidmax ), inc( ninmax ), kb( nkbmax )
00141       \textcolor{keywordtype}{LOGICAL}            ltest( nsubs )
00142       \textcolor{keywordtype}{CHARACTER*6}        snames( nsubs )
00143 \textcolor{comment}{*     .. External Functions ..}
00144       \textcolor{keywordtype}{DOUBLE PRECISION}   ddiff
00145       \textcolor{keywordtype}{LOGICAL}            lde
00146       \textcolor{keywordtype}{EXTERNAL}           ddiff, lde
00147 \textcolor{comment}{*     .. External Subroutines ..}
00148       \textcolor{keywordtype}{EXTERNAL}           dchk1, dchk2, dchk3, dchk4, dchk5, dchk6,
00149      $                   dchke, dmvch
00150 \textcolor{comment}{*     .. Intrinsic Functions ..}
00151       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00152 \textcolor{comment}{*     .. Scalars in Common ..}
00153       \textcolor{keywordtype}{INTEGER}            infot, noutc
00154       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00155       \textcolor{keywordtype}{CHARACTER*6}        srnamt
00156 \textcolor{comment}{*     .. Common blocks ..}
00157       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00158       \textcolor{keyword}{COMMON}             /srnamc/srnamt
00159 \textcolor{comment}{*     .. Data statements ..}
00160       \textcolor{keyword}{DATA}               snames/\textcolor{stringliteral}{'DGEMV '}, \textcolor{stringliteral}{'DGBMV '}, \textcolor{stringliteral}{'DSYMV '}, \textcolor{stringliteral}{'DSBMV '},
00161      $                   \textcolor{stringliteral}{'DSPMV '}, \textcolor{stringliteral}{'DTRMV '}, \textcolor{stringliteral}{'DTBMV '}, \textcolor{stringliteral}{'DTPMV '},
00162      $                   \textcolor{stringliteral}{'DTRSV '}, \textcolor{stringliteral}{'DTBSV '}, \textcolor{stringliteral}{'DTPSV '}, \textcolor{stringliteral}{'DGER  '},
00163      $                   \textcolor{stringliteral}{'DSYR  '}, \textcolor{stringliteral}{'DSPR  '}, \textcolor{stringliteral}{'DSYR2 '}, \textcolor{stringliteral}{'DSPR2 '}/
00164 \textcolor{comment}{*     .. Executable Statements ..}
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*     Read name and unit number for summary output file and open file.}
00167 \textcolor{comment}{*}
00168       \textcolor{keyword}{READ}( nin, fmt = * )summry
00169       \textcolor{keyword}{READ}( nin, fmt = * )nout
00170       \textcolor{keyword}{OPEN}( nout, \hyperlink{structfile}{file} = summry, status = \textcolor{stringliteral}{'UNKNOWN'} )
00171       noutc = nout
00172 \textcolor{comment}{*}
00173 \textcolor{comment}{*     Read name and unit number for snapshot output file and open file.}
00174 \textcolor{comment}{*}
00175       \textcolor{keyword}{READ}( nin, fmt = * )snaps
00176       \textcolor{keyword}{READ}( nin, fmt = * )ntra
00177       trace = ntra.GE.0
00178       \textcolor{keywordflow}{IF}( trace )\textcolor{keywordflow}{THEN}
00179          \textcolor{keyword}{OPEN}( ntra, \hyperlink{structfile}{file} = snaps, status = \textcolor{stringliteral}{'UNKNOWN'} )
00180 \textcolor{keywordflow}{      END IF}
00181 \textcolor{comment}{*     Read the flag that directs rewinding of the snapshot file.}
00182       \textcolor{keyword}{READ}( nin, fmt = * )rewi
00183       rewi = rewi.AND.trace
00184 \textcolor{comment}{*     Read the flag that directs stopping on any failure.}
00185       \textcolor{keyword}{READ}( nin, fmt = * )sfatal
00186 \textcolor{comment}{*     Read the flag that indicates whether error exits are to be tested.}
00187       \textcolor{keyword}{READ}( nin, fmt = * )tsterr
00188 \textcolor{comment}{*     Read the threshold value of the test ratio}
00189       \textcolor{keyword}{READ}( nin, fmt = * )thresh
00190 \textcolor{comment}{*}
00191 \textcolor{comment}{*     Read and check the parameter values for the tests.}
00192 \textcolor{comment}{*}
00193 \textcolor{comment}{*     Values of N}
00194       \textcolor{keyword}{READ}( nin, fmt = * )nidim
00195       \textcolor{keywordflow}{IF}( nidim.LT.1.OR.nidim.GT.nidmax )\textcolor{keywordflow}{THEN}
00196          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'N'}, nidmax
00197          \textcolor{keywordflow}{GO TO} 230
00198 \textcolor{keywordflow}{      END IF}
00199       \textcolor{keyword}{READ}( nin, fmt = * )( idim( i ), i = 1, nidim )
00200       \textcolor{keywordflow}{DO} 10 i = 1, nidim
00201          \textcolor{keywordflow}{IF}( idim( i ).LT.0.OR.idim( i ).GT.nmax )\textcolor{keywordflow}{THEN}
00202             \textcolor{keyword}{WRITE}( nout, fmt = 9996 )nmax
00203             \textcolor{keywordflow}{GO TO} 230
00204 \textcolor{keywordflow}{         END IF}
00205    10 \textcolor{keywordflow}{CONTINUE}
00206 \textcolor{comment}{*     Values of K}
00207       \textcolor{keyword}{READ}( nin, fmt = * )nkb
00208       \textcolor{keywordflow}{IF}( nkb.LT.1.OR.nkb.GT.nkbmax )\textcolor{keywordflow}{THEN}
00209          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'K'}, nkbmax
00210          \textcolor{keywordflow}{GO TO} 230
00211 \textcolor{keywordflow}{      END IF}
00212       \textcolor{keyword}{READ}( nin, fmt = * )( kb( i ), i = 1, nkb )
00213       \textcolor{keywordflow}{DO} 20 i = 1, nkb
00214          \textcolor{keywordflow}{IF}( kb( i ).LT.0 )\textcolor{keywordflow}{THEN}
00215             \textcolor{keyword}{WRITE}( nout, fmt = 9995 )
00216             \textcolor{keywordflow}{GO TO} 230
00217 \textcolor{keywordflow}{         END IF}
00218    20 \textcolor{keywordflow}{CONTINUE}
00219 \textcolor{comment}{*     Values of INCX and INCY}
00220       \textcolor{keyword}{READ}( nin, fmt = * )ninc
00221       \textcolor{keywordflow}{IF}( ninc.LT.1.OR.ninc.GT.ninmax )\textcolor{keywordflow}{THEN}
00222          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'INCX AND INCY'}, ninmax
00223          \textcolor{keywordflow}{GO TO} 230
00224 \textcolor{keywordflow}{      END IF}
00225       \textcolor{keyword}{READ}( nin, fmt = * )( inc( i ), i = 1, ninc )
00226       \textcolor{keywordflow}{DO} 30 i = 1, ninc
00227          \textcolor{keywordflow}{IF}( inc( i ).EQ.0.OR.abs( inc( i ) ).GT.incmax )\textcolor{keywordflow}{THEN}
00228             \textcolor{keyword}{WRITE}( nout, fmt = 9994 )incmax
00229             \textcolor{keywordflow}{GO TO} 230
00230 \textcolor{keywordflow}{         END IF}
00231    30 \textcolor{keywordflow}{CONTINUE}
00232 \textcolor{comment}{*     Values of ALPHA}
00233       \textcolor{keyword}{READ}( nin, fmt = * )nalf
00234       \textcolor{keywordflow}{IF}( nalf.LT.1.OR.nalf.GT.nalmax )\textcolor{keywordflow}{THEN}
00235          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'ALPHA'}, nalmax
00236          \textcolor{keywordflow}{GO TO} 230
00237 \textcolor{keywordflow}{      END IF}
00238       \textcolor{keyword}{READ}( nin, fmt = * )( alf( i ), i = 1, nalf )
00239 \textcolor{comment}{*     Values of BETA}
00240       \textcolor{keyword}{READ}( nin, fmt = * )nbet
00241       \textcolor{keywordflow}{IF}( nbet.LT.1.OR.nbet.GT.nbemax )\textcolor{keywordflow}{THEN}
00242          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'BETA'}, nbemax
00243          \textcolor{keywordflow}{GO TO} 230
00244 \textcolor{keywordflow}{      END IF}
00245       \textcolor{keyword}{READ}( nin, fmt = * )( bet( i ), i = 1, nbet )
00246 \textcolor{comment}{*}
00247 \textcolor{comment}{*     Report values of parameters.}
00248 \textcolor{comment}{*}
00249       \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00250       \textcolor{keyword}{WRITE}( nout, fmt = 9992 )( idim( i ), i = 1, nidim )
00251       \textcolor{keyword}{WRITE}( nout, fmt = 9991 )( kb( i ), i = 1, nkb )
00252       \textcolor{keyword}{WRITE}( nout, fmt = 9990 )( inc( i ), i = 1, ninc )
00253       \textcolor{keyword}{WRITE}( nout, fmt = 9989 )( alf( i ), i = 1, nalf )
00254       \textcolor{keyword}{WRITE}( nout, fmt = 9988 )( bet( i ), i = 1, nbet )
00255       \textcolor{keywordflow}{IF}( .NOT.tsterr )\textcolor{keywordflow}{THEN}
00256          \textcolor{keyword}{WRITE}( nout, fmt = * )
00257          \textcolor{keyword}{WRITE}( nout, fmt = 9980 )
00258 \textcolor{keywordflow}{      END IF}
00259       \textcolor{keyword}{WRITE}( nout, fmt = * )
00260       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )thresh
00261       \textcolor{keyword}{WRITE}( nout, fmt = * )
00262 \textcolor{comment}{*}
00263 \textcolor{comment}{*     Read names of subroutines and flags which indicate}
00264 \textcolor{comment}{*     whether they are to be tested.}
00265 \textcolor{comment}{*}
00266       \textcolor{keywordflow}{DO} 40 i = 1, nsubs
00267          ltest( i ) = .false.
00268    40 \textcolor{keywordflow}{CONTINUE}
00269    50 \textcolor{keyword}{READ}( nin, fmt = 9984, end = 80 )snamet, ltestt
00270       \textcolor{keywordflow}{DO} 60 i = 1, nsubs
00271          \textcolor{keywordflow}{IF}( snamet.EQ.snames( i ) )
00272      $      \textcolor{keywordflow}{GO TO} 70
00273    60 \textcolor{keywordflow}{CONTINUE}
00274       \textcolor{keyword}{WRITE}( nout, fmt = 9986 )snamet
00275       stop
00276    70 ltest( i ) = ltestt
00277       \textcolor{keywordflow}{GO TO} 50
00278 \textcolor{comment}{*}
00279    80 \textcolor{keywordflow}{CONTINUE}
00280       \textcolor{keyword}{CLOSE} ( nin )
00281 \textcolor{comment}{*}
00282 \textcolor{comment}{*     Compute EPS (the machine precision).}
00283 \textcolor{comment}{*}
00284       eps = epsilon(zero)
00285       \textcolor{keyword}{WRITE}( nout, fmt = 9998 )eps
00286 \textcolor{comment}{*}
00287 \textcolor{comment}{*     Check the reliability of DMVCH using exact data.}
00288 \textcolor{comment}{*}
00289       n = min( 32, nmax )
00290       \textcolor{keywordflow}{DO} 120 j = 1, n
00291          \textcolor{keywordflow}{DO} 110 i = 1, n
00292             a( i, j ) = max( i - j + 1, 0 )
00293   110    \textcolor{keywordflow}{CONTINUE}
00294          x( j ) = j
00295          y( j ) = zero
00296   120 \textcolor{keywordflow}{CONTINUE}
00297       \textcolor{keywordflow}{DO} 130 j = 1, n
00298          yy( j ) = j*( ( j + 1 )*j )/2 - ( ( j + 1 )*j*( j - 1 ) )/3
00299   130 \textcolor{keywordflow}{CONTINUE}
00300 \textcolor{comment}{*     YY holds the exact result. On exit from DMVCH YT holds}
00301 \textcolor{comment}{*     the result computed by DMVCH.}
00302       trans = \textcolor{stringliteral}{'N'}
00303       \textcolor{keyword}{CALL }dmvch( trans, n, n, one, a, nmax, x, 1, zero, y, 1, yt, g,
00304      $            yy, eps, err, fatal, nout, .true. )
00305       same = lde( yy, yt, n )
00306       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00307          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00308          stop
00309 \textcolor{keywordflow}{      END IF}
00310       trans = \textcolor{stringliteral}{'T'}
00311       \textcolor{keyword}{CALL }dmvch( trans, n, n, one, a, nmax, x, -1, zero, y, -1, yt, g,
00312      $            yy, eps, err, fatal, nout, .true. )
00313       same = lde( yy, yt, n )
00314       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.zero )\textcolor{keywordflow}{THEN}
00315          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00316          stop
00317 \textcolor{keywordflow}{      END IF}
00318 \textcolor{comment}{*}
00319 \textcolor{comment}{*     Test each subroutine in turn.}
00320 \textcolor{comment}{*}
00321       \textcolor{keywordflow}{DO} 210 isnum = 1, nsubs
00322          \textcolor{keyword}{WRITE}( nout, fmt = * )
00323          \textcolor{keywordflow}{IF}( .NOT.ltest( isnum ) )\textcolor{keywordflow}{THEN}
00324 \textcolor{comment}{*           Subprogram is not to be tested.}
00325             \textcolor{keyword}{WRITE}( nout, fmt = 9983 )snames( isnum )
00326          \textcolor{keywordflow}{ELSE}
00327             srnamt = snames( isnum )
00328 \textcolor{comment}{*           Test error exits.}
00329             \textcolor{keywordflow}{IF}( tsterr )\textcolor{keywordflow}{THEN}
00330                \textcolor{keyword}{CALL }dchke( isnum, snames( isnum ), nout )
00331                \textcolor{keyword}{WRITE}( nout, fmt = * )
00332 \textcolor{keywordflow}{            END IF}
00333 \textcolor{comment}{*           Test computations.}
00334             infot = 0
00335             ok = .true.
00336             fatal = .false.
00337             \textcolor{keywordflow}{GO TO} ( 140, 140, 150, 150, 150, 160, 160,
00338      $              160, 160, 160, 160, 170, 180, 180,
00339      $              190, 190 )isnum
00340 \textcolor{comment}{*           Test DGEMV, 01, and DGBMV, 02.}
00341   140       \textcolor{keyword}{CALL }dchk1( snames( isnum ), eps, thresh, nout, ntra, trace,
00342      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00343      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00344      $                  x, xx, xs, y, yy, ys, yt, g )
00345             \textcolor{keywordflow}{GO TO} 200
00346 \textcolor{comment}{*           Test DSYMV, 03, DSBMV, 04, and DSPMV, 05.}
00347   150       \textcolor{keyword}{CALL }dchk2( snames( isnum ), eps, thresh, nout, ntra, trace,
00348      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00349      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00350      $                  x, xx, xs, y, yy, ys, yt, g )
00351             \textcolor{keywordflow}{GO TO} 200
00352 \textcolor{comment}{*           Test DTRMV, 06, DTBMV, 07, DTPMV, 08,}
00353 \textcolor{comment}{*           DTRSV, 09, DTBSV, 10, and DTPSV, 11.}
00354   160       \textcolor{keyword}{CALL }dchk3( snames( isnum ), eps, thresh, nout, ntra, trace,
00355      $                  rewi, fatal, nidim, idim, nkb, kb, ninc, inc,
00356      $                  nmax, incmax, a, aa, as, y, yy, ys, yt, g, z )
00357             \textcolor{keywordflow}{GO TO} 200
00358 \textcolor{comment}{*           Test DGER, 12.}
00359   170       \textcolor{keyword}{CALL }dchk4( snames( isnum ), eps, thresh, nout, ntra, trace,
00360      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00361      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00362      $                  yt, g, z )
00363             \textcolor{keywordflow}{GO TO} 200
00364 \textcolor{comment}{*           Test DSYR, 13, and DSPR, 14.}
00365   180       \textcolor{keyword}{CALL }dchk5( snames( isnum ), eps, thresh, nout, ntra, trace,
00366      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00367      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00368      $                  yt, g, z )
00369             \textcolor{keywordflow}{GO TO} 200
00370 \textcolor{comment}{*           Test DSYR2, 15, and DSPR2, 16.}
00371   190       \textcolor{keyword}{CALL }dchk6( snames( isnum ), eps, thresh, nout, ntra, trace,
00372      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00373      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00374      $                  yt, g, z )
00375 \textcolor{comment}{*}
00376   200       \textcolor{keywordflow}{IF}( fatal.AND.sfatal )
00377      $         \textcolor{keywordflow}{GO TO} 220
00378 \textcolor{keywordflow}{         END IF}
00379   210 \textcolor{keywordflow}{CONTINUE}
00380       \textcolor{keyword}{WRITE}( nout, fmt = 9982 )
00381       \textcolor{keywordflow}{GO TO} 240
00382 \textcolor{comment}{*}
00383   220 \textcolor{keywordflow}{CONTINUE}
00384       \textcolor{keyword}{WRITE}( nout, fmt = 9981 )
00385       \textcolor{keywordflow}{GO TO} 240
00386 \textcolor{comment}{*}
00387   230 \textcolor{keywordflow}{CONTINUE}
00388       \textcolor{keyword}{WRITE}( nout, fmt = 9987 )
00389 \textcolor{comment}{*}
00390   240 \textcolor{keywordflow}{CONTINUE}
00391       \textcolor{keywordflow}{IF}( trace )
00392      $   \textcolor{keyword}{CLOSE} ( ntra )
00393       \textcolor{keyword}{CLOSE} ( nout )
00394       stop
00395 \textcolor{comment}{*}
00396  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ROUTINES PASS COMPUTATIONAL TESTS IF TEST RATIO IS LES'},
00397      $      \textcolor{stringliteral}{'S THAN'}, f8.2 )
00398  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' RELATIVE MACHINE PRECISION IS TAKEN TO BE'}, 1p, d9.1 )
00399  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' NUMBER OF VALUES OF '}, a, \textcolor{stringliteral}{' IS LESS THAN 1 OR GREATER '},
00400      $      \textcolor{stringliteral}{'THAN '}, i2 )
00401  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF N IS LESS THAN 0 OR GREATER THAN '}, i2 )
00402  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF K IS LESS THAN 0'} )
00403  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ABSOLUTE VALUE OF INCX OR INCY IS 0 OR GREATER THAN '},
00404      $      i2 )
00405  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' TESTS OF THE DOUBLE PRECISION LEVEL 2 BLAS'}, //\textcolor{stringliteral}{' THE F'},
00406      $      \textcolor{stringliteral}{'OLLOWING PARAMETER VALUES WILL BE USED:'} )
00407  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR N              '}, 9i6 )
00408  9991 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR K              '}, 7i6 )
00409  9990 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR INCX AND INCY  '}, 7i6 )
00410  9989 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR ALPHA          '}, 7f6.1 )
00411  9988 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR BETA           '}, 7f6.1 )
00412  9987 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' AMEND DATA FILE OR INCREASE ARRAY SIZES IN PROGRAM'},
00413      $      /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00414  9986 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' SUBPROGRAM NAME '}, a6, \textcolor{stringliteral}{' NOT RECOGNIZED'}, /\textcolor{stringliteral}{' ******* T'},
00415      $      \textcolor{stringliteral}{'ESTS ABANDONED *******'} )
00416  9985 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR IN DMVCH -  IN-LINE DOT PRODUCTS ARE BEING EVALU'},
00417      $      \textcolor{stringliteral}{'ATED WRONGLY.'}, /\textcolor{stringliteral}{' DMVCH WAS CALLED WITH TRANS = '}, a1,
00418      $      \textcolor{stringliteral}{' AND RETURNED SAME = '}, l1, \textcolor{stringliteral}{' AND ERR = '}, f12.3, \textcolor{stringliteral}{'.'}, /
00419      $   \textcolor{stringliteral}{' THIS MAY BE DUE TO FAULTS IN THE ARITHMETIC OR THE COMPILER.'}
00420      $      , /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00421  9984 \textcolor{keyword}{FORMAT}( a6, l2 )
00422  9983 \textcolor{keyword}{FORMAT}( 1x, a6, \textcolor{stringliteral}{' WAS NOT TESTED'} )
00423  9982 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' END OF TESTS'} )
00424  9981 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' ******* FATAL ERROR - TESTS ABANDONED *******'} )
00425  9980 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR-EXITS WILL NOT BE TESTED'} )
00426 \textcolor{comment}{*}
00427 \textcolor{comment}{*     End of DBLAT2.}
00428 \textcolor{comment}{*}
00429 \textcolor{keyword}{      END}
00430 \textcolor{keyword}{      SUBROUTINE }dchk1( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00431      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00432      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00433      $                  XS, Y, YY, YS, YT, G )
00434 \textcolor{comment}{*}
00435 \textcolor{comment}{*  Tests DGEMV and DGBMV.}
00436 \textcolor{comment}{*}
00437 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00438 \textcolor{comment}{*}
00439 \textcolor{comment}{*  -- Written on 10-August-1987.}
00440 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00441 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00442 \textcolor{comment}{*}
00443 \textcolor{comment}{*     .. Parameters ..}
00444       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half
00445       parameter( zero = 0.0d0, half = 0.5d0 )
00446 \textcolor{comment}{*     .. Scalar Arguments ..}
00447       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00448       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00449      $                   nout, ntra
00450       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00451       \textcolor{keywordtype}{CHARACTER*6}        sname
00452 \textcolor{comment}{*     .. Array Arguments ..}
00453       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00454      $                   as( nmax*nmax ), bet( nbet ), g( nmax ),
00455      $                   x( nmax ), xs( nmax*incmax ),
00456      $                   xx( nmax*incmax ), y( nmax ),
00457      $                   ys( nmax*incmax ), yt( nmax ),
00458      $                   yy( nmax*incmax )
00459       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00460 \textcolor{comment}{*     .. Local Scalars ..}
00461       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bls, err, errmax, transl
00462       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, iku, im, in, incx, incxs, incy,
00463      $                   incys, ix, iy, kl, kls, ku, kus, laa, lda,
00464      $                   ldas, lx, ly, m, ml, ms, n, nargs, nc, nd, nk,
00465      $                   nl, ns
00466       \textcolor{keywordtype}{LOGICAL}            banded, full, null, reset, same, tran
00467       \textcolor{keywordtype}{CHARACTER*1}        trans, transs
00468       \textcolor{keywordtype}{CHARACTER*3}        ich
00469 \textcolor{comment}{*     .. Local Arrays ..}
00470       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00471 \textcolor{comment}{*     .. External Functions ..}
00472       \textcolor{keywordtype}{LOGICAL}            lde, lderes
00473       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
00474 \textcolor{comment}{*     .. External Subroutines ..}
00475       \textcolor{keywordtype}{EXTERNAL}           dgbmv, dgemv, dmake, dmvch
00476 \textcolor{comment}{*     .. Intrinsic Functions ..}
00477       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00478 \textcolor{comment}{*     .. Scalars in Common ..}
00479       \textcolor{keywordtype}{INTEGER}            infot, noutc
00480       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00481 \textcolor{comment}{*     .. Common blocks ..}
00482       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00483 \textcolor{comment}{*     .. Data statements ..}
00484       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'NTC'}/
00485 \textcolor{comment}{*     .. Executable Statements ..}
00486       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
00487       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00488 \textcolor{comment}{*     Define the number of arguments.}
00489       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00490          nargs = 11
00491       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00492          nargs = 13
00493 \textcolor{keywordflow}{      END IF}
00494 \textcolor{comment}{*}
00495       nc = 0
00496       reset = .true.
00497       errmax = zero
00498 \textcolor{comment}{*}
00499       \textcolor{keywordflow}{DO} 120 in = 1, nidim
00500          n = idim( in )
00501          nd = n/2 + 1
00502 \textcolor{comment}{*}
00503          \textcolor{keywordflow}{DO} 110 im = 1, 2
00504             \textcolor{keywordflow}{IF}( im.EQ.1 )
00505      $         m = max( n - nd, 0 )
00506             \textcolor{keywordflow}{IF}( im.EQ.2 )
00507      $         m = min( n + nd, nmax )
00508 \textcolor{comment}{*}
00509             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00510                nk = nkb
00511             \textcolor{keywordflow}{ELSE}
00512                nk = 1
00513 \textcolor{keywordflow}{            END IF}
00514             \textcolor{keywordflow}{DO} 100 iku = 1, nk
00515                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00516                   ku = kb( iku )
00517                   kl = max( ku - 1, 0 )
00518                \textcolor{keywordflow}{ELSE}
00519                   ku = n - 1
00520                   kl = m - 1
00521 \textcolor{keywordflow}{               END IF}
00522 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
00523                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00524                   lda = kl + ku + 1
00525                \textcolor{keywordflow}{ELSE}
00526                   lda = m
00527 \textcolor{keywordflow}{               END IF}
00528                \textcolor{keywordflow}{IF}( lda.LT.nmax )
00529      $            lda = lda + 1
00530 \textcolor{comment}{*              Skip tests if not enough room.}
00531                \textcolor{keywordflow}{IF}( lda.GT.nmax )
00532      $            \textcolor{keywordflow}{GO TO} 100
00533                laa = lda*n
00534                null = n.LE.0.OR.m.LE.0
00535 \textcolor{comment}{*}
00536 \textcolor{comment}{*              Generate the matrix A.}
00537 \textcolor{comment}{*}
00538                transl = zero
00539                \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax, aa,
00540      $                     lda, kl, ku, reset, transl )
00541 \textcolor{comment}{*}
00542                \textcolor{keywordflow}{DO} 90 ic = 1, 3
00543                   trans = ich( ic: ic )
00544                   tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
00545 \textcolor{comment}{*}
00546                   \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
00547                      ml = n
00548                      nl = m
00549                   \textcolor{keywordflow}{ELSE}
00550                      ml = m
00551                      nl = n
00552 \textcolor{keywordflow}{                  END IF}
00553 \textcolor{comment}{*}
00554                   \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00555                      incx = inc( ix )
00556                      lx = abs( incx )*nl
00557 \textcolor{comment}{*}
00558 \textcolor{comment}{*                    Generate the vector X.}
00559 \textcolor{comment}{*}
00560                      transl = half
00561                      \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, nl, x, 1, xx,
00562      $                           abs( incx ), 0, nl - 1, reset, transl )
00563                      \textcolor{keywordflow}{IF}( nl.GT.1 )\textcolor{keywordflow}{THEN}
00564                         x( nl/2 ) = zero
00565                         xx( 1 + abs( incx )*( nl/2 - 1 ) ) = zero
00566 \textcolor{keywordflow}{                     END IF}
00567 \textcolor{comment}{*}
00568                      \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00569                         incy = inc( iy )
00570                         ly = abs( incy )*ml
00571 \textcolor{comment}{*}
00572                         \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00573                            alpha = alf( ia )
00574 \textcolor{comment}{*}
00575                            \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00576                               beta = bet( ib )
00577 \textcolor{comment}{*}
00578 \textcolor{comment}{*                             Generate the vector Y.}
00579 \textcolor{comment}{*}
00580                               transl = zero
00581                               \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, ml, y, 1,
00582      $                                    yy, abs( incy ), 0, ml - 1,
00583      $                                    reset, transl )
00584 \textcolor{comment}{*}
00585                               nc = nc + 1
00586 \textcolor{comment}{*}
00587 \textcolor{comment}{*                             Save every datum before calling the}
00588 \textcolor{comment}{*                             subroutine.}
00589 \textcolor{comment}{*}
00590                               transs = trans
00591                               ms = m
00592                               ns = n
00593                               kls = kl
00594                               kus = ku
00595                               als = alpha
00596                               \textcolor{keywordflow}{DO} 10 i = 1, laa
00597                                  as( i ) = aa( i )
00598    10                         \textcolor{keywordflow}{CONTINUE}
00599                               ldas = lda
00600                               \textcolor{keywordflow}{DO} 20 i = 1, lx
00601                                  xs( i ) = xx( i )
00602    20                         \textcolor{keywordflow}{CONTINUE}
00603                               incxs = incx
00604                               bls = beta
00605                               \textcolor{keywordflow}{DO} 30 i = 1, ly
00606                                  ys( i ) = yy( i )
00607    30                         \textcolor{keywordflow}{CONTINUE}
00608                               incys = incy
00609 \textcolor{comment}{*}
00610 \textcolor{comment}{*                             Call the subroutine.}
00611 \textcolor{comment}{*}
00612                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00613                                  \textcolor{keywordflow}{IF}( trace )
00614      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00615      $                              trans, m, n, alpha, lda, incx, beta,
00616      $                              incy
00617                                  \textcolor{keywordflow}{IF}( rewi )
00618      $                              rewind ntra
00619                                  \textcolor{keyword}{CALL }dgemv( trans, m, n, alpha, aa,
00620      $                                       lda, xx, incx, beta, yy,
00621      $                                       incy )
00622                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00623                                  \textcolor{keywordflow}{IF}( trace )
00624      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00625      $                              trans, m, n, kl, ku, alpha, lda,
00626      $                              incx, beta, incy
00627                                  \textcolor{keywordflow}{IF}( rewi )
00628      $                              rewind ntra
00629                                  \textcolor{keyword}{CALL }dgbmv( trans, m, n, kl, ku, alpha,
00630      $                                       aa, lda, xx, incx, beta,
00631      $                                       yy, incy )
00632 \textcolor{keywordflow}{                              END IF}
00633 \textcolor{comment}{*}
00634 \textcolor{comment}{*                             Check if error-exit was taken incorrectly.}
00635 \textcolor{comment}{*}
00636                               \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00637                                  \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00638                                  fatal = .true.
00639                                  \textcolor{keywordflow}{GO TO} 130
00640 \textcolor{keywordflow}{                              END IF}
00641 \textcolor{comment}{*}
00642 \textcolor{comment}{*                             See what data changed inside subroutines.}
00643 \textcolor{comment}{*}
00644                               isame( 1 ) = trans.EQ.transs
00645                               isame( 2 ) = ms.EQ.m
00646                               isame( 3 ) = ns.EQ.n
00647                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00648                                  isame( 4 ) = als.EQ.alpha
00649                                  isame( 5 ) = lde( as, aa, laa )
00650                                  isame( 6 ) = ldas.EQ.lda
00651                                  isame( 7 ) = lde( xs, xx, lx )
00652                                  isame( 8 ) = incxs.EQ.incx
00653                                  isame( 9 ) = bls.EQ.beta
00654                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00655                                     isame( 10 ) = lde( ys, yy, ly )
00656                                  \textcolor{keywordflow}{ELSE}
00657                                     isame( 10 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00658      $                                            ml, ys, yy,
00659      $                                            abs( incy ) )
00660 \textcolor{keywordflow}{                                 END IF}
00661                                  isame( 11 ) = incys.EQ.incy
00662                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00663                                  isame( 4 ) = kls.EQ.kl
00664                                  isame( 5 ) = kus.EQ.ku
00665                                  isame( 6 ) = als.EQ.alpha
00666                                  isame( 7 ) = lde( as, aa, laa )
00667                                  isame( 8 ) = ldas.EQ.lda
00668                                  isame( 9 ) = lde( xs, xx, lx )
00669                                  isame( 10 ) = incxs.EQ.incx
00670                                  isame( 11 ) = bls.EQ.beta
00671                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00672                                     isame( 12 ) = lde( ys, yy, ly )
00673                                  \textcolor{keywordflow}{ELSE}
00674                                     isame( 12 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00675      $                                            ml, ys, yy,
00676      $                                            abs( incy ) )
00677 \textcolor{keywordflow}{                                 END IF}
00678                                  isame( 13 ) = incys.EQ.incy
00679 \textcolor{keywordflow}{                              END IF}
00680 \textcolor{comment}{*}
00681 \textcolor{comment}{*                             If data was incorrectly changed, report}
00682 \textcolor{comment}{*                             and return.}
00683 \textcolor{comment}{*}
00684                               same = .true.
00685                               \textcolor{keywordflow}{DO} 40 i = 1, nargs
00686                                  same = same.AND.isame( i )
00687                                  \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
00688      $                              \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
00689    40                         \textcolor{keywordflow}{CONTINUE}
00690                               \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
00691                                  fatal = .true.
00692                                  \textcolor{keywordflow}{GO TO} 130
00693 \textcolor{keywordflow}{                              END IF}
00694 \textcolor{comment}{*}
00695                               \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
00696 \textcolor{comment}{*}
00697 \textcolor{comment}{*                                Check the result.}
00698 \textcolor{comment}{*}
00699                                  \textcolor{keyword}{CALL }dmvch( trans, m, n, alpha, a,
00700      $                                       nmax, x, incx, beta, y,
00701      $                                       incy, yt, g, yy, eps, err,
00702      $                                       fatal, nout, .true. )
00703                                  errmax = max( errmax, err )
00704 \textcolor{comment}{*                                If got really bad answer, report and}
00705 \textcolor{comment}{*                                return.}
00706                                  \textcolor{keywordflow}{IF}( fatal )
00707      $                              \textcolor{keywordflow}{GO TO} 130
00708                               \textcolor{keywordflow}{ELSE}
00709 \textcolor{comment}{*                                Avoid repeating tests with M.le.0 or}
00710 \textcolor{comment}{*                                N.le.0.}
00711                                  \textcolor{keywordflow}{GO TO} 110
00712 \textcolor{keywordflow}{                              END IF}
00713 \textcolor{comment}{*}
00714    50                      \textcolor{keywordflow}{CONTINUE}
00715 \textcolor{comment}{*}
00716    60                   \textcolor{keywordflow}{CONTINUE}
00717 \textcolor{comment}{*}
00718    70                \textcolor{keywordflow}{CONTINUE}
00719 \textcolor{comment}{*}
00720    80             \textcolor{keywordflow}{CONTINUE}
00721 \textcolor{comment}{*}
00722    90          \textcolor{keywordflow}{CONTINUE}
00723 \textcolor{comment}{*}
00724   100       \textcolor{keywordflow}{CONTINUE}
00725 \textcolor{comment}{*}
00726   110    \textcolor{keywordflow}{CONTINUE}
00727 \textcolor{comment}{*}
00728   120 \textcolor{keywordflow}{CONTINUE}
00729 \textcolor{comment}{*}
00730 \textcolor{comment}{*     Report result.}
00731 \textcolor{comment}{*}
00732       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
00733          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
00734       \textcolor{keywordflow}{ELSE}
00735          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
00736 \textcolor{keywordflow}{      END IF}
00737       \textcolor{keywordflow}{GO TO} 140
00738 \textcolor{comment}{*}
00739   130 \textcolor{keywordflow}{CONTINUE}
00740       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
00741       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00742          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, trans, m, n, alpha, lda,
00743      $      incx, beta, incy
00744       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00745          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, trans, m, n, kl, ku,
00746      $      alpha, lda, incx, beta, incy
00747 \textcolor{keywordflow}{      END IF}
00748 \textcolor{comment}{*}
00749   140 \textcolor{keywordflow}{CONTINUE}
00750       \textcolor{keywordflow}{RETURN}
00751 \textcolor{comment}{*}
00752  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
00753      $      \textcolor{stringliteral}{'S)'} )
00754  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
00755      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
00756  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
00757      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
00758      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
00759  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
00760  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 4( i3, \textcolor{stringliteral}{','} ), f4.1,
00761      $      \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{') .'} )
00762  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), f4.1,
00763      $      \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', Y,'}, i2,
00764      $      \textcolor{stringliteral}{')         .'} )
00765  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
00766      $      \textcolor{stringliteral}{'******'} )
00767 \textcolor{comment}{*}
00768 \textcolor{comment}{*     End of DCHK1.}
00769 \textcolor{comment}{*}
00770 \textcolor{keyword}{      END}
00771 \textcolor{keyword}{      SUBROUTINE }dchk2( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00772      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00773      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00774      $                  XS, Y, YY, YS, YT, G )
00775 \textcolor{comment}{*}
00776 \textcolor{comment}{*  Tests DSYMV, DSBMV and DSPMV.}
00777 \textcolor{comment}{*}
00778 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00779 \textcolor{comment}{*}
00780 \textcolor{comment}{*  -- Written on 10-August-1987.}
00781 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00782 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00783 \textcolor{comment}{*}
00784 \textcolor{comment}{*     .. Parameters ..}
00785       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half
00786       parameter( zero = 0.0d0, half = 0.5d0 )
00787 \textcolor{comment}{*     .. Scalar Arguments ..}
00788       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
00789       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00790      $                   nout, ntra
00791       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00792       \textcolor{keywordtype}{CHARACTER*6}        sname
00793 \textcolor{comment}{*     .. Array Arguments ..}
00794       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00795      $                   as( nmax*nmax ), bet( nbet ), g( nmax ),
00796      $                   x( nmax ), xs( nmax*incmax ),
00797      $                   xx( nmax*incmax ), y( nmax ),
00798      $                   ys( nmax*incmax ), yt( nmax ),
00799      $                   yy( nmax*incmax )
00800       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00801 \textcolor{comment}{*     .. Local Scalars ..}
00802       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, beta, bls, err, errmax, transl
00803       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, ik, in, incx, incxs, incy,
00804      $                   incys, ix, iy, k, ks, laa, lda, ldas, lx, ly,
00805      $                   n, nargs, nc, nk, ns
00806       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
00807       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
00808       \textcolor{keywordtype}{CHARACTER*2}        ich
00809 \textcolor{comment}{*     .. Local Arrays ..}
00810       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00811 \textcolor{comment}{*     .. External Functions ..}
00812       \textcolor{keywordtype}{LOGICAL}            lde, lderes
00813       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
00814 \textcolor{comment}{*     .. External Subroutines ..}
00815       \textcolor{keywordtype}{EXTERNAL}           dmake, dmvch, dsbmv, dspmv, dsymv
00816 \textcolor{comment}{*     .. Intrinsic Functions ..}
00817       \textcolor{keywordtype}{INTRINSIC}          abs, max
00818 \textcolor{comment}{*     .. Scalars in Common ..}
00819       \textcolor{keywordtype}{INTEGER}            infot, noutc
00820       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00821 \textcolor{comment}{*     .. Common blocks ..}
00822       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00823 \textcolor{comment}{*     .. Data statements ..}
00824       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
00825 \textcolor{comment}{*     .. Executable Statements ..}
00826       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'Y'}
00827       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00828       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
00829 \textcolor{comment}{*     Define the number of arguments.}
00830       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00831          nargs = 10
00832       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00833          nargs = 11
00834       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00835          nargs = 9
00836 \textcolor{keywordflow}{      END IF}
00837 \textcolor{comment}{*}
00838       nc = 0
00839       reset = .true.
00840       errmax = zero
00841 \textcolor{comment}{*}
00842       \textcolor{keywordflow}{DO} 110 in = 1, nidim
00843          n = idim( in )
00844 \textcolor{comment}{*}
00845          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00846             nk = nkb
00847          \textcolor{keywordflow}{ELSE}
00848             nk = 1
00849 \textcolor{keywordflow}{         END IF}
00850          \textcolor{keywordflow}{DO} 100 ik = 1, nk
00851             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00852                k = kb( ik )
00853             \textcolor{keywordflow}{ELSE}
00854                k = n - 1
00855 \textcolor{keywordflow}{            END IF}
00856 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
00857             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00858                lda = k + 1
00859             \textcolor{keywordflow}{ELSE}
00860                lda = n
00861 \textcolor{keywordflow}{            END IF}
00862             \textcolor{keywordflow}{IF}( lda.LT.nmax )
00863      $         lda = lda + 1
00864 \textcolor{comment}{*           Skip tests if not enough room.}
00865             \textcolor{keywordflow}{IF}( lda.GT.nmax )
00866      $         \textcolor{keywordflow}{GO TO} 100
00867             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00868                laa = ( n*( n + 1 ) )/2
00869             \textcolor{keywordflow}{ELSE}
00870                laa = lda*n
00871 \textcolor{keywordflow}{            END IF}
00872             null = n.LE.0
00873 \textcolor{comment}{*}
00874             \textcolor{keywordflow}{DO} 90 ic = 1, 2
00875                uplo = ich( ic: ic )
00876 \textcolor{comment}{*}
00877 \textcolor{comment}{*              Generate the matrix A.}
00878 \textcolor{comment}{*}
00879                transl = zero
00880                \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax, aa,
00881      $                     lda, k, k, reset, transl )
00882 \textcolor{comment}{*}
00883                \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00884                   incx = inc( ix )
00885                   lx = abs( incx )*n
00886 \textcolor{comment}{*}
00887 \textcolor{comment}{*                 Generate the vector X.}
00888 \textcolor{comment}{*}
00889                   transl = half
00890                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
00891      $                        abs( incx ), 0, n - 1, reset, transl )
00892                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
00893                      x( n/2 ) = zero
00894                      xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
00895 \textcolor{keywordflow}{                  END IF}
00896 \textcolor{comment}{*}
00897                   \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00898                      incy = inc( iy )
00899                      ly = abs( incy )*n
00900 \textcolor{comment}{*}
00901                      \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00902                         alpha = alf( ia )
00903 \textcolor{comment}{*}
00904                         \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00905                            beta = bet( ib )
00906 \textcolor{comment}{*}
00907 \textcolor{comment}{*                          Generate the vector Y.}
00908 \textcolor{comment}{*}
00909                            transl = zero
00910                            \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
00911      $                                 abs( incy ), 0, n - 1, reset,
00912      $                                 transl )
00913 \textcolor{comment}{*}
00914                            nc = nc + 1
00915 \textcolor{comment}{*}
00916 \textcolor{comment}{*                          Save every datum before calling the}
00917 \textcolor{comment}{*                          subroutine.}
00918 \textcolor{comment}{*}
00919                            uplos = uplo
00920                            ns = n
00921                            ks = k
00922                            als = alpha
00923                            \textcolor{keywordflow}{DO} 10 i = 1, laa
00924                               as( i ) = aa( i )
00925    10                      \textcolor{keywordflow}{CONTINUE}
00926                            ldas = lda
00927                            \textcolor{keywordflow}{DO} 20 i = 1, lx
00928                               xs( i ) = xx( i )
00929    20                      \textcolor{keywordflow}{CONTINUE}
00930                            incxs = incx
00931                            bls = beta
00932                            \textcolor{keywordflow}{DO} 30 i = 1, ly
00933                               ys( i ) = yy( i )
00934    30                      \textcolor{keywordflow}{CONTINUE}
00935                            incys = incy
00936 \textcolor{comment}{*}
00937 \textcolor{comment}{*                          Call the subroutine.}
00938 \textcolor{comment}{*}
00939                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00940                               \textcolor{keywordflow}{IF}( trace )
00941      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
00942      $                           uplo, n, alpha, lda, incx, beta, incy
00943                               \textcolor{keywordflow}{IF}( rewi )
00944      $                           rewind ntra
00945                               \textcolor{keyword}{CALL }dsymv( uplo, n, alpha, aa, lda, xx,
00946      $                                    incx, beta, yy, incy )
00947                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00948                               \textcolor{keywordflow}{IF}( trace )
00949      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00950      $                           uplo, n, k, alpha, lda, incx, beta,
00951      $                           incy
00952                               \textcolor{keywordflow}{IF}( rewi )
00953      $                           rewind ntra
00954                               \textcolor{keyword}{CALL }dsbmv( uplo, n, k, alpha, aa, lda,
00955      $                                    xx, incx, beta, yy, incy )
00956                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00957                               \textcolor{keywordflow}{IF}( trace )
00958      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00959      $                           uplo, n, alpha, incx, beta, incy
00960                               \textcolor{keywordflow}{IF}( rewi )
00961      $                           rewind ntra
00962                               \textcolor{keyword}{CALL }dspmv( uplo, n, alpha, aa, xx, incx,
00963      $                                    beta, yy, incy )
00964 \textcolor{keywordflow}{                           END IF}
00965 \textcolor{comment}{*}
00966 \textcolor{comment}{*                          Check if error-exit was taken incorrectly.}
00967 \textcolor{comment}{*}
00968                            \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00969                               \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
00970                               fatal = .true.
00971                               \textcolor{keywordflow}{GO TO} 120
00972 \textcolor{keywordflow}{                           END IF}
00973 \textcolor{comment}{*}
00974 \textcolor{comment}{*                          See what data changed inside subroutines.}
00975 \textcolor{comment}{*}
00976                            isame( 1 ) = uplo.EQ.uplos
00977                            isame( 2 ) = ns.EQ.n
00978                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00979                               isame( 3 ) = als.EQ.alpha
00980                               isame( 4 ) = lde( as, aa, laa )
00981                               isame( 5 ) = ldas.EQ.lda
00982                               isame( 6 ) = lde( xs, xx, lx )
00983                               isame( 7 ) = incxs.EQ.incx
00984                               isame( 8 ) = bls.EQ.beta
00985                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00986                                  isame( 9 ) = lde( ys, yy, ly )
00987                               \textcolor{keywordflow}{ELSE}
00988                                  isame( 9 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
00989      $                                        ys, yy, abs( incy ) )
00990 \textcolor{keywordflow}{                              END IF}
00991                               isame( 10 ) = incys.EQ.incy
00992                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00993                               isame( 3 ) = ks.EQ.k
00994                               isame( 4 ) = als.EQ.alpha
00995                               isame( 5 ) = lde( as, aa, laa )
00996                               isame( 6 ) = ldas.EQ.lda
00997                               isame( 7 ) = lde( xs, xx, lx )
00998                               isame( 8 ) = incxs.EQ.incx
00999                               isame( 9 ) = bls.EQ.beta
01000                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01001                                  isame( 10 ) = lde( ys, yy, ly )
01002                               \textcolor{keywordflow}{ELSE}
01003                                  isame( 10 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01004      $                                         ys, yy, abs( incy ) )
01005 \textcolor{keywordflow}{                              END IF}
01006                               isame( 11 ) = incys.EQ.incy
01007                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01008                               isame( 3 ) = als.EQ.alpha
01009                               isame( 4 ) = lde( as, aa, laa )
01010                               isame( 5 ) = lde( xs, xx, lx )
01011                               isame( 6 ) = incxs.EQ.incx
01012                               isame( 7 ) = bls.EQ.beta
01013                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01014                                  isame( 8 ) = lde( ys, yy, ly )
01015                               \textcolor{keywordflow}{ELSE}
01016                                  isame( 8 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01017      $                                        ys, yy, abs( incy ) )
01018 \textcolor{keywordflow}{                              END IF}
01019                               isame( 9 ) = incys.EQ.incy
01020 \textcolor{keywordflow}{                           END IF}
01021 \textcolor{comment}{*}
01022 \textcolor{comment}{*                          If data was incorrectly changed, report and}
01023 \textcolor{comment}{*                          return.}
01024 \textcolor{comment}{*}
01025                            same = .true.
01026                            \textcolor{keywordflow}{DO} 40 i = 1, nargs
01027                               same = same.AND.isame( i )
01028                               \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01029      $                           \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01030    40                      \textcolor{keywordflow}{CONTINUE}
01031                            \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01032                               fatal = .true.
01033                               \textcolor{keywordflow}{GO TO} 120
01034 \textcolor{keywordflow}{                           END IF}
01035 \textcolor{comment}{*}
01036                            \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01037 \textcolor{comment}{*}
01038 \textcolor{comment}{*                             Check the result.}
01039 \textcolor{comment}{*}
01040                               \textcolor{keyword}{CALL }dmvch( \textcolor{stringliteral}{'N'}, n, n, alpha, a, nmax, x,
01041      $                                    incx, beta, y, incy, yt, g,
01042      $                                    yy, eps, err, fatal, nout,
01043      $                                    .true. )
01044                               errmax = max( errmax, err )
01045 \textcolor{comment}{*                             If got really bad answer, report and}
01046 \textcolor{comment}{*                             return.}
01047                               \textcolor{keywordflow}{IF}( fatal )
01048      $                           \textcolor{keywordflow}{GO TO} 120
01049                            \textcolor{keywordflow}{ELSE}
01050 \textcolor{comment}{*                             Avoid repeating tests with N.le.0}
01051                               \textcolor{keywordflow}{GO TO} 110
01052 \textcolor{keywordflow}{                           END IF}
01053 \textcolor{comment}{*}
01054    50                   \textcolor{keywordflow}{CONTINUE}
01055 \textcolor{comment}{*}
01056    60                \textcolor{keywordflow}{CONTINUE}
01057 \textcolor{comment}{*}
01058    70             \textcolor{keywordflow}{CONTINUE}
01059 \textcolor{comment}{*}
01060    80          \textcolor{keywordflow}{CONTINUE}
01061 \textcolor{comment}{*}
01062    90       \textcolor{keywordflow}{CONTINUE}
01063 \textcolor{comment}{*}
01064   100    \textcolor{keywordflow}{CONTINUE}
01065 \textcolor{comment}{*}
01066   110 \textcolor{keywordflow}{CONTINUE}
01067 \textcolor{comment}{*}
01068 \textcolor{comment}{*     Report result.}
01069 \textcolor{comment}{*}
01070       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01071          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01072       \textcolor{keywordflow}{ELSE}
01073          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01074 \textcolor{keywordflow}{      END IF}
01075       \textcolor{keywordflow}{GO TO} 130
01076 \textcolor{comment}{*}
01077   120 \textcolor{keywordflow}{CONTINUE}
01078       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01079       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01080          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, lda, incx,
01081      $      beta, incy
01082       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01083          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, k, alpha, lda,
01084      $      incx, beta, incy
01085       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01086          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, n, alpha, incx,
01087      $      beta, incy
01088 \textcolor{keywordflow}{      END IF}
01089 \textcolor{comment}{*}
01090   130 \textcolor{keywordflow}{CONTINUE}
01091       \textcolor{keywordflow}{RETURN}
01092 \textcolor{comment}{*}
01093  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01094      $      \textcolor{stringliteral}{'S)'} )
01095  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01096      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01097  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01098      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01099      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01100  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01101  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', AP'},
01102      $      \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{')                .'} )
01103  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), f4.1,
01104      $      \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', Y,'}, i2,
01105      $      \textcolor{stringliteral}{')         .'} )
01106  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', A,'},
01107      $      i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{')             .'} )
01108  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01109      $      \textcolor{stringliteral}{'******'} )
01110 \textcolor{comment}{*}
01111 \textcolor{comment}{*     End of DCHK2.}
01112 \textcolor{comment}{*}
01113 \textcolor{keyword}{      END}
01114 \textcolor{keyword}{      SUBROUTINE }dchk3( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01115      $                  FATAL, NIDIM, IDIM, NKB, KB, NINC, INC, NMAX,
01116      $                  INCMAX, A, AA, AS, X, XX, XS, XT, G, Z )
01117 \textcolor{comment}{*}
01118 \textcolor{comment}{*  Tests DTRMV, DTBMV, DTPMV, DTRSV, DTBSV and DTPSV.}
01119 \textcolor{comment}{*}
01120 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01121 \textcolor{comment}{*}
01122 \textcolor{comment}{*  -- Written on 10-August-1987.}
01123 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01124 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01125 \textcolor{comment}{*}
01126 \textcolor{comment}{*     .. Parameters ..}
01127       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half, one
01128       parameter( zero = 0.0d0, half = 0.5d0, one = 1.0d0 )
01129 \textcolor{comment}{*     .. Scalar Arguments ..}
01130       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01131       \textcolor{keywordtype}{INTEGER}            incmax, nidim, ninc, nkb, nmax, nout, ntra
01132       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01133       \textcolor{keywordtype}{CHARACTER*6}        sname
01134 \textcolor{comment}{*     .. Array Arguments ..}
01135       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ),
01136      $                   as( nmax*nmax ), g( nmax ), x( nmax ),
01137      $                   xs( nmax*incmax ), xt( nmax ),
01138      $                   xx( nmax*incmax ), z( nmax )
01139       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
01140 \textcolor{comment}{*     .. Local Scalars ..}
01141       \textcolor{keywordtype}{DOUBLE PRECISION}   err, errmax, transl
01142       \textcolor{keywordtype}{INTEGER}            i, icd, ict, icu, ik, in, incx, incxs, ix, k,
01143      $                   ks, laa, lda, ldas, lx, n, nargs, nc, nk, ns
01144       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
01145       \textcolor{keywordtype}{CHARACTER*1}        diag, diags, trans, transs, uplo, uplos
01146       \textcolor{keywordtype}{CHARACTER*2}        ichd, ichu
01147       \textcolor{keywordtype}{CHARACTER*3}        icht
01148 \textcolor{comment}{*     .. Local Arrays ..}
01149       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01150 \textcolor{comment}{*     .. External Functions ..}
01151       \textcolor{keywordtype}{LOGICAL}            lde, lderes
01152       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
01153 \textcolor{comment}{*     .. External Subroutines ..}
01154       \textcolor{keywordtype}{EXTERNAL}           dmake, dmvch, dtbmv, dtbsv, dtpmv, dtpsv,
01155      $                   dtrmv, dtrsv
01156 \textcolor{comment}{*     .. Intrinsic Functions ..}
01157       \textcolor{keywordtype}{INTRINSIC}          abs, max
01158 \textcolor{comment}{*     .. Scalars in Common ..}
01159       \textcolor{keywordtype}{INTEGER}            infot, noutc
01160       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01161 \textcolor{comment}{*     .. Common blocks ..}
01162       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01163 \textcolor{comment}{*     .. Data statements ..}
01164       \textcolor{keyword}{DATA}               ichu/\textcolor{stringliteral}{'UL'}/, icht/\textcolor{stringliteral}{'NTC'}/, ichd/\textcolor{stringliteral}{'UN'}/
01165 \textcolor{comment}{*     .. Executable Statements ..}
01166       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'R'}
01167       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
01168       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01169 \textcolor{comment}{*     Define the number of arguments.}
01170       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01171          nargs = 8
01172       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01173          nargs = 9
01174       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01175          nargs = 7
01176 \textcolor{keywordflow}{      END IF}
01177 \textcolor{comment}{*}
01178       nc = 0
01179       reset = .true.
01180       errmax = zero
01181 \textcolor{comment}{*     Set up zero vector for DMVCH.}
01182       \textcolor{keywordflow}{DO} 10 i = 1, nmax
01183          z( i ) = zero
01184    10 \textcolor{keywordflow}{CONTINUE}
01185 \textcolor{comment}{*}
01186       \textcolor{keywordflow}{DO} 110 in = 1, nidim
01187          n = idim( in )
01188 \textcolor{comment}{*}
01189          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01190             nk = nkb
01191          \textcolor{keywordflow}{ELSE}
01192             nk = 1
01193 \textcolor{keywordflow}{         END IF}
01194          \textcolor{keywordflow}{DO} 100 ik = 1, nk
01195             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01196                k = kb( ik )
01197             \textcolor{keywordflow}{ELSE}
01198                k = n - 1
01199 \textcolor{keywordflow}{            END IF}
01200 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01201             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01202                lda = k + 1
01203             \textcolor{keywordflow}{ELSE}
01204                lda = n
01205 \textcolor{keywordflow}{            END IF}
01206             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01207      $         lda = lda + 1
01208 \textcolor{comment}{*           Skip tests if not enough room.}
01209             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01210      $         \textcolor{keywordflow}{GO TO} 100
01211             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01212                laa = ( n*( n + 1 ) )/2
01213             \textcolor{keywordflow}{ELSE}
01214                laa = lda*n
01215 \textcolor{keywordflow}{            END IF}
01216             null = n.LE.0
01217 \textcolor{comment}{*}
01218             \textcolor{keywordflow}{DO} 90 icu = 1, 2
01219                uplo = ichu( icu: icu )
01220 \textcolor{comment}{*}
01221                \textcolor{keywordflow}{DO} 80 ict = 1, 3
01222                   trans = icht( ict: ict )
01223 \textcolor{comment}{*}
01224                   \textcolor{keywordflow}{DO} 70 icd = 1, 2
01225                      diag = ichd( icd: icd )
01226 \textcolor{comment}{*}
01227 \textcolor{comment}{*                    Generate the matrix A.}
01228 \textcolor{comment}{*}
01229                      transl = zero
01230                      \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), uplo, diag, n, n, a,
01231      $                           nmax, aa, lda, k, k, reset, transl )
01232 \textcolor{comment}{*}
01233                      \textcolor{keywordflow}{DO} 60 ix = 1, ninc
01234                         incx = inc( ix )
01235                         lx = abs( incx )*n
01236 \textcolor{comment}{*}
01237 \textcolor{comment}{*                       Generate the vector X.}
01238 \textcolor{comment}{*}
01239                         transl = half
01240                         \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
01241      $                              abs( incx ), 0, n - 1, reset,
01242      $                              transl )
01243                         \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01244                            x( n/2 ) = zero
01245                            xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01246 \textcolor{keywordflow}{                        END IF}
01247 \textcolor{comment}{*}
01248                         nc = nc + 1
01249 \textcolor{comment}{*}
01250 \textcolor{comment}{*                       Save every datum before calling the subroutine.}
01251 \textcolor{comment}{*}
01252                         uplos = uplo
01253                         transs = trans
01254                         diags = diag
01255                         ns = n
01256                         ks = k
01257                         \textcolor{keywordflow}{DO} 20 i = 1, laa
01258                            as( i ) = aa( i )
01259    20                   \textcolor{keywordflow}{CONTINUE}
01260                         ldas = lda
01261                         \textcolor{keywordflow}{DO} 30 i = 1, lx
01262                            xs( i ) = xx( i )
01263    30                   \textcolor{keywordflow}{CONTINUE}
01264                         incxs = incx
01265 \textcolor{comment}{*}
01266 \textcolor{comment}{*                       Call the subroutine.}
01267 \textcolor{comment}{*}
01268                         \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01269                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01270                               \textcolor{keywordflow}{IF}( trace )
01271      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01272      $                           uplo, trans, diag, n, lda, incx
01273                               \textcolor{keywordflow}{IF}( rewi )
01274      $                           rewind ntra
01275                               \textcolor{keyword}{CALL }dtrmv( uplo, trans, diag, n, aa, lda,
01276      $                                    xx, incx )
01277                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01278                               \textcolor{keywordflow}{IF}( trace )
01279      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01280      $                           uplo, trans, diag, n, k, lda, incx
01281                               \textcolor{keywordflow}{IF}( rewi )
01282      $                           rewind ntra
01283                               \textcolor{keyword}{CALL }dtbmv( uplo, trans, diag, n, k, aa,
01284      $                                    lda, xx, incx )
01285                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01286                               \textcolor{keywordflow}{IF}( trace )
01287      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01288      $                           uplo, trans, diag, n, incx
01289                               \textcolor{keywordflow}{IF}( rewi )
01290      $                           rewind ntra
01291                               \textcolor{keyword}{CALL }dtpmv( uplo, trans, diag, n, aa, xx,
01292      $                                    incx )
01293 \textcolor{keywordflow}{                           END IF}
01294                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01295                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01296                               \textcolor{keywordflow}{IF}( trace )
01297      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01298      $                           uplo, trans, diag, n, lda, incx
01299                               \textcolor{keywordflow}{IF}( rewi )
01300      $                           rewind ntra
01301                               \textcolor{keyword}{CALL }dtrsv( uplo, trans, diag, n, aa, lda,
01302      $                                    xx, incx )
01303                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01304                               \textcolor{keywordflow}{IF}( trace )
01305      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01306      $                           uplo, trans, diag, n, k, lda, incx
01307                               \textcolor{keywordflow}{IF}( rewi )
01308      $                           rewind ntra
01309                               \textcolor{keyword}{CALL }dtbsv( uplo, trans, diag, n, k, aa,
01310      $                                    lda, xx, incx )
01311                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01312                               \textcolor{keywordflow}{IF}( trace )
01313      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01314      $                           uplo, trans, diag, n, incx
01315                               \textcolor{keywordflow}{IF}( rewi )
01316      $                           rewind ntra
01317                               \textcolor{keyword}{CALL }dtpsv( uplo, trans, diag, n, aa, xx,
01318      $                                    incx )
01319 \textcolor{keywordflow}{                           END IF}
01320 \textcolor{keywordflow}{                        END IF}
01321 \textcolor{comment}{*}
01322 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
01323 \textcolor{comment}{*}
01324                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01325                            \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01326                            fatal = .true.
01327                            \textcolor{keywordflow}{GO TO} 120
01328 \textcolor{keywordflow}{                        END IF}
01329 \textcolor{comment}{*}
01330 \textcolor{comment}{*                       See what data changed inside subroutines.}
01331 \textcolor{comment}{*}
01332                         isame( 1 ) = uplo.EQ.uplos
01333                         isame( 2 ) = trans.EQ.transs
01334                         isame( 3 ) = diag.EQ.diags
01335                         isame( 4 ) = ns.EQ.n
01336                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01337                            isame( 5 ) = lde( as, aa, laa )
01338                            isame( 6 ) = ldas.EQ.lda
01339                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01340                               isame( 7 ) = lde( xs, xx, lx )
01341                            \textcolor{keywordflow}{ELSE}
01342                               isame( 7 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01343      $                                     xx, abs( incx ) )
01344 \textcolor{keywordflow}{                           END IF}
01345                            isame( 8 ) = incxs.EQ.incx
01346                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01347                            isame( 5 ) = ks.EQ.k
01348                            isame( 6 ) = lde( as, aa, laa )
01349                            isame( 7 ) = ldas.EQ.lda
01350                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01351                               isame( 8 ) = lde( xs, xx, lx )
01352                            \textcolor{keywordflow}{ELSE}
01353                               isame( 8 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01354      $                                     xx, abs( incx ) )
01355 \textcolor{keywordflow}{                           END IF}
01356                            isame( 9 ) = incxs.EQ.incx
01357                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01358                            isame( 5 ) = lde( as, aa, laa )
01359                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01360                               isame( 6 ) = lde( xs, xx, lx )
01361                            \textcolor{keywordflow}{ELSE}
01362                               isame( 6 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01363      $                                     xx, abs( incx ) )
01364 \textcolor{keywordflow}{                           END IF}
01365                            isame( 7 ) = incxs.EQ.incx
01366 \textcolor{keywordflow}{                        END IF}
01367 \textcolor{comment}{*}
01368 \textcolor{comment}{*                       If data was incorrectly changed, report and}
01369 \textcolor{comment}{*                       return.}
01370 \textcolor{comment}{*}
01371                         same = .true.
01372                         \textcolor{keywordflow}{DO} 40 i = 1, nargs
01373                            same = same.AND.isame( i )
01374                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01375      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01376    40                   \textcolor{keywordflow}{CONTINUE}
01377                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01378                            fatal = .true.
01379                            \textcolor{keywordflow}{GO TO} 120
01380 \textcolor{keywordflow}{                        END IF}
01381 \textcolor{comment}{*}
01382                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01383                            \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01384 \textcolor{comment}{*}
01385 \textcolor{comment}{*                             Check the result.}
01386 \textcolor{comment}{*}
01387                               \textcolor{keyword}{CALL }dmvch( trans, n, n, one, a, nmax, x,
01388      $                                    incx, zero, z, incx, xt, g,
01389      $                                    xx, eps, err, fatal, nout,
01390      $                                    .true. )
01391                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01392 \textcolor{comment}{*}
01393 \textcolor{comment}{*                             Compute approximation to original vector.}
01394 \textcolor{comment}{*}
01395                               \textcolor{keywordflow}{DO} 50 i = 1, n
01396                                  z( i ) = xx( 1 + ( i - 1 )*
01397      $                                    abs( incx ) )
01398                                  xx( 1 + ( i - 1 )*abs( incx ) )
01399      $                              = x( i )
01400    50                         \textcolor{keywordflow}{CONTINUE}
01401                               \textcolor{keyword}{CALL }dmvch( trans, n, n, one, a, nmax, z,
01402      $                                    incx, zero, x, incx, xt, g,
01403      $                                    xx, eps, err, fatal, nout,
01404      $                                    .false. )
01405 \textcolor{keywordflow}{                           END IF}
01406                            errmax = max( errmax, err )
01407 \textcolor{comment}{*                          If got really bad answer, report and return.}
01408                            \textcolor{keywordflow}{IF}( fatal )
01409      $                        \textcolor{keywordflow}{GO TO} 120
01410                         \textcolor{keywordflow}{ELSE}
01411 \textcolor{comment}{*                          Avoid repeating tests with N.le.0.}
01412                            \textcolor{keywordflow}{GO TO} 110
01413 \textcolor{keywordflow}{                        END IF}
01414 \textcolor{comment}{*}
01415    60                \textcolor{keywordflow}{CONTINUE}
01416 \textcolor{comment}{*}
01417    70             \textcolor{keywordflow}{CONTINUE}
01418 \textcolor{comment}{*}
01419    80          \textcolor{keywordflow}{CONTINUE}
01420 \textcolor{comment}{*}
01421    90       \textcolor{keywordflow}{CONTINUE}
01422 \textcolor{comment}{*}
01423   100    \textcolor{keywordflow}{CONTINUE}
01424 \textcolor{comment}{*}
01425   110 \textcolor{keywordflow}{CONTINUE}
01426 \textcolor{comment}{*}
01427 \textcolor{comment}{*     Report result.}
01428 \textcolor{comment}{*}
01429       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01430          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01431       \textcolor{keywordflow}{ELSE}
01432          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01433 \textcolor{keywordflow}{      END IF}
01434       \textcolor{keywordflow}{GO TO} 130
01435 \textcolor{comment}{*}
01436   120 \textcolor{keywordflow}{CONTINUE}
01437       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01438       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01439          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, trans, diag, n, lda,
01440      $      incx
01441       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01442          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, trans, diag, n, k,
01443      $      lda, incx
01444       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01445          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, trans, diag, n, incx
01446 \textcolor{keywordflow}{      END IF}
01447 \textcolor{comment}{*}
01448   130 \textcolor{keywordflow}{CONTINUE}
01449       \textcolor{keywordflow}{RETURN}
01450 \textcolor{comment}{*}
01451  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01452      $      \textcolor{stringliteral}{'S)'} )
01453  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01454      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01455  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01456      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01457      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01458  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01459  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', AP, '},
01460      $      \textcolor{stringliteral}{'X,'}, i2, \textcolor{stringliteral}{')                        .'} )
01461  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01462      $      \textcolor{stringliteral}{' A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                 .'} )
01463  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', A,'},
01464      $      i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                     .'} )
01465  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01466      $      \textcolor{stringliteral}{'******'} )
01467 \textcolor{comment}{*}
01468 \textcolor{comment}{*     End of DCHK3.}
01469 \textcolor{comment}{*}
01470 \textcolor{keyword}{      END}
01471 \textcolor{keyword}{      SUBROUTINE }dchk4( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01472      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01473      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01474      $                  Z )
01475 \textcolor{comment}{*}
01476 \textcolor{comment}{*  Tests DGER.}
01477 \textcolor{comment}{*}
01478 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01479 \textcolor{comment}{*}
01480 \textcolor{comment}{*  -- Written on 10-August-1987.}
01481 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01482 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01483 \textcolor{comment}{*}
01484 \textcolor{comment}{*     .. Parameters ..}
01485       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half, one
01486       parameter( zero = 0.0d0, half = 0.5d0, one = 1.0d0 )
01487 \textcolor{comment}{*     .. Scalar Arguments ..}
01488       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01489       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01490       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01491       \textcolor{keywordtype}{CHARACTER*6}        sname
01492 \textcolor{comment}{*     .. Array Arguments ..}
01493       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01494      $                   as( nmax*nmax ), g( nmax ), x( nmax ),
01495      $                   xs( nmax*incmax ), xx( nmax*incmax ),
01496      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
01497      $                   yy( nmax*incmax ), z( nmax )
01498       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01499 \textcolor{comment}{*     .. Local Scalars ..}
01500       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, err, errmax, transl
01501       \textcolor{keywordtype}{INTEGER}            i, ia, im, in, incx, incxs, incy, incys, ix,
01502      $                   iy, j, laa, lda, ldas, lx, ly, m, ms, n, nargs,
01503      $                   nc, nd, ns
01504       \textcolor{keywordtype}{LOGICAL}            null, reset, same
01505 \textcolor{comment}{*     .. Local Arrays ..}
01506       \textcolor{keywordtype}{DOUBLE PRECISION}   w( 1 )
01507       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01508 \textcolor{comment}{*     .. External Functions ..}
01509       \textcolor{keywordtype}{LOGICAL}            lde, lderes
01510       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
01511 \textcolor{comment}{*     .. External Subroutines ..}
01512       \textcolor{keywordtype}{EXTERNAL}           dger, dmake, dmvch
01513 \textcolor{comment}{*     .. Intrinsic Functions ..}
01514       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
01515 \textcolor{comment}{*     .. Scalars in Common ..}
01516       \textcolor{keywordtype}{INTEGER}            infot, noutc
01517       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01518 \textcolor{comment}{*     .. Common blocks ..}
01519       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01520 \textcolor{comment}{*     .. Executable Statements ..}
01521 \textcolor{comment}{*     Define the number of arguments.}
01522       nargs = 9
01523 \textcolor{comment}{*}
01524       nc = 0
01525       reset = .true.
01526       errmax = zero
01527 \textcolor{comment}{*}
01528       \textcolor{keywordflow}{DO} 120 in = 1, nidim
01529          n = idim( in )
01530          nd = n/2 + 1
01531 \textcolor{comment}{*}
01532          \textcolor{keywordflow}{DO} 110 im = 1, 2
01533             \textcolor{keywordflow}{IF}( im.EQ.1 )
01534      $         m = max( n - nd, 0 )
01535             \textcolor{keywordflow}{IF}( im.EQ.2 )
01536      $         m = min( n + nd, nmax )
01537 \textcolor{comment}{*}
01538 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01539             lda = m
01540             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01541      $         lda = lda + 1
01542 \textcolor{comment}{*           Skip tests if not enough room.}
01543             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01544      $         \textcolor{keywordflow}{GO TO} 110
01545             laa = lda*n
01546             null = n.LE.0.OR.m.LE.0
01547 \textcolor{comment}{*}
01548             \textcolor{keywordflow}{DO} 100 ix = 1, ninc
01549                incx = inc( ix )
01550                lx = abs( incx )*m
01551 \textcolor{comment}{*}
01552 \textcolor{comment}{*              Generate the vector X.}
01553 \textcolor{comment}{*}
01554                transl = half
01555                \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, m, x, 1, xx, abs( incx ),
01556      $                     0, m - 1, reset, transl )
01557                \textcolor{keywordflow}{IF}( m.GT.1 )\textcolor{keywordflow}{THEN}
01558                   x( m/2 ) = zero
01559                   xx( 1 + abs( incx )*( m/2 - 1 ) ) = zero
01560 \textcolor{keywordflow}{               END IF}
01561 \textcolor{comment}{*}
01562                \textcolor{keywordflow}{DO} 90 iy = 1, ninc
01563                   incy = inc( iy )
01564                   ly = abs( incy )*n
01565 \textcolor{comment}{*}
01566 \textcolor{comment}{*                 Generate the vector Y.}
01567 \textcolor{comment}{*}
01568                   transl = zero
01569                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
01570      $                        abs( incy ), 0, n - 1, reset, transl )
01571                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01572                      y( n/2 ) = zero
01573                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
01574 \textcolor{keywordflow}{                  END IF}
01575 \textcolor{comment}{*}
01576                   \textcolor{keywordflow}{DO} 80 ia = 1, nalf
01577                      alpha = alf( ia )
01578 \textcolor{comment}{*}
01579 \textcolor{comment}{*                    Generate the matrix A.}
01580 \textcolor{comment}{*}
01581                      transl = zero
01582                      \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax,
01583      $                           aa, lda, m - 1, n - 1, reset, transl )
01584 \textcolor{comment}{*}
01585                      nc = nc + 1
01586 \textcolor{comment}{*}
01587 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
01588 \textcolor{comment}{*}
01589                      ms = m
01590                      ns = n
01591                      als = alpha
01592                      \textcolor{keywordflow}{DO} 10 i = 1, laa
01593                         as( i ) = aa( i )
01594    10                \textcolor{keywordflow}{CONTINUE}
01595                      ldas = lda
01596                      \textcolor{keywordflow}{DO} 20 i = 1, lx
01597                         xs( i ) = xx( i )
01598    20                \textcolor{keywordflow}{CONTINUE}
01599                      incxs = incx
01600                      \textcolor{keywordflow}{DO} 30 i = 1, ly
01601                         ys( i ) = yy( i )
01602    30                \textcolor{keywordflow}{CONTINUE}
01603                      incys = incy
01604 \textcolor{comment}{*}
01605 \textcolor{comment}{*                    Call the subroutine.}
01606 \textcolor{comment}{*}
01607                      \textcolor{keywordflow}{IF}( trace )
01608      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, m, n,
01609      $                  alpha, incx, incy, lda
01610                      \textcolor{keywordflow}{IF}( rewi )
01611      $                  rewind ntra
01612                      \textcolor{keyword}{CALL }dger( m, n, alpha, xx, incx, yy, incy, aa,
01613      $                          lda )
01614 \textcolor{comment}{*}
01615 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
01616 \textcolor{comment}{*}
01617                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01618                         \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
01619                         fatal = .true.
01620                         \textcolor{keywordflow}{GO TO} 140
01621 \textcolor{keywordflow}{                     END IF}
01622 \textcolor{comment}{*}
01623 \textcolor{comment}{*                    See what data changed inside subroutine.}
01624 \textcolor{comment}{*}
01625                      isame( 1 ) = ms.EQ.m
01626                      isame( 2 ) = ns.EQ.n
01627                      isame( 3 ) = als.EQ.alpha
01628                      isame( 4 ) = lde( xs, xx, lx )
01629                      isame( 5 ) = incxs.EQ.incx
01630                      isame( 6 ) = lde( ys, yy, ly )
01631                      isame( 7 ) = incys.EQ.incy
01632                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01633                         isame( 8 ) = lde( as, aa, laa )
01634                      \textcolor{keywordflow}{ELSE}
01635                         isame( 8 ) = lderes( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, as, aa,
01636      $                               lda )
01637 \textcolor{keywordflow}{                     END IF}
01638                      isame( 9 ) = ldas.EQ.lda
01639 \textcolor{comment}{*}
01640 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
01641 \textcolor{comment}{*}
01642                      same = .true.
01643                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
01644                         same = same.AND.isame( i )
01645                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01646      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01647    40                \textcolor{keywordflow}{CONTINUE}
01648                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01649                         fatal = .true.
01650                         \textcolor{keywordflow}{GO TO} 140
01651 \textcolor{keywordflow}{                     END IF}
01652 \textcolor{comment}{*}
01653                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01654 \textcolor{comment}{*}
01655 \textcolor{comment}{*                       Check the result column by column.}
01656 \textcolor{comment}{*}
01657                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01658                            \textcolor{keywordflow}{DO} 50 i = 1, m
01659                               z( i ) = x( i )
01660    50                      \textcolor{keywordflow}{CONTINUE}
01661                         \textcolor{keywordflow}{ELSE}
01662                            \textcolor{keywordflow}{DO} 60 i = 1, m
01663                               z( i ) = x( m - i + 1 )
01664    60                      \textcolor{keywordflow}{CONTINUE}
01665 \textcolor{keywordflow}{                        END IF}
01666                         \textcolor{keywordflow}{DO} 70 j = 1, n
01667                            \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
01668                               w( 1 ) = y( j )
01669                            \textcolor{keywordflow}{ELSE}
01670                               w( 1 ) = y( n - j + 1 )
01671 \textcolor{keywordflow}{                           END IF}
01672                            \textcolor{keyword}{CALL }dmvch( \textcolor{stringliteral}{'N'}, m, 1, alpha, z, nmax, w, 1,
01673      $                                 one, a( 1, j ), 1, yt, g,
01674      $                                 aa( 1 + ( j - 1 )*lda ), eps,
01675      $                                 err, fatal, nout, .true. )
01676                            errmax = max( errmax, err )
01677 \textcolor{comment}{*                          If got really bad answer, report and return.}
01678                            \textcolor{keywordflow}{IF}( fatal )
01679      $                        \textcolor{keywordflow}{GO TO} 130
01680    70                   \textcolor{keywordflow}{CONTINUE}
01681                      \textcolor{keywordflow}{ELSE}
01682 \textcolor{comment}{*                       Avoid repeating tests with M.le.0 or N.le.0.}
01683                         \textcolor{keywordflow}{GO TO} 110
01684 \textcolor{keywordflow}{                     END IF}
01685 \textcolor{comment}{*}
01686    80             \textcolor{keywordflow}{CONTINUE}
01687 \textcolor{comment}{*}
01688    90          \textcolor{keywordflow}{CONTINUE}
01689 \textcolor{comment}{*}
01690   100       \textcolor{keywordflow}{CONTINUE}
01691 \textcolor{comment}{*}
01692   110    \textcolor{keywordflow}{CONTINUE}
01693 \textcolor{comment}{*}
01694   120 \textcolor{keywordflow}{CONTINUE}
01695 \textcolor{comment}{*}
01696 \textcolor{comment}{*     Report result.}
01697 \textcolor{comment}{*}
01698       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01699          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01700       \textcolor{keywordflow}{ELSE}
01701          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01702 \textcolor{keywordflow}{      END IF}
01703       \textcolor{keywordflow}{GO TO} 150
01704 \textcolor{comment}{*}
01705   130 \textcolor{keywordflow}{CONTINUE}
01706       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01707 \textcolor{comment}{*}
01708   140 \textcolor{keywordflow}{CONTINUE}
01709       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01710       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, m, n, alpha, incx, incy, lda
01711 \textcolor{comment}{*}
01712   150 \textcolor{keywordflow}{CONTINUE}
01713       \textcolor{keywordflow}{RETURN}
01714 \textcolor{comment}{*}
01715  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01716      $      \textcolor{stringliteral}{'S)'} )
01717  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01718      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01719  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01720      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01721      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01722  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01723  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
01724  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( i3, \textcolor{stringliteral}{','} ), f4.1, \textcolor{stringliteral}{', X,'}, i2,
01725      $      \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                  .'} )
01726  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01727      $      \textcolor{stringliteral}{'******'} )
01728 \textcolor{comment}{*}
01729 \textcolor{comment}{*     End of DCHK4.}
01730 \textcolor{comment}{*}
01731 \textcolor{keyword}{      END}
01732 \textcolor{keyword}{      SUBROUTINE }dchk5( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01733      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01734      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01735      $                  Z )
01736 \textcolor{comment}{*}
01737 \textcolor{comment}{*  Tests DSYR and DSPR.}
01738 \textcolor{comment}{*}
01739 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01740 \textcolor{comment}{*}
01741 \textcolor{comment}{*  -- Written on 10-August-1987.}
01742 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01743 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01744 \textcolor{comment}{*}
01745 \textcolor{comment}{*     .. Parameters ..}
01746       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half, one
01747       parameter( zero = 0.0d0, half = 0.5d0, one = 1.0d0 )
01748 \textcolor{comment}{*     .. Scalar Arguments ..}
01749       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
01750       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01751       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01752       \textcolor{keywordtype}{CHARACTER*6}        sname
01753 \textcolor{comment}{*     .. Array Arguments ..}
01754       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01755      $                   as( nmax*nmax ), g( nmax ), x( nmax ),
01756      $                   xs( nmax*incmax ), xx( nmax*incmax ),
01757      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
01758      $                   yy( nmax*incmax ), z( nmax )
01759       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01760 \textcolor{comment}{*     .. Local Scalars ..}
01761       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, err, errmax, transl
01762       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, ix, j, ja, jj, laa,
01763      $                   lda, ldas, lj, lx, n, nargs, nc, ns
01764       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
01765       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
01766       \textcolor{keywordtype}{CHARACTER*2}        ich
01767 \textcolor{comment}{*     .. Local Arrays ..}
01768       \textcolor{keywordtype}{DOUBLE PRECISION}   w( 1 )
01769       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01770 \textcolor{comment}{*     .. External Functions ..}
01771       \textcolor{keywordtype}{LOGICAL}            lde, lderes
01772       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
01773 \textcolor{comment}{*     .. External Subroutines ..}
01774       \textcolor{keywordtype}{EXTERNAL}           dmake, dmvch, dspr, dsyr
01775 \textcolor{comment}{*     .. Intrinsic Functions ..}
01776       \textcolor{keywordtype}{INTRINSIC}          abs, max
01777 \textcolor{comment}{*     .. Scalars in Common ..}
01778       \textcolor{keywordtype}{INTEGER}            infot, noutc
01779       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01780 \textcolor{comment}{*     .. Common blocks ..}
01781       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01782 \textcolor{comment}{*     .. Data statements ..}
01783       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
01784 \textcolor{comment}{*     .. Executable Statements ..}
01785       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'Y'}
01786       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01787 \textcolor{comment}{*     Define the number of arguments.}
01788       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01789          nargs = 7
01790       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01791          nargs = 6
01792 \textcolor{keywordflow}{      END IF}
01793 \textcolor{comment}{*}
01794       nc = 0
01795       reset = .true.
01796       errmax = zero
01797 \textcolor{comment}{*}
01798       \textcolor{keywordflow}{DO} 100 in = 1, nidim
01799          n = idim( in )
01800 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
01801          lda = n
01802          \textcolor{keywordflow}{IF}( lda.LT.nmax )
01803      $      lda = lda + 1
01804 \textcolor{comment}{*        Skip tests if not enough room.}
01805          \textcolor{keywordflow}{IF}( lda.GT.nmax )
01806      $      \textcolor{keywordflow}{GO TO} 100
01807          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01808             laa = ( n*( n + 1 ) )/2
01809          \textcolor{keywordflow}{ELSE}
01810             laa = lda*n
01811 \textcolor{keywordflow}{         END IF}
01812 \textcolor{comment}{*}
01813          \textcolor{keywordflow}{DO} 90 ic = 1, 2
01814             uplo = ich( ic: ic )
01815             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
01816 \textcolor{comment}{*}
01817             \textcolor{keywordflow}{DO} 80 ix = 1, ninc
01818                incx = inc( ix )
01819                lx = abs( incx )*n
01820 \textcolor{comment}{*}
01821 \textcolor{comment}{*              Generate the vector X.}
01822 \textcolor{comment}{*}
01823                transl = half
01824                \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
01825      $                     0, n - 1, reset, transl )
01826                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01827                   x( n/2 ) = zero
01828                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01829 \textcolor{keywordflow}{               END IF}
01830 \textcolor{comment}{*}
01831                \textcolor{keywordflow}{DO} 70 ia = 1, nalf
01832                   alpha = alf( ia )
01833                   null = n.LE.0.OR.alpha.EQ.zero
01834 \textcolor{comment}{*}
01835 \textcolor{comment}{*                 Generate the matrix A.}
01836 \textcolor{comment}{*}
01837                   transl = zero
01838                   \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax,
01839      $                        aa, lda, n - 1, n - 1, reset, transl )
01840 \textcolor{comment}{*}
01841                   nc = nc + 1
01842 \textcolor{comment}{*}
01843 \textcolor{comment}{*                 Save every datum before calling the subroutine.}
01844 \textcolor{comment}{*}
01845                   uplos = uplo
01846                   ns = n
01847                   als = alpha
01848                   \textcolor{keywordflow}{DO} 10 i = 1, laa
01849                      as( i ) = aa( i )
01850    10             \textcolor{keywordflow}{CONTINUE}
01851                   ldas = lda
01852                   \textcolor{keywordflow}{DO} 20 i = 1, lx
01853                      xs( i ) = xx( i )
01854    20             \textcolor{keywordflow}{CONTINUE}
01855                   incxs = incx
01856 \textcolor{comment}{*}
01857 \textcolor{comment}{*                 Call the subroutine.}
01858 \textcolor{comment}{*}
01859                   \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01860                      \textcolor{keywordflow}{IF}( trace )
01861      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
01862      $                  alpha, incx, lda
01863                      \textcolor{keywordflow}{IF}( rewi )
01864      $                  rewind ntra
01865                      \textcolor{keyword}{CALL }dsyr( uplo, n, alpha, xx, incx, aa, lda )
01866                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01867                      \textcolor{keywordflow}{IF}( trace )
01868      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
01869      $                  alpha, incx
01870                      \textcolor{keywordflow}{IF}( rewi )
01871      $                  rewind ntra
01872                      \textcolor{keyword}{CALL }dspr( uplo, n, alpha, xx, incx, aa )
01873 \textcolor{keywordflow}{                  END IF}
01874 \textcolor{comment}{*}
01875 \textcolor{comment}{*                 Check if error-exit was taken incorrectly.}
01876 \textcolor{comment}{*}
01877                   \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01878                      \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01879                      fatal = .true.
01880                      \textcolor{keywordflow}{GO TO} 120
01881 \textcolor{keywordflow}{                  END IF}
01882 \textcolor{comment}{*}
01883 \textcolor{comment}{*                 See what data changed inside subroutines.}
01884 \textcolor{comment}{*}
01885                   isame( 1 ) = uplo.EQ.uplos
01886                   isame( 2 ) = ns.EQ.n
01887                   isame( 3 ) = als.EQ.alpha
01888                   isame( 4 ) = lde( xs, xx, lx )
01889                   isame( 5 ) = incxs.EQ.incx
01890                   \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01891                      isame( 6 ) = lde( as, aa, laa )
01892                   \textcolor{keywordflow}{ELSE}
01893                      isame( 6 ) = lderes( sname( 2: 3 ), uplo, n, n, as,
01894      $                            aa, lda )
01895 \textcolor{keywordflow}{                  END IF}
01896                   \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
01897                      isame( 7 ) = ldas.EQ.lda
01898 \textcolor{keywordflow}{                  END IF}
01899 \textcolor{comment}{*}
01900 \textcolor{comment}{*                 If data was incorrectly changed, report and return.}
01901 \textcolor{comment}{*}
01902                   same = .true.
01903                   \textcolor{keywordflow}{DO} 30 i = 1, nargs
01904                      same = same.AND.isame( i )
01905                      \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01906      $                  \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01907    30             \textcolor{keywordflow}{CONTINUE}
01908                   \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01909                      fatal = .true.
01910                      \textcolor{keywordflow}{GO TO} 120
01911 \textcolor{keywordflow}{                  END IF}
01912 \textcolor{comment}{*}
01913                   \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01914 \textcolor{comment}{*}
01915 \textcolor{comment}{*                    Check the result column by column.}
01916 \textcolor{comment}{*}
01917                      \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01918                         \textcolor{keywordflow}{DO} 40 i = 1, n
01919                            z( i ) = x( i )
01920    40                   \textcolor{keywordflow}{CONTINUE}
01921                      \textcolor{keywordflow}{ELSE}
01922                         \textcolor{keywordflow}{DO} 50 i = 1, n
01923                            z( i ) = x( n - i + 1 )
01924    50                   \textcolor{keywordflow}{CONTINUE}
01925 \textcolor{keywordflow}{                     END IF}
01926                      ja = 1
01927                      \textcolor{keywordflow}{DO} 60 j = 1, n
01928                         w( 1 ) = z( j )
01929                         \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01930                            jj = 1
01931                            lj = j
01932                         \textcolor{keywordflow}{ELSE}
01933                            jj = j
01934                            lj = n - j + 1
01935 \textcolor{keywordflow}{                        END IF}
01936                         \textcolor{keyword}{CALL }dmvch( \textcolor{stringliteral}{'N'}, lj, 1, alpha, z( jj ), lj, w,
01937      $                              1, one, a( jj, j ), 1, yt, g,
01938      $                              aa( ja ), eps, err, fatal, nout,
01939      $                              .true. )
01940                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01941                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01942                               ja = ja + lda
01943                            \textcolor{keywordflow}{ELSE}
01944                               ja = ja + lda + 1
01945 \textcolor{keywordflow}{                           END IF}
01946                         \textcolor{keywordflow}{ELSE}
01947                            ja = ja + lj
01948 \textcolor{keywordflow}{                        END IF}
01949                         errmax = max( errmax, err )
01950 \textcolor{comment}{*                       If got really bad answer, report and return.}
01951                         \textcolor{keywordflow}{IF}( fatal )
01952      $                     \textcolor{keywordflow}{GO TO} 110
01953    60                \textcolor{keywordflow}{CONTINUE}
01954                   \textcolor{keywordflow}{ELSE}
01955 \textcolor{comment}{*                    Avoid repeating tests if N.le.0.}
01956                      \textcolor{keywordflow}{IF}( n.LE.0 )
01957      $                  \textcolor{keywordflow}{GO TO} 100
01958 \textcolor{keywordflow}{                  END IF}
01959 \textcolor{comment}{*}
01960    70          \textcolor{keywordflow}{CONTINUE}
01961 \textcolor{comment}{*}
01962    80       \textcolor{keywordflow}{CONTINUE}
01963 \textcolor{comment}{*}
01964    90    \textcolor{keywordflow}{CONTINUE}
01965 \textcolor{comment}{*}
01966   100 \textcolor{keywordflow}{CONTINUE}
01967 \textcolor{comment}{*}
01968 \textcolor{comment}{*     Report result.}
01969 \textcolor{comment}{*}
01970       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01971          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01972       \textcolor{keywordflow}{ELSE}
01973          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01974 \textcolor{keywordflow}{      END IF}
01975       \textcolor{keywordflow}{GO TO} 130
01976 \textcolor{comment}{*}
01977   110 \textcolor{keywordflow}{CONTINUE}
01978       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01979 \textcolor{comment}{*}
01980   120 \textcolor{keywordflow}{CONTINUE}
01981       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01982       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01983          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, incx, lda
01984       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01985          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, alpha, incx
01986 \textcolor{keywordflow}{      END IF}
01987 \textcolor{comment}{*}
01988   130 \textcolor{keywordflow}{CONTINUE}
01989       \textcolor{keywordflow}{RETURN}
01990 \textcolor{comment}{*}
01991  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01992      $      \textcolor{stringliteral}{'S)'} )
01993  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01994      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01995  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01996      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01997      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01998  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01999  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02000  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02001      $      i2, \textcolor{stringliteral}{', AP)                           .'} )
02002  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02003      $      i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                        .'} )
02004  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02005      $      \textcolor{stringliteral}{'******'} )
02006 \textcolor{comment}{*}
02007 \textcolor{comment}{*     End of DCHK5.}
02008 \textcolor{comment}{*}
02009 \textcolor{keyword}{      END}
02010 \textcolor{keyword}{      SUBROUTINE }dchk6( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
02011      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
02012      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
02013      $                  Z )
02014 \textcolor{comment}{*}
02015 \textcolor{comment}{*  Tests DSYR2 and DSPR2.}
02016 \textcolor{comment}{*}
02017 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02018 \textcolor{comment}{*}
02019 \textcolor{comment}{*  -- Written on 10-August-1987.}
02020 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02021 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02022 \textcolor{comment}{*}
02023 \textcolor{comment}{*     .. Parameters ..}
02024       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, half, one
02025       parameter( zero = 0.0d0, half = 0.5d0, one = 1.0d0 )
02026 \textcolor{comment}{*     .. Scalar Arguments ..}
02027       \textcolor{keywordtype}{DOUBLE PRECISION}   eps, thresh
02028       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
02029       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
02030       \textcolor{keywordtype}{CHARACTER*6}        sname
02031 \textcolor{comment}{*     .. Array Arguments ..}
02032       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
02033      $                   as( nmax*nmax ), g( nmax ), x( nmax ),
02034      $                   xs( nmax*incmax ), xx( nmax*incmax ),
02035      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
02036      $                   yy( nmax*incmax ), z( nmax, 2 )
02037       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
02038 \textcolor{comment}{*     .. Local Scalars ..}
02039       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, als, err, errmax, transl
02040       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, incy, incys, ix,
02041      $                   iy, j, ja, jj, laa, lda, ldas, lj, lx, ly, n,
02042      $                   nargs, nc, ns
02043       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
02044       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
02045       \textcolor{keywordtype}{CHARACTER*2}        ich
02046 \textcolor{comment}{*     .. Local Arrays ..}
02047       \textcolor{keywordtype}{DOUBLE PRECISION}   w( 2 )
02048       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
02049 \textcolor{comment}{*     .. External Functions ..}
02050       \textcolor{keywordtype}{LOGICAL}            lde, lderes
02051       \textcolor{keywordtype}{EXTERNAL}           lde, lderes
02052 \textcolor{comment}{*     .. External Subroutines ..}
02053       \textcolor{keywordtype}{EXTERNAL}           dmake, dmvch, dspr2, dsyr2
02054 \textcolor{comment}{*     .. Intrinsic Functions ..}
02055       \textcolor{keywordtype}{INTRINSIC}          abs, max
02056 \textcolor{comment}{*     .. Scalars in Common ..}
02057       \textcolor{keywordtype}{INTEGER}            infot, noutc
02058       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02059 \textcolor{comment}{*     .. Common blocks ..}
02060       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02061 \textcolor{comment}{*     .. Data statements ..}
02062       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
02063 \textcolor{comment}{*     .. Executable Statements ..}
02064       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'Y'}
02065       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
02066 \textcolor{comment}{*     Define the number of arguments.}
02067       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02068          nargs = 9
02069       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02070          nargs = 8
02071 \textcolor{keywordflow}{      END IF}
02072 \textcolor{comment}{*}
02073       nc = 0
02074       reset = .true.
02075       errmax = zero
02076 \textcolor{comment}{*}
02077       \textcolor{keywordflow}{DO} 140 in = 1, nidim
02078          n = idim( in )
02079 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
02080          lda = n
02081          \textcolor{keywordflow}{IF}( lda.LT.nmax )
02082      $      lda = lda + 1
02083 \textcolor{comment}{*        Skip tests if not enough room.}
02084          \textcolor{keywordflow}{IF}( lda.GT.nmax )
02085      $      \textcolor{keywordflow}{GO TO} 140
02086          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02087             laa = ( n*( n + 1 ) )/2
02088          \textcolor{keywordflow}{ELSE}
02089             laa = lda*n
02090 \textcolor{keywordflow}{         END IF}
02091 \textcolor{comment}{*}
02092          \textcolor{keywordflow}{DO} 130 ic = 1, 2
02093             uplo = ich( ic: ic )
02094             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
02095 \textcolor{comment}{*}
02096             \textcolor{keywordflow}{DO} 120 ix = 1, ninc
02097                incx = inc( ix )
02098                lx = abs( incx )*n
02099 \textcolor{comment}{*}
02100 \textcolor{comment}{*              Generate the vector X.}
02101 \textcolor{comment}{*}
02102                transl = half
02103                \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
02104      $                     0, n - 1, reset, transl )
02105                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02106                   x( n/2 ) = zero
02107                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
02108 \textcolor{keywordflow}{               END IF}
02109 \textcolor{comment}{*}
02110                \textcolor{keywordflow}{DO} 110 iy = 1, ninc
02111                   incy = inc( iy )
02112                   ly = abs( incy )*n
02113 \textcolor{comment}{*}
02114 \textcolor{comment}{*                 Generate the vector Y.}
02115 \textcolor{comment}{*}
02116                   transl = zero
02117                   \textcolor{keyword}{CALL }dmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
02118      $                        abs( incy ), 0, n - 1, reset, transl )
02119                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02120                      y( n/2 ) = zero
02121                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
02122 \textcolor{keywordflow}{                  END IF}
02123 \textcolor{comment}{*}
02124                   \textcolor{keywordflow}{DO} 100 ia = 1, nalf
02125                      alpha = alf( ia )
02126                      null = n.LE.0.OR.alpha.EQ.zero
02127 \textcolor{comment}{*}
02128 \textcolor{comment}{*                    Generate the matrix A.}
02129 \textcolor{comment}{*}
02130                      transl = zero
02131                      \textcolor{keyword}{CALL }dmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a,
02132      $                           nmax, aa, lda, n - 1, n - 1, reset,
02133      $                           transl )
02134 \textcolor{comment}{*}
02135                      nc = nc + 1
02136 \textcolor{comment}{*}
02137 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
02138 \textcolor{comment}{*}
02139                      uplos = uplo
02140                      ns = n
02141                      als = alpha
02142                      \textcolor{keywordflow}{DO} 10 i = 1, laa
02143                         as( i ) = aa( i )
02144    10                \textcolor{keywordflow}{CONTINUE}
02145                      ldas = lda
02146                      \textcolor{keywordflow}{DO} 20 i = 1, lx
02147                         xs( i ) = xx( i )
02148    20                \textcolor{keywordflow}{CONTINUE}
02149                      incxs = incx
02150                      \textcolor{keywordflow}{DO} 30 i = 1, ly
02151                         ys( i ) = yy( i )
02152    30                \textcolor{keywordflow}{CONTINUE}
02153                      incys = incy
02154 \textcolor{comment}{*}
02155 \textcolor{comment}{*                    Call the subroutine.}
02156 \textcolor{comment}{*}
02157                      \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02158                         \textcolor{keywordflow}{IF}( trace )
02159      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
02160      $                     alpha, incx, incy, lda
02161                         \textcolor{keywordflow}{IF}( rewi )
02162      $                     rewind ntra
02163                         \textcolor{keyword}{CALL }dsyr2( uplo, n, alpha, xx, incx, yy, incy,
02164      $                              aa, lda )
02165                      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02166                         \textcolor{keywordflow}{IF}( trace )
02167      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
02168      $                     alpha, incx, incy
02169                         \textcolor{keywordflow}{IF}( rewi )
02170      $                     rewind ntra
02171                         \textcolor{keyword}{CALL }dspr2( uplo, n, alpha, xx, incx, yy, incy,
02172      $                              aa )
02173 \textcolor{keywordflow}{                     END IF}
02174 \textcolor{comment}{*}
02175 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
02176 \textcolor{comment}{*}
02177                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
02178                         \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
02179                         fatal = .true.
02180                         \textcolor{keywordflow}{GO TO} 160
02181 \textcolor{keywordflow}{                     END IF}
02182 \textcolor{comment}{*}
02183 \textcolor{comment}{*                    See what data changed inside subroutines.}
02184 \textcolor{comment}{*}
02185                      isame( 1 ) = uplo.EQ.uplos
02186                      isame( 2 ) = ns.EQ.n
02187                      isame( 3 ) = als.EQ.alpha
02188                      isame( 4 ) = lde( xs, xx, lx )
02189                      isame( 5 ) = incxs.EQ.incx
02190                      isame( 6 ) = lde( ys, yy, ly )
02191                      isame( 7 ) = incys.EQ.incy
02192                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
02193                         isame( 8 ) = lde( as, aa, laa )
02194                      \textcolor{keywordflow}{ELSE}
02195                         isame( 8 ) = lderes( sname( 2: 3 ), uplo, n, n,
02196      $                               as, aa, lda )
02197 \textcolor{keywordflow}{                     END IF}
02198                      \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
02199                         isame( 9 ) = ldas.EQ.lda
02200 \textcolor{keywordflow}{                     END IF}
02201 \textcolor{comment}{*}
02202 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
02203 \textcolor{comment}{*}
02204                      same = .true.
02205                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
02206                         same = same.AND.isame( i )
02207                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
02208      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
02209    40                \textcolor{keywordflow}{CONTINUE}
02210                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
02211                         fatal = .true.
02212                         \textcolor{keywordflow}{GO TO} 160
02213 \textcolor{keywordflow}{                     END IF}
02214 \textcolor{comment}{*}
02215                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
02216 \textcolor{comment}{*}
02217 \textcolor{comment}{*                       Check the result column by column.}
02218 \textcolor{comment}{*}
02219                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
02220                            \textcolor{keywordflow}{DO} 50 i = 1, n
02221                               z( i, 1 ) = x( i )
02222    50                      \textcolor{keywordflow}{CONTINUE}
02223                         \textcolor{keywordflow}{ELSE}
02224                            \textcolor{keywordflow}{DO} 60 i = 1, n
02225                               z( i, 1 ) = x( n - i + 1 )
02226    60                      \textcolor{keywordflow}{CONTINUE}
02227 \textcolor{keywordflow}{                        END IF}
02228                         \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
02229                            \textcolor{keywordflow}{DO} 70 i = 1, n
02230                               z( i, 2 ) = y( i )
02231    70                      \textcolor{keywordflow}{CONTINUE}
02232                         \textcolor{keywordflow}{ELSE}
02233                            \textcolor{keywordflow}{DO} 80 i = 1, n
02234                               z( i, 2 ) = y( n - i + 1 )
02235    80                      \textcolor{keywordflow}{CONTINUE}
02236 \textcolor{keywordflow}{                        END IF}
02237                         ja = 1
02238                         \textcolor{keywordflow}{DO} 90 j = 1, n
02239                            w( 1 ) = z( j, 2 )
02240                            w( 2 ) = z( j, 1 )
02241                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02242                               jj = 1
02243                               lj = j
02244                            \textcolor{keywordflow}{ELSE}
02245                               jj = j
02246                               lj = n - j + 1
02247 \textcolor{keywordflow}{                           END IF}
02248                            \textcolor{keyword}{CALL }dmvch( \textcolor{stringliteral}{'N'}, lj, 2, alpha, z( jj, 1 ),
02249      $                                 nmax, w, 1, one, a( jj, j ), 1,
02250      $                                 yt, g, aa( ja ), eps, err, fatal,
02251      $                                 nout, .true. )
02252                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02253                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02254                                  ja = ja + lda
02255                               \textcolor{keywordflow}{ELSE}
02256                                  ja = ja + lda + 1
02257 \textcolor{keywordflow}{                              END IF}
02258                            \textcolor{keywordflow}{ELSE}
02259                               ja = ja + lj
02260 \textcolor{keywordflow}{                           END IF}
02261                            errmax = max( errmax, err )
02262 \textcolor{comment}{*                          If got really bad answer, report and return.}
02263                            \textcolor{keywordflow}{IF}( fatal )
02264      $                        \textcolor{keywordflow}{GO TO} 150
02265    90                   \textcolor{keywordflow}{CONTINUE}
02266                      \textcolor{keywordflow}{ELSE}
02267 \textcolor{comment}{*                       Avoid repeating tests with N.le.0.}
02268                         \textcolor{keywordflow}{IF}( n.LE.0 )
02269      $                     \textcolor{keywordflow}{GO TO} 140
02270 \textcolor{keywordflow}{                     END IF}
02271 \textcolor{comment}{*}
02272   100             \textcolor{keywordflow}{CONTINUE}
02273 \textcolor{comment}{*}
02274   110          \textcolor{keywordflow}{CONTINUE}
02275 \textcolor{comment}{*}
02276   120       \textcolor{keywordflow}{CONTINUE}
02277 \textcolor{comment}{*}
02278   130    \textcolor{keywordflow}{CONTINUE}
02279 \textcolor{comment}{*}
02280   140 \textcolor{keywordflow}{CONTINUE}
02281 \textcolor{comment}{*}
02282 \textcolor{comment}{*     Report result.}
02283 \textcolor{comment}{*}
02284       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
02285          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
02286       \textcolor{keywordflow}{ELSE}
02287          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
02288 \textcolor{keywordflow}{      END IF}
02289       \textcolor{keywordflow}{GO TO} 170
02290 \textcolor{comment}{*}
02291   150 \textcolor{keywordflow}{CONTINUE}
02292       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
02293 \textcolor{comment}{*}
02294   160 \textcolor{keywordflow}{CONTINUE}
02295       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
02296       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02297          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, incx,
02298      $      incy, lda
02299       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02300          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, alpha, incx, incy
02301 \textcolor{keywordflow}{      END IF}
02302 \textcolor{comment}{*}
02303   170 \textcolor{keywordflow}{CONTINUE}
02304       \textcolor{keywordflow}{RETURN}
02305 \textcolor{comment}{*}
02306  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
02307      $      \textcolor{stringliteral}{'S)'} )
02308  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
02309      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
02310  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
02311      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
02312      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
02313  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
02314  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02315  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02316      $      i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', AP)                     .'} )
02317  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02318      $      i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                  .'} )
02319  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02320      $      \textcolor{stringliteral}{'******'} )
02321 \textcolor{comment}{*}
02322 \textcolor{comment}{*     End of DCHK6.}
02323 \textcolor{comment}{*}
02324 \textcolor{keyword}{      END}
02325 \textcolor{keyword}{      SUBROUTINE }dchke( ISNUM, SRNAMT, NOUT )
02326 \textcolor{comment}{*}
02327 \textcolor{comment}{*  Tests the error exits from the Level 2 Blas.}
02328 \textcolor{comment}{*  Requires a special version of the error-handling routine XERBLA.}
02329 \textcolor{comment}{*  ALPHA, BETA, A, X and Y should not need to be defined.}
02330 \textcolor{comment}{*}
02331 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02332 \textcolor{comment}{*}
02333 \textcolor{comment}{*  -- Written on 10-August-1987.}
02334 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02335 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02336 \textcolor{comment}{*}
02337 \textcolor{comment}{*     .. Scalar Arguments ..}
02338       \textcolor{keywordtype}{INTEGER}            isnum, nout
02339       \textcolor{keywordtype}{CHARACTER*6}        srnamt
02340 \textcolor{comment}{*     .. Scalars in Common ..}
02341       \textcolor{keywordtype}{INTEGER}            infot, noutc
02342       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02343 \textcolor{comment}{*     .. Local Scalars ..}
02344       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, beta
02345 \textcolor{comment}{*     .. Local Arrays ..}
02346       \textcolor{keywordtype}{DOUBLE PRECISION}   a( 1, 1 ), x( 1 ), y( 1 )
02347 \textcolor{comment}{*     .. External Subroutines ..}
02348       \textcolor{keywordtype}{EXTERNAL}           chkxer, dgbmv, dgemv, dger, dsbmv, dspmv, dspr,
02349      $                   dspr2, dsymv, dsyr, dsyr2, dtbmv, dtbsv, dtpmv,
02350      $                   dtpsv, dtrmv, dtrsv
02351 \textcolor{comment}{*     .. Common blocks ..}
02352       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02353 \textcolor{comment}{*     .. Executable Statements ..}
02354 \textcolor{comment}{*     OK is set to .FALSE. by the special version of XERBLA or by CHKXER}
02355 \textcolor{comment}{*     if anything is wrong.}
02356       ok = .true.
02357 \textcolor{comment}{*     LERR is set to .TRUE. by the special version of XERBLA each time}
02358 \textcolor{comment}{*     it is called, and is then tested and re-set by CHKXER.}
02359       lerr = .false.
02360       \textcolor{keywordflow}{GO TO} ( 10, 20, 30, 40, 50, 60, 70, 80,
02361      $        90, 100, 110, 120, 130, 140, 150,
02362      $        160 )isnum
02363    10 infot = 1
02364       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02365       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02366       infot = 2
02367       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02368       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02369       infot = 3
02370       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02371       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02372       infot = 6
02373       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, x, 1, beta, y, 1 )
02374       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02375       infot = 8
02376       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02377       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02378       infot = 11
02379       \textcolor{keyword}{CALL }dgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02380       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02381       \textcolor{keywordflow}{GO TO} 170
02382    20 infot = 1
02383       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'/'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02384       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02385       infot = 2
02386       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, -1, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02387       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02388       infot = 3
02389       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 0, -1, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02390       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02391       infot = 4
02392       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 0, 0, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02393       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02394       infot = 5
02395       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 2, 0, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02396       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02397       infot = 8
02398       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02399       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02400       infot = 10
02401       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02402       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02403       infot = 13
02404       \textcolor{keyword}{CALL }dgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02405       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02406       \textcolor{keywordflow}{GO TO} 170
02407    30 infot = 1
02408       \textcolor{keyword}{CALL }dsymv( \textcolor{stringliteral}{'/'}, 0, alpha, a, 1, x, 1, beta, y, 1 )
02409       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02410       infot = 2
02411       \textcolor{keyword}{CALL }dsymv( \textcolor{stringliteral}{'U'}, -1, alpha, a, 1, x, 1, beta, y, 1 )
02412       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02413       infot = 5
02414       \textcolor{keyword}{CALL }dsymv( \textcolor{stringliteral}{'U'}, 2, alpha, a, 1, x, 1, beta, y, 1 )
02415       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02416       infot = 7
02417       \textcolor{keyword}{CALL }dsymv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 0, beta, y, 1 )
02418       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02419       infot = 10
02420       \textcolor{keyword}{CALL }dsymv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 1, beta, y, 0 )
02421       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02422       \textcolor{keywordflow}{GO TO} 170
02423    40 infot = 1
02424       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02425       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02426       infot = 2
02427       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'U'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02428       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02429       infot = 3
02430       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'U'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02431       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02432       infot = 6
02433       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'U'}, 0, 1, alpha, a, 1, x, 1, beta, y, 1 )
02434       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02435       infot = 8
02436       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02437       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02438       infot = 11
02439       \textcolor{keyword}{CALL }dsbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02440       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02441       \textcolor{keywordflow}{GO TO} 170
02442    50 infot = 1
02443       \textcolor{keyword}{CALL }dspmv( \textcolor{stringliteral}{'/'}, 0, alpha, a, x, 1, beta, y, 1 )
02444       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02445       infot = 2
02446       \textcolor{keyword}{CALL }dspmv( \textcolor{stringliteral}{'U'}, -1, alpha, a, x, 1, beta, y, 1 )
02447       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02448       infot = 6
02449       \textcolor{keyword}{CALL }dspmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 0, beta, y, 1 )
02450       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02451       infot = 9
02452       \textcolor{keyword}{CALL }dspmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 1, beta, y, 0 )
02453       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02454       \textcolor{keywordflow}{GO TO} 170
02455    60 infot = 1
02456       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02457       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02458       infot = 2
02459       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02460       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02461       infot = 3
02462       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02463       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02464       infot = 4
02465       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02466       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02467       infot = 6
02468       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02469       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02470       infot = 8
02471       \textcolor{keyword}{CALL }dtrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02472       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02473       \textcolor{keywordflow}{GO TO} 170
02474    70 infot = 1
02475       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02476       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02477       infot = 2
02478       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02479       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02480       infot = 3
02481       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02482       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02483       infot = 4
02484       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02485       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02486       infot = 5
02487       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02488       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02489       infot = 7
02490       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02491       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02492       infot = 9
02493       \textcolor{keyword}{CALL }dtbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02494       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02495       \textcolor{keywordflow}{GO TO} 170
02496    80 infot = 1
02497       \textcolor{keyword}{CALL }dtpmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02498       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02499       infot = 2
02500       \textcolor{keyword}{CALL }dtpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02501       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02502       infot = 3
02503       \textcolor{keyword}{CALL }dtpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02504       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02505       infot = 4
02506       \textcolor{keyword}{CALL }dtpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02507       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02508       infot = 7
02509       \textcolor{keyword}{CALL }dtpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02510       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02511       \textcolor{keywordflow}{GO TO} 170
02512    90 infot = 1
02513       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02514       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02515       infot = 2
02516       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02517       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02518       infot = 3
02519       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02520       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02521       infot = 4
02522       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02523       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02524       infot = 6
02525       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02526       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02527       infot = 8
02528       \textcolor{keyword}{CALL }dtrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02529       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02530       \textcolor{keywordflow}{GO TO} 170
02531   100 infot = 1
02532       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02533       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02534       infot = 2
02535       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02536       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02537       infot = 3
02538       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02539       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02540       infot = 4
02541       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02542       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02543       infot = 5
02544       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02545       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02546       infot = 7
02547       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02548       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02549       infot = 9
02550       \textcolor{keyword}{CALL }dtbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02551       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02552       \textcolor{keywordflow}{GO TO} 170
02553   110 infot = 1
02554       \textcolor{keyword}{CALL }dtpsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02555       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02556       infot = 2
02557       \textcolor{keyword}{CALL }dtpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02558       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02559       infot = 3
02560       \textcolor{keyword}{CALL }dtpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02561       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02562       infot = 4
02563       \textcolor{keyword}{CALL }dtpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02564       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02565       infot = 7
02566       \textcolor{keyword}{CALL }dtpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02567       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02568       \textcolor{keywordflow}{GO TO} 170
02569   120 infot = 1
02570       \textcolor{keyword}{CALL }dger( -1, 0, alpha, x, 1, y, 1, a, 1 )
02571       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02572       infot = 2
02573       \textcolor{keyword}{CALL }dger( 0, -1, alpha, x, 1, y, 1, a, 1 )
02574       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02575       infot = 5
02576       \textcolor{keyword}{CALL }dger( 0, 0, alpha, x, 0, y, 1, a, 1 )
02577       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02578       infot = 7
02579       \textcolor{keyword}{CALL }dger( 0, 0, alpha, x, 1, y, 0, a, 1 )
02580       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02581       infot = 9
02582       \textcolor{keyword}{CALL }dger( 2, 0, alpha, x, 1, y, 1, a, 1 )
02583       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02584       \textcolor{keywordflow}{GO TO} 170
02585   130 infot = 1
02586       \textcolor{keyword}{CALL }dsyr( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, a, 1 )
02587       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02588       infot = 2
02589       \textcolor{keyword}{CALL }dsyr( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, a, 1 )
02590       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02591       infot = 5
02592       \textcolor{keyword}{CALL }dsyr( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, a, 1 )
02593       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02594       infot = 7
02595       \textcolor{keyword}{CALL }dsyr( \textcolor{stringliteral}{'U'}, 2, alpha, x, 1, a, 1 )
02596       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02597       \textcolor{keywordflow}{GO TO} 170
02598   140 infot = 1
02599       \textcolor{keyword}{CALL }dspr( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, a )
02600       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02601       infot = 2
02602       \textcolor{keyword}{CALL }dspr( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, a )
02603       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02604       infot = 5
02605       \textcolor{keyword}{CALL }dspr( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, a )
02606       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02607       \textcolor{keywordflow}{GO TO} 170
02608   150 infot = 1
02609       \textcolor{keyword}{CALL }dsyr2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a, 1 )
02610       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02611       infot = 2
02612       \textcolor{keyword}{CALL }dsyr2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a, 1 )
02613       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02614       infot = 5
02615       \textcolor{keyword}{CALL }dsyr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a, 1 )
02616       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02617       infot = 7
02618       \textcolor{keyword}{CALL }dsyr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a, 1 )
02619       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02620       infot = 9
02621       \textcolor{keyword}{CALL }dsyr2( \textcolor{stringliteral}{'U'}, 2, alpha, x, 1, y, 1, a, 1 )
02622       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02623       \textcolor{keywordflow}{GO TO} 170
02624   160 infot = 1
02625       \textcolor{keyword}{CALL }dspr2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a )
02626       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02627       infot = 2
02628       \textcolor{keyword}{CALL }dspr2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a )
02629       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02630       infot = 5
02631       \textcolor{keyword}{CALL }dspr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a )
02632       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02633       infot = 7
02634       \textcolor{keyword}{CALL }dspr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a )
02635       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02636 \textcolor{comment}{*}
02637   170 \textcolor{keywordflow}{IF}( ok )\textcolor{keywordflow}{THEN}
02638          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )srnamt
02639       \textcolor{keywordflow}{ELSE}
02640          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srnamt
02641 \textcolor{keywordflow}{      END IF}
02642       \textcolor{keywordflow}{RETURN}
02643 \textcolor{comment}{*}
02644  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE TESTS OF ERROR-EXITS'} )
02645  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED THE TESTS OF ERROR-EXITS *****'},
02646      $      \textcolor{stringliteral}{'**'} )
02647 \textcolor{comment}{*}
02648 \textcolor{comment}{*     End of DCHKE.}
02649 \textcolor{comment}{*}
02650 \textcolor{keyword}{      END}
02651 \textcolor{keyword}{      SUBROUTINE }dmake( TYPE, UPLO, DIAG, M, N, A, NMAX, AA, LDA, KL,
02652      $                  KU, RESET, TRANSL )
02653 \textcolor{comment}{*}
02654 \textcolor{comment}{*  Generates values for an M by N matrix A within the bandwidth}
02655 \textcolor{comment}{*  defined by KL and KU.}
02656 \textcolor{comment}{*  Stores the values in the array AA in the data structure required}
02657 \textcolor{comment}{*  by the routine, with unwanted elements set to rogue value.}
02658 \textcolor{comment}{*}
02659 \textcolor{comment}{*  TYPE is 'GE', 'GB', 'SY', 'SB', 'SP', 'TR', 'TB' OR 'TP'.}
02660 \textcolor{comment}{*}
02661 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02662 \textcolor{comment}{*}
02663 \textcolor{comment}{*  -- Written on 10-August-1987.}
02664 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02665 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02666 \textcolor{comment}{*}
02667 \textcolor{comment}{*     .. Parameters ..}
02668       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
02669       parameter( zero = 0.0d0, one = 1.0d0 )
02670       \textcolor{keywordtype}{DOUBLE PRECISION}   rogue
02671       parameter( rogue = -1.0d10 )
02672 \textcolor{comment}{*     .. Scalar Arguments ..}
02673       \textcolor{keywordtype}{DOUBLE PRECISION}   transl
02674       \textcolor{keywordtype}{INTEGER}            kl, ku, lda, m, n, nmax
02675       \textcolor{keywordtype}{LOGICAL}            reset
02676       \textcolor{keywordtype}{CHARACTER*1}        diag, uplo
02677       \textcolor{keywordtype}{CHARACTER*2}        type
02678 \textcolor{comment}{*     .. Array Arguments ..}
02679       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, * ), aa( * )
02680 \textcolor{comment}{*     .. Local Scalars ..}
02681       \textcolor{keywordtype}{INTEGER}            i, i1, i2, i3, ibeg, iend, ioff, j, kk
02682       \textcolor{keywordtype}{LOGICAL}            gen, lower, sym, tri, unit, upper
02683 \textcolor{comment}{*     .. External Functions ..}
02684       \textcolor{keywordtype}{DOUBLE PRECISION}   dbeg
02685       \textcolor{keywordtype}{EXTERNAL}           dbeg
02686 \textcolor{comment}{*     .. Intrinsic Functions ..}
02687       \textcolor{keywordtype}{INTRINSIC}          max, min
02688 \textcolor{comment}{*     .. Executable Statements ..}
02689       gen = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'G'}
02690       sym = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'S'}
02691       tri = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'T'}
02692       upper = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'U'}
02693       lower = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'L'}
02694       unit = tri.AND.diag.EQ.\textcolor{stringliteral}{'U'}
02695 \textcolor{comment}{*}
02696 \textcolor{comment}{*     Generate data in array A.}
02697 \textcolor{comment}{*}
02698       \textcolor{keywordflow}{DO} 20 j = 1, n
02699          \textcolor{keywordflow}{DO} 10 i = 1, m
02700             \textcolor{keywordflow}{IF}( gen.OR.( upper.AND.i.LE.j ).OR.( lower.AND.i.GE.j ) )
02701      $          \textcolor{keywordflow}{THEN}
02702                \textcolor{keywordflow}{IF}( ( i.LE.j.AND.j - i.LE.ku ).OR.
02703      $             ( i.GE.j.AND.i - j.LE.kl ) )\textcolor{keywordflow}{THEN}
02704                   a( i, j ) = dbeg( reset ) + transl
02705                \textcolor{keywordflow}{ELSE}
02706                   a( i, j ) = zero
02707 \textcolor{keywordflow}{               END IF}
02708                \textcolor{keywordflow}{IF}( i.NE.j )\textcolor{keywordflow}{THEN}
02709                   \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02710                      a( j, i ) = a( i, j )
02711                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( tri )\textcolor{keywordflow}{THEN}
02712                      a( j, i ) = zero
02713 \textcolor{keywordflow}{                  END IF}
02714 \textcolor{keywordflow}{               END IF}
02715 \textcolor{keywordflow}{            END IF}
02716    10    \textcolor{keywordflow}{CONTINUE}
02717          \textcolor{keywordflow}{IF}( tri )
02718      $      a( j, j ) = a( j, j ) + one
02719          \textcolor{keywordflow}{IF}( unit )
02720      $      a( j, j ) = one
02721    20 \textcolor{keywordflow}{CONTINUE}
02722 \textcolor{comment}{*}
02723 \textcolor{comment}{*     Store elements in array AS in data structure required by routine.}
02724 \textcolor{comment}{*}
02725       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02726          \textcolor{keywordflow}{DO} 50 j = 1, n
02727             \textcolor{keywordflow}{DO} 30 i = 1, m
02728                aa( i + ( j - 1 )*lda ) = a( i, j )
02729    30       \textcolor{keywordflow}{CONTINUE}
02730             \textcolor{keywordflow}{DO} 40 i = m + 1, lda
02731                aa( i + ( j - 1 )*lda ) = rogue
02732    40       \textcolor{keywordflow}{CONTINUE}
02733    50    \textcolor{keywordflow}{CONTINUE}
02734       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GB'} )\textcolor{keywordflow}{THEN}
02735          \textcolor{keywordflow}{DO} 90 j = 1, n
02736             \textcolor{keywordflow}{DO} 60 i1 = 1, ku + 1 - j
02737                aa( i1 + ( j - 1 )*lda ) = rogue
02738    60       \textcolor{keywordflow}{CONTINUE}
02739             \textcolor{keywordflow}{DO} 70 i2 = i1, min( kl + ku + 1, ku + 1 + m - j )
02740                aa( i2 + ( j - 1 )*lda ) = a( i2 + j - ku - 1, j )
02741    70       \textcolor{keywordflow}{CONTINUE}
02742             \textcolor{keywordflow}{DO} 80 i3 = i2, lda
02743                aa( i3 + ( j - 1 )*lda ) = rogue
02744    80       \textcolor{keywordflow}{CONTINUE}
02745    90    \textcolor{keywordflow}{CONTINUE}
02746       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SY'}.OR.type.EQ.\textcolor{stringliteral}{'TR'} )\textcolor{keywordflow}{THEN}
02747          \textcolor{keywordflow}{DO} 130 j = 1, n
02748             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02749                ibeg = 1
02750                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02751                   iend = j - 1
02752                \textcolor{keywordflow}{ELSE}
02753                   iend = j
02754 \textcolor{keywordflow}{               END IF}
02755             \textcolor{keywordflow}{ELSE}
02756                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02757                   ibeg = j + 1
02758                \textcolor{keywordflow}{ELSE}
02759                   ibeg = j
02760 \textcolor{keywordflow}{               END IF}
02761                iend = n
02762 \textcolor{keywordflow}{            END IF}
02763             \textcolor{keywordflow}{DO} 100 i = 1, ibeg - 1
02764                aa( i + ( j - 1 )*lda ) = rogue
02765   100       \textcolor{keywordflow}{CONTINUE}
02766             \textcolor{keywordflow}{DO} 110 i = ibeg, iend
02767                aa( i + ( j - 1 )*lda ) = a( i, j )
02768   110       \textcolor{keywordflow}{CONTINUE}
02769             \textcolor{keywordflow}{DO} 120 i = iend + 1, lda
02770                aa( i + ( j - 1 )*lda ) = rogue
02771   120       \textcolor{keywordflow}{CONTINUE}
02772   130    \textcolor{keywordflow}{CONTINUE}
02773       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SB'}.OR.type.EQ.\textcolor{stringliteral}{'TB'} )\textcolor{keywordflow}{THEN}
02774          \textcolor{keywordflow}{DO} 170 j = 1, n
02775             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02776                kk = kl + 1
02777                ibeg = max( 1, kl + 2 - j )
02778                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02779                   iend = kl
02780                \textcolor{keywordflow}{ELSE}
02781                   iend = kl + 1
02782 \textcolor{keywordflow}{               END IF}
02783             \textcolor{keywordflow}{ELSE}
02784                kk = 1
02785                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02786                   ibeg = 2
02787                \textcolor{keywordflow}{ELSE}
02788                   ibeg = 1
02789 \textcolor{keywordflow}{               END IF}
02790                iend = min( kl + 1, 1 + m - j )
02791 \textcolor{keywordflow}{            END IF}
02792             \textcolor{keywordflow}{DO} 140 i = 1, ibeg - 1
02793                aa( i + ( j - 1 )*lda ) = rogue
02794   140       \textcolor{keywordflow}{CONTINUE}
02795             \textcolor{keywordflow}{DO} 150 i = ibeg, iend
02796                aa( i + ( j - 1 )*lda ) = a( i + j - kk, j )
02797   150       \textcolor{keywordflow}{CONTINUE}
02798             \textcolor{keywordflow}{DO} 160 i = iend + 1, lda
02799                aa( i + ( j - 1 )*lda ) = rogue
02800   160       \textcolor{keywordflow}{CONTINUE}
02801   170    \textcolor{keywordflow}{CONTINUE}
02802       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SP'}.OR.type.EQ.\textcolor{stringliteral}{'TP'} )\textcolor{keywordflow}{THEN}
02803          ioff = 0
02804          \textcolor{keywordflow}{DO} 190 j = 1, n
02805             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02806                ibeg = 1
02807                iend = j
02808             \textcolor{keywordflow}{ELSE}
02809                ibeg = j
02810                iend = n
02811 \textcolor{keywordflow}{            END IF}
02812             \textcolor{keywordflow}{DO} 180 i = ibeg, iend
02813                ioff = ioff + 1
02814                aa( ioff ) = a( i, j )
02815                \textcolor{keywordflow}{IF}( i.EQ.j )\textcolor{keywordflow}{THEN}
02816                   \textcolor{keywordflow}{IF}( unit )
02817      $               aa( ioff ) = rogue
02818 \textcolor{keywordflow}{               END IF}
02819   180       \textcolor{keywordflow}{CONTINUE}
02820   190    \textcolor{keywordflow}{CONTINUE}
02821 \textcolor{keywordflow}{      END IF}
02822       \textcolor{keywordflow}{RETURN}
02823 \textcolor{comment}{*}
02824 \textcolor{comment}{*     End of DMAKE.}
02825 \textcolor{comment}{*}
02826 \textcolor{keyword}{      END}
02827 \textcolor{keyword}{      SUBROUTINE }dmvch( TRANS, M, N, ALPHA, A, NMAX, X, INCX, BETA, Y,
02828      $                  INCY, YT, G, YY, EPS, ERR, FATAL, NOUT, MV )
02829 \textcolor{comment}{*}
02830 \textcolor{comment}{*  Checks the results of the computational tests.}
02831 \textcolor{comment}{*}
02832 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02833 \textcolor{comment}{*}
02834 \textcolor{comment}{*  -- Written on 10-August-1987.}
02835 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02836 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02837 \textcolor{comment}{*}
02838 \textcolor{comment}{*     .. Parameters ..}
02839       \textcolor{keywordtype}{DOUBLE PRECISION}   zero, one
02840       parameter( zero = 0.0d0, one = 1.0d0 )
02841 \textcolor{comment}{*     .. Scalar Arguments ..}
02842       \textcolor{keywordtype}{DOUBLE PRECISION}   alpha, beta, eps, err
02843       \textcolor{keywordtype}{INTEGER}            incx, incy, m, n, nmax, nout
02844       \textcolor{keywordtype}{LOGICAL}            fatal, mv
02845       \textcolor{keywordtype}{CHARACTER*1}        trans
02846 \textcolor{comment}{*     .. Array Arguments ..}
02847       \textcolor{keywordtype}{DOUBLE PRECISION}   a( nmax, * ), g( * ), x( * ), y( * ), yt( * ),
02848      $                   yy( * )
02849 \textcolor{comment}{*     .. Local Scalars ..}
02850       \textcolor{keywordtype}{DOUBLE PRECISION}   erri
02851       \textcolor{keywordtype}{INTEGER}            i, incxl, incyl, iy, j, jx, kx, ky, ml, nl
02852       \textcolor{keywordtype}{LOGICAL}            tran
02853 \textcolor{comment}{*     .. Intrinsic Functions ..}
02854       \textcolor{keywordtype}{INTRINSIC}          abs, max, sqrt
02855 \textcolor{comment}{*     .. Executable Statements ..}
02856       tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
02857       \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
02858          ml = n
02859          nl = m
02860       \textcolor{keywordflow}{ELSE}
02861          ml = m
02862          nl = n
02863 \textcolor{keywordflow}{      END IF}
02864       \textcolor{keywordflow}{IF}( incx.LT.0 )\textcolor{keywordflow}{THEN}
02865          kx = nl
02866          incxl = -1
02867       \textcolor{keywordflow}{ELSE}
02868          kx = 1
02869          incxl = 1
02870 \textcolor{keywordflow}{      END IF}
02871       \textcolor{keywordflow}{IF}( incy.LT.0 )\textcolor{keywordflow}{THEN}
02872          ky = ml
02873          incyl = -1
02874       \textcolor{keywordflow}{ELSE}
02875          ky = 1
02876          incyl = 1
02877 \textcolor{keywordflow}{      END IF}
02878 \textcolor{comment}{*}
02879 \textcolor{comment}{*     Compute expected result in YT using data in A, X and Y.}
02880 \textcolor{comment}{*     Compute gauges in G.}
02881 \textcolor{comment}{*}
02882       iy = ky
02883       \textcolor{keywordflow}{DO} 30 i = 1, ml
02884          yt( iy ) = zero
02885          g( iy ) = zero
02886          jx = kx
02887          \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
02888             \textcolor{keywordflow}{DO} 10 j = 1, nl
02889                yt( iy ) = yt( iy ) + a( j, i )*x( jx )
02890                g( iy ) = g( iy ) + abs( a( j, i )*x( jx ) )
02891                jx = jx + incxl
02892    10       \textcolor{keywordflow}{CONTINUE}
02893          \textcolor{keywordflow}{ELSE}
02894             \textcolor{keywordflow}{DO} 20 j = 1, nl
02895                yt( iy ) = yt( iy ) + a( i, j )*x( jx )
02896                g( iy ) = g( iy ) + abs( a( i, j )*x( jx ) )
02897                jx = jx + incxl
02898    20       \textcolor{keywordflow}{CONTINUE}
02899 \textcolor{keywordflow}{         END IF}
02900          yt( iy ) = alpha*yt( iy ) + beta*y( iy )
02901          g( iy ) = abs( alpha )*g( iy ) + abs( beta*y( iy ) )
02902          iy = iy + incyl
02903    30 \textcolor{keywordflow}{CONTINUE}
02904 \textcolor{comment}{*}
02905 \textcolor{comment}{*     Compute the error ratio for this result.}
02906 \textcolor{comment}{*}
02907       err = zero
02908       \textcolor{keywordflow}{DO} 40 i = 1, ml
02909          erri = abs( yt( i ) - yy( 1 + ( i - 1 )*abs( incy ) ) )/eps
02910          \textcolor{keywordflow}{IF}( g( i ).NE.zero )
02911      $      erri = erri/g( i )
02912          err = max( err, erri )
02913          \textcolor{keywordflow}{IF}( err*sqrt( eps ).GE.one )
02914      $      \textcolor{keywordflow}{GO TO} 50
02915    40 \textcolor{keywordflow}{CONTINUE}
02916 \textcolor{comment}{*     If the loop completes, all results are at least half accurate.}
02917       \textcolor{keywordflow}{GO TO} 70
02918 \textcolor{comment}{*}
02919 \textcolor{comment}{*     Report fatal error.}
02920 \textcolor{comment}{*}
02921    50 fatal = .true.
02922       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )
02923       \textcolor{keywordflow}{DO} 60 i = 1, ml
02924          \textcolor{keywordflow}{IF}( mv )\textcolor{keywordflow}{THEN}
02925             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i, yt( i ),
02926      $         yy( 1 + ( i - 1 )*abs( incy ) )
02927          \textcolor{keywordflow}{ELSE}
02928             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i,
02929      $         yy( 1 + ( i - 1 )*abs( incy ) ), yt( i )
02930 \textcolor{keywordflow}{         END IF}
02931    60 \textcolor{keywordflow}{CONTINUE}
02932 \textcolor{comment}{*}
02933    70 \textcolor{keywordflow}{CONTINUE}
02934       \textcolor{keywordflow}{RETURN}
02935 \textcolor{comment}{*}
02936  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - COMPUTED RESULT IS LESS THAN HAL'},
02937      $      \textcolor{stringliteral}{'F ACCURATE *******'}, /\textcolor{stringliteral}{'           EXPECTED RESULT   COMPU'},
02938      $      \textcolor{stringliteral}{'TED RESULT'} )
02939  9998 \textcolor{keyword}{FORMAT}( 1x, i7, 2g18.6 )
02940 \textcolor{comment}{*}
02941 \textcolor{comment}{*     End of DMVCH.}
02942 \textcolor{comment}{*}
02943 \textcolor{keyword}{      END}
02944 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lde( RI, RJ, LR )
02945 \textcolor{comment}{*}
02946 \textcolor{comment}{*  Tests if two arrays are identical.}
02947 \textcolor{comment}{*}
02948 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02949 \textcolor{comment}{*}
02950 \textcolor{comment}{*  -- Written on 10-August-1987.}
02951 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02952 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02953 \textcolor{comment}{*}
02954 \textcolor{comment}{*     .. Scalar Arguments ..}
02955       \textcolor{keywordtype}{INTEGER}            lr
02956 \textcolor{comment}{*     .. Array Arguments ..}
02957       \textcolor{keywordtype}{DOUBLE PRECISION}   ri( * ), rj( * )
02958 \textcolor{comment}{*     .. Local Scalars ..}
02959       \textcolor{keywordtype}{INTEGER}            i
02960 \textcolor{comment}{*     .. Executable Statements ..}
02961       \textcolor{keywordflow}{DO} 10 i = 1, lr
02962          \textcolor{keywordflow}{IF}( ri( i ).NE.rj( i ) )
02963      $      \textcolor{keywordflow}{GO TO} 20
02964    10 \textcolor{keywordflow}{CONTINUE}
02965       lde = .true.
02966       \textcolor{keywordflow}{GO TO} 30
02967    20 \textcolor{keywordflow}{CONTINUE}
02968       lde = .false.
02969    30 \textcolor{keywordflow}{RETURN}
02970 \textcolor{comment}{*}
02971 \textcolor{comment}{*     End of LDE.}
02972 \textcolor{comment}{*}
02973 \textcolor{keyword}{      END}
02974 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lderes( TYPE, UPLO, M, N, AA, AS, LDA )
02975 \textcolor{comment}{*}
02976 \textcolor{comment}{*  Tests if selected elements in two arrays are equal.}
02977 \textcolor{comment}{*}
02978 \textcolor{comment}{*  TYPE is 'GE', 'SY' or 'SP'.}
02979 \textcolor{comment}{*}
02980 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02981 \textcolor{comment}{*}
02982 \textcolor{comment}{*  -- Written on 10-August-1987.}
02983 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02984 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02985 \textcolor{comment}{*}
02986 \textcolor{comment}{*     .. Scalar Arguments ..}
02987       \textcolor{keywordtype}{INTEGER}            lda, m, n
02988       \textcolor{keywordtype}{CHARACTER*1}        uplo
02989       \textcolor{keywordtype}{CHARACTER*2}        type
02990 \textcolor{comment}{*     .. Array Arguments ..}
02991       \textcolor{keywordtype}{DOUBLE PRECISION}   aa( lda, * ), as( lda, * )
02992 \textcolor{comment}{*     .. Local Scalars ..}
02993       \textcolor{keywordtype}{INTEGER}            i, ibeg, iend, j
02994       \textcolor{keywordtype}{LOGICAL}            upper
02995 \textcolor{comment}{*     .. Executable Statements ..}
02996       upper = uplo.EQ.\textcolor{stringliteral}{'U'}
02997       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02998          \textcolor{keywordflow}{DO} 20 j = 1, n
02999             \textcolor{keywordflow}{DO} 10 i = m + 1, lda
03000                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03001      $            \textcolor{keywordflow}{GO TO} 70
03002    10       \textcolor{keywordflow}{CONTINUE}
03003    20    \textcolor{keywordflow}{CONTINUE}
03004       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'SY'} )\textcolor{keywordflow}{THEN}
03005          \textcolor{keywordflow}{DO} 50 j = 1, n
03006             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
03007                ibeg = 1
03008                iend = j
03009             \textcolor{keywordflow}{ELSE}
03010                ibeg = j
03011                iend = n
03012 \textcolor{keywordflow}{            END IF}
03013             \textcolor{keywordflow}{DO} 30 i = 1, ibeg - 1
03014                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03015      $            \textcolor{keywordflow}{GO TO} 70
03016    30       \textcolor{keywordflow}{CONTINUE}
03017             \textcolor{keywordflow}{DO} 40 i = iend + 1, lda
03018                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03019      $            \textcolor{keywordflow}{GO TO} 70
03020    40       \textcolor{keywordflow}{CONTINUE}
03021    50    \textcolor{keywordflow}{CONTINUE}
03022 \textcolor{keywordflow}{      END IF}
03023 \textcolor{comment}{*}
03024       lderes = .true.
03025       \textcolor{keywordflow}{GO TO} 80
03026    70 \textcolor{keywordflow}{CONTINUE}
03027       lderes = .false.
03028    80 \textcolor{keywordflow}{RETURN}
03029 \textcolor{comment}{*}
03030 \textcolor{comment}{*     End of LDERES.}
03031 \textcolor{comment}{*}
03032 \textcolor{keyword}{      END}
03033 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }dbeg( RESET )
03034 \textcolor{comment}{*}
03035 \textcolor{comment}{*  Generates random numbers uniformly distributed between -0.5 and 0.5.}
03036 \textcolor{comment}{*}
03037 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03038 \textcolor{comment}{*}
03039 \textcolor{comment}{*  -- Written on 10-August-1987.}
03040 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03041 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03042 \textcolor{comment}{*}
03043 \textcolor{comment}{*     .. Scalar Arguments ..}
03044       \textcolor{keywordtype}{LOGICAL}            reset
03045 \textcolor{comment}{*     .. Local Scalars ..}
03046       \textcolor{keywordtype}{INTEGER}            i, ic, mi
03047 \textcolor{comment}{*     .. Save statement ..}
03048       \textcolor{keywordtype}{SAVE}               i, ic, mi
03049 \textcolor{comment}{*     .. Intrinsic Functions ..}
03050       \textcolor{keywordtype}{INTRINSIC}          dble
03051 \textcolor{comment}{*     .. Executable Statements ..}
03052       \textcolor{keywordflow}{IF}( reset )\textcolor{keywordflow}{THEN}
03053 \textcolor{comment}{*        Initialize local variables.}
03054          mi = 891
03055          i = 7
03056          ic = 0
03057          reset = .false.
03058 \textcolor{keywordflow}{      END IF}
03059 \textcolor{comment}{*}
03060 \textcolor{comment}{*     The sequence of values of I is bounded between 1 and 999.}
03061 \textcolor{comment}{*     If initial I = 1,2,3,6,7 or 9, the period will be 50.}
03062 \textcolor{comment}{*     If initial I = 4 or 8, the period will be 25.}
03063 \textcolor{comment}{*     If initial I = 5, the period will be 10.}
03064 \textcolor{comment}{*     IC is used to break up the period by skipping 1 value of I in 6.}
03065 \textcolor{comment}{*}
03066       ic = ic + 1
03067    10 i = i*mi
03068       i = i - 1000*( i/1000 )
03069       \textcolor{keywordflow}{IF}( ic.GE.5 )\textcolor{keywordflow}{THEN}
03070          ic = 0
03071          \textcolor{keywordflow}{GO TO} 10
03072 \textcolor{keywordflow}{      END IF}
03073       dbeg = dble( i - 500 )/1001.0d0
03074       \textcolor{keywordflow}{RETURN}
03075 \textcolor{comment}{*}
03076 \textcolor{comment}{*     End of DBEG.}
03077 \textcolor{comment}{*}
03078 \textcolor{keyword}{      END}
03079 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }ddiff( X, Y )
03080 \textcolor{comment}{*}
03081 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03082 \textcolor{comment}{*}
03083 \textcolor{comment}{*  -- Written on 10-August-1987.}
03084 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03085 \textcolor{comment}{*}
03086 \textcolor{comment}{*     .. Scalar Arguments ..}
03087       \textcolor{keywordtype}{DOUBLE PRECISION}   x, y
03088 \textcolor{comment}{*     .. Executable Statements ..}
03089       ddiff = x - y
03090       \textcolor{keywordflow}{RETURN}
03091 \textcolor{comment}{*}
03092 \textcolor{comment}{*     End of DDIFF.}
03093 \textcolor{comment}{*}
03094 \textcolor{keyword}{      END}
03095 \textcolor{keyword}{      SUBROUTINE }chkxer( SRNAMT, INFOT, NOUT, LERR, OK )
03096 \textcolor{comment}{*}
03097 \textcolor{comment}{*  Tests whether XERBLA has detected an error when it should.}
03098 \textcolor{comment}{*}
03099 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03100 \textcolor{comment}{*}
03101 \textcolor{comment}{*  -- Written on 10-August-1987.}
03102 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03103 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03104 \textcolor{comment}{*}
03105 \textcolor{comment}{*     .. Scalar Arguments ..}
03106       \textcolor{keywordtype}{INTEGER}            infot, nout
03107       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03108       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03109 \textcolor{comment}{*     .. Executable Statements ..}
03110       \textcolor{keywordflow}{IF}( .NOT.lerr )\textcolor{keywordflow}{THEN}
03111          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )infot, srnamt
03112          ok = .false.
03113 \textcolor{keywordflow}{      END IF}
03114       lerr = .false.
03115       \textcolor{keywordflow}{RETURN}
03116 \textcolor{comment}{*}
03117  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ***** ILLEGAL VALUE OF PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' NOT D'},
03118      $      \textcolor{stringliteral}{'ETECTED BY '}, a6, \textcolor{stringliteral}{' *****'} )
03119 \textcolor{comment}{*}
03120 \textcolor{comment}{*     End of CHKXER.}
03121 \textcolor{comment}{*}
03122 \textcolor{keyword}{      END}
03123 \textcolor{keyword}{      SUBROUTINE }xerbla( SRNAME, INFO )
03124 \textcolor{comment}{*}
03125 \textcolor{comment}{*  This is a special version of XERBLA to be used only as part of}
03126 \textcolor{comment}{*  the test program for testing error exits from the Level 2 BLAS}
03127 \textcolor{comment}{*  routines.}
03128 \textcolor{comment}{*}
03129 \textcolor{comment}{*  XERBLA  is an error handler for the Level 2 BLAS routines.}
03130 \textcolor{comment}{*}
03131 \textcolor{comment}{*  It is called by the Level 2 BLAS routines if an input parameter is}
03132 \textcolor{comment}{*  invalid.}
03133 \textcolor{comment}{*}
03134 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03135 \textcolor{comment}{*}
03136 \textcolor{comment}{*  -- Written on 10-August-1987.}
03137 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03138 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03139 \textcolor{comment}{*}
03140 \textcolor{comment}{*     .. Scalar Arguments ..}
03141       \textcolor{keywordtype}{INTEGER}            info
03142       \textcolor{keywordtype}{CHARACTER*6}        srname
03143 \textcolor{comment}{*     .. Scalars in Common ..}
03144       \textcolor{keywordtype}{INTEGER}            infot, nout
03145       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03146       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03147 \textcolor{comment}{*     .. Common blocks ..}
03148       \textcolor{keyword}{COMMON}             /infoc/infot, nout, ok, lerr
03149       \textcolor{keyword}{COMMON}             /srnamc/srnamt
03150 \textcolor{comment}{*     .. Executable Statements ..}
03151       lerr = .true.
03152       \textcolor{keywordflow}{IF}( info.NE.infot )\textcolor{keywordflow}{THEN}
03153          \textcolor{keywordflow}{IF}( infot.NE.0 )\textcolor{keywordflow}{THEN}
03154             \textcolor{keyword}{WRITE}( nout, fmt = 9999 )info, infot
03155          \textcolor{keywordflow}{ELSE}
03156             \textcolor{keyword}{WRITE}( nout, fmt = 9997 )info
03157 \textcolor{keywordflow}{         END IF}
03158          ok = .false.
03159 \textcolor{keywordflow}{      END IF}
03160       \textcolor{keywordflow}{IF}( srname.NE.srnamt )\textcolor{keywordflow}{THEN}
03161          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srname, srnamt
03162          ok = .false.
03163 \textcolor{keywordflow}{      END IF}
03164       \textcolor{keywordflow}{RETURN}
03165 \textcolor{comment}{*}
03166  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6, \textcolor{stringliteral}{' INSTEAD'},
03167      $      \textcolor{stringliteral}{' OF '}, i2, \textcolor{stringliteral}{' *******'} )
03168  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH SRNAME = '}, a6, \textcolor{stringliteral}{' INSTE'},
03169      $      \textcolor{stringliteral}{'AD OF '}, a6, \textcolor{stringliteral}{' *******'} )
03170  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6,
03171      $      \textcolor{stringliteral}{' *******'} )
03172 \textcolor{comment}{*}
03173 \textcolor{comment}{*     End of XERBLA}
03174 \textcolor{comment}{*}
03175 \textcolor{keyword}{      END}
03176 
\end{DoxyCode}
