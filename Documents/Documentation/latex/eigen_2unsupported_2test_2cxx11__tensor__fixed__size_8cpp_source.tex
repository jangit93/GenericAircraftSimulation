\hypertarget{eigen_2unsupported_2test_2cxx11__tensor__fixed__size_8cpp_source}{}\section{eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+fixed\+\_\+size.cpp}
\label{eigen_2unsupported_2test_2cxx11__tensor__fixed__size_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+fixed\+\_\+size.\+cpp@{cxx11\+\_\+tensor\+\_\+fixed\+\_\+size.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 \textcolor{keyword}{using} \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{Eigen::RowMajor};
00016 
00017 
00018 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_0d()
00019 \{
00020   TensorFixedSize<float, Sizes<> > scalar1;
00021   TensorFixedSize<float, Sizes<>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> scalar2;
00022   VERIFY\_IS\_EQUAL(scalar1.rank(), 0);
00023   VERIFY\_IS\_EQUAL(scalar1.size(), 1);
00024   VERIFY\_IS\_EQUAL(array\_prod(scalar1.dimensions()), 1);
00025 
00026   scalar1() = 7.0;
00027   scalar2() = 13.0;
00028 
00029   \textcolor{comment}{// Test against shallow copy.}
00030   TensorFixedSize<float, Sizes<> > copy = scalar1;
00031   VERIFY\_IS\_NOT\_EQUAL(scalar1.data(), copy.data());
00032   VERIFY\_IS\_APPROX(scalar1(), copy());
00033   copy = scalar1;
00034   VERIFY\_IS\_NOT\_EQUAL(scalar1.data(), copy.data());
00035   VERIFY\_IS\_APPROX(scalar1(), copy());
00036 
00037   TensorFixedSize<float, Sizes<> > scalar3 = scalar1.sqrt();
00038   TensorFixedSize<float, Sizes<>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> scalar4 = scalar2.sqrt();
00039   VERIFY\_IS\_EQUAL(scalar3.rank(), 0);
00040   VERIFY\_IS\_APPROX(scalar3(), sqrtf(7.0));
00041   VERIFY\_IS\_APPROX(scalar4(), sqrtf(13.0));
00042 
00043   scalar3 = scalar1 + scalar2;
00044   VERIFY\_IS\_APPROX(scalar3(), 7.0f + 13.0f);
00045 \}
00046 
00047 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_1d()
00048 \{
00049   TensorFixedSize<float, Sizes<6> > vec1;
00050   TensorFixedSize<float, Sizes<6>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> vec2;
00051 
00052   VERIFY\_IS\_EQUAL((vec1.size()), 6);
00053   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((vec1.dimensions()[0]), 6);}
00054   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((vec1.dimension(0)), 6);}
00055 
00056   vec1(0) = 4.0;  vec2(0) = 0.0;
00057   vec1(1) = 8.0;  vec2(1) = 1.0;
00058   vec1(2) = 15.0; vec2(2) = 2.0;
00059   vec1(3) = 16.0; vec2(3) = 3.0;
00060   vec1(4) = 23.0; vec2(4) = 4.0;
00061   vec1(5) = 42.0; vec2(5) = 5.0;
00062 
00063   \textcolor{comment}{// Test against shallow copy.}
00064   TensorFixedSize<float, Sizes<6> > copy = vec1;
00065   VERIFY\_IS\_NOT\_EQUAL(vec1.data(), copy.data());
00066   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 6; ++i) \{
00067     VERIFY\_IS\_APPROX(vec1(i), copy(i));
00068   \}
00069   copy = vec1;
00070   VERIFY\_IS\_NOT\_EQUAL(vec1.data(), copy.data());
00071   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 6; ++i) \{
00072     VERIFY\_IS\_APPROX(vec1(i), copy(i));
00073   \}
00074 
00075   TensorFixedSize<float, Sizes<6> > vec3 = vec1.sqrt();
00076   TensorFixedSize<float, Sizes<6>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> vec4 = vec2.sqrt();
00077 
00078   VERIFY\_IS\_EQUAL((vec3.size()), 6);
00079   VERIFY\_IS\_EQUAL(vec3.rank(), 1);
00080   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((vec3.dimensions()[0]), 6);}
00081   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((vec3.dimension(0)), 6);}
00082 
00083   VERIFY\_IS\_APPROX(vec3(0), sqrtf(4.0));
00084   VERIFY\_IS\_APPROX(vec3(1), sqrtf(8.0));
00085   VERIFY\_IS\_APPROX(vec3(2), sqrtf(15.0));
00086   VERIFY\_IS\_APPROX(vec3(3), sqrtf(16.0));
00087   VERIFY\_IS\_APPROX(vec3(4), sqrtf(23.0));
00088   VERIFY\_IS\_APPROX(vec3(5), sqrtf(42.0));
00089 
00090   VERIFY\_IS\_APPROX(vec4(0), sqrtf(0.0));
00091   VERIFY\_IS\_APPROX(vec4(1), sqrtf(1.0));
00092   VERIFY\_IS\_APPROX(vec4(2), sqrtf(2.0));
00093   VERIFY\_IS\_APPROX(vec4(3), sqrtf(3.0));
00094   VERIFY\_IS\_APPROX(vec4(4), sqrtf(4.0));
00095   VERIFY\_IS\_APPROX(vec4(5), sqrtf(5.0));
00096 
00097   vec3 = vec1 + vec2;
00098   VERIFY\_IS\_APPROX(vec3(0), 4.0f + 0.0f);
00099   VERIFY\_IS\_APPROX(vec3(1), 8.0f + 1.0f);
00100   VERIFY\_IS\_APPROX(vec3(2), 15.0f + 2.0f);
00101   VERIFY\_IS\_APPROX(vec3(3), 16.0f + 3.0f);
00102   VERIFY\_IS\_APPROX(vec3(4), 23.0f + 4.0f);
00103   VERIFY\_IS\_APPROX(vec3(5), 42.0f + 5.0f);
00104 \}
00105 
00106 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_tensor\_map()
00107 \{
00108   TensorFixedSize<float, Sizes<6> > vec1;
00109   TensorFixedSize<float, Sizes<6>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> vec2;
00110 
00111   vec1(0) = 4.0;  vec2(0) = 0.0;
00112   vec1(1) = 8.0;  vec2(1) = 1.0;
00113   vec1(2) = 15.0; vec2(2) = 2.0;
00114   vec1(3) = 16.0; vec2(3) = 3.0;
00115   vec1(4) = 23.0; vec2(4) = 4.0;
00116   vec1(5) = 42.0; vec2(5) = 5.0;
00117 
00118   \textcolor{keywordtype}{float} data3[6];
00119   TensorMap<TensorFixedSize<float, Sizes<6> > > vec3(data3, 6);
00120   vec3 = vec1.sqrt() + vec2;
00121 
00122   VERIFY\_IS\_APPROX(vec3(0), sqrtf(4.0));
00123   VERIFY\_IS\_APPROX(vec3(1), sqrtf(8.0) + 1.0f);
00124   VERIFY\_IS\_APPROX(vec3(2), sqrtf(15.0) + 2.0f);
00125   VERIFY\_IS\_APPROX(vec3(3), sqrtf(16.0) + 3.0f);
00126   VERIFY\_IS\_APPROX(vec3(4), sqrtf(23.0) + 4.0f);
00127   VERIFY\_IS\_APPROX(vec3(5), sqrtf(42.0) + 5.0f);
00128 \}
00129 
00130 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_2d()
00131 \{
00132   \textcolor{keywordtype}{float} data1[6];
00133   TensorMap<TensorFixedSize<float, Sizes<2, 3> > > mat1(data1,2,3);
00134   \textcolor{keywordtype}{float} data2[6];
00135   TensorMap<TensorFixedSize<float, Sizes<2, 3>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> > mat2(data2,2,3);
00136 
00137   VERIFY\_IS\_EQUAL((mat1.size()), 2*3);
00138   VERIFY\_IS\_EQUAL(mat1.rank(), 2);
00139   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat1.dimension(0)), 2);}
00140   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat1.dimension(1)), 3);}
00141 
00142   mat1(0,0) = 0.0;
00143   mat1(0,1) = 1.0;
00144   mat1(0,2) = 2.0;
00145   mat1(1,0) = 3.0;
00146   mat1(1,1) = 4.0;
00147   mat1(1,2) = 5.0;
00148 
00149   mat2(0,0) = -0.0;
00150   mat2(0,1) = -1.0;
00151   mat2(0,2) = -2.0;
00152   mat2(1,0) = -3.0;
00153   mat2(1,1) = -4.0;
00154   mat2(1,2) = -5.0;
00155 
00156   TensorFixedSize<float, Sizes<2, 3> > mat3;
00157   TensorFixedSize<float, Sizes<2, 3>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> mat4;
00158   mat3 = mat1.abs();
00159   mat4 = mat2.abs();
00160 
00161   VERIFY\_IS\_EQUAL((mat3.size()), 2*3);
00162     \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat3.dimension(0)), 2);}
00163     \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat3.dimension(1)), 3);}
00164 
00165   VERIFY\_IS\_APPROX(mat3(0,0), 0.0f);
00166   VERIFY\_IS\_APPROX(mat3(0,1), 1.0f);
00167   VERIFY\_IS\_APPROX(mat3(0,2), 2.0f);
00168   VERIFY\_IS\_APPROX(mat3(1,0), 3.0f);
00169   VERIFY\_IS\_APPROX(mat3(1,1), 4.0f);
00170   VERIFY\_IS\_APPROX(mat3(1,2), 5.0f);
00171 
00172   VERIFY\_IS\_APPROX(mat4(0,0), 0.0f);
00173   VERIFY\_IS\_APPROX(mat4(0,1), 1.0f);
00174   VERIFY\_IS\_APPROX(mat4(0,2), 2.0f);
00175   VERIFY\_IS\_APPROX(mat4(1,0), 3.0f);
00176   VERIFY\_IS\_APPROX(mat4(1,1), 4.0f);
00177   VERIFY\_IS\_APPROX(mat4(1,2), 5.0f);
00178 \}
00179 
00180 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_3d()
00181 \{
00182   TensorFixedSize<float, Sizes<2, 3, 7> > mat1;
00183   TensorFixedSize<float, Sizes<2, 3, 7>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> mat2;
00184 
00185   VERIFY\_IS\_EQUAL((mat1.size()), 2*3*7);
00186   VERIFY\_IS\_EQUAL(mat1.rank(), 3);
00187   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat1.dimension(0)), 2);}
00188   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat1.dimension(1)), 3);}
00189   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat1.dimension(2)), 7);}
00190 
00191   \textcolor{keywordtype}{float} val = 0.0f;
00192   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00193     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00194       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00195         mat1(i,j,k) = val;
00196         mat2(i,j,k) = val;
00197         val += 1.0f;
00198       \}
00199     \}
00200   \}
00201 
00202   TensorFixedSize<float, Sizes<2, 3, 7> > mat3;
00203   mat3 = mat1.sqrt();
00204   TensorFixedSize<float, Sizes<2, 3, 7>, \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}> mat4;
00205   mat4 = mat2.sqrt();
00206 
00207   VERIFY\_IS\_EQUAL((mat3.size()), 2*3*7);
00208   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat3.dimension(0)), 2);}
00209   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat3.dimension(1)), 3);}
00210   \textcolor{comment}{//  VERIFY\_IS\_EQUAL((mat3.dimension(2)), 7);}
00211 
00212 
00213   val = 0.0f;
00214   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00215     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00216       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00217         VERIFY\_IS\_APPROX(mat3(i,j,k), sqrtf(val));
00218         VERIFY\_IS\_APPROX(mat4(i,j,k), sqrtf(val));
00219         val += 1.0f;
00220       \}
00221     \}
00222   \}
00223 \}
00224 
00225 
00226 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_array()
00227 \{
00228   TensorFixedSize<float, Sizes<2, 3, 7> > mat1;
00229   \textcolor{keywordtype}{float} val = 0.0f;
00230   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00231     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00232       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00233         mat1(i,j,k) = val;
00234         val += 1.0f;
00235       \}
00236     \}
00237   \}
00238 
00239   TensorFixedSize<float, Sizes<2, 3, 7> > mat3;
00240   mat3 = mat1.pow(3.5f);
00241 
00242   val = 0.0f;
00243   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00244     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00245       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 7; ++k) \{
00246         VERIFY\_IS\_APPROX(mat3(i,j,k), powf(val, 3.5f));
00247         val += 1.0f;
00248       \}
00249     \}
00250   \}
00251 \}
00252 
00253 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_fixed\_size()
00254 \{
00255   CALL\_SUBTEST(test\_0d());
00256   CALL\_SUBTEST(test\_1d());
00257   CALL\_SUBTEST(test\_tensor\_map());
00258   CALL\_SUBTEST(test\_2d());
00259   CALL\_SUBTEST(test\_3d());
00260   CALL\_SUBTEST(test\_array());
00261 \}
\end{DoxyCode}
