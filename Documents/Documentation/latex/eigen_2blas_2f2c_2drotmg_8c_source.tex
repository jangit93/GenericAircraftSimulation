\hypertarget{eigen_2blas_2f2c_2drotmg_8c_source}{}\section{eigen/blas/f2c/drotmg.c}
\label{eigen_2blas_2f2c_2drotmg_8c_source}\index{drotmg.\+c@{drotmg.\+c}}

\begin{DoxyCode}
00001 \textcolor{comment}{/* drotmg.f -- translated by f2c (version 20100827).}
00002 \textcolor{comment}{   You must link the resulting object file with libf2c:}
00003 \textcolor{comment}{    on Microsoft Windows system, link with libf2c.lib;}
00004 \textcolor{comment}{    on Linux or Unix systems, link with .../path/to/libf2c.a -lm}
00005 \textcolor{comment}{    or, if you install libf2c.a in a standard place, with -lf2c -lm}
00006 \textcolor{comment}{    -- in that order, at the end of the command line, as in}
00007 \textcolor{comment}{        cc *.o -lf2c -lm}
00008 \textcolor{comment}{    Source for libf2c is in /netlib/f2c/libf2c.zip, e.g.,}
00009 \textcolor{comment}{}
00010 \textcolor{comment}{        http://www.netlib.org/f2c/libf2c.zip}
00011 \textcolor{comment}{*/}
00012 
00013 \textcolor{preprocessor}{#include "datatypes.h"}
00014 
00015 \textcolor{comment}{/* Subroutine */} \textcolor{keywordtype}{int} drotmg\_(doublereal *dd1, doublereal *dd2, doublereal *
00016     dx1, doublereal *dy1, doublereal *dparam)
00017 \{
00018     \textcolor{comment}{/* Initialized data */}
00019 
00020     \textcolor{keyword}{static} doublereal zero = 0.;
00021     \textcolor{keyword}{static} doublereal one = 1.;
00022     \textcolor{keyword}{static} doublereal two = 2.;
00023     \textcolor{keyword}{static} doublereal gam = 4096.;
00024     \textcolor{keyword}{static} doublereal gamsq = 16777216.;
00025     \textcolor{keyword}{static} doublereal rgamsq = 5.9604645e-8;
00026 
00027     \textcolor{comment}{/* Format strings */}
00028     \textcolor{keyword}{static} \textcolor{keywordtype}{char} fmt\_120[] = \textcolor{stringliteral}{""};
00029     \textcolor{keyword}{static} \textcolor{keywordtype}{char} fmt\_150[] = \textcolor{stringliteral}{""};
00030     \textcolor{keyword}{static} \textcolor{keywordtype}{char} fmt\_180[] = \textcolor{stringliteral}{""};
00031     \textcolor{keyword}{static} \textcolor{keywordtype}{char} fmt\_210[] = \textcolor{stringliteral}{""};
00032 
00033     \textcolor{comment}{/* System generated locals */}
00034     doublereal d\_\_1;
00035 
00036     \textcolor{comment}{/* Local variables */}
00037     doublereal du, dp1, dp2, dq1, dq2, dh11, dh12, dh21, dh22;
00038     integer igo;
00039     doublereal dflag, dtemp;
00040 
00041     \textcolor{comment}{/* Assigned format variables */}
00042     \textcolor{keyword}{static} \textcolor{keywordtype}{char} *igo\_fmt;
00043 
00044 \textcolor{comment}{/*     .. Scalar Arguments .. */}
00045 \textcolor{comment}{/*     .. */}
00046 \textcolor{comment}{/*     .. Array Arguments .. */}
00047 \textcolor{comment}{/*     .. */}
00048 
00049 \textcolor{comment}{/*  Purpose */}
00050 \textcolor{comment}{/*  ======= */}
00051 
00052 \textcolor{comment}{/*     CONSTRUCT THE MODIFIED GIVENS TRANSFORMATION MATRIX H WHICH ZEROS */}
00053 \textcolor{comment}{/*     THE SECOND COMPONENT OF THE 2-VECTOR  (DSQRT(DD1)*DX1,DSQRT(DD2)* */}
00054 \textcolor{comment}{/*     DY2)**T. */}
00055 \textcolor{comment}{/*     WITH DPARAM(1)=DFLAG, H HAS ONE OF THE FOLLOWING FORMS.. */}
00056 
00057 \textcolor{comment}{/*     DFLAG=-1.D0     DFLAG=0.D0        DFLAG=1.D0     DFLAG=-2.D0 */}
00058 
00059 \textcolor{comment}{/*       (DH11  DH12)    (1.D0  DH12)    (DH11  1.D0)    (1.D0  0.D0) */}
00060 \textcolor{comment}{/*     H=(          )    (          )    (          )    (          ) */}
00061 \textcolor{comment}{/*       (DH21  DH22),   (DH21  1.D0),   (-1.D0 DH22),   (0.D0  1.D0). */}
00062 \textcolor{comment}{/*     LOCATIONS 2-4 OF DPARAM CONTAIN DH11, DH21, DH12, AND DH22 */}
00063 \textcolor{comment}{/*     RESPECTIVELY. (VALUES OF 1.D0, -1.D0, OR 0.D0 IMPLIED BY THE */}
00064 \textcolor{comment}{/*     VALUE OF DPARAM(1) ARE NOT STORED IN DPARAM.) */}
00065 
00066 \textcolor{comment}{/*     THE VALUES OF GAMSQ AND RGAMSQ SET IN THE DATA STATEMENT MAY BE */}
00067 \textcolor{comment}{/*     INEXACT.  THIS IS OK AS THEY ARE ONLY USED FOR TESTING THE SIZE */}
00068 \textcolor{comment}{/*     OF DD1 AND DD2.  ALL ACTUAL SCALING OF DATA IS DONE USING GAM. */}
00069 
00070 
00071 \textcolor{comment}{/*  Arguments */}
00072 \textcolor{comment}{/*  ========= */}
00073 
00074 \textcolor{comment}{/*  DD1    (input/output) DOUBLE PRECISION */}
00075 
00076 \textcolor{comment}{/*  DD2    (input/output) DOUBLE PRECISION */}
00077 
00078 \textcolor{comment}{/*  DX1    (input/output) DOUBLE PRECISION */}
00079 
00080 \textcolor{comment}{/*  DY1    (input) DOUBLE PRECISION */}
00081 
00082 \textcolor{comment}{/*  DPARAM (input/output)  DOUBLE PRECISION array, dimension 5 */}
00083 \textcolor{comment}{/*     DPARAM(1)=DFLAG */}
00084 \textcolor{comment}{/*     DPARAM(2)=DH11 */}
00085 \textcolor{comment}{/*     DPARAM(3)=DH21 */}
00086 \textcolor{comment}{/*     DPARAM(4)=DH12 */}
00087 \textcolor{comment}{/*     DPARAM(5)=DH22 */}
00088 
00089 \textcolor{comment}{/*  ===================================================================== */}
00090 
00091 \textcolor{comment}{/*     .. Local Scalars .. */}
00092 \textcolor{comment}{/*     .. */}
00093 \textcolor{comment}{/*     .. Intrinsic Functions .. */}
00094 \textcolor{comment}{/*     .. */}
00095 \textcolor{comment}{/*     .. Data statements .. */}
00096 
00097     \textcolor{comment}{/* Parameter adjustments */}
00098     --dparam;
00099 
00100     \textcolor{comment}{/* Function Body */}
00101 \textcolor{comment}{/*     .. */}
00102     \textcolor{keywordflow}{if} (! (*dd1 < zero)) \{
00103     \textcolor{keywordflow}{goto} L10;
00104     \}
00105 \textcolor{comment}{/*       GO ZERO-H-D-AND-DX1.. */}
00106     \textcolor{keywordflow}{goto} L60;
00107 L10:
00108 \textcolor{comment}{/*     CASE-DD1-NONNEGATIVE */}
00109     dp2 = *dd2 * *dy1;
00110     \textcolor{keywordflow}{if} (! (dp2 == zero)) \{
00111     \textcolor{keywordflow}{goto} L20;
00112     \}
00113     dflag = -two;
00114     \textcolor{keywordflow}{goto} L260;
00115 \textcolor{comment}{/*     REGULAR-CASE.. */}
00116 L20:
00117     dp1 = *dd1 * *dx1;
00118     dq2 = dp2 * *dy1;
00119     dq1 = dp1 * *dx1;
00120 
00121     \textcolor{keywordflow}{if} (! (abs(dq1) > abs(dq2))) \{
00122     \textcolor{keywordflow}{goto} L40;
00123     \}
00124     dh21 = -(*dy1) / *dx1;
00125     dh12 = dp2 / dp1;
00126 
00127     du = one - dh12 * dh21;
00128 
00129     \textcolor{keywordflow}{if} (! (du <= zero)) \{
00130     \textcolor{keywordflow}{goto} L30;
00131     \}
00132 \textcolor{comment}{/*         GO ZERO-H-D-AND-DX1.. */}
00133     \textcolor{keywordflow}{goto} L60;
00134 L30:
00135     dflag = zero;
00136     *dd1 /= du;
00137     *dd2 /= du;
00138     *dx1 *= du;
00139 \textcolor{comment}{/*         GO SCALE-CHECK.. */}
00140     \textcolor{keywordflow}{goto} L100;
00141 L40:
00142     \textcolor{keywordflow}{if} (! (dq2 < zero)) \{
00143     \textcolor{keywordflow}{goto} L50;
00144     \}
00145 \textcolor{comment}{/*         GO ZERO-H-D-AND-DX1.. */}
00146     \textcolor{keywordflow}{goto} L60;
00147 L50:
00148     dflag = one;
00149     dh11 = dp1 / dp2;
00150     dh22 = *dx1 / *dy1;
00151     du = one + dh11 * dh22;
00152     dtemp = *dd2 / du;
00153     *dd2 = *dd1 / du;
00154     *dd1 = dtemp;
00155     *dx1 = *dy1 * du;
00156 \textcolor{comment}{/*         GO SCALE-CHECK */}
00157     \textcolor{keywordflow}{goto} L100;
00158 \textcolor{comment}{/*     PROCEDURE..ZERO-H-D-AND-DX1.. */}
00159 L60:
00160     dflag = -one;
00161     dh11 = zero;
00162     dh12 = zero;
00163     dh21 = zero;
00164     dh22 = zero;
00165 
00166     *dd1 = zero;
00167     *dd2 = zero;
00168     *dx1 = zero;
00169 \textcolor{comment}{/*         RETURN.. */}
00170     \textcolor{keywordflow}{goto} L220;
00171 \textcolor{comment}{/*     PROCEDURE..FIX-H.. */}
00172 L70:
00173     \textcolor{keywordflow}{if} (! (dflag >= zero)) \{
00174     \textcolor{keywordflow}{goto} L90;
00175     \}
00176 
00177     \textcolor{keywordflow}{if} (! (dflag == zero)) \{
00178     \textcolor{keywordflow}{goto} L80;
00179     \}
00180     dh11 = one;
00181     dh22 = one;
00182     dflag = -one;
00183     \textcolor{keywordflow}{goto} L90;
00184 L80:
00185     dh21 = -one;
00186     dh12 = one;
00187     dflag = -one;
00188 L90:
00189     \textcolor{keywordflow}{switch} (igo) \{
00190     \textcolor{keywordflow}{case} 0: \textcolor{keywordflow}{goto} L120;
00191     \textcolor{keywordflow}{case} 1: \textcolor{keywordflow}{goto} L150;
00192     \textcolor{keywordflow}{case} 2: \textcolor{keywordflow}{goto} L180;
00193     \textcolor{keywordflow}{case} 3: \textcolor{keywordflow}{goto} L210;
00194     \}
00195 \textcolor{comment}{/*     PROCEDURE..SCALE-CHECK */}
00196 L100:
00197 L110:
00198     \textcolor{keywordflow}{if} (! (*dd1 <= rgamsq)) \{
00199     \textcolor{keywordflow}{goto} L130;
00200     \}
00201     \textcolor{keywordflow}{if} (*dd1 == zero) \{
00202     \textcolor{keywordflow}{goto} L160;
00203     \}
00204     igo = 0;
00205     igo\_fmt = fmt\_120;
00206 \textcolor{comment}{/*              FIX-H.. */}
00207     \textcolor{keywordflow}{goto} L70;
00208 L120:
00209 \textcolor{comment}{/* Computing 2nd power */}
00210     d\_\_1 = gam;
00211     *dd1 *= d\_\_1 * d\_\_1;
00212     *dx1 /= gam;
00213     dh11 /= gam;
00214     dh12 /= gam;
00215     \textcolor{keywordflow}{goto} L110;
00216 L130:
00217 L140:
00218     \textcolor{keywordflow}{if} (! (*dd1 >= gamsq)) \{
00219     \textcolor{keywordflow}{goto} L160;
00220     \}
00221     igo = 1;
00222     igo\_fmt = fmt\_150;
00223 \textcolor{comment}{/*              FIX-H.. */}
00224     \textcolor{keywordflow}{goto} L70;
00225 L150:
00226 \textcolor{comment}{/* Computing 2nd power */}
00227     d\_\_1 = gam;
00228     *dd1 /= d\_\_1 * d\_\_1;
00229     *dx1 *= gam;
00230     dh11 *= gam;
00231     dh12 *= gam;
00232     \textcolor{keywordflow}{goto} L140;
00233 L160:
00234 L170:
00235     \textcolor{keywordflow}{if} (! (abs(*dd2) <= rgamsq)) \{
00236     \textcolor{keywordflow}{goto} L190;
00237     \}
00238     \textcolor{keywordflow}{if} (*dd2 == zero) \{
00239     \textcolor{keywordflow}{goto} L220;
00240     \}
00241     igo = 2;
00242     igo\_fmt = fmt\_180;
00243 \textcolor{comment}{/*              FIX-H.. */}
00244     \textcolor{keywordflow}{goto} L70;
00245 L180:
00246 \textcolor{comment}{/* Computing 2nd power */}
00247     d\_\_1 = gam;
00248     *dd2 *= d\_\_1 * d\_\_1;
00249     dh21 /= gam;
00250     dh22 /= gam;
00251     \textcolor{keywordflow}{goto} L170;
00252 L190:
00253 L200:
00254     \textcolor{keywordflow}{if} (! (abs(*dd2) >= gamsq)) \{
00255     \textcolor{keywordflow}{goto} L220;
00256     \}
00257     igo = 3;
00258     igo\_fmt = fmt\_210;
00259 \textcolor{comment}{/*              FIX-H.. */}
00260     \textcolor{keywordflow}{goto} L70;
00261 L210:
00262 \textcolor{comment}{/* Computing 2nd power */}
00263     d\_\_1 = gam;
00264     *dd2 /= d\_\_1 * d\_\_1;
00265     dh21 *= gam;
00266     dh22 *= gam;
00267     \textcolor{keywordflow}{goto} L200;
00268 L220:
00269     \textcolor{keywordflow}{if} (dflag < 0.) \{
00270     \textcolor{keywordflow}{goto} L250;
00271     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (dflag == 0) \{
00272     \textcolor{keywordflow}{goto} L230;
00273     \} \textcolor{keywordflow}{else} \{
00274     \textcolor{keywordflow}{goto} L240;
00275     \}
00276 L230:
00277     dparam[3] = dh21;
00278     dparam[4] = dh12;
00279     \textcolor{keywordflow}{goto} L260;
00280 L240:
00281     dparam[2] = dh11;
00282     dparam[5] = dh22;
00283     \textcolor{keywordflow}{goto} L260;
00284 L250:
00285     dparam[2] = dh11;
00286     dparam[3] = dh21;
00287     dparam[4] = dh12;
00288     dparam[5] = dh22;
00289 L260:
00290     dparam[1] = dflag;
00291     \textcolor{keywordflow}{return} 0;
00292 \} \textcolor{comment}{/* drotmg\_ */}
00293 
\end{DoxyCode}
