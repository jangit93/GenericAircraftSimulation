\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__padding_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+padding.cpp}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__padding_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+padding.\+cpp@{cxx11\+\_\+tensor\+\_\+padding.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 
00016 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} DataLayout>
00017 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_simple\_padding()
00018 \{
00019   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} tensor(2,3,5,7);
00020   tensor.setRandom();
00021 
00022   array<std::pair<ptrdiff\_t, ptrdiff\_t>, 4> paddings;
00023   paddings[0] = std::make\_pair(0, 0);
00024   paddings[1] = std::make\_pair(2, 1);
00025   paddings[2] = std::make\_pair(3, 4);
00026   paddings[3] = std::make\_pair(0, 0);
00027 
00028   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} padded;
00029   padded = tensor.pad(paddings);
00030 
00031   VERIFY\_IS\_EQUAL(padded.dimension(0), 2+0);
00032   VERIFY\_IS\_EQUAL(padded.dimension(1), 3+3);
00033   VERIFY\_IS\_EQUAL(padded.dimension(2), 5+7);
00034   VERIFY\_IS\_EQUAL(padded.dimension(3), 7+0);
00035 
00036   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00037     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 6; ++j) \{
00038       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 12; ++k) \{
00039         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00040           \textcolor{keywordflow}{if} (j >= 2 && j < 5 && k >= 3 && k < 8) \{
00041             VERIFY\_IS\_EQUAL(padded(i,j,k,l), tensor(i,j-2,k-3,l));
00042           \} \textcolor{keywordflow}{else} \{
00043             VERIFY\_IS\_EQUAL(padded(i,j,k,l), 0.0f);
00044           \}
00045         \}
00046       \}
00047     \}
00048   \}
00049 \}
00050 
00051 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} DataLayout>
00052 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_padded\_expr()
00053 \{
00054   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} tensor(2,3,5,7);
00055   tensor.setRandom();
00056 
00057   array<std::pair<ptrdiff\_t, ptrdiff\_t>, 4> paddings;
00058   paddings[0] = std::make\_pair(0, 0);
00059   paddings[1] = std::make\_pair(2, 1);
00060   paddings[2] = std::make\_pair(3, 4);
00061   paddings[3] = std::make\_pair(0, 0);
00062 
00063   \hyperlink{struct_eigen_1_1_d_sizes}{Eigen::DSizes<ptrdiff\_t, 2>} reshape\_dims;
00064   reshape\_dims[0] = 12;
00065   reshape\_dims[1] = 84;
00066 
00067   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 2, DataLayout>} result;
00068   result = tensor.pad(paddings).reshape(reshape\_dims);
00069 
00070   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00071     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 6; ++j) \{
00072       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 12; ++k) \{
00073         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00074           \textcolor{keyword}{const} \textcolor{keywordtype}{float} result\_value = DataLayout == \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor} ?
00075               result(i+2*j,k+12*l) : result(j+6*i,l+7*k);
00076           \textcolor{keywordflow}{if} (j >= 2 && j < 5 && k >= 3 && k < 8) \{
00077             VERIFY\_IS\_EQUAL(result\_value, tensor(i,j-2,k-3,l));
00078           \} \textcolor{keywordflow}{else} \{
00079             VERIFY\_IS\_EQUAL(result\_value, 0.0f);
00080           \}
00081         \}
00082       \}
00083     \}
00084   \}
00085 \}
00086 
00087 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_padding()
00088 \{
00089   CALL\_SUBTEST(test\_simple\_padding<ColMajor>());
00090   CALL\_SUBTEST(test\_simple\_padding<RowMajor>());
00091   CALL\_SUBTEST(test\_padded\_expr<ColMajor>());
00092   CALL\_SUBTEST(test\_padded\_expr<RowMajor>());
00093 \}
\end{DoxyCode}
