\hypertarget{matio_2visual__studio_2test_2eigen_2scripts_2relicense_8py_source}{}\section{matio/visual\+\_\+studio/test/eigen/scripts/relicense.py}
\label{matio_2visual__studio_2test_2eigen_2scripts_2relicense_8py_source}\index{relicense.\+py@{relicense.\+py}}

\begin{DoxyCode}
00001 \textcolor{comment}{# This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{# for linear algebra.}
00003 \textcolor{comment}{#}
00004 \textcolor{comment}{# Copyright (C) 2012 Keir Mierle <mierle@gmail.com>}
00005 \textcolor{comment}{#}
00006 \textcolor{comment}{# This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{# Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{# with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 \textcolor{comment}{#}
00010 \textcolor{comment}{# Author: mierle@gmail.com (Keir Mierle)}
00011 \textcolor{comment}{#}
00012 \textcolor{comment}{# Make the long-awaited conversion to MPL.}
00013 
00014 lgpl3\_header = \textcolor{stringliteral}{'''}
00015 \textcolor{stringliteral}{// Eigen is free software; you can redistribute it and/or}
00016 \textcolor{stringliteral}{// modify it under the terms of the GNU Lesser General Public}
00017 \textcolor{stringliteral}{// License as published by the Free Software Foundation; either}
00018 \textcolor{stringliteral}{// version 3 of the License, or (at your option) any later version.}
00019 \textcolor{stringliteral}{//}
00020 \textcolor{stringliteral}{// Alternatively, you can redistribute it and/or}
00021 \textcolor{stringliteral}{// modify it under the terms of the GNU General Public License as}
00022 \textcolor{stringliteral}{// published by the Free Software Foundation; either version 2 of}
00023 \textcolor{stringliteral}{// the License, or (at your option) any later version.}
00024 \textcolor{stringliteral}{//}
00025 \textcolor{stringliteral}{// Eigen is distributed in the hope that it will be useful, but WITHOUT ANY}
00026 \textcolor{stringliteral}{// WARRANTY; without even the implied warranty of MERCHANTABILITY or FITNESS}
00027 \textcolor{stringliteral}{// FOR A PARTICULAR PURPOSE. See the GNU Lesser General Public License or the}
00028 \textcolor{stringliteral}{// GNU General Public License for more details.}
00029 \textcolor{stringliteral}{//}
00030 \textcolor{stringliteral}{// You should have received a copy of the GNU Lesser General Public}
00031 \textcolor{stringliteral}{// License and a copy of the GNU General Public License along with}
00032 \textcolor{stringliteral}{// Eigen. If not, see <http://www.gnu.org/licenses/>.}
00033 \textcolor{stringliteral}{'''}
00034 
00035 mpl2\_header = \textcolor{stringliteral}{"""}
00036 \textcolor{stringliteral}{// This Source Code Form is subject to the terms of the Mozilla}
00037 \textcolor{stringliteral}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00038 \textcolor{stringliteral}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00039 \textcolor{stringliteral}{"""}
00040 
00041 \textcolor{keyword}{import} os
00042 \textcolor{keyword}{import} sys
00043 
00044 exclusions = set([\textcolor{stringliteral}{'relicense.py'}])
00045 
00046 \textcolor{keyword}{def }update(text):
00047   \textcolor{keywordflow}{if} text.find(lgpl3\_header) == -1:
00048     \textcolor{keywordflow}{return} text, \textcolor{keyword}{False}
00049   \textcolor{keywordflow}{return} text.replace(lgpl3\_header, mpl2\_header), \textcolor{keyword}{True}
00050 
00051 rootdir = sys.argv[1]
00052 \textcolor{keywordflow}{for} root, sub\_folders, files \textcolor{keywordflow}{in} os.walk(rootdir):
00053     \textcolor{keywordflow}{for} basename \textcolor{keywordflow}{in} files:
00054         \textcolor{keywordflow}{if} basename \textcolor{keywordflow}{in} exclusions:
00055           \textcolor{keywordflow}{print} \textcolor{stringliteral}{'SKIPPED'}, filename
00056           \textcolor{keywordflow}{continue}
00057         filename = os.path.join(root, basename)
00058         fo = \hyperlink{structfile}{file}(filename)
00059         text = fo.read()
00060         fo.close()
00061 
00062         text, updated = update(text)
00063         \textcolor{keywordflow}{if} updated:
00064           fo = \hyperlink{structfile}{file}(filename, \textcolor{stringliteral}{"w"})
00065           fo.write(text)
00066           fo.close()
00067           \textcolor{keywordflow}{print} \textcolor{stringliteral}{'UPDATED'}, filename
00068         \textcolor{keywordflow}{else}:
00069           \textcolor{keywordflow}{print} \textcolor{stringliteral}{'       '}, filename
\end{DoxyCode}
