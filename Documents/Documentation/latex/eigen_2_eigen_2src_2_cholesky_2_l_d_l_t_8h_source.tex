\hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source}{}\section{eigen/\+Eigen/src/\+Cholesky/\+L\+D\+LT.h}
\label{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source}\index{L\+D\+L\+T.\+h@{L\+D\+L\+T.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2011 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2009 Keir Mierle <mierle@gmail.com>}
00006 \textcolor{comment}{// Copyright (C) 2009 Benoit Jacob <jacob.benoit.1@gmail.com>}
00007 \textcolor{comment}{// Copyright (C) 2011 Timothy E. Holy <tim.holy@gmail.com >}
00008 \textcolor{comment}{//}
00009 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00010 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00011 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00012 
00013 \textcolor{preprocessor}{#ifndef EIGEN\_LDLT\_H}
00014 \textcolor{preprocessor}{#define EIGEN\_LDLT\_H}
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00017 
00018 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00019}\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{00019}   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} UpLo> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{LDLT\_Traits};
00020 
00021   \textcolor{comment}{// PositiveSemiDef means positive semi-definite and non-zero; same for NegativeSemiDef}
00022   \textcolor{keyword}{enum} SignMatrix \{ PositiveSemiDef, NegativeSemiDef, ZeroSign, Indefinite \};
00023 \}
00024 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00050}\hyperlink{group___cholesky___module}{00050} \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType, \textcolor{keywordtype}{int} \_UpLo> \textcolor{keyword}{class }\hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT}
00051 \{
00052   \textcolor{keyword}{public}:
00053     \textcolor{keyword}{typedef} \_MatrixType MatrixType;
00054     \textcolor{keyword}{enum} \{
00055       RowsAtCompileTime = MatrixType::RowsAtCompileTime,
00056       ColsAtCompileTime = MatrixType::ColsAtCompileTime,
00057       MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,
00058       MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime,
00059       UpLo = \_UpLo
00060     \};
00061     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00062     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<typename MatrixType::Scalar>::Real}
       RealScalar;
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00063}\hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{00063}     \textcolor{keyword}{typedef} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Eigen::Index} \hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index}; 
00064     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::StorageIndex StorageIndex;
00065     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{Matrix<Scalar, RowsAtCompileTime, 1, 0, MaxRowsAtCompileTime, 1>}
       \hyperlink{group___core___module}{TmpMatrixType};
00066 
00067     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{Transpositions<RowsAtCompileTime, MaxRowsAtCompileTime>}
       \hyperlink{group___core___module}{TranspositionType};
00068     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{PermutationMatrix<RowsAtCompileTime, MaxRowsAtCompileTime>}
       \hyperlink{group___core___module}{PermutationType};
00069 
00070     \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{internal::LDLT\_Traits<MatrixType,UpLo>} 
      \hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{Traits};
00071 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00077}\hyperlink{group___cholesky___module_a2e06dedd2651649c5b251fbf9ba4e7d4}{00077}     \hyperlink{group___cholesky___module_a2e06dedd2651649c5b251fbf9ba4e7d4}{LDLT}()
00078       : m\_matrix(),
00079         m\_transpositions(),
00080         m\_sign(\hyperlink{namespaceinternal}{internal}::ZeroSign),
00081         m\_isInitialized(false)
00082     \{\}
00083 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00090}\hyperlink{group___cholesky___module_a154aa41bd2460199d48861eaf5e4f597}{00090}     \textcolor{keyword}{explicit} \hyperlink{group___cholesky___module_a154aa41bd2460199d48861eaf5e4f597}{LDLT}(Index size)
00091       : m\_matrix(size, size),
00092         m\_transpositions(size),
00093         m\_temporary(size),
00094         m\_sign(\hyperlink{namespaceinternal}{internal}::ZeroSign),
00095         m\_isInitialized(false)
00096     \{\}
00097 
00104     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00105}\hyperlink{group___cholesky___module_ad0e8d2131ea1a626a08d98e9effb1cc5}{00105}     \textcolor{keyword}{explicit} \hyperlink{group___cholesky___module_ad0e8d2131ea1a626a08d98e9effb1cc5}{LDLT}(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00106       : m\_matrix(matrix.rows(), matrix.cols()),
00107         m\_transpositions(matrix.rows()),
00108         m\_temporary(matrix.rows()),
00109         m\_sign(\hyperlink{namespaceinternal}{internal}::ZeroSign),
00110         m\_isInitialized(false)
00111     \{
00112       compute(matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}());
00113     \}
00114 
00121     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00122}\hyperlink{group___cholesky___module_adf853d6cbbc49f3535a44439bca344d9}{00122}     \textcolor{keyword}{explicit} \hyperlink{group___cholesky___module_adf853d6cbbc49f3535a44439bca344d9}{LDLT}(\hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00123       : m\_matrix(matrix.derived()),
00124         m\_transpositions(matrix.rows()),
00125         m\_temporary(matrix.rows()),
00126         m\_sign(\hyperlink{namespaceinternal}{internal}::ZeroSign),
00127         m\_isInitialized(false)
00128     \{
00129       compute(matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}());
00130     \}
00131 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00135}\hyperlink{group___cholesky___module_a776d0ab6c980847297d25b03b5d2216a}{00135}     \textcolor{keywordtype}{void} \hyperlink{group___cholesky___module_a776d0ab6c980847297d25b03b5d2216a}{setZero}()
00136     \{
00137       m\_isInitialized = \textcolor{keyword}{false};
00138     \}
00139 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00141}\hyperlink{group___cholesky___module_a54838a2e31e53bbe4dcb78b5e80c8484}{00141}     \textcolor{keyword}{inline} \textcolor{keyword}{typename} Traits::MatrixU \hyperlink{group___cholesky___module_a54838a2e31e53bbe4dcb78b5e80c8484}{matrixU}()\textcolor{keyword}{ const}
00142 \textcolor{keyword}{    }\{
00143       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00144       \textcolor{keywordflow}{return} Traits::getU(m\_matrix);
00145     \}
00146 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00148}\hyperlink{group___cholesky___module_af0e6a0df5679873b42cf82a372dd8ddb}{00148}     \textcolor{keyword}{inline} \textcolor{keyword}{typename} Traits::MatrixL \hyperlink{group___cholesky___module_af0e6a0df5679873b42cf82a372dd8ddb}{matrixL}()\textcolor{keyword}{ const}
00149 \textcolor{keyword}{    }\{
00150       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00151       \textcolor{keywordflow}{return} Traits::getL(m\_matrix);
00152     \}
00153 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00156}\hyperlink{group___cholesky___module_a47257d3500f9f7c9a4478158d0e34941}{00156}     \textcolor{keyword}{inline} \textcolor{keyword}{const} TranspositionType& \hyperlink{group___cholesky___module_a47257d3500f9f7c9a4478158d0e34941}{transpositionsP}()\textcolor{keyword}{ const}
00157 \textcolor{keyword}{    }\{
00158       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00159       \textcolor{keywordflow}{return} m\_transpositions;
00160     \}
00161 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00163}\hyperlink{group___cholesky___module_af60b2f826a38a00070e0efccf0572066}{00163}     \textcolor{keyword}{inline} \hyperlink{group___core___module_class_eigen_1_1_diagonal}{Diagonal<const MatrixType>} \hyperlink{group___cholesky___module_af60b2f826a38a00070e0efccf0572066}{vectorD}()\textcolor{keyword}{ const}
00164 \textcolor{keyword}{    }\{
00165       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00166       \textcolor{keywordflow}{return} m\_matrix.diagonal();
00167     \}
00168 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00170}\hyperlink{group___cholesky___module_a5e1c6b7ba8d7b82575d6ffdc3bf35bcb}{00170}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___cholesky___module_a5e1c6b7ba8d7b82575d6ffdc3bf35bcb}{isPositive}()\textcolor{keyword}{ const}
00171 \textcolor{keyword}{    }\{
00172       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00173       \textcolor{keywordflow}{return} m\_sign == internal::PositiveSemiDef || m\_sign == internal::ZeroSign;
00174     \}
00175 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00177}\hyperlink{group___cholesky___module_aabd3e7aebe844034caca4c62dbe9c1eb}{00177}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___cholesky___module_aabd3e7aebe844034caca4c62dbe9c1eb}{isNegative}(\textcolor{keywordtype}{void})\textcolor{keyword}{ const}
00178 \textcolor{keyword}{    }\{
00179       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00180       \textcolor{keywordflow}{return} m\_sign == internal::NegativeSemiDef || m\_sign == internal::ZeroSign;
00181     \}
00182 
00198     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs>
00199     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<LDLT, Rhs>}
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00200}\hyperlink{group___cholesky___module_aa257dd7a8acf8b347d5a22a13d6ca3e1}{00200}     \hyperlink{group___cholesky___module_aa257dd7a8acf8b347d5a22a13d6ca3e1}{solve}(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Rhs>}& b)\textcolor{keyword}{ const}
00201 \textcolor{keyword}{    }\{
00202       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00203       eigen\_assert(m\_matrix.rows()==b.rows()
00204                 && \textcolor{stringliteral}{"LDLT::solve(): invalid number of rows of the right hand side matrix b"});
00205       \textcolor{keywordflow}{return} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<LDLT, Rhs>}(*\textcolor{keyword}{this}, b.derived());
00206     \}
00207 
00208     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00209     \textcolor{keywordtype}{bool} solveInPlace(\hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Derived>} &bAndX) \textcolor{keyword}{const};
00210 
00211     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
00212     \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT}& compute(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix);
00213 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00217}\hyperlink{group___cholesky___module_ae646403fdde3a4b18e278a32c61a0953}{00217}     RealScalar \hyperlink{group___cholesky___module_ae646403fdde3a4b18e278a32c61a0953}{rcond}()\textcolor{keyword}{ const}
00218 \textcolor{keyword}{    }\{
00219       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00220       \textcolor{keywordflow}{return} \hyperlink{namespace_eigen_1_1internal_ad1de0d785387bfb5435c410bf0554068}{internal::rcond\_estimate\_helper}(m\_l1\_norm, *\textcolor{keyword}{this});
00221     \}
00222 
00223     \textcolor{keyword}{template} <\textcolor{keyword}{typename} Derived>
00224     \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT}& rankUpdate(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Derived>}& w, \textcolor{keyword}{const} RealScalar& alpha=1);
00225 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00230}\hyperlink{group___cholesky___module_aa5e0fd09dcd5251a8521fa248b95db0b}{00230}     \textcolor{keyword}{inline} \textcolor{keyword}{const} MatrixType& \hyperlink{group___cholesky___module_aa5e0fd09dcd5251a8521fa248b95db0b}{matrixLDLT}()\textcolor{keyword}{ const}
00231 \textcolor{keyword}{    }\{
00232       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00233       \textcolor{keywordflow}{return} m\_matrix;
00234     \}
00235 
00236     MatrixType reconstructedMatrix() \textcolor{keyword}{const};
00237 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00243}\hyperlink{group___cholesky___module_ac656a209860fa0c6a8faa8bb9f9a06ef}{00243}     \textcolor{keyword}{const} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT}& \hyperlink{group___cholesky___module_ac656a209860fa0c6a8faa8bb9f9a06ef}{adjoint}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{this}; \};
00244 
00245     \textcolor{keyword}{inline} Index rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.rows(); \}
00246     \textcolor{keyword}{inline} Index cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_matrix.cols(); \}
00247 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00253}\hyperlink{group___cholesky___module_a6bd6008501a537d2e16ea672a853bf3e}{00253}     \hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo} \hyperlink{group___cholesky___module_a6bd6008501a537d2e16ea672a853bf3e}{info}()\textcolor{keyword}{ const}
00254 \textcolor{keyword}{    }\{
00255       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00256       \textcolor{keywordflow}{return} m\_info;
00257     \}
00258 
00259 \textcolor{preprocessor}{    #ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00260     \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00261     EIGEN\_DEVICE\_FUNC
00262     \textcolor{keywordtype}{void} \_solve\_impl(\textcolor{keyword}{const} RhsType &rhs, DstType &dst) \textcolor{keyword}{const};
00263 \textcolor{preprocessor}{    #endif}
00264 
00265   \textcolor{keyword}{protected}:
00266 
00267     \textcolor{keyword}{static} \textcolor{keywordtype}{void} check\_template\_parameters()
00268     \{
00269       EIGEN\_STATIC\_ASSERT\_NON\_INTEGER(Scalar);
00270     \}
00271 
00278     MatrixType m\_matrix;
00279     RealScalar m\_l1\_norm;
00280     TranspositionType m\_transpositions;
00281     TmpMatrixType m\_temporary;
00282     internal::SignMatrix m\_sign;
00283     \textcolor{keywordtype}{bool} m\_isInitialized;
00284     \hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo} m\_info;
00285 \};
00286 
00287 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00288 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00289}\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{00289} \textcolor{keyword}{template}<\textcolor{keywordtype}{int} UpLo> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace};
00290 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00291}\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace_3_01_lower_01_4}{00291} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace}<\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}>
00292 \{
00293   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} TranspositionType, \textcolor{keyword}{typename} Workspace>
00294   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} unblocked(MatrixType& mat, TranspositionType& transpositions, Workspace& temp, SignMatrix& 
      sign)
00295   \{
00296     \textcolor{keyword}{using} std::abs;
00297     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00298     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00299     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} TranspositionType::StorageIndex IndexType;
00300     eigen\_assert(mat.rows()==mat.cols());
00301     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = mat.rows();
00302     \textcolor{keywordtype}{bool} found\_zero\_pivot = \textcolor{keyword}{false};
00303     \textcolor{keywordtype}{bool} ret = \textcolor{keyword}{true};
00304 
00305     \textcolor{keywordflow}{if} (size <= 1)
00306     \{
00307       transpositions.setIdentity();
00308       \textcolor{keywordflow}{if} (numext::real(mat.coeff(0,0)) > static\_cast<RealScalar>(0) ) sign = PositiveSemiDef;
00309       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (numext::real(mat.coeff(0,0)) < static\_cast<RealScalar>(0)) sign = NegativeSemiDef;
00310       \textcolor{keywordflow}{else} sign = ZeroSign;
00311       \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00312     \}
00313 
00314     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < size; ++k)
00315     \{
00316       \textcolor{comment}{// Find largest diagonal element}
00317       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} index\_of\_biggest\_in\_corner;
00318       mat.diagonal().tail(size-k).cwiseAbs().maxCoeff(&index\_of\_biggest\_in\_corner);
00319       index\_of\_biggest\_in\_corner += k;
00320 
00321       transpositions.coeffRef(k) = IndexType(index\_of\_biggest\_in\_corner);
00322       \textcolor{keywordflow}{if}(k != index\_of\_biggest\_in\_corner)
00323       \{
00324         \textcolor{comment}{// apply the transposition while taking care to consider only}
00325         \textcolor{comment}{// the lower triangular part}
00326         \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} s = size-index\_of\_biggest\_in\_corner-1; \textcolor{comment}{// trailing size after the biggest element}
00327         mat.row(k).head(k).swap(mat.row(index\_of\_biggest\_in\_corner).head(k));
00328         mat.col(k).tail(s).swap(mat.col(index\_of\_biggest\_in\_corner).tail(s));
00329         \hyperlink{endian_8c_a3ca5ecd34b04d6a243c054ac3a57f68d}{std::swap}(mat.coeffRef(k,k),mat.coeffRef(index\_of\_biggest\_in\_corner,
      index\_of\_biggest\_in\_corner));
00330         \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i=k+1;i<index\_of\_biggest\_in\_corner;++i)
00331         \{
00332           Scalar tmp = mat.coeffRef(i,k);
00333           mat.coeffRef(i,k) = numext::conj(mat.coeffRef(index\_of\_biggest\_in\_corner,i));
00334           mat.coeffRef(index\_of\_biggest\_in\_corner,i) = numext::conj(tmp);
00335         \}
00336         \textcolor{keywordflow}{if}(\hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::IsComplex})
00337           mat.coeffRef(index\_of\_biggest\_in\_corner,k) = numext::conj(mat.coeff(index\_of\_biggest\_in\_corner,k)
      );
00338       \}
00339 
00340       \textcolor{comment}{// partition the matrix:}
00341       \textcolor{comment}{//       A00 |  -  |  -}
00342       \textcolor{comment}{// lu  = A10 | A11 |  -}
00343       \textcolor{comment}{//       A20 | A21 | A22}
00344       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rs = size - k - 1;
00345       \hyperlink{group___core___module_class_eigen_1_1_block}{Block<MatrixType,Dynamic,1>} A21(mat,k+1,k,rs,1);
00346       \hyperlink{group___core___module_class_eigen_1_1_block}{Block<MatrixType,1,Dynamic>} A10(mat,k,0,1,k);
00347       \hyperlink{group___core___module_class_eigen_1_1_block}{Block<MatrixType,Dynamic,Dynamic>} A20(mat,k+1,0,rs,k);
00348 
00349       \textcolor{keywordflow}{if}(k>0)
00350       \{
00351         temp.head(k) = mat.diagonal().real().head(k).asDiagonal() * A10.adjoint();
00352         mat.coeffRef(k,k) -= (A10 * temp.head(k)).value();
00353         \textcolor{keywordflow}{if}(rs>0)
00354           A21.noalias() -= A20 * temp.head(k);
00355       \}
00356 
00357       \textcolor{comment}{// In some previous versions of Eigen (e.g., 3.2.1), the scaling was omitted if the pivot}
00358       \textcolor{comment}{// was smaller than the cutoff value. However, since LDLT is not rank-revealing}
00359       \textcolor{comment}{// we should only make sure that we do not introduce INF or NaN values.}
00360       \textcolor{comment}{// Remark that LAPACK also uses 0 as the cutoff value.}
00361       RealScalar realAkk = numext::real(mat.coeffRef(k,k));
00362       \textcolor{keywordtype}{bool} pivot\_is\_valid = (abs(realAkk) > RealScalar(0));
00363 
00364       \textcolor{keywordflow}{if}(k==0 && !pivot\_is\_valid)
00365       \{
00366         \textcolor{comment}{// The entire diagonal is zero, there is nothing more to do}
00367         \textcolor{comment}{// except filling the transpositions, and checking whether the matrix is zero.}
00368         sign = ZeroSign;
00369         \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = 0; j<size; ++j)
00370         \{
00371           transpositions.coeffRef(j) = IndexType(j);
00372           ret = ret && (mat.col(j).tail(size-j-1).array()==Scalar(0)).all();
00373         \}
00374         \textcolor{keywordflow}{return} ret;
00375       \}
00376 
00377       \textcolor{keywordflow}{if}((rs>0) && pivot\_is\_valid)
00378         A21 /= realAkk;
00379 
00380       \textcolor{keywordflow}{if}(found\_zero\_pivot && pivot\_is\_valid) ret = \textcolor{keyword}{false}; \textcolor{comment}{// factorization failed}
00381       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(!pivot\_is\_valid) found\_zero\_pivot = \textcolor{keyword}{true};
00382 
00383       \textcolor{keywordflow}{if} (sign == PositiveSemiDef) \{
00384         \textcolor{keywordflow}{if} (realAkk < static\_cast<RealScalar>(0)) sign = Indefinite;
00385       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sign == NegativeSemiDef) \{
00386         \textcolor{keywordflow}{if} (realAkk > static\_cast<RealScalar>(0)) sign = Indefinite;
00387       \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (sign == ZeroSign) \{
00388         \textcolor{keywordflow}{if} (realAkk > static\_cast<RealScalar>(0)) sign = PositiveSemiDef;
00389         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} (realAkk < static\_cast<RealScalar>(0)) sign = NegativeSemiDef;
00390       \}
00391     \}
00392 
00393     \textcolor{keywordflow}{return} ret;
00394   \}
00395 
00396   \textcolor{comment}{// Reference for the algorithm: Davis and Hager, "Multiple Rank}
00397   \textcolor{comment}{// Modifications of a Sparse Cholesky Factorization" (Algorithm 1)}
00398   \textcolor{comment}{// Trivial rearrangements of their computations (Timothy E. Holy)}
00399   \textcolor{comment}{// allow their algorithm to work for rank-1 updates even if the}
00400   \textcolor{comment}{// original matrix is not of full rank.}
00401   \textcolor{comment}{// Here only rank-1 updates are implemented, to reduce the}
00402   \textcolor{comment}{// requirement for intermediate storage and improve accuracy}
00403   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} WDerived>
00404   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} updateInPlace(MatrixType& mat, \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<WDerived>}& w, \textcolor{keyword}{const} \textcolor{keyword}{typename} 
      MatrixType::RealScalar& sigma=1)
00405   \{
00406     \textcolor{keyword}{using} numext::isfinite;
00407     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00408     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00409 
00410     \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = mat.rows();
00411     eigen\_assert(mat.cols() == size && w.size()==size);
00412 
00413     RealScalar alpha = 1;
00414 
00415     \textcolor{comment}{// Apply the update}
00416     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = 0; j < size; j++)
00417     \{
00418       \textcolor{comment}{// Check for termination due to an original decomposition of low-rank}
00419       \textcolor{keywordflow}{if} (!(isfinite)(alpha))
00420         \textcolor{keywordflow}{break};
00421 
00422       \textcolor{comment}{// Update the diagonal terms}
00423       RealScalar dj = numext::real(mat.coeff(j,j));
00424       Scalar wj = w.coeff(j);
00425       RealScalar swj2 = sigma*numext::abs2(wj);
00426       RealScalar gamma = dj*alpha + swj2;
00427 
00428       mat.coeffRef(j,j) += swj2/alpha;
00429       alpha += swj2/dj;
00430 
00431 
00432       \textcolor{comment}{// Update the terms of L}
00433       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rs = size-j-1;
00434       w.\hyperlink{group___core___module_aec3cf8f4f73c641d21a2c080c3e59662}{tail}(rs) -= wj * mat.col(j).tail(rs);
00435       \textcolor{keywordflow}{if}(gamma != 0)
00436         mat.col(j).tail(rs) += (sigma*numext::conj(wj)/gamma)*w.\hyperlink{group___core___module_aec3cf8f4f73c641d21a2c080c3e59662}{tail}(rs);
00437     \}
00438     \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00439   \}
00440 
00441   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} TranspositionType, \textcolor{keyword}{typename} Workspace, \textcolor{keyword}{typename} WType>
00442   \textcolor{keyword}{static} \textcolor{keywordtype}{bool} update(MatrixType& mat, \textcolor{keyword}{const} TranspositionType& transpositions, Workspace& tmp, \textcolor{keyword}{const} WType&
       w, \textcolor{keyword}{const} \textcolor{keyword}{typename} MatrixType::RealScalar& sigma=1)
00443   \{
00444     \textcolor{comment}{// Apply the permutation to the input w}
00445     tmp = transpositions * w;
00446 
00447     \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace<Lower>::updateInPlace}(mat,tmp,sigma);
00448   \}
00449 \};
00450 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00451}\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace_3_01_upper_01_4}{00451} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace}<\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}>
00452 \{
00453   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} TranspositionType, \textcolor{keyword}{typename} Workspace>
00454   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{bool} unblocked(MatrixType& mat, TranspositionType& transpositions, Workspace& 
      temp, SignMatrix& sign)
00455   \{
00456     \hyperlink{group___core___module_class_eigen_1_1_transpose}{Transpose<MatrixType>} matt(mat);
00457     \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace<Lower>::unblocked}(matt, transpositions, temp, sign);
00458   \}
00459 
00460   \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} TranspositionType, \textcolor{keyword}{typename} Workspace, \textcolor{keyword}{typename} WType>
00461   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{bool} update(MatrixType& mat, TranspositionType& transpositions, Workspace& tmp
      , WType& w, \textcolor{keyword}{const} \textcolor{keyword}{typename} MatrixType::RealScalar& sigma=1)
00462   \{
00463     \hyperlink{group___core___module_class_eigen_1_1_transpose}{Transpose<MatrixType>} matt(mat);
00464     \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{ldlt\_inplace<Lower>::update}(matt, transpositions, tmp, w.conjugate(),
       sigma);
00465   \}
00466 \};
00467 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00468}\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits_3_01_matrix_type_00_01_lower_01_4}{00468} \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{LDLT\_Traits}<MatrixType,\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}>
00469 \{
00470   \textcolor{keyword}{typedef} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{TriangularView<const MatrixType, UnitLower>} 
      \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{MatrixL};
00471   \textcolor{keyword}{typedef} \textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{TriangularView<const typename MatrixType::AdjointReturnType, UnitUpper>}
       \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{MatrixU};
00472   \textcolor{keyword}{static} \textcolor{keyword}{inline} MatrixL getL(\textcolor{keyword}{const} MatrixType& m) \{ \textcolor{keywordflow}{return} MatrixL(m); \}
00473   \textcolor{keyword}{static} \textcolor{keyword}{inline} MatrixU getU(\textcolor{keyword}{const} MatrixType& m) \{ \textcolor{keywordflow}{return} MatrixU(m.adjoint()); \}
00474 \};
00475 
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00476}\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits_3_01_matrix_type_00_01_upper_01_4}{00476} \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_l_d_l_t___traits}{LDLT\_Traits}<MatrixType,\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}>
00477 \{
00478   \textcolor{keyword}{typedef} \textcolor{keyword}{const} 
      \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{TriangularView<const typename MatrixType::AdjointReturnType, UnitLower>}
       \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{MatrixL};
00479   \textcolor{keyword}{typedef} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{TriangularView<const MatrixType, UnitUpper>} 
      \hyperlink{group___core___module_class_eigen_1_1_triangular_view}{MatrixU};
00480   \textcolor{keyword}{static} \textcolor{keyword}{inline} MatrixL getL(\textcolor{keyword}{const} MatrixType& m) \{ \textcolor{keywordflow}{return} MatrixL(m.adjoint()); \}
00481   \textcolor{keyword}{static} \textcolor{keyword}{inline} MatrixU getU(\textcolor{keyword}{const} MatrixType& m) \{ \textcolor{keywordflow}{return} MatrixU(m); \}
00482 \};
00483 
00484 \} \textcolor{comment}{// end namespace internal}
00485 
00488 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} \_UpLo>
00489 \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00490}\hyperlink{group___cholesky___module_ad1074d10072cf19437c6428c478fe5d6}{00490} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<MatrixType,\_UpLo>}& \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<MatrixType,\_UpLo>::compute}
      (\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& a)
00491 \{
00492   check\_template\_parameters();
00493 
00494   eigen\_assert(a.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}()==a.\hyperlink{group___core___module_a7b0b45c7351847696c911ce8aa2abbdb}{cols}());
00495   \textcolor{keyword}{const} \hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} size = a.\hyperlink{group___core___module_a8141320ba8df384426c298b32b000d8e}{rows}();
00496 
00497   m\_matrix = a.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}();
00498 
00499   \textcolor{comment}{// Compute matrix L1 norm = max abs column sum.}
00500   m\_l1\_norm = RealScalar(0);
00501   \textcolor{comment}{// TODO move this code to SelfAdjointView}
00502   \textcolor{keywordflow}{for} (\hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} col = 0; col < size; ++col) \{
00503     RealScalar abs\_col\_sum;
00504     \textcolor{keywordflow}{if} (\_UpLo == \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower})
00505       abs\_col\_sum = m\_matrix.col(col).tail(size - col).template lpNorm<1>() + m\_matrix.row(col).head(col).
      template lpNorm<1>();
00506     \textcolor{keywordflow}{else}
00507       abs\_col\_sum = m\_matrix.col(col).head(col).template lpNorm<1>() + m\_matrix.row(col).tail(size - col).
      template lpNorm<1>();
00508     \textcolor{keywordflow}{if} (abs\_col\_sum > m\_l1\_norm)
00509       m\_l1\_norm = abs\_col\_sum;
00510   \}
00511 
00512   m\_transpositions.resize(size);
00513   m\_isInitialized = \textcolor{keyword}{false};
00514   m\_temporary.resize(size);
00515   m\_sign = internal::ZeroSign;
00516 
00517   m\_info = \hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{internal::ldlt\_inplace<UpLo>::unblocked}(m\_matrix, 
      m\_transpositions, m\_temporary, m\_sign) ? \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success} : \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5eaaf9b736d310a664e7729d163a035cc5f}{NumericalIssue};
00518 
00519   m\_isInitialized = \textcolor{keyword}{true};
00520   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00521 \}
00522 
00528 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} \_UpLo>
00529 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00530}\hyperlink{group___cholesky___module_a59a415ea2ba2d6208233da42f981579a}{00530} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<MatrixType,\_UpLo>}& \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<MatrixType,\_UpLo>::rankUpdate}
      (\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Derived>}& w, \textcolor{keyword}{const} \textcolor{keyword}{typename} LDLT<MatrixType,\_UpLo>::RealScalar& sigma)
00531 \{
00532   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} TranspositionType::StorageIndex IndexType;
00533   \textcolor{keyword}{const} \hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} size = w.rows();
00534   \textcolor{keywordflow}{if} (m\_isInitialized)
00535   \{
00536     eigen\_assert(m\_matrix.rows()==size);
00537   \}
00538   \textcolor{keywordflow}{else}
00539   \{
00540     m\_matrix.resize(size,size);
00541     m\_matrix.setZero();
00542     m\_transpositions.resize(size);
00543     \textcolor{keywordflow}{for} (\hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} i = 0; i < size; i++)
00544       m\_transpositions.coeffRef(i) = IndexType(i);
00545     m\_temporary.resize(size);
00546     m\_sign = sigma>=0 ? internal::PositiveSemiDef : internal::NegativeSemiDef;
00547     m\_isInitialized = \textcolor{keyword}{true};
00548   \}
00549 
00550   \hyperlink{struct_eigen_1_1internal_1_1ldlt__inplace}{internal::ldlt\_inplace<UpLo>::update}(m\_matrix, m\_transpositions, 
      m\_temporary, w, sigma);
00551 
00552   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00553 \}
00554 
00555 \textcolor{preprocessor}{#ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00556 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType, \textcolor{keywordtype}{int} \_UpLo>
00557 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00558 \textcolor{keywordtype}{void} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<\_MatrixType,\_UpLo>::\_solve\_impl}(\textcolor{keyword}{const} RhsType &rhs, DstType &
      dst)\textcolor{keyword}{ const}
00559 \textcolor{keyword}{}\{
00560   eigen\_assert(rhs.rows() == rows());
00561   \textcolor{comment}{// dst = P b}
00562   dst = m\_transpositions * rhs;
00563 
00564   \textcolor{comment}{// dst = L^-1 (P b)}
00565   matrixL().solveInPlace(dst);
00566 
00567   \textcolor{comment}{// dst = D^-1 (L^-1 P b)}
00568   \textcolor{comment}{// more precisely, use pseudo-inverse of D (see bug 241)}
00569   \textcolor{keyword}{using} std::abs;
00570   \textcolor{keyword}{const} \textcolor{keyword}{typename} \hyperlink{group___core___module_class_eigen_1_1_diagonal}{Diagonal<const MatrixType>::RealReturnType} vecD(
      vectorD());
00571   \textcolor{comment}{// In some previous versions, tolerance was set to the max of 1/highest and the maximal diagonal entry *
       epsilon}
00572   \textcolor{comment}{// as motivated by LAPACK's xGELSS:}
00573   \textcolor{comment}{// RealScalar tolerance = numext::maxi(vecD.array().abs().maxCoeff() *
       NumTraits<RealScalar>::epsilon(),RealScalar(1) / NumTraits<RealScalar>::highest());}
00574   \textcolor{comment}{// However, LDLT is not rank revealing, and so adjusting the tolerance wrt to the highest}
00575   \textcolor{comment}{// diagonal element is not well justified and leads to numerical issues in some cases.}
00576   \textcolor{comment}{// Moreover, Lapack's xSYTRS routines use 0 for the tolerance.}
00577   RealScalar tolerance = RealScalar(1) / \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<RealScalar>::highest}();
00578 
00579   \textcolor{keywordflow}{for} (\hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} i = 0; i < vecD.size(); ++i)
00580   \{
00581     \textcolor{keywordflow}{if}(abs(vecD(i)) > tolerance)
00582       dst.row(i) /= vecD(i);
00583     \textcolor{keywordflow}{else}
00584       dst.row(i).setZero();
00585   \}
00586 
00587   \textcolor{comment}{// dst = L^-T (D^-1 L^-1 P b)}
00588   matrixU().solveInPlace(dst);
00589 
00590   \textcolor{comment}{// dst = P^-1 (L^-T D^-1 L^-1 P b) = A^-1 b}
00591   dst = m\_transpositions.transpose() * dst;
00592 \}
00593 \textcolor{preprocessor}{#endif}
00594 
00608 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType,\textcolor{keywordtype}{int} \_UpLo>
00609 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00610 \textcolor{keywordtype}{bool} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<MatrixType,\_UpLo>::solveInPlace}(
      \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Derived>} &bAndX)\textcolor{keyword}{ const}
00611 \textcolor{keyword}{}\{
00612   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00613   eigen\_assert(m\_matrix.rows() == bAndX.rows());
00614 
00615   bAndX = this->solve(bAndX);
00616 
00617   \textcolor{keywordflow}{return} \textcolor{keyword}{true};
00618 \}
00619 
00623 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} \_UpLo>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00624}\hyperlink{group___cholesky___module_ae3693372ca29f50d87d324dfadaae148}{00624} MatrixType \hyperlink{group___cholesky___module_ae3693372ca29f50d87d324dfadaae148}{LDLT<MatrixType,\_UpLo>::reconstructedMatrix}()\textcolor{keyword}{ const}
00625 \textcolor{keyword}{}\{
00626   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"LDLT is not initialized."});
00627   \textcolor{keyword}{const} \hyperlink{group___cholesky___module_ad9c57eb2fb3bbccd51b9d2e111bea355}{Index} size = m\_matrix.rows();
00628   MatrixType res(size,size);
00629 
00630   \textcolor{comment}{// P}
00631   res.setIdentity();
00632   res = transpositionsP() * res;
00633   \textcolor{comment}{// L^* P}
00634   res = matrixU() * res;
00635   \textcolor{comment}{// D(L^*P)}
00636   res = vectorD().real().asDiagonal() * res;
00637   \textcolor{comment}{// L(DL^*P)}
00638   res = matrixL() * res;
00639   \textcolor{comment}{// P^T (LDL^*P)}
00640   res = transpositionsP().transpose() * res;
00641 
00642   \textcolor{keywordflow}{return} res;
00643 \}
00644 
00649 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} UpLo>
00650 \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<typename SelfAdjointView<MatrixType, UpLo>::PlainObject}
      , UpLo>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00651}\hyperlink{group___core___module_a644155eef17b37c95d85b9f65bb49ac4}{00651} \hyperlink{group___core___module_a644155eef17b37c95d85b9f65bb49ac4}{SelfAdjointView<MatrixType, UpLo>::ldlt}()\textcolor{keyword}{ const}
00652 \textcolor{keyword}{}\{
00653   \textcolor{keywordflow}{return} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<PlainObject,UpLo>}(m\_matrix);
00654 \}
00655 
00660 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00661 \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<typename MatrixBase<Derived>::PlainObject}>
\Hypertarget{eigen_2_eigen_2src_2_cholesky_2_l_d_l_t_8h_source_l00662}\hyperlink{group___core___module_a0ecf058a0727a4cab8b42d79e95072e1}{00662} \hyperlink{group___core___module_a0ecf058a0727a4cab8b42d79e95072e1}{MatrixBase<Derived>::ldlt}()\textcolor{keyword}{ const}
00663 \textcolor{keyword}{}\{
00664   \textcolor{keywordflow}{return} \hyperlink{group___cholesky___module_class_eigen_1_1_l_d_l_t}{LDLT<PlainObject>}(derived());
00665 \}
00666 
00667 \} \textcolor{comment}{// end namespace Eigen}
00668 
00669 \textcolor{preprocessor}{#endif // EIGEN\_LDLT\_H}
\end{DoxyCode}
