\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_generalized_self_adjoint_eigen_solver_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Eigenvalues/\+Generalized\+Self\+Adjoint\+Eigen\+Solver.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_generalized_self_adjoint_eigen_solver_8h_source}\index{Generalized\+Self\+Adjoint\+Eigen\+Solver.\+h@{Generalized\+Self\+Adjoint\+Eigen\+Solver.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2010 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2010 Jitse Niesen <jitse@maths.leeds.ac.uk>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}
00013 
00014 \textcolor{preprocessor}{#include "./Tridiagonalization.h"}
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00017 
00047 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType>
00048 \textcolor{keyword}{class }GeneralizedSelfAdjointEigenSolver : \textcolor{keyword}{public} SelfAdjointEigenSolver<\_MatrixType>
00049 \{
00050     \textcolor{keyword}{typedef} SelfAdjointEigenSolver<\_MatrixType> Base;
00051   \textcolor{keyword}{public}:
00052 
00053     \textcolor{keyword}{typedef} \_MatrixType MatrixType;
00054 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_generalized_self_adjoint_eigen_solver_8h_source_l00062}\hyperlink{group___eigenvalues___module_a501effdbf722c0609ea05ff3fd4cc721}{00062}     \hyperlink{group___eigenvalues___module_a501effdbf722c0609ea05ff3fd4cc721}{GeneralizedSelfAdjointEigenSolver}() : Base() \{\}
00063 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_generalized_self_adjoint_eigen_solver_8h_source_l00076}\hyperlink{group___eigenvalues___module_aac849f01a8c6148c645acd10bd3a9b0e}{00076}     \textcolor{keyword}{explicit} \hyperlink{group___eigenvalues___module_aac849f01a8c6148c645acd10bd3a9b0e}{GeneralizedSelfAdjointEigenSolver}(
      \hyperlink{group___eigenvalues___module_a8a59ab7734b6eae2754fd78bc7c3a360}{Index} size)
00077         : Base(size)
00078     \{\}
00079 
\Hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_eigenvalues_2_generalized_self_adjoint_eigen_solver_8h_source_l00106}\hyperlink{group___eigenvalues___module_addc0409c9cb1a5ac9cbbd00efe68908e}{00106}     \hyperlink{group___eigenvalues___module_addc0409c9cb1a5ac9cbbd00efe68908e}{GeneralizedSelfAdjointEigenSolver}(\textcolor{keyword}{const} MatrixType& matA, \textcolor{keyword}{const} 
      MatrixType& matB,
00107                                       \textcolor{keywordtype}{int} options = \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors}|
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a1a7cefbb22c2c3928d246b753cf53633}{Ax\_lBx})
00108       : Base(matA.cols())
00109     \{
00110       \hyperlink{group___eigenvalues___module_a724764fe196612b752042692156ed023}{compute}(matA, matB, options);
00111     \}
00112 
00153     \hyperlink{group___eigenvalues___module_class_eigen_1_1_generalized_self_adjoint_eigen_solver}{GeneralizedSelfAdjointEigenSolver}& \hyperlink{group___eigenvalues___module_a724764fe196612b752042692156ed023}{compute}(\textcolor{keyword}{const} MatrixType& 
      matA, \textcolor{keyword}{const} MatrixType& matB,
00154                                                \textcolor{keywordtype}{int} options = \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors}|
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a1a7cefbb22c2c3928d246b753cf53633}{Ax\_lBx});
00155 
00156   \textcolor{keyword}{protected}:
00157 
00158 \};
00159 
00160 
00161 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00162 \hyperlink{group___eigenvalues___module_class_eigen_1_1_generalized_self_adjoint_eigen_solver}{GeneralizedSelfAdjointEigenSolver<MatrixType>}& 
      \hyperlink{group___eigenvalues___module_a724764fe196612b752042692156ed023}{GeneralizedSelfAdjointEigenSolver<MatrixType>::}
00163 \hyperlink{group___eigenvalues___module_a724764fe196612b752042692156ed023}{compute}(\textcolor{keyword}{const} MatrixType& matA, \textcolor{keyword}{const} MatrixType& matB, \textcolor{keywordtype}{int} options)
00164 \{
00165   eigen\_assert(matA.cols()==matA.rows() && matB.rows()==matA.rows() && matB.cols()==matB.rows());
00166   eigen\_assert((options&~(EigVecMask|GenEigMask))==0
00167           && (options&EigVecMask)!=EigVecMask
00168           && ((options&GenEigMask)==0 || (options&GenEigMask)==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a1a7cefbb22c2c3928d246b753cf53633}{Ax\_lBx}
00169            || (options&GenEigMask)==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afc36646eaa4187858eaad466d32a2096}{ABx\_lx} || (options&GenEigMask)==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5b64c528c90483f0b716018cad0143f8}{BAx\_lx})
00170           && \textcolor{stringliteral}{"invalid option parameter"});
00171 
00172   \textcolor{keywordtype}{bool} computeEigVecs = ((options&EigVecMask)==0) || ((options&EigVecMask)==
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors});
00173 
00174   \textcolor{comment}{// Compute the cholesky decomposition of matB = L L' = U'U}
00175   \hyperlink{group___cholesky___module_class_eigen_1_1_l_l_t}{LLT<MatrixType>} cholB(matB);
00176 
00177   \textcolor{keywordtype}{int} type = (options&GenEigMask);
00178   \textcolor{keywordflow}{if}(type==0)
00179     type = \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a1a7cefbb22c2c3928d246b753cf53633}{Ax\_lBx};
00180 
00181   \textcolor{keywordflow}{if}(type==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a1a7cefbb22c2c3928d246b753cf53633}{Ax\_lBx})
00182   \{
00183     \textcolor{comment}{// compute C = inv(L) A inv(L')}
00184     MatrixType matC = matA.template selfadjointView<Lower>();
00185     cholB.\hyperlink{group___cholesky___module_a7f4a3eedbf82e7ce2d6bf0dcd84cdfa3}{matrixL}().template solveInPlace<OnTheLeft>(matC);
00186     cholB.\hyperlink{group___cholesky___module_a18a390f085567e650e8345cc7e7c0df8}{matrixU}().template solveInPlace<OnTheRight>(matC);
00187 
00188     \hyperlink{group___eigenvalues___module_a88bcdc24112efa7c4d2ebb3476efcbe9}{Base::compute}(matC, computeEigVecs ? \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors} : 
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ad0c82cf0a9daf2a63bb6e2f10d51f69c}{EigenvaluesOnly} );
00189 
00190     \textcolor{comment}{// transform back the eigen vectors: evecs = inv(U) * evecs}
00191     \textcolor{keywordflow}{if}(computeEigVecs)
00192       cholB.\hyperlink{group___cholesky___module_a18a390f085567e650e8345cc7e7c0df8}{matrixU}().solveInPlace(Base::m\_eivec);
00193   \}
00194   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(type==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9afc36646eaa4187858eaad466d32a2096}{ABx\_lx})
00195   \{
00196     \textcolor{comment}{// compute C = L' A L}
00197     MatrixType matC = matA.template selfadjointView<Lower>();
00198     matC = matC * cholB.\hyperlink{group___cholesky___module_a7f4a3eedbf82e7ce2d6bf0dcd84cdfa3}{matrixL}();
00199     matC = cholB.\hyperlink{group___cholesky___module_a18a390f085567e650e8345cc7e7c0df8}{matrixU}() * matC;
00200 
00201     \hyperlink{group___eigenvalues___module_a88bcdc24112efa7c4d2ebb3476efcbe9}{Base::compute}(matC, computeEigVecs ? \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors} : 
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ad0c82cf0a9daf2a63bb6e2f10d51f69c}{EigenvaluesOnly});
00202 
00203     \textcolor{comment}{// transform back the eigen vectors: evecs = inv(U) * evecs}
00204     \textcolor{keywordflow}{if}(computeEigVecs)
00205       cholB.\hyperlink{group___cholesky___module_a18a390f085567e650e8345cc7e7c0df8}{matrixU}().solveInPlace(Base::m\_eivec);
00206   \}
00207   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(type==\hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9a5b64c528c90483f0b716018cad0143f8}{BAx\_lx})
00208   \{
00209     \textcolor{comment}{// compute C = L' A L}
00210     MatrixType matC = matA.template selfadjointView<Lower>();
00211     matC = matC * cholB.\hyperlink{group___cholesky___module_a7f4a3eedbf82e7ce2d6bf0dcd84cdfa3}{matrixL}();
00212     matC = cholB.\hyperlink{group___cholesky___module_a18a390f085567e650e8345cc7e7c0df8}{matrixU}() * matC;
00213 
00214     \hyperlink{group___eigenvalues___module_a88bcdc24112efa7c4d2ebb3476efcbe9}{Base::compute}(matC, computeEigVecs ? \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ada93d8885bde32b876ba4af01d3292cc}{ComputeEigenvectors} : 
      \hyperlink{group__enums_ggae3e239fb70022eb8747994cf5d68b4a9ad0c82cf0a9daf2a63bb6e2f10d51f69c}{EigenvaluesOnly});
00215 
00216     \textcolor{comment}{// transform back the eigen vectors: evecs = L * evecs}
00217     \textcolor{keywordflow}{if}(computeEigVecs)
00218       Base::m\_eivec = cholB.\hyperlink{group___cholesky___module_a7f4a3eedbf82e7ce2d6bf0dcd84cdfa3}{matrixL}() * Base::m\_eivec;
00219   \}
00220 
00221   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00222 \}
00223 
00224 \} \textcolor{comment}{// end namespace Eigen}
00225 
00226 \textcolor{preprocessor}{#endif // EIGEN\_GENERALIZEDSELFADJOINTEIGENSOLVER\_H}
\end{DoxyCode}
