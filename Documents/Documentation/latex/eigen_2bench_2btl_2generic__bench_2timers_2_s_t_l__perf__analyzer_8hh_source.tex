\hypertarget{eigen_2bench_2btl_2generic__bench_2timers_2_s_t_l__perf__analyzer_8hh_source}{}\section{eigen/bench/btl/generic\+\_\+bench/timers/\+S\+T\+L\+\_\+perf\+\_\+analyzer.hh}
\label{eigen_2bench_2btl_2generic__bench_2timers_2_s_t_l__perf__analyzer_8hh_source}\index{S\+T\+L\+\_\+perf\+\_\+analyzer.\+hh@{S\+T\+L\+\_\+perf\+\_\+analyzer.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  STL\_perf\_analyzer.hh}
00003 \textcolor{comment}{// Author :  L. Plagne <laurent.plagne@edf.fr)>        }
00004 \textcolor{comment}{// Copyright (C) EDF R&D,  mar déc 3 18:59:35 CET 2002}
00005 \textcolor{comment}{//=====================================================}
00006 \textcolor{comment}{// }
00007 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00008 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00009 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00010 \textcolor{comment}{// of the License, or (at your option) any later version.}
00011 \textcolor{comment}{// }
00012 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00013 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00014 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00015 \textcolor{comment}{// GNU General Public License for more details.}
00016 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00018 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00019 \textcolor{comment}{// }
00020 \textcolor{preprocessor}{#ifndef \_STL\_PERF\_ANALYSER\_HH}
00021 \textcolor{preprocessor}{#define \_STL\_PERF\_ANALYSER\_HH}
00022 
00023 \textcolor{preprocessor}{#include "STL\_timer.hh"}
00024 \textcolor{preprocessor}{#include "bench\_parameter.hh"}
00025 
00026 \textcolor{keyword}{template}<\textcolor{keyword}{class} ACTION>
\Hypertarget{eigen_2bench_2btl_2generic__bench_2timers_2_s_t_l__perf__analyzer_8hh_source_l00027}\hyperlink{class_s_t_l___perf___analyzer}{00027} \textcolor{keyword}{class }\hyperlink{class_s_t_l___perf___analyzer}{STL\_Perf\_Analyzer}\{
00028 \textcolor{keyword}{public}:  
00029   \hyperlink{class_s_t_l___perf___analyzer}{STL\_Perf\_Analyzer}(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} nb\_sample=DEFAULT\_NB\_SAMPLE):\_nb\_sample(nb\_sample),
      \_chronos()
00030   \{
00031     MESSAGE(\textcolor{stringliteral}{"STL\_Perf\_Analyzer Ctor"});
00032   \}; 
00033   \hyperlink{class_s_t_l___perf___analyzer}{STL\_Perf\_Analyzer}( \textcolor{keyword}{const} \hyperlink{class_s_t_l___perf___analyzer}{STL\_Perf\_Analyzer} & )\{
00034     INFOS(\textcolor{stringliteral}{"Copy Ctor not implemented"});
00035     exit(0);
00036   \};
00037   ~\hyperlink{class_s_t_l___perf___analyzer}{STL\_Perf\_Analyzer}( \textcolor{keywordtype}{void} )\{
00038     MESSAGE(\textcolor{stringliteral}{"STL\_Perf\_Analyzer Dtor"});
00039   \};
00040   
00041   
00042   \textcolor{keyword}{inline} \textcolor{keywordtype}{double} eval\_mflops(\textcolor{keywordtype}{int} size)
00043   \{
00044 
00045     ACTION action(size);
00046 
00047     \_chronos.start\_baseline(\_nb\_sample);
00048       
00049     \textcolor{keywordflow}{do} \{
00050 
00051       action.initialize();
00052     \} \textcolor{keywordflow}{while} (\_chronos.check());
00053 
00054     \textcolor{keywordtype}{double} baseline\_time=\_chronos.get\_time();
00055 
00056     \_chronos.start(\_nb\_sample);
00057     \textcolor{keywordflow}{do} \{
00058       action.initialize();
00059       action.calculate();
00060     \} \textcolor{keywordflow}{while} (\_chronos.check());
00061 
00062     \textcolor{keywordtype}{double} calculate\_time=\_chronos.get\_time();
00063 
00064     \textcolor{keywordtype}{double} corrected\_time=calculate\_time-baseline\_time;
00065     
00066     \textcolor{comment}{//    cout << size <<" "<<baseline\_time<<" "<<calculate\_time<<" "<<corrected\_time<<"
       "<<action.nb\_op\_base() << endl;    }
00067     
00068     \textcolor{keywordflow}{return} action.nb\_op\_base()/(corrected\_time*1000000.0);
00069     \textcolor{comment}{//return action.nb\_op\_base()/(calculate\_time*1000000.0);}
00070     
00071   \}
00072 \textcolor{keyword}{private}:
00073 
00074   \hyperlink{class_s_t_l___timer}{STL\_Timer} \_chronos;
00075   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} \_nb\_sample;
00076 
00077   
00078 \};
00079 
00080   
00081   
00082 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
