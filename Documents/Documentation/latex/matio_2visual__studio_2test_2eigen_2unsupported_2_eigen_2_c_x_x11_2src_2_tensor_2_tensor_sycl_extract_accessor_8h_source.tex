\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2_c_x_x11_2src_2_tensor_2_tensor_sycl_extract_accessor_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/\+Eigen/\+C\+X\+X11/src/\+Tensor/\+Tensor\+Sycl\+Extract\+Accessor.h}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2_c_x_x11_2src_2_tensor_2_tensor_sycl_extract_accessor_8h_source}\index{Tensor\+Sycl\+Extract\+Accessor.\+h@{Tensor\+Sycl\+Extract\+Accessor.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Mehdi Goli    Codeplay Software Ltd.}
00005 \textcolor{comment}{// Ralph Potter  Codeplay Software Ltd.}
00006 \textcolor{comment}{// Luke Iwanski  Codeplay Software Ltd.}
00007 \textcolor{comment}{// Contact: <eigen@codeplay.com>}
00008 \textcolor{comment}{//}
00009 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00010 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00011 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00012 
00013 \textcolor{comment}{/*****************************************************************}
00014 \textcolor{comment}{ * TensorSyclExtractAccessor.h}
00015 \textcolor{comment}{ *}
00016 \textcolor{comment}{ * \(\backslash\)brief:}
00017 \textcolor{comment}{ * ExtractAccessor takes Expression placeHolder expression and the tuple of sycl}
00018 \textcolor{comment}{ * buffers as an input. Using pre-order tree traversal, ExtractAccessor}
00019 \textcolor{comment}{ * recursively calls itself for its children in the expression tree. The}
00020 \textcolor{comment}{ * leaf node in the PlaceHolder expression is nothing but a container preserving}
00021 \textcolor{comment}{ * the order of the actual data in the tuple of sycl buffer. By invoking the}
00022 \textcolor{comment}{ * extract accessor for the PlaceHolder<N>, an accessor is created for the Nth}
00023 \textcolor{comment}{ * buffer in the tuple of buffers. This accessor is then added as an Nth}
00024 \textcolor{comment}{ * element in the tuple of accessors. In this case we preserve the order of data}
00025 \textcolor{comment}{ * in the expression tree.}
00026 \textcolor{comment}{ *}
00027 \textcolor{comment}{ * This is the specialisation of extract accessor method for different operation}
00028 \textcolor{comment}{ * type in the PlaceHolder expression.}
00029 \textcolor{comment}{ *}
00030 \textcolor{comment}{*****************************************************************/}
00031 
00032 \textcolor{preprocessor}{#ifndef UNSUPPORTED\_EIGEN\_CXX11\_SRC\_TENSOR\_TENSORSYCL\_EXTRACT\_ACCESSOR\_HPP}
00033 \textcolor{preprocessor}{#define UNSUPPORTED\_EIGEN\_CXX11\_SRC\_TENSOR\_TENSORSYCL\_EXTRACT\_ACCESSOR\_HPP}
00034 
00035 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00036 \textcolor{keyword}{namespace }TensorSycl \{
00037 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00042 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Evaluator>
00043 \textcolor{keyword}{struct }ExtractAccessor;
00044 
00045 \textcolor{keyword}{struct }AccessorConstructor\{
00046   \textcolor{keyword}{template}<\textcolor{keyword}{typename} Arg> \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, Arg eval)
00047   -> decltype(ExtractAccessor<Arg>::getTuple(cgh, eval)) \{
00048   \textcolor{keywordflow}{return} ExtractAccessor<Arg>::getTuple(cgh, eval);
00049   \}
00050 
00051   \textcolor{keyword}{template}<\textcolor{keyword}{typename} Arg1, \textcolor{keyword}{typename} Arg2> \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, Arg1 eval1, 
      Arg2 eval2)
00052   -> decltype(utility::tuple::append(ExtractAccessor<Arg1>::getTuple(cgh, eval1), 
      ExtractAccessor<Arg2>::getTuple(cgh, eval2))) \{
00053     \textcolor{keywordflow}{return} utility::tuple::append(ExtractAccessor<Arg1>::getTuple(cgh, eval1), 
      ExtractAccessor<Arg2>::getTuple(cgh, eval2));
00054   \}
00055   \textcolor{keyword}{template}<\textcolor{keyword}{typename} Arg1, \textcolor{keyword}{typename} Arg2, \textcolor{keyword}{typename} Arg3> \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh,
       Arg1 eval1 , Arg2 eval2 , Arg3 eval3)
00056   -> decltype(utility::tuple::append(ExtractAccessor<Arg1>::getTuple(cgh, eval1),utility::tuple::append(
      ExtractAccessor<Arg2>::getTuple(cgh, eval2), ExtractAccessor<Arg3>::getTuple(cgh, eval3)))) \{
00057     \textcolor{keywordflow}{return} utility::tuple::append(ExtractAccessor<Arg1>::getTuple(cgh, eval1),utility::tuple::append(
      ExtractAccessor<Arg2>::getTuple(cgh, eval2), ExtractAccessor<Arg3>::getTuple(cgh, eval3)));
00058   \}
00059   \textcolor{keyword}{template}< cl::sycl::access::mode AcM, \textcolor{keyword}{typename} Arg> \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getAccessor(cl::sycl::handler& cgh
      , Arg eval)
00060   -> decltype(utility::tuple::make\_tuple( eval.device().template get\_sycl\_accessor<AcM,
00061   \textcolor{keyword}{typename} \hyperlink{group___sparse_core___module}{Eigen::internal::remove\_all<typename Arg::CoeffReturnType>::type}
      >(eval.dimensions().TotalSize(), cgh,eval.data())))\{
00062     \textcolor{keywordflow}{return} utility::tuple::make\_tuple(eval.device().template get\_sycl\_accessor<AcM, typename
       Eigen::internal::remove\_all<typename Arg::CoeffReturnType>::type>(eval.dimensions().TotalSize(), cgh,eval.data()));
00063   \}
00064 \};
00065 
00068 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }UnaryCategory, \textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} RHSExpr, \textcolor{keyword}{typename} Dev>
00069 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const UnaryCategory<OP, RHSExpr>, Dev> > \{
00070   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} UnaryCategory<OP,
       RHSExpr>, Dev> eval)
00071   -> decltype(AccessorConstructor::getTuple(cgh, eval.impl()))\{
00072     \textcolor{keywordflow}{return} AccessorConstructor::getTuple(cgh, eval.impl());
00073   \}
00074 \};
00075 
00077 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }UnaryCategory, \textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} RHSExpr, \textcolor{keyword}{typename} Dev>
00078 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<UnaryCategory<OP, RHSExpr>, Dev> >
00079 : ExtractAccessor<TensorEvaluator<const UnaryCategory<OP, RHSExpr>, Dev> > \{\};
00080 
00082 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }BinaryCategory, \textcolor{keyword}{typename} OP,  \textcolor{keyword}{typename} LHSExpr, \textcolor{keyword}{typename} 
      RHSExpr, \textcolor{keyword}{typename} Dev>
00083 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const BinaryCategory<OP, LHSExpr, RHSExpr>, Dev> > \{
00084   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} BinaryCategory<OP,
       LHSExpr, RHSExpr>, Dev> eval)
00085   -> decltype(AccessorConstructor::getTuple(cgh, eval.left\_impl(), eval.right\_impl()))\{
00086     \textcolor{keywordflow}{return} AccessorConstructor::getTuple(cgh, eval.left\_impl(), eval.right\_impl());
00087   \}
00088 \};
00090 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }BinaryCategory, \textcolor{keyword}{typename} OP,  \textcolor{keyword}{typename} LHSExpr, \textcolor{keyword}{typename} 
      RHSExpr, \textcolor{keyword}{typename} Dev>
00091 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<BinaryCategory<OP, LHSExpr, RHSExpr>, Dev> >
00092 : ExtractAccessor<TensorEvaluator<const BinaryCategory<OP, LHSExpr, RHSExpr>, Dev> >\{\};
00093 
00096 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }TernaryCategory, \textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} Arg1Expr, \textcolor{keyword}{
      typename} Arg2Expr, \textcolor{keyword}{typename} Arg3Expr, \textcolor{keyword}{typename} Dev>
00097 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TernaryCategory<OP, Arg1Expr, Arg2Expr, Arg3Expr>, Dev> > \{
00098   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TernaryCategory<OP,
       Arg1Expr, Arg2Expr, Arg3Expr>, Dev> eval)
00099   -> decltype(AccessorConstructor::getTuple(cgh, eval.arg1Impl(), eval.arg2Impl(), eval.arg3Impl()))\{
00100     \textcolor{keywordflow}{return} AccessorConstructor::getTuple(cgh, eval.arg1Impl(), eval.arg2Impl(), eval.arg3Impl());
00101   \}
00102 \};
00103 
00105 \textcolor{keyword}{template} <\textcolor{keyword}{template}<\textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}, \textcolor{keyword}{class}> \textcolor{keyword}{class }TernaryCategory, \textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} Arg1Expr, \textcolor{keyword}{
      typename} Arg2Expr, \textcolor{keyword}{typename} Arg3Expr, \textcolor{keyword}{typename} Dev>
00106 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TernaryCategory<OP, Arg1Expr, Arg2Expr, Arg3Expr>, Dev> >
00107 : ExtractAccessor<TensorEvaluator<const TernaryCategory<OP, Arg1Expr, Arg2Expr, Arg3Expr>, Dev> >\{\};
00108 
00111 \textcolor{keyword}{template} <\textcolor{keyword}{typename} IfExpr, \textcolor{keyword}{typename} ThenExpr, \textcolor{keyword}{typename} ElseExpr, \textcolor{keyword}{typename} Dev>
00112 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TensorSelectOp<IfExpr, ThenExpr, ElseExpr>, Dev> > \{
00113   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TensorSelectOp<IfExpr,
       ThenExpr, ElseExpr>, Dev> eval)
00114   -> decltype(AccessorConstructor::getTuple(cgh, eval.cond\_impl(), eval.then\_impl(), eval.else\_impl()))\{
00115     \textcolor{keywordflow}{return} AccessorConstructor::getTuple(cgh, eval.cond\_impl(), eval.then\_impl(), eval.else\_impl());
00116   \}
00117 \};
00118 
00121 \textcolor{keyword}{template} <\textcolor{keyword}{typename} IfExpr, \textcolor{keyword}{typename} ThenExpr, \textcolor{keyword}{typename} ElseExpr, \textcolor{keyword}{typename} Dev>
00122 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TensorSelectOp<IfExpr, ThenExpr, ElseExpr>, Dev> >
00123 : ExtractAccessor<TensorEvaluator<const TensorSelectOp<IfExpr, ThenExpr, ElseExpr>, Dev> >\{\};
00124 
00126 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LHSExpr, \textcolor{keyword}{typename} RHSExpr, \textcolor{keyword}{typename} Dev>
00127 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TensorAssignOp<LHSExpr, RHSExpr>, Dev> > \{
00128   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TensorAssignOp<LHSExpr,
       RHSExpr>, Dev> eval)
00129   -> decltype(AccessorConstructor::getTuple(cgh, eval.left\_impl(), eval.right\_impl()))\{
00130     \textcolor{keywordflow}{return} AccessorConstructor::getTuple(cgh, eval.left\_impl(), eval.right\_impl());
00131  \}
00132 \};
00133 
00135 \textcolor{keyword}{template} <\textcolor{keyword}{typename} LHSExpr, \textcolor{keyword}{typename} RHSExpr, \textcolor{keyword}{typename} Dev>
00136 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TensorAssignOp<LHSExpr, RHSExpr>, Dev> >
00137 : ExtractAccessor<TensorEvaluator<const TensorAssignOp<LHSExpr, RHSExpr>, Dev> >\{\};
00138 
00140 \textcolor{preprocessor}{#define TENSORMAPEXPR(CVQual, ACCType)\(\backslash\)}
00141 \textcolor{preprocessor}{template <typename PlainObjectType, int Options\_, typename Dev>\(\backslash\)}
00142 \textcolor{preprocessor}{struct ExtractAccessor<TensorEvaluator<CVQual TensorMap<PlainObjectType, Options\_>, Dev> > \{\(\backslash\)}
00143 \textcolor{preprocessor}{  static inline auto getTuple(cl::sycl::handler& cgh,const TensorEvaluator<CVQual
       TensorMap<PlainObjectType, Options\_>, Dev> eval)\(\backslash\)}
00144 \textcolor{preprocessor}{  -> decltype(AccessorConstructor::template getAccessor<ACCType>(cgh, eval))\{\(\backslash\)}
00145 \textcolor{preprocessor}{    return AccessorConstructor::template getAccessor<ACCType>(cgh, eval);\(\backslash\)}
00146 \textcolor{preprocessor}{  \}\(\backslash\)}
00147 \textcolor{preprocessor}{\};}
00148 TENSORMAPEXPR(\textcolor{keyword}{const}, cl::sycl::access::mode::read)
00149 TENSORMAPEXPR(, cl::sycl::access::mode::read\_write)
00150 \textcolor{preprocessor}{#undef TENSORMAPEXPR}
00151 
00153 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00154 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TensorForcedEvalOp<Expr>, Dev> > \{
00155   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TensorForcedEvalOp<Expr>,
       Dev> eval)
00156   -> decltype(AccessorConstructor::template getAccessor<cl::sycl::access::mode::read>(cgh, eval))\{
00157     \textcolor{keywordflow}{return} AccessorConstructor::template getAccessor<cl::sycl::access::mode::read>(cgh, eval);
00158   \}
00159 \};
00160 
00162 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00163 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TensorForcedEvalOp<Expr>, Dev> >
00164 : ExtractAccessor<TensorEvaluator<const TensorForcedEvalOp<Expr>, Dev> >\{\};
00165 
00167 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00168 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TensorEvalToOp<Expr>, Dev> > \{
00169   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh,\textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TensorEvalToOp<Expr>, Dev>
       eval)
00170   -> decltype(utility::tuple::append(AccessorConstructor::template 
      getAccessor<cl::sycl::access::mode::write>(cgh, eval), AccessorConstructor::getTuple(cgh, eval.impl())))\{
00171     \textcolor{keywordflow}{return} utility::tuple::append(AccessorConstructor::template getAccessor<cl::sycl::access::mode::write>(
      cgh, eval), AccessorConstructor::getTuple(cgh, eval.impl()));
00172   \}
00173 \};
00174 
00176 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00177 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TensorEvalToOp<Expr>, Dev> >
00178 : ExtractAccessor<TensorEvaluator<const TensorEvalToOp<Expr>, Dev> >\{\};
00179 
00181 \textcolor{keyword}{template} <\textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} Dim, \textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00182 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<const TensorReductionOp<OP, Dim, Expr>, Dev> > \{
00183   \textcolor{keyword}{static} \textcolor{keyword}{inline} \textcolor{keyword}{auto} getTuple(cl::sycl::handler& cgh, \textcolor{keyword}{const} TensorEvaluator<\textcolor{keyword}{const} TensorReductionOp<OP,
       Dim, Expr>, Dev> eval)
00184   -> decltype(AccessorConstructor::template getAccessor<cl::sycl::access::mode::read>(cgh, eval))\{
00185     \textcolor{keywordflow}{return} AccessorConstructor::template getAccessor<cl::sycl::access::mode::read>(cgh, eval);
00186   \}
00187 \};
00188 
00190 \textcolor{keyword}{template} <\textcolor{keyword}{typename} OP, \textcolor{keyword}{typename} Dim, \textcolor{keyword}{typename} Expr, \textcolor{keyword}{typename} Dev>
00191 \textcolor{keyword}{struct }ExtractAccessor<TensorEvaluator<TensorReductionOp<OP, Dim, Expr>, Dev> >
00192 : ExtractAccessor<TensorEvaluator<const TensorReductionOp<OP, Dim, Expr>, Dev> >\{\};
00193 
00195 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Evaluator>
00196 \textcolor{keyword}{auto} createTupleOfAccessors(cl::sycl::handler& cgh, \textcolor{keyword}{const} Evaluator& expr)
00197 -> decltype(ExtractAccessor<Evaluator>::getTuple(cgh, expr)) \{
00198   \textcolor{keywordflow}{return} ExtractAccessor<Evaluator>::getTuple(cgh, expr);
00199 \}
00200 
00201 \} 
00202 \} 
00203 \} 
00204 \textcolor{preprocessor}{#endif  // UNSUPPORTED\_EIGEN\_CXX11\_SRC\_TENSOR\_TENSORSYCL\_EXTRACT\_ACCESSOR\_HPP}
\end{DoxyCode}
