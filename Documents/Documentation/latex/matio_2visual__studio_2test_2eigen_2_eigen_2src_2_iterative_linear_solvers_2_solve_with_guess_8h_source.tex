\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_iterative_linear_solvers_2_solve_with_guess_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Iterative\+Linear\+Solvers/\+Solve\+With\+Guess.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_iterative_linear_solvers_2_solve_with_guess_8h_source}\index{Solve\+With\+Guess.\+h@{Solve\+With\+Guess.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_SOLVEWITHGUESS\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_SOLVEWITHGUESS\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00014 
00015 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} GuessType> \textcolor{keyword}{class }SolveWithGuess;
00016   
00029 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00030 
00031 
00032 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} GuessType>
00033 \textcolor{keyword}{struct }traits<SolveWithGuess<Decomposition, RhsType, GuessType> >
00034   : traits<Solve<Decomposition,RhsType> >
00035 \{\};
00036 
00037 \}
00038 
00039 
00040 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} GuessType>
00041 \textcolor{keyword}{class }SolveWithGuess : \textcolor{keyword}{public} internal::generic\_xpr\_base<SolveWithGuess<Decomposition,RhsType,GuessType>, M
      atrixXpr, typename internal::traits<RhsType>::StorageKind>::type
00042 \{
00043 \textcolor{keyword}{public}:
00044   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::traits<SolveWithGuess>::Scalar Scalar;
00045   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::traits<SolveWithGuess>::PlainObject PlainObject;
00046   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::generic\_xpr\_base<SolveWithGuess<Decomposition,RhsType,GuessType>, MatrixXpr, \textcolor{keyword}{
      typename} internal::traits<RhsType>::StorageKind>::type Base;
00047   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::ref\_selector<SolveWithGuess>::type Nested;
00048   
00049   SolveWithGuess(\textcolor{keyword}{const} Decomposition &dec, \textcolor{keyword}{const} RhsType &rhs, \textcolor{keyword}{const} GuessType &guess)
00050     : m\_dec(dec), m\_rhs(rhs), m\_guess(guess)
00051   \{\}
00052   
00053   EIGEN\_DEVICE\_FUNC \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_dec.cols(); \}
00054   EIGEN\_DEVICE\_FUNC \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_rhs.cols(); \}
00055 
00056   EIGEN\_DEVICE\_FUNC \textcolor{keyword}{const} Decomposition& dec()\textcolor{keyword}{   const }\{ \textcolor{keywordflow}{return} m\_dec; \}
00057   EIGEN\_DEVICE\_FUNC \textcolor{keyword}{const} RhsType&       rhs()\textcolor{keyword}{   const }\{ \textcolor{keywordflow}{return} m\_rhs; \}
00058   EIGEN\_DEVICE\_FUNC \textcolor{keyword}{const} GuessType&     guess()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_guess; \}
00059 
00060 \textcolor{keyword}{protected}:
00061   \textcolor{keyword}{const} Decomposition &m\_dec;
00062   \textcolor{keyword}{const} RhsType       &m\_rhs;
00063   \textcolor{keyword}{const} GuessType     &m\_guess;
00064   
00065 \textcolor{keyword}{private}:
00066   Scalar coeff(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} col) \textcolor{keyword}{const};
00067   Scalar coeff(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i) \textcolor{keyword}{const};
00068 \};
00069 
00070 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00071 
00072 \textcolor{comment}{// Evaluator of SolveWithGuess -> eval into a temporary}
00073 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} GuessType>
00074 \textcolor{keyword}{struct }evaluator<SolveWithGuess<Decomposition,RhsType, GuessType> >
00075   : \textcolor{keyword}{public} evaluator<typename SolveWithGuess<Decomposition,RhsType,GuessType>::PlainObject>
00076 \{
00077   \textcolor{keyword}{typedef} SolveWithGuess<Decomposition,RhsType,GuessType> SolveType;
00078   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} SolveType::PlainObject PlainObject;
00079   \textcolor{keyword}{typedef} evaluator<PlainObject> Base;
00080 
00081   evaluator(\textcolor{keyword}{const} SolveType& solve)
00082     : m\_result(solve.rows(), solve.cols())
00083   \{
00084     ::new (static\_cast<Base*>(\textcolor{keyword}{this})) Base(m\_result);
00085     m\_result = solve.guess();
00086     solve.dec().\_solve\_with\_guess\_impl(solve.rhs(), m\_result);
00087   \}
00088   
00089 protected:  
00090   PlainObject m\_result;
00091 \};
00092 
00093 \textcolor{comment}{// Specialization for "dst = dec.solveWithGuess(rhs)"}
00094 \textcolor{comment}{// NOTE we need to specialize it for Dense2Dense to avoid ambiguous specialization error and a
       Sparse2Sparse specialization must exist somewhere}
00095 template<typename DstXprType, typename DecType, typename RhsType, typename GuessType, typename Scalar>
00096 struct Assignment<DstXprType, SolveWithGuess<DecType,RhsType,GuessType>, 
      \hyperlink{namespaceinternal}{internal}::assign\_op<Scalar,Scalar>, Dense2Dense>
00097 \{
00098   \textcolor{keyword}{typedef} SolveWithGuess<DecType,RhsType,GuessType> SrcXprType;
00099   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(DstXprType &dst, \textcolor{keyword}{const} SrcXprType &src, \textcolor{keyword}{const} internal::assign\_op<Scalar,Scalar> &)
00100   \{
00101     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} dstRows = src.rows();
00102     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} dstCols = src.cols();
00103     \textcolor{keywordflow}{if}((dst.rows()!=dstRows) || (dst.cols()!=dstCols))
00104       dst.resize(dstRows, dstCols);
00105 
00106     dst = src.guess();
00107     src.dec().\_solve\_with\_guess\_impl(src.rhs(), dst\textcolor{comment}{/*, src.guess()*/});
00108   \}
00109 \};
00110 
00111 \} \textcolor{comment}{// end namepsace internal}
00112 
00113 \} \textcolor{comment}{// end namespace Eigen}
00114 
00115 \textcolor{preprocessor}{#endif // EIGEN\_SOLVEWITHGUESS\_H}
\end{DoxyCode}
