\hypertarget{matio_2visual__studio_2test_2eigen_2bench_2btl_2generic__bench_2timers_2_s_t_l__timer_8hh_source}{}\section{matio/visual\+\_\+studio/test/eigen/bench/btl/generic\+\_\+bench/timers/\+S\+T\+L\+\_\+timer.hh}
\label{matio_2visual__studio_2test_2eigen_2bench_2btl_2generic__bench_2timers_2_s_t_l__timer_8hh_source}\index{S\+T\+L\+\_\+timer.\+hh@{S\+T\+L\+\_\+timer.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  STL\_Timer.hh}
00003 \textcolor{comment}{// Author :  L. Plagne <laurent.plagne@edf.fr)>        }
00004 \textcolor{comment}{// Copyright (C) EDF R&D,  mar déc 3 18:59:35 CET 2002}
00005 \textcolor{comment}{//=====================================================}
00006 \textcolor{comment}{// }
00007 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00008 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00009 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00010 \textcolor{comment}{// of the License, or (at your option) any later version.}
00011 \textcolor{comment}{// }
00012 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00013 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00014 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00015 \textcolor{comment}{// GNU General Public License for more details.}
00016 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00018 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00019 \textcolor{comment}{// }
00020 \textcolor{comment}{// STL Timer Class. Adapted (L.P.) from the timer class by Musser et Al}
00021 \textcolor{comment}{// described int the Book : STL Tutorial and reference guide.}
00022 \textcolor{comment}{// Define a timer class for analyzing algorithm performance.}
00023 \textcolor{preprocessor}{#include <iostream>}
00024 \textcolor{preprocessor}{#include <iomanip>}
00025 \textcolor{preprocessor}{#include <vector>}
00026 \textcolor{preprocessor}{#include <map>}
00027 \textcolor{preprocessor}{#include <algorithm>}
00028 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00029 
00030 \textcolor{keyword}{class }\hyperlink{class_s_t_l___timer}{STL\_Timer} \{
00031 \textcolor{keyword}{public}:
00032   \hyperlink{class_s_t_l___timer}{STL\_Timer}()\{ baseline = \textcolor{keyword}{false}; \};  \textcolor{comment}{// Default constructor}
00033   \textcolor{comment}{// Start a series of r trials:}
00034   \textcolor{keywordtype}{void} start(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r)\{
00035     reps = r;
00036     count = 0;
00037     iterations.clear();
00038     iterations.reserve(reps);
00039     initial = time(0);
00040   \};
00041   \textcolor{comment}{// Start a series of r trials to determine baseline time:}
00042   \textcolor{keywordtype}{void} start\_baseline(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} r)
00043   \{
00044     baseline = \textcolor{keyword}{true};
00045     start(r);
00046   \}
00047   \textcolor{comment}{// Returns true if the trials have been completed, else false}
00048   \textcolor{keywordtype}{bool} check()
00049   \{
00050     ++count;
00051     \textcolor{keyword}{final} = time(0);
00052     \textcolor{keywordflow}{if} (initial < \textcolor{keyword}{final}) \{
00053       iterations.push\_back(count);  
00054       initial = \textcolor{keyword}{final};
00055       count = 0;
00056     \}
00057     \textcolor{keywordflow}{return} (iterations.size() < reps);
00058   \};
00059   \textcolor{comment}{// Returns the results for external use}
00060   \textcolor{keywordtype}{double} get\_time( \textcolor{keywordtype}{void} )
00061   \{
00062     sort(iterations.begin(), iterations.end());
00063     \textcolor{keywordflow}{return} 1.0/iterations[reps/2];
00064   \};
00065 \textcolor{keyword}{private}:
00066   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{int} reps;  \textcolor{comment}{// Number of trials}
00067   \textcolor{comment}{// For storing loop iterations of a trial}
00068   vector<long> iterations;
00069   \textcolor{comment}{// For saving initial and final times of a trial}
00070   time\_t initial, \textcolor{keyword}{final};
00071   \textcolor{comment}{// For counting loop iterations of a trial}
00072   \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} count;
00073   \textcolor{comment}{// true if this is a baseline computation, false otherwise}
00074   \textcolor{keywordtype}{bool} baseline;
00075   \textcolor{comment}{// For recording the baseline time }
00076   \textcolor{keywordtype}{double} baseline\_time;
00077 \};
00078 
\end{DoxyCode}
