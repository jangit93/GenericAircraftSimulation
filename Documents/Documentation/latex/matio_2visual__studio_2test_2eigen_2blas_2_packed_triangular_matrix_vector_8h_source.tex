\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2_packed_triangular_matrix_vector_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/\+Packed\+Triangular\+Matrix\+Vector.h}
\label{matio_2visual__studio_2test_2eigen_2blas_2_packed_triangular_matrix_vector_8h_source}\index{Packed\+Triangular\+Matrix\+Vector.\+h@{Packed\+Triangular\+Matrix\+Vector.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2012 Chen-Pang He <jdh8@ms63.hinet.net>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_PACKED\_TRIANGULAR\_MATRIX\_VECTOR\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_PACKED\_TRIANGULAR\_MATRIX\_VECTOR\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00014 
00015 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keyword}{typename} LhsScalar, \textcolor{keywordtype}{bool} ConjLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{bool} ConjRhs, \textcolor{keywordtype}{int} 
      StorageOrder>
00016 \textcolor{keyword}{struct }packed\_triangular\_matrix\_vector\_product;
00017 
00018 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keyword}{typename} LhsScalar, \textcolor{keywordtype}{bool} ConjLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{bool} ConjRhs>
00019 \textcolor{keyword}{struct }packed\_triangular\_matrix\_vector\_product<\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},Mode,LhsScalar,ConjLhs,RhsScalar,ConjRhs,
      \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13a0cbd4bdd0abcfc0224c5fcb5e4f6669a}{ColMajor}>
00020 \{
00021   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType ResScalar;
00022   \textcolor{keyword}{enum} \{
00023     IsLower     = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower})   ==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower},
00024     HasUnitDiag = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag},
00025     HasZeroDiag = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda884ff7240392e85aa6e4b3c957e36483}{ZeroDiag})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda884ff7240392e85aa6e4b3c957e36483}{ZeroDiag}
00026   \};
00027   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, \textcolor{keyword}{const} LhsScalar* lhs, \textcolor{keyword}{const} RhsScalar* rhs, ResScalar* res, ResScalar alpha)
00028   \{
00029     internal::conj\_if<ConjRhs> cj;
00030     \textcolor{keyword}{typedef} Map<const Matrix<LhsScalar,Dynamic,1> > LhsMap;
00031     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conj\_expr\_if<ConjLhs,LhsMap>::type ConjLhsType;
00032     \textcolor{keyword}{typedef} Map<Matrix<ResScalar,Dynamic,1> > ResMap;
00033 
00034     \textcolor{keywordflow}{for} (Index i=0; i<size; ++i)
00035     \{
00036       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} s = IsLower&&(HasUnitDiag||HasZeroDiag) ? 1 : 0;
00037       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} r = IsLower ? size-i: i+1;
00038       \textcolor{keywordflow}{if} (EIGEN\_IMPLIES(HasUnitDiag||HasZeroDiag, (--r)>0))
00039     ResMap(res+(IsLower ? s+i : 0),r) += alpha * cj(rhs[i]) * ConjLhsType(LhsMap(lhs+s,r));
00040       \textcolor{keywordflow}{if} (HasUnitDiag)
00041     res[i] += alpha * cj(rhs[i]);
00042       lhs += IsLower ? size-i: i+1;
00043     \}
00044   \};
00045 \};
00046 
00047 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keyword}{typename} LhsScalar, \textcolor{keywordtype}{bool} ConjLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{bool} ConjRhs>
00048 \textcolor{keyword}{struct }packed\_triangular\_matrix\_vector\_product<\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},Mode,LhsScalar,ConjLhs,RhsScalar,ConjRhs,
      \hyperlink{group__enums_ggaacded1a18ae58b0f554751f6cdf9eb13acfcde9cd8677c5f7caf6bd603666aae3}{RowMajor}>
00049 \{
00050   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} ScalarBinaryOpTraits<LhsScalar, RhsScalar>::ReturnType ResScalar;
00051   \textcolor{keyword}{enum} \{
00052     IsLower     = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower})   ==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower},
00053     HasUnitDiag = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cdaddb72f888ac85d5a1c52333e54f9374b}{UnitDiag},
00054     HasZeroDiag = (Mode & \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda884ff7240392e85aa6e4b3c957e36483}{ZeroDiag})==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda884ff7240392e85aa6e4b3c957e36483}{ZeroDiag}
00055   \};
00056   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, \textcolor{keyword}{const} LhsScalar* lhs, \textcolor{keyword}{const} RhsScalar* rhs, ResScalar* res, ResScalar alpha)
00057   \{
00058     internal::conj\_if<ConjRhs> cj;
00059     \textcolor{keyword}{typedef} Map<const Matrix<LhsScalar,Dynamic,1> > LhsMap;
00060     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conj\_expr\_if<ConjLhs,LhsMap>::type ConjLhsType;
00061     \textcolor{keyword}{typedef} Map<const Matrix<RhsScalar,Dynamic,1> > RhsMap;
00062     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} conj\_expr\_if<ConjRhs,RhsMap>::type ConjRhsType;
00063 
00064     \textcolor{keywordflow}{for} (Index i=0; i<size; ++i)
00065     \{
00066       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} s = !IsLower&&(HasUnitDiag||HasZeroDiag) ? 1 : 0;
00067       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} r = IsLower ? i+1 : size-i;
00068       \textcolor{keywordflow}{if} (EIGEN\_IMPLIES(HasUnitDiag||HasZeroDiag, (--r)>0))
00069     res[i] += alpha * (ConjLhsType(LhsMap(lhs+s,r)).cwiseProduct(ConjRhsType(RhsMap(rhs+(IsLower ? 0 : s+i)
      ,r)))).sum();
00070       \textcolor{keywordflow}{if} (HasUnitDiag)
00071     res[i] += alpha * cj(rhs[i]);
00072       lhs += IsLower ? i+1 : size-i;
00073     \}
00074   \};
00075 \};
00076 
00077 \} \textcolor{comment}{// end namespace internal}
00078 
00079 \textcolor{preprocessor}{#endif // EIGEN\_PACKED\_TRIANGULAR\_MATRIX\_VECTOR\_H}
\end{DoxyCode}
