\hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source}{}\section{eigen/\+Eigen/src/\+Householder/\+Householder.h}
\label{eigen_2_eigen_2src_2_householder_2_householder_8h_source}\index{Householder.\+h@{Householder.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2010 Benoit Jacob <jacob.benoit.1@gmail.com>}
00005 \textcolor{comment}{// Copyright (C) 2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_HOUSEHOLDER\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_HOUSEHOLDER\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
\Hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source_l00017}\hyperlink{struct_eigen_1_1internal_1_1decrement__size}{00017} \textcolor{keyword}{template}<\textcolor{keywordtype}{int} n> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1decrement__size}{decrement\_size}
00018 \{
00019   \textcolor{keyword}{enum} \{
00020     ret = n==\hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? n : n-1
00021   \};
00022 \};
00023 \}
00024 
00041 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source_l00042}\hyperlink{group___core___module_aebf4bac7dffe2685ab93734fb776e817}{00042} \textcolor{keywordtype}{void} \hyperlink{group___core___module_aebf4bac7dffe2685ab93734fb776e817}{MatrixBase<Derived>::makeHouseholderInPlace}(
      \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}& tau, RealScalar& beta)
00043 \{
00044   \hyperlink{group___core___module_class_eigen_1_1_vector_block}{VectorBlock<Derived, internal::decrement\_size<Base::SizeAtCompileTime>::ret}
      > essentialPart(derived(), 1, size()-1);
00045   makeHouseholder(essentialPart, tau, beta);
00046 \}
00047 
00063 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00064 \textcolor{keyword}{template}<\textcolor{keyword}{typename} EssentialPart>
\Hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source_l00065}\hyperlink{group___core___module_a13291e900f7e81ddc6e5b8802f82092b}{00065} \textcolor{keywordtype}{void} \hyperlink{group___core___module_a13291e900f7e81ddc6e5b8802f82092b}{MatrixBase<Derived>::makeHouseholder}(
00066   EssentialPart& essential,
00067   \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}& tau,
00068   RealScalar& beta)\textcolor{keyword}{ const}
00069 \textcolor{keyword}{}\{
00070   \textcolor{keyword}{using} std::sqrt;
00071   \textcolor{keyword}{using} numext::conj;
00072   
00073   EIGEN\_STATIC\_ASSERT\_VECTOR\_ONLY(EssentialPart)
00074   \hyperlink{group___core___module_class_eigen_1_1_vector_block}{VectorBlock<const Derived, EssentialPart::SizeAtCompileTime>}
       tail(derived(), 1, size()-1);
00075   
00076   RealScalar tailSqNorm = size()==1 ? RealScalar(0) : tail.squaredNorm();
00077   \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar} c0 = coeff(0);
00078   \textcolor{keyword}{const} RealScalar tol = (std::numeric\_limits<RealScalar>::min)();
00079 
00080   \textcolor{keywordflow}{if}(tailSqNorm <= tol && numext::abs2(numext::imag(c0))<=tol)
00081   \{
00082     tau = RealScalar(0);
00083     beta = numext::real(c0);
00084     essential.setZero();
00085   \}
00086   \textcolor{keywordflow}{else}
00087   \{
00088     beta = sqrt(numext::abs2(c0) + tailSqNorm);
00089     \textcolor{keywordflow}{if} (numext::real(c0)>=RealScalar(0))
00090       beta = -beta;
00091     essential = tail / (c0 - beta);
00092     tau = conj((beta - c0) / beta);
00093   \}
00094 \}
00095 
00111 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00112 \textcolor{keyword}{template}<\textcolor{keyword}{typename} EssentialPart>
\Hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source_l00113}\hyperlink{group___core___module_a8f2c8059ef3f04cfa0c73b4c012db855}{00113} \textcolor{keywordtype}{void} \hyperlink{group___core___module_a8f2c8059ef3f04cfa0c73b4c012db855}{MatrixBase<Derived>::applyHouseholderOnTheLeft}(
00114   \textcolor{keyword}{const} EssentialPart& essential,
00115   \textcolor{keyword}{const} \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}& tau,
00116   \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}* workspace)
00117 \{
00118   \textcolor{keywordflow}{if}(rows() == 1)
00119   \{
00120     *\textcolor{keyword}{this} *= \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}(1)-tau;
00121   \}
00122   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tau!=\hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}(0))
00123   \{
00124     \hyperlink{group___core___module_class_eigen_1_1_map}{Map<typename internal::plain\_row\_type<PlainObject>::type}
      > tmp(workspace,cols());
00125     \hyperlink{group___core___module_class_eigen_1_1_block}{Block<Derived, EssentialPart::SizeAtCompileTime, Derived::ColsAtCompileTime>}
       bottom(derived(), 1, 0, rows()-1, cols());
00126     tmp.noalias() = essential.adjoint() * bottom;
00127     tmp += this->row(0);
00128     this->row(0) -= tau * tmp;
00129     bottom.noalias() -= tau * essential * tmp;
00130   \}
00131 \}
00132 
00148 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00149 \textcolor{keyword}{template}<\textcolor{keyword}{typename} EssentialPart>
\Hypertarget{eigen_2_eigen_2src_2_householder_2_householder_8h_source_l00150}\hyperlink{group___core___module_ab3e52262b41fa40e194dda245e0f9675}{00150} \textcolor{keywordtype}{void} \hyperlink{group___core___module_ab3e52262b41fa40e194dda245e0f9675}{MatrixBase<Derived>::applyHouseholderOnTheRight}(
00151   \textcolor{keyword}{const} EssentialPart& essential,
00152   \textcolor{keyword}{const} \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}& tau,
00153   \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}* workspace)
00154 \{
00155   \textcolor{keywordflow}{if}(cols() == 1)
00156   \{
00157     *\textcolor{keyword}{this} *= \hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}(1)-tau;
00158   \}
00159   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(tau!=\hyperlink{group___core___module_a5feed465b3a8e60c47e73ecce83e39a2}{Scalar}(0))
00160   \{
00161     \hyperlink{group___core___module_class_eigen_1_1_map}{Map<typename internal::plain\_col\_type<PlainObject>::type}
      > tmp(workspace,rows());
00162     \hyperlink{group___core___module_class_eigen_1_1_block}{Block<Derived, Derived::RowsAtCompileTime, EssentialPart::SizeAtCompileTime>}
       right(derived(), 0, 1, rows(), cols()-1);
00163     tmp.noalias() = right * essential.conjugate();
00164     tmp += this->col(0);
00165     this->col(0) -= tau * tmp;
00166     right.noalias() -= tau * tmp * essential.transpose();
00167   \}
00168 \}
00169 
00170 \} \textcolor{comment}{// end namespace Eigen}
00171 
00172 \textcolor{preprocessor}{#endif // EIGEN\_HOUSEHOLDER\_H}
\end{DoxyCode}
