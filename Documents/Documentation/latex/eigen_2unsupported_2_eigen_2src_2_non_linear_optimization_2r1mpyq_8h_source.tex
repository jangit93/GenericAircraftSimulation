\hypertarget{eigen_2unsupported_2_eigen_2src_2_non_linear_optimization_2r1mpyq_8h_source}{}\section{eigen/unsupported/\+Eigen/src/\+Non\+Linear\+Optimization/r1mpyq.h}
\label{eigen_2unsupported_2_eigen_2src_2_non_linear_optimization_2r1mpyq_8h_source}\index{r1mpyq.\+h@{r1mpyq.\+h}}

\begin{DoxyCode}
00001 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00002 
00003 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00004 
00005 \textcolor{comment}{// TODO : move this to GivensQR once there's such a thing in Eigen}
00006 
00007 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar>
00008 \textcolor{keywordtype}{void} r1mpyq(DenseIndex m, DenseIndex n, Scalar *a, \textcolor{keyword}{const} std::vector<JacobiRotation<Scalar> > &v\_givens, \textcolor{keyword}{
      const} std::vector<JacobiRotation<Scalar> > &w\_givens)
00009 \{
00010     \textcolor{keyword}{typedef} DenseIndex \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00011 
00012     \textcolor{comment}{/*     apply the first set of givens rotations to a. */}
00013     \textcolor{keywordflow}{for} (Index j = n-2; j>=0; --j)
00014         \textcolor{keywordflow}{for} (Index i = 0; i<m; ++i) \{
00015             Scalar temp = v\_givens[j].c() * a[i+m*j] - v\_givens[j].s() * a[i+m*(n-1)];
00016             a[i+m*(n-1)] = v\_givens[j].s() * a[i+m*j] + v\_givens[j].c() * a[i+m*(n-1)];
00017             a[i+m*j] = temp;
00018         \}
00019     \textcolor{comment}{/*     apply the second set of givens rotations to a. */}
00020     \textcolor{keywordflow}{for} (Index j = 0; j<n-1; ++j)
00021         \textcolor{keywordflow}{for} (Index i = 0; i<m; ++i) \{
00022             Scalar temp = w\_givens[j].c() * a[i+m*j] + w\_givens[j].s() * a[i+m*(n-1)];
00023             a[i+m*(n-1)] = -w\_givens[j].s() * a[i+m*j] + w\_givens[j].c() * a[i+m*(n-1)];
00024             a[i+m*j] = temp;
00025         \}
00026 \}
00027 
00028 \} \textcolor{comment}{// end namespace internal}
00029 
00030 \} \textcolor{comment}{// end namespace Eigen}
\end{DoxyCode}
