\hypertarget{matio_2visual__studio_2test_2eigen_2bench_2btl_2actions_2action__partial__lu_8hh_source}{}\section{matio/visual\+\_\+studio/test/eigen/bench/btl/actions/action\+\_\+partial\+\_\+lu.hh}
\label{matio_2visual__studio_2test_2eigen_2bench_2btl_2actions_2action__partial__lu_8hh_source}\index{action\+\_\+partial\+\_\+lu.\+hh@{action\+\_\+partial\+\_\+lu.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  action\_lu\_decomp.hh}
00003 \textcolor{comment}{// Copyright (C) 2008 Gael Guennebaud <gael.guennebaud@inria.fr>}
00004 \textcolor{comment}{//=====================================================}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00007 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00008 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00009 \textcolor{comment}{// of the License, or (at your option) any later version.}
00010 \textcolor{comment}{//}
00011 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00012 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00013 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00014 \textcolor{comment}{// GNU General Public License for more details.}
00015 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00016 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00017 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00018 \textcolor{comment}{//}
00019 \textcolor{preprocessor}{#ifndef ACTION\_PARTIAL\_LU}
00020 \textcolor{preprocessor}{#define ACTION\_PARTIAL\_LU}
00021 \textcolor{preprocessor}{#include "utilities.h"}
00022 \textcolor{preprocessor}{#include "STL\_interface.hh"}
00023 \textcolor{preprocessor}{#include <string>}
00024 \textcolor{preprocessor}{#include "init/init\_function.hh"}
00025 \textcolor{preprocessor}{#include "init/init\_vector.hh"}
00026 \textcolor{preprocessor}{#include "init/init\_matrix.hh"}
00027 
00028 \textcolor{keyword}{using namespace }\hyperlink{namespacestd}{std};
00029 
00030 \textcolor{keyword}{template}<\textcolor{keyword}{class} Interface>
00031 \textcolor{keyword}{class }\hyperlink{class_action__partial__lu}{Action\_partial\_lu} \{
00032 
00033 public :
00034 
00035   \textcolor{comment}{// Ctor}
00036 
00037   \hyperlink{class_action__partial__lu}{Action\_partial\_lu}( \textcolor{keywordtype}{int} size ):\_size(size)
00038   \{
00039     MESSAGE(\textcolor{stringliteral}{"Action\_partial\_lu Ctor"});
00040 
00041     \textcolor{comment}{// STL vector initialization}
00042     init\_matrix<pseudo\_random>(X\_stl,\_size);
00043     init\_matrix<null\_function>(C\_stl,\_size);
00044 
00045     \textcolor{comment}{// make sure X is invertible}
00046     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i=0; i<\_size; ++i)
00047       X\_stl[i][i] = X\_stl[i][i] * 1e2 + 1;
00048 
00049     \textcolor{comment}{// generic matrix and vector initialization}
00050     Interface::matrix\_from\_stl(X\_ref,X\_stl);
00051     Interface::matrix\_from\_stl(X,X\_stl);
00052     Interface::matrix\_from\_stl(C,C\_stl);
00053 
00054     \_cost = 2.0*size*size*size/3.0 + size*size;
00055   \}
00056 
00057   \textcolor{comment}{// invalidate copy ctor}
00058 
00059   \hyperlink{class_action__partial__lu}{Action\_partial\_lu}( \textcolor{keyword}{const}  \hyperlink{class_action__partial__lu}{Action\_partial\_lu} & )
00060   \{
00061     INFOS(\textcolor{stringliteral}{"illegal call to Action\_partial\_lu Copy Ctor"});
00062     exit(1);
00063   \}
00064 
00065   \textcolor{comment}{// Dtor}
00066 
00067   ~\hyperlink{class_action__partial__lu}{Action\_partial\_lu}( \textcolor{keywordtype}{void} )\{
00068 
00069     MESSAGE(\textcolor{stringliteral}{"Action\_partial\_lu Dtor"});
00070 
00071     \textcolor{comment}{// deallocation}
00072     Interface::free\_matrix(X\_ref,\_size);
00073     Interface::free\_matrix(X,\_size);
00074     Interface::free\_matrix(C,\_size);
00075   \}
00076 
00077   \textcolor{comment}{// action name}
00078 
00079   \textcolor{keyword}{static} \textcolor{keyword}{inline} std::string name( \textcolor{keywordtype}{void} )
00080   \{
00081     \textcolor{keywordflow}{return} \textcolor{stringliteral}{"partial\_lu\_decomp\_"}+Interface::name();
00082   \}
00083 
00084   \textcolor{keywordtype}{double} nb\_op\_base( \textcolor{keywordtype}{void} )\{
00085     \textcolor{keywordflow}{return} \_cost;
00086   \}
00087 
00088   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} initialize( \textcolor{keywordtype}{void} )\{
00089     Interface::copy\_matrix(X\_ref,X,\_size);
00090   \}
00091 
00092   \textcolor{keyword}{inline} \textcolor{keywordtype}{void} calculate( \textcolor{keywordtype}{void} ) \{
00093       Interface::partial\_lu\_decomp(X,C,\_size);
00094   \}
00095 
00096   \textcolor{keywordtype}{void} check\_result( \textcolor{keywordtype}{void} )\{
00097     \textcolor{comment}{// calculation check}
00098 \textcolor{comment}{//     Interface::matrix\_to\_stl(C,resu\_stl);}
00099 
00100 \textcolor{comment}{//     STL\_interface<typename Interface::real\_type>::lu\_decomp(X\_stl,C\_stl,\_size);}
00101 \textcolor{comment}{//}
00102 \textcolor{comment}{//     typename Interface::real\_type error=}
00103 \textcolor{comment}{//       STL\_interface<typename Interface::real\_type>::norm\_diff(C\_stl,resu\_stl);}
00104 \textcolor{comment}{//}
00105 \textcolor{comment}{//     if (error>1.e-6)\{}
00106 \textcolor{comment}{//       INFOS("WRONG CALCULATION...residual=" << error);}
00107 \textcolor{comment}{//       exit(0);}
00108 \textcolor{comment}{//     \}}
00109 
00110   \}
00111 
00112 private :
00113 
00114   \textcolor{keyword}{typename} Interface::stl\_matrix X\_stl;
00115   \textcolor{keyword}{typename} Interface::stl\_matrix C\_stl;
00116 
00117   \textcolor{keyword}{typename} Interface::gene\_matrix X\_ref;
00118   \textcolor{keyword}{typename} Interface::gene\_matrix X;
00119   \textcolor{keyword}{typename} Interface::gene\_matrix C;
00120 
00121   \textcolor{keywordtype}{int} \_size;
00122   \textcolor{keywordtype}{double} \_cost;
00123 \};
00124 
00125 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
