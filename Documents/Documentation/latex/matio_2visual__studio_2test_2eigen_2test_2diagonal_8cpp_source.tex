\hypertarget{matio_2visual__studio_2test_2eigen_2test_2diagonal_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/test/diagonal.cpp}
\label{matio_2visual__studio_2test_2eigen_2test_2diagonal_8cpp_source}\index{diagonal.\+cpp@{diagonal.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2006-2010 Benoit Jacob <jacob.benoit.1@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keywordtype}{void} diagonal(\textcolor{keyword}{const} MatrixType& m)
00013 \{
00014   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Index \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00015   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00016 
00017   Index rows = m.rows();
00018   Index cols = m.cols();
00019 
00020   MatrixType m1 = MatrixType::Random(rows, cols),
00021              m2 = MatrixType::Random(rows, cols);
00022 
00023   Scalar s1 = internal::random<Scalar>();
00024 
00025   \textcolor{comment}{//check diagonal()}
00026   VERIFY\_IS\_APPROX(m1.diagonal(), m1.transpose().diagonal());
00027   m2.diagonal() = 2 * m1.diagonal();
00028   m2.diagonal()[0] *= 3;
00029 
00030   \textcolor{keywordflow}{if} (rows>2)
00031   \{
00032     \textcolor{keyword}{enum} \{
00033       N1 = MatrixType::RowsAtCompileTime>2 ?  2 : 0,
00034       N2 = MatrixType::RowsAtCompileTime>1 ? -1 : 0
00035     \};
00036 
00037     \textcolor{comment}{// check sub/super diagonal}
00038     \textcolor{keywordflow}{if}(MatrixType::SizeAtCompileTime!=Dynamic)
00039     \{
00040       VERIFY(m1.template diagonal<N1>().RowsAtCompileTime == m1.diagonal(N1).size());
00041       VERIFY(m1.template diagonal<N2>().RowsAtCompileTime == m1.diagonal(N2).size());
00042     \}
00043 
00044     m2.template diagonal<N1>() = 2 * m1.template diagonal<N1>();
00045     VERIFY\_IS\_APPROX(m2.template diagonal<N1>(), static\_cast<Scalar>(2) * m1.diagonal(N1));
00046     m2.template diagonal<N1>()[0] *= 3;
00047     VERIFY\_IS\_APPROX(m2.template diagonal<N1>()[0], static\_cast<Scalar>(6) * m1.template diagonal<N1>()[0])
      ;
00048 
00049 
00050     m2.template diagonal<N2>() = 2 * m1.template diagonal<N2>();
00051     m2.template diagonal<N2>()[0] *= 3;
00052     VERIFY\_IS\_APPROX(m2.template diagonal<N2>()[0], static\_cast<Scalar>(6) * m1.template diagonal<N2>()[0])
      ;
00053 
00054     m2.diagonal(N1) = 2 * m1.diagonal(N1);
00055     VERIFY\_IS\_APPROX(m2.template diagonal<N1>(), static\_cast<Scalar>(2) * m1.diagonal(N1));
00056     m2.diagonal(N1)[0] *= 3;
00057     VERIFY\_IS\_APPROX(m2.diagonal(N1)[0], \textcolor{keyword}{static\_cast<}Scalar\textcolor{keyword}{>}(6) * m1.diagonal(N1)[0]);
00058 
00059     m2.diagonal(N2) = 2 * m1.diagonal(N2);
00060     VERIFY\_IS\_APPROX(m2.template diagonal<N2>(), static\_cast<Scalar>(2) * m1.diagonal(N2));
00061     m2.diagonal(N2)[0] *= 3;
00062     VERIFY\_IS\_APPROX(m2.diagonal(N2)[0], \textcolor{keyword}{static\_cast<}Scalar\textcolor{keyword}{>}(6) * m1.diagonal(N2)[0]);
00063 
00064     m2.diagonal(N2).x() = s1;
00065     VERIFY\_IS\_APPROX(m2.diagonal(N2).x(), s1);
00066     m2.diagonal(N2).coeffRef(0) = Scalar(2)*s1;
00067     VERIFY\_IS\_APPROX(m2.diagonal(N2).coeff(0), Scalar(2)*s1);
00068   \}
00069 \}
00070 
00071 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType> \textcolor{keywordtype}{void} diagonal\_assert(\textcolor{keyword}{const} MatrixType& m) \{
00072   Index rows = m.rows();
00073   Index cols = m.cols();
00074 
00075   MatrixType m1 = MatrixType::Random(rows, cols);
00076 
00077   \textcolor{keywordflow}{if} (rows>=2 && cols>=2)
00078   \{
00079     VERIFY\_RAISES\_ASSERT( m1 += m1.diagonal() );
00080     VERIFY\_RAISES\_ASSERT( m1 -= m1.diagonal() );
00081     VERIFY\_RAISES\_ASSERT( m1.array() *= m1.diagonal().array() );
00082     VERIFY\_RAISES\_ASSERT( m1.array() /= m1.diagonal().array() );
00083   \}
00084 \}
00085 
00086 \textcolor{keywordtype}{void} test\_diagonal()
00087 \{
00088   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < g\_repeat; i++) \{
00089     CALL\_SUBTEST\_1( diagonal(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 1, 1>}()) );
00090     CALL\_SUBTEST\_1( diagonal(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 4, 9>}()) );
00091     CALL\_SUBTEST\_1( diagonal(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 7, 3>}()) );
00092     CALL\_SUBTEST\_2( diagonal(Matrix4d()) );
00093     CALL\_SUBTEST\_2( diagonal(MatrixXcf(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE), internal::random<int>(
      1,EIGEN\_TEST\_MAX\_SIZE))) );
00094     CALL\_SUBTEST\_2( diagonal(MatrixXi(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE), internal::random<int>(1
      ,EIGEN\_TEST\_MAX\_SIZE))) );
00095     CALL\_SUBTEST\_2( diagonal(MatrixXcd(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE), internal::random<int>(
      1,EIGEN\_TEST\_MAX\_SIZE))) );
00096     CALL\_SUBTEST\_1( diagonal(MatrixXf(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE), internal::random<int>(1
      ,EIGEN\_TEST\_MAX\_SIZE))) );
00097     CALL\_SUBTEST\_1( diagonal(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float,Dynamic,4>}(3, 4)) );
00098   \}
00099 
00100   CALL\_SUBTEST\_1( diagonal\_assert(MatrixXf(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE), 
      internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE))) );
00101 \}
\end{DoxyCode}
