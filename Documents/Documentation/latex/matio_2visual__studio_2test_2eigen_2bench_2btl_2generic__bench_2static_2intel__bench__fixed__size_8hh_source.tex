\hypertarget{matio_2visual__studio_2test_2eigen_2bench_2btl_2generic__bench_2static_2intel__bench__fixed__size_8hh_source}{}\section{matio/visual\+\_\+studio/test/eigen/bench/btl/generic\+\_\+bench/static/intel\+\_\+bench\+\_\+fixed\+\_\+size.hh}
\label{matio_2visual__studio_2test_2eigen_2bench_2btl_2generic__bench_2static_2intel__bench__fixed__size_8hh_source}\index{intel\+\_\+bench\+\_\+fixed\+\_\+size.\+hh@{intel\+\_\+bench\+\_\+fixed\+\_\+size.\+hh}}

\begin{DoxyCode}
00001 \textcolor{comment}{//=====================================================}
00002 \textcolor{comment}{// File   :  intel\_bench\_fixed\_size.hh}
00003 \textcolor{comment}{// Author :  L. Plagne <laurent.plagne@edf.fr)>        }
00004 \textcolor{comment}{// Copyright (C) EDF R&D,  mar déc 3 18:59:37 CET 2002}
00005 \textcolor{comment}{//=====================================================}
00006 \textcolor{comment}{// }
00007 \textcolor{comment}{// This program is free software; you can redistribute it and/or}
00008 \textcolor{comment}{// modify it under the terms of the GNU General Public License}
00009 \textcolor{comment}{// as published by the Free Software Foundation; either version 2}
00010 \textcolor{comment}{// of the License, or (at your option) any later version.}
00011 \textcolor{comment}{// }
00012 \textcolor{comment}{// This program is distributed in the hope that it will be useful,}
00013 \textcolor{comment}{// but WITHOUT ANY WARRANTY; without even the implied warranty of}
00014 \textcolor{comment}{// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00015 \textcolor{comment}{// GNU General Public License for more details.}
00016 \textcolor{comment}{// You should have received a copy of the GNU General Public License}
00017 \textcolor{comment}{// along with this program; if not, write to the Free Software}
00018 \textcolor{comment}{// Foundation, Inc., 59 Temple Place - Suite 330, Boston, MA  02111-1307, USA.}
00019 \textcolor{comment}{// }
00020 \textcolor{preprocessor}{#ifndef \_BENCH\_FIXED\_SIZE\_HH\_}
00021 \textcolor{preprocessor}{#define \_BENCH\_FIXED\_SIZE\_HH\_}
00022 
00023 \textcolor{preprocessor}{#include "utilities.h"}
00024 \textcolor{preprocessor}{#include "function\_time.hh"}
00025 
00026 \textcolor{keyword}{template} <\textcolor{keyword}{class} Action>
00027 \textcolor{keywordtype}{double} bench\_fixed\_size(\textcolor{keywordtype}{int} size, \textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long}  & nb\_calc,\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long} & nb\_init)
00028 \{
00029   
00030   Action action(size);
00031   
00032   \textcolor{keywordtype}{double} time\_baseline=time\_init(nb\_init,action);
00033 
00034   \textcolor{keywordflow}{while} (time\_baseline < MIN\_TIME) \{
00035 
00036     \textcolor{comment}{//INFOS("nb\_init="<<nb\_init);}
00037     \textcolor{comment}{//INFOS("time\_baseline="<<time\_baseline);}
00038     nb\_init*=2;
00039     time\_baseline=time\_init(nb\_init,action);
00040   \}
00041   
00042   time\_baseline=time\_baseline/(double(nb\_init));
00043   
00044   \textcolor{keywordtype}{double} time\_action=time\_calculate(nb\_calc,action);
00045   
00046   \textcolor{keywordflow}{while} (time\_action < MIN\_TIME) \{
00047     
00048     nb\_calc*=2;
00049     time\_action=time\_calculate(nb\_calc,action);
00050   \}
00051 
00052   INFOS(\textcolor{stringliteral}{"nb\_init="}<<nb\_init);
00053   INFOS(\textcolor{stringliteral}{"nb\_calc="}<<nb\_calc);
00054   
00055   
00056   time\_action=time\_action/(double(nb\_calc));
00057   
00058   action.check\_result();
00059   
00060   time\_action=time\_action-time\_baseline;
00061 
00062   \textcolor{keywordflow}{return} action.nb\_op\_base()/(time\_action*1000000.0);
00063 
00064 \}
00065 
00066 \textcolor{preprocessor}{#endif}
\end{DoxyCode}
