\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2cblat2_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/cblat2.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2cblat2_8f_source}\index{cblat2.\+f@{cblat2.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b CBLAT2}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM CBLAT2}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*> Test program for the COMPLEX          Level 2 Blas.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*> The program must be driven by a short data file. The first 18 records}
00022 \textcolor{comment}{*> of the file are read using list-directed input, the last 17 records}
00023 \textcolor{comment}{*> are read using the format ( A6, L2 ). An annotated example of a data}
00024 \textcolor{comment}{*> file can be obtained by deleting the first 3 characters from the}
00025 \textcolor{comment}{*> following 35 lines:}
00026 \textcolor{comment}{*> 'cblat2.out'      NAME OF SUMMARY OUTPUT FILE}
00027 \textcolor{comment}{*> 6                 UNIT NUMBER OF SUMMARY FILE}
00028 \textcolor{comment}{*> 'CBLA2T.SNAP'     NAME OF SNAPSHOT OUTPUT FILE}
00029 \textcolor{comment}{*> -1                UNIT NUMBER OF SNAPSHOT FILE (NOT USED IF .LT. 0)}
00030 \textcolor{comment}{*> F        LOGICAL FLAG, T TO REWIND SNAPSHOT FILE AFTER EACH RECORD.}
00031 \textcolor{comment}{*> F        LOGICAL FLAG, T TO STOP ON FAILURES.}
00032 \textcolor{comment}{*> T        LOGICAL FLAG, T TO TEST ERROR EXITS.}
00033 \textcolor{comment}{*> 16.0     THRESHOLD VALUE OF TEST RATIO}
00034 \textcolor{comment}{*> 6                 NUMBER OF VALUES OF N}
00035 \textcolor{comment}{*> 0 1 2 3 5 9       VALUES OF N}
00036 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF K}
00037 \textcolor{comment}{*> 0 1 2 4           VALUES OF K}
00038 \textcolor{comment}{*> 4                 NUMBER OF VALUES OF INCX AND INCY}
00039 \textcolor{comment}{*> 1 2 -1 -2         VALUES OF INCX AND INCY}
00040 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF ALPHA}
00041 \textcolor{comment}{*> (0.0,0.0) (1.0,0.0) (0.7,-0.9)       VALUES OF ALPHA}
00042 \textcolor{comment}{*> 3                 NUMBER OF VALUES OF BETA}
00043 \textcolor{comment}{*> (0.0,0.0) (1.0,0.0) (1.3,-1.1)       VALUES OF BETA}
00044 \textcolor{comment}{*> CGEMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00045 \textcolor{comment}{*> CGBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00046 \textcolor{comment}{*> CHEMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00047 \textcolor{comment}{*> CHBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00048 \textcolor{comment}{*> CHPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00049 \textcolor{comment}{*> CTRMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00050 \textcolor{comment}{*> CTBMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00051 \textcolor{comment}{*> CTPMV  T PUT F FOR NO TEST. SAME COLUMNS.}
00052 \textcolor{comment}{*> CTRSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00053 \textcolor{comment}{*> CTBSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00054 \textcolor{comment}{*> CTPSV  T PUT F FOR NO TEST. SAME COLUMNS.}
00055 \textcolor{comment}{*> CGERC  T PUT F FOR NO TEST. SAME COLUMNS.}
00056 \textcolor{comment}{*> CGERU  T PUT F FOR NO TEST. SAME COLUMNS.}
00057 \textcolor{comment}{*> CHER   T PUT F FOR NO TEST. SAME COLUMNS.}
00058 \textcolor{comment}{*> CHPR   T PUT F FOR NO TEST. SAME COLUMNS.}
00059 \textcolor{comment}{*> CHER2  T PUT F FOR NO TEST. SAME COLUMNS.}
00060 \textcolor{comment}{*> CHPR2  T PUT F FOR NO TEST. SAME COLUMNS.}
00061 \textcolor{comment}{*>}
00062 \textcolor{comment}{*> Further Details}
00063 \textcolor{comment}{*> ===============}
00064 \textcolor{comment}{*>}
00065 \textcolor{comment}{*>    See:}
00066 \textcolor{comment}{*>}
00067 \textcolor{comment}{*>       Dongarra J. J., Du Croz J. J., Hammarling S.  and Hanson R. J..}
00068 \textcolor{comment}{*>       An  extended  set of Fortran  Basic Linear Algebra Subprograms.}
00069 \textcolor{comment}{*>}
00070 \textcolor{comment}{*>       Technical  Memoranda  Nos. 41 (revision 3) and 81,  Mathematics}
00071 \textcolor{comment}{*>       and  Computer Science  Division,  Argonne  National Laboratory,}
00072 \textcolor{comment}{*>       9700 South Cass Avenue, Argonne, Illinois 60439, US.}
00073 \textcolor{comment}{*>}
00074 \textcolor{comment}{*>       Or}
00075 \textcolor{comment}{*>}
00076 \textcolor{comment}{*>       NAG  Technical Reports TR3/87 and TR4/87,  Numerical Algorithms}
00077 \textcolor{comment}{*>       Group  Ltd.,  NAG  Central  Office,  256  Banbury  Road, Oxford}
00078 \textcolor{comment}{*>       OX2 7DE, UK,  and  Numerical Algorithms Group Inc.,  1101  31st}
00079 \textcolor{comment}{*>       Street,  Suite 100,  Downers Grove,  Illinois 60515-1263,  USA.}
00080 \textcolor{comment}{*>}
00081 \textcolor{comment}{*>}
00082 \textcolor{comment}{*> -- Written on 10-August-1987.}
00083 \textcolor{comment}{*>    Richard Hanson, Sandia National Labs.}
00084 \textcolor{comment}{*>    Jeremy Du Croz, NAG Central Office.}
00085 \textcolor{comment}{*>}
00086 \textcolor{comment}{*>    10-9-00:  Change STATUS='NEW' to 'UNKNOWN' so that the testers}
00087 \textcolor{comment}{*>              can be run multiple times without deleting generated}
00088 \textcolor{comment}{*>              output files (susan)}
00089 \textcolor{comment}{*> \(\backslash\)endverbatim}
00090 \textcolor{comment}{*}
00091 \textcolor{comment}{*  Authors:}
00092 \textcolor{comment}{*  ========}
00093 \textcolor{comment}{*}
00094 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00095 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00096 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00097 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00098 \textcolor{comment}{*}
00099 \textcolor{comment}{*> \(\backslash\)date April 2012}
00100 \textcolor{comment}{*}
00101 \textcolor{comment}{*> \(\backslash\)ingroup complex\_blas\_testing}
00102 \textcolor{comment}{*}
00103 \textcolor{comment}{*  =====================================================================}
00104       \textcolor{keyword}{PROGRAM} cblat2
00105 \textcolor{comment}{*}
00106 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00107 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00108 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00109 \textcolor{comment}{*     April 2012}
00110 \textcolor{comment}{*}
00111 \textcolor{comment}{*  =====================================================================}
00112 \textcolor{comment}{*}
00113 \textcolor{comment}{*     .. Parameters ..}
00114       \textcolor{keywordtype}{INTEGER}            nin
00115       parameter( nin = 5 )
00116       \textcolor{keywordtype}{INTEGER}            nsubs
00117       parameter( nsubs = 17 )
00118       \textcolor{keywordtype}{COMPLEX}            zero, one
00119       parameter( zero = ( 0.0, 0.0 ), one = ( 1.0, 0.0 ) )
00120       \textcolor{keywordtype}{REAL}               rzero
00121       parameter( rzero = 0.0 )
00122       \textcolor{keywordtype}{INTEGER}            nmax, incmax
00123       parameter( nmax = 65, incmax = 2 )
00124       \textcolor{keywordtype}{INTEGER}            ninmax, nidmax, nkbmax, nalmax, nbemax
00125       parameter( ninmax = 7, nidmax = 9, nkbmax = 7,
00126      $                   nalmax = 7, nbemax = 7 )
00127 \textcolor{comment}{*     .. Local Scalars ..}
00128       \textcolor{keywordtype}{REAL}               eps, err, thresh
00129       \textcolor{keywordtype}{INTEGER}            i, isnum, j, n, nalf, nbet, nidim, ninc, nkb,
00130      $                   nout, ntra
00131       \textcolor{keywordtype}{LOGICAL}            fatal, ltestt, rewi, same, sfatal, trace,
00132      $                   tsterr
00133       \textcolor{keywordtype}{CHARACTER*1}        trans
00134       \textcolor{keywordtype}{CHARACTER*6}        snamet
00135       \textcolor{keywordtype}{CHARACTER*32}       snaps, summry
00136 \textcolor{comment}{*     .. Local Arrays ..}
00137       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ),
00138      $                   alf( nalmax ), as( nmax*nmax ), bet( nbemax ),
00139      $                   x( nmax ), xs( nmax*incmax ),
00140      $                   xx( nmax*incmax ), y( nmax ),
00141      $                   ys( nmax*incmax ), yt( nmax ),
00142      $                   yy( nmax*incmax ), z( 2*nmax )
00143       \textcolor{keywordtype}{REAL}               g( nmax )
00144       \textcolor{keywordtype}{INTEGER}            idim( nidmax ), inc( ninmax ), kb( nkbmax )
00145       \textcolor{keywordtype}{LOGICAL}            ltest( nsubs )
00146       \textcolor{keywordtype}{CHARACTER*6}        snames( nsubs )
00147 \textcolor{comment}{*     .. External Functions ..}
00148       \textcolor{keywordtype}{REAL}               sdiff
00149       \textcolor{keywordtype}{LOGICAL}            lce
00150       \textcolor{keywordtype}{EXTERNAL}           sdiff, lce
00151 \textcolor{comment}{*     .. External Subroutines ..}
00152       \textcolor{keywordtype}{EXTERNAL}           cchk1, cchk2, cchk3, cchk4, cchk5, cchk6,
00153      $                   cchke, cmvch
00154 \textcolor{comment}{*     .. Intrinsic Functions ..}
00155       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00156 \textcolor{comment}{*     .. Scalars in Common ..}
00157       \textcolor{keywordtype}{INTEGER}            infot, noutc
00158       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00159       \textcolor{keywordtype}{CHARACTER*6}        srnamt
00160 \textcolor{comment}{*     .. Common blocks ..}
00161       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00162       \textcolor{keyword}{COMMON}             /srnamc/srnamt
00163 \textcolor{comment}{*     .. Data statements ..}
00164       \textcolor{keyword}{DATA}               snames/\textcolor{stringliteral}{'CGEMV '}, \textcolor{stringliteral}{'CGBMV '}, \textcolor{stringliteral}{'CHEMV '}, \textcolor{stringliteral}{'CHBMV '},
00165      $                   \textcolor{stringliteral}{'CHPMV '}, \textcolor{stringliteral}{'CTRMV '}, \textcolor{stringliteral}{'CTBMV '}, \textcolor{stringliteral}{'CTPMV '},
00166      $                   \textcolor{stringliteral}{'CTRSV '}, \textcolor{stringliteral}{'CTBSV '}, \textcolor{stringliteral}{'CTPSV '}, \textcolor{stringliteral}{'CGERC '},
00167      $                   \textcolor{stringliteral}{'CGERU '}, \textcolor{stringliteral}{'CHER  '}, \textcolor{stringliteral}{'CHPR  '}, \textcolor{stringliteral}{'CHER2 '},
00168      $                   \textcolor{stringliteral}{'CHPR2 '}/
00169 \textcolor{comment}{*     .. Executable Statements ..}
00170 \textcolor{comment}{*}
00171 \textcolor{comment}{*     Read name and unit number for summary output file and open file.}
00172 \textcolor{comment}{*}
00173       \textcolor{keyword}{READ}( nin, fmt = * )summry
00174       \textcolor{keyword}{READ}( nin, fmt = * )nout
00175       \textcolor{keyword}{OPEN}( nout, \hyperlink{structfile}{file} = summry, status = \textcolor{stringliteral}{'UNKNOWN'} )
00176       noutc = nout
00177 \textcolor{comment}{*}
00178 \textcolor{comment}{*     Read name and unit number for snapshot output file and open file.}
00179 \textcolor{comment}{*}
00180       \textcolor{keyword}{READ}( nin, fmt = * )snaps
00181       \textcolor{keyword}{READ}( nin, fmt = * )ntra
00182       trace = ntra.GE.0
00183       \textcolor{keywordflow}{IF}( trace )\textcolor{keywordflow}{THEN}
00184          \textcolor{keyword}{OPEN}( ntra, \hyperlink{structfile}{file} = snaps, status = \textcolor{stringliteral}{'UNKNOWN'} )
00185 \textcolor{keywordflow}{      END IF}
00186 \textcolor{comment}{*     Read the flag that directs rewinding of the snapshot file.}
00187       \textcolor{keyword}{READ}( nin, fmt = * )rewi
00188       rewi = rewi.AND.trace
00189 \textcolor{comment}{*     Read the flag that directs stopping on any failure.}
00190       \textcolor{keyword}{READ}( nin, fmt = * )sfatal
00191 \textcolor{comment}{*     Read the flag that indicates whether error exits are to be tested.}
00192       \textcolor{keyword}{READ}( nin, fmt = * )tsterr
00193 \textcolor{comment}{*     Read the threshold value of the test ratio}
00194       \textcolor{keyword}{READ}( nin, fmt = * )thresh
00195 \textcolor{comment}{*}
00196 \textcolor{comment}{*     Read and check the parameter values for the tests.}
00197 \textcolor{comment}{*}
00198 \textcolor{comment}{*     Values of N}
00199       \textcolor{keyword}{READ}( nin, fmt = * )nidim
00200       \textcolor{keywordflow}{IF}( nidim.LT.1.OR.nidim.GT.nidmax )\textcolor{keywordflow}{THEN}
00201          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'N'}, nidmax
00202          \textcolor{keywordflow}{GO TO} 230
00203 \textcolor{keywordflow}{      END IF}
00204       \textcolor{keyword}{READ}( nin, fmt = * )( idim( i ), i = 1, nidim )
00205       \textcolor{keywordflow}{DO} 10 i = 1, nidim
00206          \textcolor{keywordflow}{IF}( idim( i ).LT.0.OR.idim( i ).GT.nmax )\textcolor{keywordflow}{THEN}
00207             \textcolor{keyword}{WRITE}( nout, fmt = 9996 )nmax
00208             \textcolor{keywordflow}{GO TO} 230
00209 \textcolor{keywordflow}{         END IF}
00210    10 \textcolor{keywordflow}{CONTINUE}
00211 \textcolor{comment}{*     Values of K}
00212       \textcolor{keyword}{READ}( nin, fmt = * )nkb
00213       \textcolor{keywordflow}{IF}( nkb.LT.1.OR.nkb.GT.nkbmax )\textcolor{keywordflow}{THEN}
00214          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'K'}, nkbmax
00215          \textcolor{keywordflow}{GO TO} 230
00216 \textcolor{keywordflow}{      END IF}
00217       \textcolor{keyword}{READ}( nin, fmt = * )( kb( i ), i = 1, nkb )
00218       \textcolor{keywordflow}{DO} 20 i = 1, nkb
00219          \textcolor{keywordflow}{IF}( kb( i ).LT.0 )\textcolor{keywordflow}{THEN}
00220             \textcolor{keyword}{WRITE}( nout, fmt = 9995 )
00221             \textcolor{keywordflow}{GO TO} 230
00222 \textcolor{keywordflow}{         END IF}
00223    20 \textcolor{keywordflow}{CONTINUE}
00224 \textcolor{comment}{*     Values of INCX and INCY}
00225       \textcolor{keyword}{READ}( nin, fmt = * )ninc
00226       \textcolor{keywordflow}{IF}( ninc.LT.1.OR.ninc.GT.ninmax )\textcolor{keywordflow}{THEN}
00227          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'INCX AND INCY'}, ninmax
00228          \textcolor{keywordflow}{GO TO} 230
00229 \textcolor{keywordflow}{      END IF}
00230       \textcolor{keyword}{READ}( nin, fmt = * )( inc( i ), i = 1, ninc )
00231       \textcolor{keywordflow}{DO} 30 i = 1, ninc
00232          \textcolor{keywordflow}{IF}( inc( i ).EQ.0.OR.abs( inc( i ) ).GT.incmax )\textcolor{keywordflow}{THEN}
00233             \textcolor{keyword}{WRITE}( nout, fmt = 9994 )incmax
00234             \textcolor{keywordflow}{GO TO} 230
00235 \textcolor{keywordflow}{         END IF}
00236    30 \textcolor{keywordflow}{CONTINUE}
00237 \textcolor{comment}{*     Values of ALPHA}
00238       \textcolor{keyword}{READ}( nin, fmt = * )nalf
00239       \textcolor{keywordflow}{IF}( nalf.LT.1.OR.nalf.GT.nalmax )\textcolor{keywordflow}{THEN}
00240          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'ALPHA'}, nalmax
00241          \textcolor{keywordflow}{GO TO} 230
00242 \textcolor{keywordflow}{      END IF}
00243       \textcolor{keyword}{READ}( nin, fmt = * )( alf( i ), i = 1, nalf )
00244 \textcolor{comment}{*     Values of BETA}
00245       \textcolor{keyword}{READ}( nin, fmt = * )nbet
00246       \textcolor{keywordflow}{IF}( nbet.LT.1.OR.nbet.GT.nbemax )\textcolor{keywordflow}{THEN}
00247          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )\textcolor{stringliteral}{'BETA'}, nbemax
00248          \textcolor{keywordflow}{GO TO} 230
00249 \textcolor{keywordflow}{      END IF}
00250       \textcolor{keyword}{READ}( nin, fmt = * )( bet( i ), i = 1, nbet )
00251 \textcolor{comment}{*}
00252 \textcolor{comment}{*     Report values of parameters.}
00253 \textcolor{comment}{*}
00254       \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00255       \textcolor{keyword}{WRITE}( nout, fmt = 9992 )( idim( i ), i = 1, nidim )
00256       \textcolor{keyword}{WRITE}( nout, fmt = 9991 )( kb( i ), i = 1, nkb )
00257       \textcolor{keyword}{WRITE}( nout, fmt = 9990 )( inc( i ), i = 1, ninc )
00258       \textcolor{keyword}{WRITE}( nout, fmt = 9989 )( alf( i ), i = 1, nalf )
00259       \textcolor{keyword}{WRITE}( nout, fmt = 9988 )( bet( i ), i = 1, nbet )
00260       \textcolor{keywordflow}{IF}( .NOT.tsterr )\textcolor{keywordflow}{THEN}
00261          \textcolor{keyword}{WRITE}( nout, fmt = * )
00262          \textcolor{keyword}{WRITE}( nout, fmt = 9980 )
00263 \textcolor{keywordflow}{      END IF}
00264       \textcolor{keyword}{WRITE}( nout, fmt = * )
00265       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )thresh
00266       \textcolor{keyword}{WRITE}( nout, fmt = * )
00267 \textcolor{comment}{*}
00268 \textcolor{comment}{*     Read names of subroutines and flags which indicate}
00269 \textcolor{comment}{*     whether they are to be tested.}
00270 \textcolor{comment}{*}
00271       \textcolor{keywordflow}{DO} 40 i = 1, nsubs
00272          ltest( i ) = .false.
00273    40 \textcolor{keywordflow}{CONTINUE}
00274    50 \textcolor{keyword}{READ}( nin, fmt = 9984, end = 80 )snamet, ltestt
00275       \textcolor{keywordflow}{DO} 60 i = 1, nsubs
00276          \textcolor{keywordflow}{IF}( snamet.EQ.snames( i ) )
00277      $      \textcolor{keywordflow}{GO TO} 70
00278    60 \textcolor{keywordflow}{CONTINUE}
00279       \textcolor{keyword}{WRITE}( nout, fmt = 9986 )snamet
00280       stop
00281    70 ltest( i ) = ltestt
00282       \textcolor{keywordflow}{GO TO} 50
00283 \textcolor{comment}{*}
00284    80 \textcolor{keywordflow}{CONTINUE}
00285       \textcolor{keyword}{CLOSE} ( nin )
00286 \textcolor{comment}{*}
00287 \textcolor{comment}{*     Compute EPS (the machine precision).}
00288 \textcolor{comment}{*}
00289       eps = epsilon(rzero)
00290       \textcolor{keyword}{WRITE}( nout, fmt = 9998 )eps
00291 \textcolor{comment}{*}
00292 \textcolor{comment}{*     Check the reliability of CMVCH using exact data.}
00293 \textcolor{comment}{*}
00294       n = min( 32, nmax )
00295       \textcolor{keywordflow}{DO} 120 j = 1, n
00296          \textcolor{keywordflow}{DO} 110 i = 1, n
00297             a( i, j ) = max( i - j + 1, 0 )
00298   110    \textcolor{keywordflow}{CONTINUE}
00299          x( j ) = j
00300          y( j ) = zero
00301   120 \textcolor{keywordflow}{CONTINUE}
00302       \textcolor{keywordflow}{DO} 130 j = 1, n
00303          yy( j ) = j*( ( j + 1 )*j )/2 - ( ( j + 1 )*j*( j - 1 ) )/3
00304   130 \textcolor{keywordflow}{CONTINUE}
00305 \textcolor{comment}{*     YY holds the exact result. On exit from CMVCH YT holds}
00306 \textcolor{comment}{*     the result computed by CMVCH.}
00307       trans = \textcolor{stringliteral}{'N'}
00308       \textcolor{keyword}{CALL }cmvch( trans, n, n, one, a, nmax, x, 1, zero, y, 1, yt, g,
00309      $            yy, eps, err, fatal, nout, .true. )
00310       same = lce( yy, yt, n )
00311       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.rzero )\textcolor{keywordflow}{THEN}
00312          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00313          stop
00314 \textcolor{keywordflow}{      END IF}
00315       trans = \textcolor{stringliteral}{'T'}
00316       \textcolor{keyword}{CALL }cmvch( trans, n, n, one, a, nmax, x, -1, zero, y, -1, yt, g,
00317      $            yy, eps, err, fatal, nout, .true. )
00318       same = lce( yy, yt, n )
00319       \textcolor{keywordflow}{IF}( .NOT.same.OR.err.NE.rzero )\textcolor{keywordflow}{THEN}
00320          \textcolor{keyword}{WRITE}( nout, fmt = 9985 )trans, same, err
00321          stop
00322 \textcolor{keywordflow}{      END IF}
00323 \textcolor{comment}{*}
00324 \textcolor{comment}{*     Test each subroutine in turn.}
00325 \textcolor{comment}{*}
00326       \textcolor{keywordflow}{DO} 210 isnum = 1, nsubs
00327          \textcolor{keyword}{WRITE}( nout, fmt = * )
00328          \textcolor{keywordflow}{IF}( .NOT.ltest( isnum ) )\textcolor{keywordflow}{THEN}
00329 \textcolor{comment}{*           Subprogram is not to be tested.}
00330             \textcolor{keyword}{WRITE}( nout, fmt = 9983 )snames( isnum )
00331          \textcolor{keywordflow}{ELSE}
00332             srnamt = snames( isnum )
00333 \textcolor{comment}{*           Test error exits.}
00334             \textcolor{keywordflow}{IF}( tsterr )\textcolor{keywordflow}{THEN}
00335                \textcolor{keyword}{CALL }cchke( isnum, snames( isnum ), nout )
00336                \textcolor{keyword}{WRITE}( nout, fmt = * )
00337 \textcolor{keywordflow}{            END IF}
00338 \textcolor{comment}{*           Test computations.}
00339             infot = 0
00340             ok = .true.
00341             fatal = .false.
00342             \textcolor{keywordflow}{GO TO} ( 140, 140, 150, 150, 150, 160, 160,
00343      $              160, 160, 160, 160, 170, 170, 180,
00344      $              180, 190, 190 )isnum
00345 \textcolor{comment}{*           Test CGEMV, 01, and CGBMV, 02.}
00346   140       \textcolor{keyword}{CALL }cchk1( snames( isnum ), eps, thresh, nout, ntra, trace,
00347      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00348      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00349      $                  x, xx, xs, y, yy, ys, yt, g )
00350             \textcolor{keywordflow}{GO TO} 200
00351 \textcolor{comment}{*           Test CHEMV, 03, CHBMV, 04, and CHPMV, 05.}
00352   150       \textcolor{keyword}{CALL }cchk2( snames( isnum ), eps, thresh, nout, ntra, trace,
00353      $                  rewi, fatal, nidim, idim, nkb, kb, nalf, alf,
00354      $                  nbet, bet, ninc, inc, nmax, incmax, a, aa, as,
00355      $                  x, xx, xs, y, yy, ys, yt, g )
00356             \textcolor{keywordflow}{GO TO} 200
00357 \textcolor{comment}{*           Test CTRMV, 06, CTBMV, 07, CTPMV, 08,}
00358 \textcolor{comment}{*           CTRSV, 09, CTBSV, 10, and CTPSV, 11.}
00359   160       \textcolor{keyword}{CALL }cchk3( snames( isnum ), eps, thresh, nout, ntra, trace,
00360      $                  rewi, fatal, nidim, idim, nkb, kb, ninc, inc,
00361      $                  nmax, incmax, a, aa, as, y, yy, ys, yt, g, z )
00362             \textcolor{keywordflow}{GO TO} 200
00363 \textcolor{comment}{*           Test CGERC, 12, CGERU, 13.}
00364   170       \textcolor{keyword}{CALL }cchk4( snames( isnum ), eps, thresh, nout, ntra, trace,
00365      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00366      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00367      $                  yt, g, z )
00368             \textcolor{keywordflow}{GO TO} 200
00369 \textcolor{comment}{*           Test CHER, 14, and CHPR, 15.}
00370   180       \textcolor{keyword}{CALL }cchk5( snames( isnum ), eps, thresh, nout, ntra, trace,
00371      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00372      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00373      $                  yt, g, z )
00374             \textcolor{keywordflow}{GO TO} 200
00375 \textcolor{comment}{*           Test CHER2, 16, and CHPR2, 17.}
00376   190       \textcolor{keyword}{CALL }cchk6( snames( isnum ), eps, thresh, nout, ntra, trace,
00377      $                  rewi, fatal, nidim, idim, nalf, alf, ninc, inc,
00378      $                  nmax, incmax, a, aa, as, x, xx, xs, y, yy, ys,
00379      $                  yt, g, z )
00380 \textcolor{comment}{*}
00381   200       \textcolor{keywordflow}{IF}( fatal.AND.sfatal )
00382      $         \textcolor{keywordflow}{GO TO} 220
00383 \textcolor{keywordflow}{         END IF}
00384   210 \textcolor{keywordflow}{CONTINUE}
00385       \textcolor{keyword}{WRITE}( nout, fmt = 9982 )
00386       \textcolor{keywordflow}{GO TO} 240
00387 \textcolor{comment}{*}
00388   220 \textcolor{keywordflow}{CONTINUE}
00389       \textcolor{keyword}{WRITE}( nout, fmt = 9981 )
00390       \textcolor{keywordflow}{GO TO} 240
00391 \textcolor{comment}{*}
00392   230 \textcolor{keywordflow}{CONTINUE}
00393       \textcolor{keyword}{WRITE}( nout, fmt = 9987 )
00394 \textcolor{comment}{*}
00395   240 \textcolor{keywordflow}{CONTINUE}
00396       \textcolor{keywordflow}{IF}( trace )
00397      $   \textcolor{keyword}{CLOSE} ( ntra )
00398       \textcolor{keyword}{CLOSE} ( nout )
00399       stop
00400 \textcolor{comment}{*}
00401  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ROUTINES PASS COMPUTATIONAL TESTS IF TEST RATIO IS LES'},
00402      $      \textcolor{stringliteral}{'S THAN'}, f8.2 )
00403  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' RELATIVE MACHINE PRECISION IS TAKEN TO BE'}, 1p, e9.1 )
00404  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' NUMBER OF VALUES OF '}, a, \textcolor{stringliteral}{' IS LESS THAN 1 OR GREATER '},
00405      $      \textcolor{stringliteral}{'THAN '}, i2 )
00406  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF N IS LESS THAN 0 OR GREATER THAN '}, i2 )
00407  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' VALUE OF K IS LESS THAN 0'} )
00408  9994 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ABSOLUTE VALUE OF INCX OR INCY IS 0 OR GREATER THAN '},
00409      $      i2 )
00410  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' TESTS OF THE COMPLEX          LEVEL 2 BLAS'}, //\textcolor{stringliteral}{' THE F'},
00411      $      \textcolor{stringliteral}{'OLLOWING PARAMETER VALUES WILL BE USED:'} )
00412  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR N              '}, 9i6 )
00413  9991 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR K              '}, 7i6 )
00414  9990 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR INCX AND INCY  '}, 7i6 )
00415  9989 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR ALPHA          '},
00416      $      7( \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{')  '}, : ) )
00417  9988 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'   FOR BETA           '},
00418      $      7( \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{')  '}, : ) )
00419  9987 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' AMEND DATA FILE OR INCREASE ARRAY SIZES IN PROGRAM'},
00420      $      /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00421  9986 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' SUBPROGRAM NAME '}, a6, \textcolor{stringliteral}{' NOT RECOGNIZED'}, /\textcolor{stringliteral}{' ******* T'},
00422      $      \textcolor{stringliteral}{'ESTS ABANDONED *******'} )
00423  9985 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR IN CMVCH -  IN-LINE DOT PRODUCTS ARE BEING EVALU'},
00424      $      \textcolor{stringliteral}{'ATED WRONGLY.'}, /\textcolor{stringliteral}{' CMVCH WAS CALLED WITH TRANS = '}, a1,
00425      $      \textcolor{stringliteral}{' AND RETURNED SAME = '}, l1, \textcolor{stringliteral}{' AND ERR = '}, f12.3, \textcolor{stringliteral}{'.'}, /
00426      $   \textcolor{stringliteral}{' THIS MAY BE DUE TO FAULTS IN THE ARITHMETIC OR THE COMPILER.'}
00427      $      , /\textcolor{stringliteral}{' ******* TESTS ABANDONED *******'} )
00428  9984 \textcolor{keyword}{FORMAT}( a6, l2 )
00429  9983 \textcolor{keyword}{FORMAT}( 1x, a6, \textcolor{stringliteral}{' WAS NOT TESTED'} )
00430  9982 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' END OF TESTS'} )
00431  9981 \textcolor{keyword}{FORMAT}( /\textcolor{stringliteral}{' ******* FATAL ERROR - TESTS ABANDONED *******'} )
00432  9980 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ERROR-EXITS WILL NOT BE TESTED'} )
00433 \textcolor{comment}{*}
00434 \textcolor{comment}{*     End of CBLAT2.}
00435 \textcolor{comment}{*}
00436 \textcolor{keyword}{      END}
00437 \textcolor{keyword}{      SUBROUTINE }cchk1( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00438      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00439      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00440      $                  XS, Y, YY, YS, YT, G )
00441 \textcolor{comment}{*}
00442 \textcolor{comment}{*  Tests CGEMV and CGBMV.}
00443 \textcolor{comment}{*}
00444 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00445 \textcolor{comment}{*}
00446 \textcolor{comment}{*  -- Written on 10-August-1987.}
00447 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00448 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00449 \textcolor{comment}{*}
00450 \textcolor{comment}{*     .. Parameters ..}
00451       \textcolor{keywordtype}{COMPLEX}            zero, half
00452       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ) )
00453       \textcolor{keywordtype}{REAL}               rzero
00454       parameter( rzero = 0.0 )
00455 \textcolor{comment}{*     .. Scalar Arguments ..}
00456       \textcolor{keywordtype}{REAL}               eps, thresh
00457       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00458      $                   nout, ntra
00459       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00460       \textcolor{keywordtype}{CHARACTER*6}        sname
00461 \textcolor{comment}{*     .. Array Arguments ..}
00462       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00463      $                   as( nmax*nmax ), bet( nbet ), x( nmax ),
00464      $                   xs( nmax*incmax ), xx( nmax*incmax ),
00465      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
00466      $                   yy( nmax*incmax )
00467       \textcolor{keywordtype}{REAL}               g( nmax )
00468       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00469 \textcolor{comment}{*     .. Local Scalars ..}
00470       \textcolor{keywordtype}{COMPLEX}            alpha, als, beta, bls, transl
00471       \textcolor{keywordtype}{REAL}               err, errmax
00472       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, iku, im, in, incx, incxs, incy,
00473      $                   incys, ix, iy, kl, kls, ku, kus, laa, lda,
00474      $                   ldas, lx, ly, m, ml, ms, n, nargs, nc, nd, nk,
00475      $                   nl, ns
00476       \textcolor{keywordtype}{LOGICAL}            banded, full, null, reset, same, tran
00477       \textcolor{keywordtype}{CHARACTER*1}        trans, transs
00478       \textcolor{keywordtype}{CHARACTER*3}        ich
00479 \textcolor{comment}{*     .. Local Arrays ..}
00480       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00481 \textcolor{comment}{*     .. External Functions ..}
00482       \textcolor{keywordtype}{LOGICAL}            lce, lceres
00483       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
00484 \textcolor{comment}{*     .. External Subroutines ..}
00485       \textcolor{keywordtype}{EXTERNAL}           cgbmv, cgemv, cmake, cmvch
00486 \textcolor{comment}{*     .. Intrinsic Functions ..}
00487       \textcolor{keywordtype}{INTRINSIC}          abs, max, min
00488 \textcolor{comment}{*     .. Scalars in Common ..}
00489       \textcolor{keywordtype}{INTEGER}            infot, noutc
00490       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00491 \textcolor{comment}{*     .. Common blocks ..}
00492       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00493 \textcolor{comment}{*     .. Data statements ..}
00494       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'NTC'}/
00495 \textcolor{comment}{*     .. Executable Statements ..}
00496       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
00497       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00498 \textcolor{comment}{*     Define the number of arguments.}
00499       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00500          nargs = 11
00501       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00502          nargs = 13
00503 \textcolor{keywordflow}{      END IF}
00504 \textcolor{comment}{*}
00505       nc = 0
00506       reset = .true.
00507       errmax = rzero
00508 \textcolor{comment}{*}
00509       \textcolor{keywordflow}{DO} 120 in = 1, nidim
00510          n = idim( in )
00511          nd = n/2 + 1
00512 \textcolor{comment}{*}
00513          \textcolor{keywordflow}{DO} 110 im = 1, 2
00514             \textcolor{keywordflow}{IF}( im.EQ.1 )
00515      $         m = max( n - nd, 0 )
00516             \textcolor{keywordflow}{IF}( im.EQ.2 )
00517      $         m = min( n + nd, nmax )
00518 \textcolor{comment}{*}
00519             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00520                nk = nkb
00521             \textcolor{keywordflow}{ELSE}
00522                nk = 1
00523 \textcolor{keywordflow}{            END IF}
00524             \textcolor{keywordflow}{DO} 100 iku = 1, nk
00525                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00526                   ku = kb( iku )
00527                   kl = max( ku - 1, 0 )
00528                \textcolor{keywordflow}{ELSE}
00529                   ku = n - 1
00530                   kl = m - 1
00531 \textcolor{keywordflow}{               END IF}
00532 \textcolor{comment}{*              Set LDA to 1 more than minimum value if room.}
00533                \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00534                   lda = kl + ku + 1
00535                \textcolor{keywordflow}{ELSE}
00536                   lda = m
00537 \textcolor{keywordflow}{               END IF}
00538                \textcolor{keywordflow}{IF}( lda.LT.nmax )
00539      $            lda = lda + 1
00540 \textcolor{comment}{*              Skip tests if not enough room.}
00541                \textcolor{keywordflow}{IF}( lda.GT.nmax )
00542      $            \textcolor{keywordflow}{GO TO} 100
00543                laa = lda*n
00544                null = n.LE.0.OR.m.LE.0
00545 \textcolor{comment}{*}
00546 \textcolor{comment}{*              Generate the matrix A.}
00547 \textcolor{comment}{*}
00548                transl = zero
00549                \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax, aa,
00550      $                     lda, kl, ku, reset, transl )
00551 \textcolor{comment}{*}
00552                \textcolor{keywordflow}{DO} 90 ic = 1, 3
00553                   trans = ich( ic: ic )
00554                   tran = trans.EQ.\textcolor{stringliteral}{'T'}.OR.trans.EQ.\textcolor{stringliteral}{'C'}
00555 \textcolor{comment}{*}
00556                   \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
00557                      ml = n
00558                      nl = m
00559                   \textcolor{keywordflow}{ELSE}
00560                      ml = m
00561                      nl = n
00562 \textcolor{keywordflow}{                  END IF}
00563 \textcolor{comment}{*}
00564                   \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00565                      incx = inc( ix )
00566                      lx = abs( incx )*nl
00567 \textcolor{comment}{*}
00568 \textcolor{comment}{*                    Generate the vector X.}
00569 \textcolor{comment}{*}
00570                      transl = half
00571                      \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, nl, x, 1, xx,
00572      $                           abs( incx ), 0, nl - 1, reset, transl )
00573                      \textcolor{keywordflow}{IF}( nl.GT.1 )\textcolor{keywordflow}{THEN}
00574                         x( nl/2 ) = zero
00575                         xx( 1 + abs( incx )*( nl/2 - 1 ) ) = zero
00576 \textcolor{keywordflow}{                     END IF}
00577 \textcolor{comment}{*}
00578                      \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00579                         incy = inc( iy )
00580                         ly = abs( incy )*ml
00581 \textcolor{comment}{*}
00582                         \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00583                            alpha = alf( ia )
00584 \textcolor{comment}{*}
00585                            \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00586                               beta = bet( ib )
00587 \textcolor{comment}{*}
00588 \textcolor{comment}{*                             Generate the vector Y.}
00589 \textcolor{comment}{*}
00590                               transl = zero
00591                               \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, ml, y, 1,
00592      $                                    yy, abs( incy ), 0, ml - 1,
00593      $                                    reset, transl )
00594 \textcolor{comment}{*}
00595                               nc = nc + 1
00596 \textcolor{comment}{*}
00597 \textcolor{comment}{*                             Save every datum before calling the}
00598 \textcolor{comment}{*                             subroutine.}
00599 \textcolor{comment}{*}
00600                               transs = trans
00601                               ms = m
00602                               ns = n
00603                               kls = kl
00604                               kus = ku
00605                               als = alpha
00606                               \textcolor{keywordflow}{DO} 10 i = 1, laa
00607                                  as( i ) = aa( i )
00608    10                         \textcolor{keywordflow}{CONTINUE}
00609                               ldas = lda
00610                               \textcolor{keywordflow}{DO} 20 i = 1, lx
00611                                  xs( i ) = xx( i )
00612    20                         \textcolor{keywordflow}{CONTINUE}
00613                               incxs = incx
00614                               bls = beta
00615                               \textcolor{keywordflow}{DO} 30 i = 1, ly
00616                                  ys( i ) = yy( i )
00617    30                         \textcolor{keywordflow}{CONTINUE}
00618                               incys = incy
00619 \textcolor{comment}{*}
00620 \textcolor{comment}{*                             Call the subroutine.}
00621 \textcolor{comment}{*}
00622                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00623                                  \textcolor{keywordflow}{IF}( trace )
00624      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00625      $                              trans, m, n, alpha, lda, incx, beta,
00626      $                              incy
00627                                  \textcolor{keywordflow}{IF}( rewi )
00628      $                              rewind ntra
00629                                  \textcolor{keyword}{CALL }cgemv( trans, m, n, alpha, aa,
00630      $                                       lda, xx, incx, beta, yy,
00631      $                                       incy )
00632                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00633                                  \textcolor{keywordflow}{IF}( trace )
00634      $                              \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00635      $                              trans, m, n, kl, ku, alpha, lda,
00636      $                              incx, beta, incy
00637                                  \textcolor{keywordflow}{IF}( rewi )
00638      $                              rewind ntra
00639                                  \textcolor{keyword}{CALL }cgbmv( trans, m, n, kl, ku, alpha,
00640      $                                       aa, lda, xx, incx, beta,
00641      $                                       yy, incy )
00642 \textcolor{keywordflow}{                              END IF}
00643 \textcolor{comment}{*}
00644 \textcolor{comment}{*                             Check if error-exit was taken incorrectly.}
00645 \textcolor{comment}{*}
00646                               \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00647                                  \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
00648                                  fatal = .true.
00649                                  \textcolor{keywordflow}{GO TO} 130
00650 \textcolor{keywordflow}{                              END IF}
00651 \textcolor{comment}{*}
00652 \textcolor{comment}{*                             See what data changed inside subroutines.}
00653 \textcolor{comment}{*}
00654                               isame( 1 ) = trans.EQ.transs
00655                               isame( 2 ) = ms.EQ.m
00656                               isame( 3 ) = ns.EQ.n
00657                               \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00658                                  isame( 4 ) = als.EQ.alpha
00659                                  isame( 5 ) = lce( as, aa, laa )
00660                                  isame( 6 ) = ldas.EQ.lda
00661                                  isame( 7 ) = lce( xs, xx, lx )
00662                                  isame( 8 ) = incxs.EQ.incx
00663                                  isame( 9 ) = bls.EQ.beta
00664                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00665                                     isame( 10 ) = lce( ys, yy, ly )
00666                                  \textcolor{keywordflow}{ELSE}
00667                                     isame( 10 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00668      $                                            ml, ys, yy,
00669      $                                            abs( incy ) )
00670 \textcolor{keywordflow}{                                 END IF}
00671                                  isame( 11 ) = incys.EQ.incy
00672                               \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00673                                  isame( 4 ) = kls.EQ.kl
00674                                  isame( 5 ) = kus.EQ.ku
00675                                  isame( 6 ) = als.EQ.alpha
00676                                  isame( 7 ) = lce( as, aa, laa )
00677                                  isame( 8 ) = ldas.EQ.lda
00678                                  isame( 9 ) = lce( xs, xx, lx )
00679                                  isame( 10 ) = incxs.EQ.incx
00680                                  isame( 11 ) = bls.EQ.beta
00681                                  \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
00682                                     isame( 12 ) = lce( ys, yy, ly )
00683                                  \textcolor{keywordflow}{ELSE}
00684                                     isame( 12 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1,
00685      $                                            ml, ys, yy,
00686      $                                            abs( incy ) )
00687 \textcolor{keywordflow}{                                 END IF}
00688                                  isame( 13 ) = incys.EQ.incy
00689 \textcolor{keywordflow}{                              END IF}
00690 \textcolor{comment}{*}
00691 \textcolor{comment}{*                             If data was incorrectly changed, report}
00692 \textcolor{comment}{*                             and return.}
00693 \textcolor{comment}{*}
00694                               same = .true.
00695                               \textcolor{keywordflow}{DO} 40 i = 1, nargs
00696                                  same = same.AND.isame( i )
00697                                  \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
00698      $                              \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
00699    40                         \textcolor{keywordflow}{CONTINUE}
00700                               \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
00701                                  fatal = .true.
00702                                  \textcolor{keywordflow}{GO TO} 130
00703 \textcolor{keywordflow}{                              END IF}
00704 \textcolor{comment}{*}
00705                               \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
00706 \textcolor{comment}{*}
00707 \textcolor{comment}{*                                Check the result.}
00708 \textcolor{comment}{*}
00709                                  \textcolor{keyword}{CALL }cmvch( trans, m, n, alpha, a,
00710      $                                       nmax, x, incx, beta, y,
00711      $                                       incy, yt, g, yy, eps, err,
00712      $                                       fatal, nout, .true. )
00713                                  errmax = max( errmax, err )
00714 \textcolor{comment}{*                                If got really bad answer, report and}
00715 \textcolor{comment}{*                                return.}
00716                                  \textcolor{keywordflow}{IF}( fatal )
00717      $                              \textcolor{keywordflow}{GO TO} 130
00718                               \textcolor{keywordflow}{ELSE}
00719 \textcolor{comment}{*                                Avoid repeating tests with M.le.0 or}
00720 \textcolor{comment}{*                                N.le.0.}
00721                                  \textcolor{keywordflow}{GO TO} 110
00722 \textcolor{keywordflow}{                              END IF}
00723 \textcolor{comment}{*}
00724    50                      \textcolor{keywordflow}{CONTINUE}
00725 \textcolor{comment}{*}
00726    60                   \textcolor{keywordflow}{CONTINUE}
00727 \textcolor{comment}{*}
00728    70                \textcolor{keywordflow}{CONTINUE}
00729 \textcolor{comment}{*}
00730    80             \textcolor{keywordflow}{CONTINUE}
00731 \textcolor{comment}{*}
00732    90          \textcolor{keywordflow}{CONTINUE}
00733 \textcolor{comment}{*}
00734   100       \textcolor{keywordflow}{CONTINUE}
00735 \textcolor{comment}{*}
00736   110    \textcolor{keywordflow}{CONTINUE}
00737 \textcolor{comment}{*}
00738   120 \textcolor{keywordflow}{CONTINUE}
00739 \textcolor{comment}{*}
00740 \textcolor{comment}{*     Report result.}
00741 \textcolor{comment}{*}
00742       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
00743          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
00744       \textcolor{keywordflow}{ELSE}
00745          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
00746 \textcolor{keywordflow}{      END IF}
00747       \textcolor{keywordflow}{GO TO} 140
00748 \textcolor{comment}{*}
00749   130 \textcolor{keywordflow}{CONTINUE}
00750       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
00751       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00752          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, trans, m, n, alpha, lda,
00753      $      incx, beta, incy
00754       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00755          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, trans, m, n, kl, ku,
00756      $      alpha, lda, incx, beta, incy
00757 \textcolor{keywordflow}{      END IF}
00758 \textcolor{comment}{*}
00759   140 \textcolor{keywordflow}{CONTINUE}
00760       \textcolor{keywordflow}{RETURN}
00761 \textcolor{comment}{*}
00762  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
00763      $      \textcolor{stringliteral}{'S)'} )
00764  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
00765      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
00766  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
00767      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
00768      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
00769  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
00770  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 4( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
00771      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
00772      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{') .'} )
00773  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
00774      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
00775      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{')         .'} )
00776  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
00777      $      \textcolor{stringliteral}{'******'} )
00778 \textcolor{comment}{*}
00779 \textcolor{comment}{*     End of CCHK1.}
00780 \textcolor{comment}{*}
00781 \textcolor{keyword}{      END}
00782 \textcolor{keyword}{      SUBROUTINE }cchk2( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
00783      $                  FATAL, NIDIM, IDIM, NKB, KB, NALF, ALF, NBET,
00784      $                  BET, NINC, INC, NMAX, INCMAX, A, AA, AS, X, XX,
00785      $                  XS, Y, YY, YS, YT, G )
00786 \textcolor{comment}{*}
00787 \textcolor{comment}{*  Tests CHEMV, CHBMV and CHPMV.}
00788 \textcolor{comment}{*}
00789 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
00790 \textcolor{comment}{*}
00791 \textcolor{comment}{*  -- Written on 10-August-1987.}
00792 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
00793 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
00794 \textcolor{comment}{*}
00795 \textcolor{comment}{*     .. Parameters ..}
00796       \textcolor{keywordtype}{COMPLEX}            zero, half
00797       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ) )
00798       \textcolor{keywordtype}{REAL}               rzero
00799       parameter( rzero = 0.0 )
00800 \textcolor{comment}{*     .. Scalar Arguments ..}
00801       \textcolor{keywordtype}{REAL}               eps, thresh
00802       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nbet, nidim, ninc, nkb, nmax,
00803      $                   nout, ntra
00804       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
00805       \textcolor{keywordtype}{CHARACTER*6}        sname
00806 \textcolor{comment}{*     .. Array Arguments ..}
00807       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
00808      $                   as( nmax*nmax ), bet( nbet ), x( nmax ),
00809      $                   xs( nmax*incmax ), xx( nmax*incmax ),
00810      $                   y( nmax ), ys( nmax*incmax ), yt( nmax ),
00811      $                   yy( nmax*incmax )
00812       \textcolor{keywordtype}{REAL}               g( nmax )
00813       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
00814 \textcolor{comment}{*     .. Local Scalars ..}
00815       \textcolor{keywordtype}{COMPLEX}            alpha, als, beta, bls, transl
00816       \textcolor{keywordtype}{REAL}               err, errmax
00817       \textcolor{keywordtype}{INTEGER}            i, ia, ib, ic, ik, in, incx, incxs, incy,
00818      $                   incys, ix, iy, k, ks, laa, lda, ldas, lx, ly,
00819      $                   n, nargs, nc, nk, ns
00820       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
00821       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
00822       \textcolor{keywordtype}{CHARACTER*2}        ich
00823 \textcolor{comment}{*     .. Local Arrays ..}
00824       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
00825 \textcolor{comment}{*     .. External Functions ..}
00826       \textcolor{keywordtype}{LOGICAL}            lce, lceres
00827       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
00828 \textcolor{comment}{*     .. External Subroutines ..}
00829       \textcolor{keywordtype}{EXTERNAL}           chbmv, chemv, chpmv, cmake, cmvch
00830 \textcolor{comment}{*     .. Intrinsic Functions ..}
00831       \textcolor{keywordtype}{INTRINSIC}          abs, max
00832 \textcolor{comment}{*     .. Scalars in Common ..}
00833       \textcolor{keywordtype}{INTEGER}            infot, noutc
00834       \textcolor{keywordtype}{LOGICAL}            lerr, ok
00835 \textcolor{comment}{*     .. Common blocks ..}
00836       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
00837 \textcolor{comment}{*     .. Data statements ..}
00838       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
00839 \textcolor{comment}{*     .. Executable Statements ..}
00840       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
00841       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
00842       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
00843 \textcolor{comment}{*     Define the number of arguments.}
00844       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00845          nargs = 10
00846       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00847          nargs = 11
00848       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00849          nargs = 9
00850 \textcolor{keywordflow}{      END IF}
00851 \textcolor{comment}{*}
00852       nc = 0
00853       reset = .true.
00854       errmax = rzero
00855 \textcolor{comment}{*}
00856       \textcolor{keywordflow}{DO} 110 in = 1, nidim
00857          n = idim( in )
00858 \textcolor{comment}{*}
00859          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00860             nk = nkb
00861          \textcolor{keywordflow}{ELSE}
00862             nk = 1
00863 \textcolor{keywordflow}{         END IF}
00864          \textcolor{keywordflow}{DO} 100 ik = 1, nk
00865             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00866                k = kb( ik )
00867             \textcolor{keywordflow}{ELSE}
00868                k = n - 1
00869 \textcolor{keywordflow}{            END IF}
00870 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
00871             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00872                lda = k + 1
00873             \textcolor{keywordflow}{ELSE}
00874                lda = n
00875 \textcolor{keywordflow}{            END IF}
00876             \textcolor{keywordflow}{IF}( lda.LT.nmax )
00877      $         lda = lda + 1
00878 \textcolor{comment}{*           Skip tests if not enough room.}
00879             \textcolor{keywordflow}{IF}( lda.GT.nmax )
00880      $         \textcolor{keywordflow}{GO TO} 100
00881             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00882                laa = ( n*( n + 1 ) )/2
00883             \textcolor{keywordflow}{ELSE}
00884                laa = lda*n
00885 \textcolor{keywordflow}{            END IF}
00886             null = n.LE.0
00887 \textcolor{comment}{*}
00888             \textcolor{keywordflow}{DO} 90 ic = 1, 2
00889                uplo = ich( ic: ic )
00890 \textcolor{comment}{*}
00891 \textcolor{comment}{*              Generate the matrix A.}
00892 \textcolor{comment}{*}
00893                transl = zero
00894                \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax, aa,
00895      $                     lda, k, k, reset, transl )
00896 \textcolor{comment}{*}
00897                \textcolor{keywordflow}{DO} 80 ix = 1, ninc
00898                   incx = inc( ix )
00899                   lx = abs( incx )*n
00900 \textcolor{comment}{*}
00901 \textcolor{comment}{*                 Generate the vector X.}
00902 \textcolor{comment}{*}
00903                   transl = half
00904                   \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
00905      $                        abs( incx ), 0, n - 1, reset, transl )
00906                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
00907                      x( n/2 ) = zero
00908                      xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
00909 \textcolor{keywordflow}{                  END IF}
00910 \textcolor{comment}{*}
00911                   \textcolor{keywordflow}{DO} 70 iy = 1, ninc
00912                      incy = inc( iy )
00913                      ly = abs( incy )*n
00914 \textcolor{comment}{*}
00915                      \textcolor{keywordflow}{DO} 60 ia = 1, nalf
00916                         alpha = alf( ia )
00917 \textcolor{comment}{*}
00918                         \textcolor{keywordflow}{DO} 50 ib = 1, nbet
00919                            beta = bet( ib )
00920 \textcolor{comment}{*}
00921 \textcolor{comment}{*                          Generate the vector Y.}
00922 \textcolor{comment}{*}
00923                            transl = zero
00924                            \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
00925      $                                 abs( incy ), 0, n - 1, reset,
00926      $                                 transl )
00927 \textcolor{comment}{*}
00928                            nc = nc + 1
00929 \textcolor{comment}{*}
00930 \textcolor{comment}{*                          Save every datum before calling the}
00931 \textcolor{comment}{*                          subroutine.}
00932 \textcolor{comment}{*}
00933                            uplos = uplo
00934                            ns = n
00935                            ks = k
00936                            als = alpha
00937                            \textcolor{keywordflow}{DO} 10 i = 1, laa
00938                               as( i ) = aa( i )
00939    10                      \textcolor{keywordflow}{CONTINUE}
00940                            ldas = lda
00941                            \textcolor{keywordflow}{DO} 20 i = 1, lx
00942                               xs( i ) = xx( i )
00943    20                      \textcolor{keywordflow}{CONTINUE}
00944                            incxs = incx
00945                            bls = beta
00946                            \textcolor{keywordflow}{DO} 30 i = 1, ly
00947                               ys( i ) = yy( i )
00948    30                      \textcolor{keywordflow}{CONTINUE}
00949                            incys = incy
00950 \textcolor{comment}{*}
00951 \textcolor{comment}{*                          Call the subroutine.}
00952 \textcolor{comment}{*}
00953                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00954                               \textcolor{keywordflow}{IF}( trace )
00955      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
00956      $                           uplo, n, alpha, lda, incx, beta, incy
00957                               \textcolor{keywordflow}{IF}( rewi )
00958      $                           rewind ntra
00959                               \textcolor{keyword}{CALL }chemv( uplo, n, alpha, aa, lda, xx,
00960      $                                    incx, beta, yy, incy )
00961                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
00962                               \textcolor{keywordflow}{IF}( trace )
00963      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
00964      $                           uplo, n, k, alpha, lda, incx, beta,
00965      $                           incy
00966                               \textcolor{keywordflow}{IF}( rewi )
00967      $                           rewind ntra
00968                               \textcolor{keyword}{CALL }chbmv( uplo, n, k, alpha, aa, lda,
00969      $                                    xx, incx, beta, yy, incy )
00970                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
00971                               \textcolor{keywordflow}{IF}( trace )
00972      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
00973      $                           uplo, n, alpha, incx, beta, incy
00974                               \textcolor{keywordflow}{IF}( rewi )
00975      $                           rewind ntra
00976                               \textcolor{keyword}{CALL }chpmv( uplo, n, alpha, aa, xx, incx,
00977      $                                    beta, yy, incy )
00978 \textcolor{keywordflow}{                           END IF}
00979 \textcolor{comment}{*}
00980 \textcolor{comment}{*                          Check if error-exit was taken incorrectly.}
00981 \textcolor{comment}{*}
00982                            \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
00983                               \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
00984                               fatal = .true.
00985                               \textcolor{keywordflow}{GO TO} 120
00986 \textcolor{keywordflow}{                           END IF}
00987 \textcolor{comment}{*}
00988 \textcolor{comment}{*                          See what data changed inside subroutines.}
00989 \textcolor{comment}{*}
00990                            isame( 1 ) = uplo.EQ.uplos
00991                            isame( 2 ) = ns.EQ.n
00992                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
00993                               isame( 3 ) = als.EQ.alpha
00994                               isame( 4 ) = lce( as, aa, laa )
00995                               isame( 5 ) = ldas.EQ.lda
00996                               isame( 6 ) = lce( xs, xx, lx )
00997                               isame( 7 ) = incxs.EQ.incx
00998                               isame( 8 ) = bls.EQ.beta
00999                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01000                                  isame( 9 ) = lce( ys, yy, ly )
01001                               \textcolor{keywordflow}{ELSE}
01002                                  isame( 9 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01003      $                                        ys, yy, abs( incy ) )
01004 \textcolor{keywordflow}{                              END IF}
01005                               isame( 10 ) = incys.EQ.incy
01006                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01007                               isame( 3 ) = ks.EQ.k
01008                               isame( 4 ) = als.EQ.alpha
01009                               isame( 5 ) = lce( as, aa, laa )
01010                               isame( 6 ) = ldas.EQ.lda
01011                               isame( 7 ) = lce( xs, xx, lx )
01012                               isame( 8 ) = incxs.EQ.incx
01013                               isame( 9 ) = bls.EQ.beta
01014                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01015                                  isame( 10 ) = lce( ys, yy, ly )
01016                               \textcolor{keywordflow}{ELSE}
01017                                  isame( 10 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01018      $                                         ys, yy, abs( incy ) )
01019 \textcolor{keywordflow}{                              END IF}
01020                               isame( 11 ) = incys.EQ.incy
01021                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01022                               isame( 3 ) = als.EQ.alpha
01023                               isame( 4 ) = lce( as, aa, laa )
01024                               isame( 5 ) = lce( xs, xx, lx )
01025                               isame( 6 ) = incxs.EQ.incx
01026                               isame( 7 ) = bls.EQ.beta
01027                               \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01028                                  isame( 8 ) = lce( ys, yy, ly )
01029                               \textcolor{keywordflow}{ELSE}
01030                                  isame( 8 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n,
01031      $                                        ys, yy, abs( incy ) )
01032 \textcolor{keywordflow}{                              END IF}
01033                               isame( 9 ) = incys.EQ.incy
01034 \textcolor{keywordflow}{                           END IF}
01035 \textcolor{comment}{*}
01036 \textcolor{comment}{*                          If data was incorrectly changed, report and}
01037 \textcolor{comment}{*                          return.}
01038 \textcolor{comment}{*}
01039                            same = .true.
01040                            \textcolor{keywordflow}{DO} 40 i = 1, nargs
01041                               same = same.AND.isame( i )
01042                               \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01043      $                           \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01044    40                      \textcolor{keywordflow}{CONTINUE}
01045                            \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01046                               fatal = .true.
01047                               \textcolor{keywordflow}{GO TO} 120
01048 \textcolor{keywordflow}{                           END IF}
01049 \textcolor{comment}{*}
01050                            \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01051 \textcolor{comment}{*}
01052 \textcolor{comment}{*                             Check the result.}
01053 \textcolor{comment}{*}
01054                               \textcolor{keyword}{CALL }cmvch( \textcolor{stringliteral}{'N'}, n, n, alpha, a, nmax, x,
01055      $                                    incx, beta, y, incy, yt, g,
01056      $                                    yy, eps, err, fatal, nout,
01057      $                                    .true. )
01058                               errmax = max( errmax, err )
01059 \textcolor{comment}{*                             If got really bad answer, report and}
01060 \textcolor{comment}{*                             return.}
01061                               \textcolor{keywordflow}{IF}( fatal )
01062      $                           \textcolor{keywordflow}{GO TO} 120
01063                            \textcolor{keywordflow}{ELSE}
01064 \textcolor{comment}{*                             Avoid repeating tests with N.le.0}
01065                               \textcolor{keywordflow}{GO TO} 110
01066 \textcolor{keywordflow}{                           END IF}
01067 \textcolor{comment}{*}
01068    50                   \textcolor{keywordflow}{CONTINUE}
01069 \textcolor{comment}{*}
01070    60                \textcolor{keywordflow}{CONTINUE}
01071 \textcolor{comment}{*}
01072    70             \textcolor{keywordflow}{CONTINUE}
01073 \textcolor{comment}{*}
01074    80          \textcolor{keywordflow}{CONTINUE}
01075 \textcolor{comment}{*}
01076    90       \textcolor{keywordflow}{CONTINUE}
01077 \textcolor{comment}{*}
01078   100    \textcolor{keywordflow}{CONTINUE}
01079 \textcolor{comment}{*}
01080   110 \textcolor{keywordflow}{CONTINUE}
01081 \textcolor{comment}{*}
01082 \textcolor{comment}{*     Report result.}
01083 \textcolor{comment}{*}
01084       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01085          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01086       \textcolor{keywordflow}{ELSE}
01087          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01088 \textcolor{keywordflow}{      END IF}
01089       \textcolor{keywordflow}{GO TO} 130
01090 \textcolor{comment}{*}
01091   120 \textcolor{keywordflow}{CONTINUE}
01092       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01093       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01094          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, lda, incx,
01095      $      beta, incy
01096       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01097          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, k, alpha, lda,
01098      $      incx, beta, incy
01099       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01100          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, n, alpha, incx,
01101      $      beta, incy
01102 \textcolor{keywordflow}{      END IF}
01103 \textcolor{comment}{*}
01104   130 \textcolor{keywordflow}{CONTINUE}
01105       \textcolor{keywordflow}{RETURN}
01106 \textcolor{comment}{*}
01107  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01108      $      \textcolor{stringliteral}{'S)'} )
01109  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01110      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01111  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01112      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01113      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01114  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01115  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01116      $      f4.1, \textcolor{stringliteral}{'), AP, X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), Y,'}, i2,
01117      $      \textcolor{stringliteral}{')                .'} )
01118  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('},
01119      $      f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01120      $      f4.1, \textcolor{stringliteral}{'), Y,'}, i2, \textcolor{stringliteral}{')         .'} )
01121  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
01122      $      f4.1, \textcolor{stringliteral}{'), A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{'), '},
01123      $      \textcolor{stringliteral}{'Y,'}, i2, \textcolor{stringliteral}{')             .'} )
01124  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01125      $      \textcolor{stringliteral}{'******'} )
01126 \textcolor{comment}{*}
01127 \textcolor{comment}{*     End of CCHK2.}
01128 \textcolor{comment}{*}
01129 \textcolor{keyword}{      END}
01130 \textcolor{keyword}{      SUBROUTINE }cchk3( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01131      $                  FATAL, NIDIM, IDIM, NKB, KB, NINC, INC, NMAX,
01132      $                  INCMAX, A, AA, AS, X, XX, XS, XT, G, Z )
01133 \textcolor{comment}{*}
01134 \textcolor{comment}{*  Tests CTRMV, CTBMV, CTPMV, CTRSV, CTBSV and CTPSV.}
01135 \textcolor{comment}{*}
01136 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01137 \textcolor{comment}{*}
01138 \textcolor{comment}{*  -- Written on 10-August-1987.}
01139 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01140 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01141 \textcolor{comment}{*}
01142 \textcolor{comment}{*     .. Parameters ..}
01143       \textcolor{keywordtype}{COMPLEX}            zero, half, one
01144       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ),
01145      $                   one = ( 1.0, 0.0 ) )
01146       \textcolor{keywordtype}{REAL}               rzero
01147       parameter( rzero = 0.0 )
01148 \textcolor{comment}{*     .. Scalar Arguments ..}
01149       \textcolor{keywordtype}{REAL}               eps, thresh
01150       \textcolor{keywordtype}{INTEGER}            incmax, nidim, ninc, nkb, nmax, nout, ntra
01151       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01152       \textcolor{keywordtype}{CHARACTER*6}        sname
01153 \textcolor{comment}{*     .. Array Arguments ..}
01154       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ),
01155      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01156      $                   xt( nmax ), xx( nmax*incmax ), z( nmax )
01157       \textcolor{keywordtype}{REAL}               g( nmax )
01158       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc ), kb( nkb )
01159 \textcolor{comment}{*     .. Local Scalars ..}
01160       \textcolor{keywordtype}{COMPLEX}            transl
01161       \textcolor{keywordtype}{REAL}               err, errmax
01162       \textcolor{keywordtype}{INTEGER}            i, icd, ict, icu, ik, in, incx, incxs, ix, k,
01163      $                   ks, laa, lda, ldas, lx, n, nargs, nc, nk, ns
01164       \textcolor{keywordtype}{LOGICAL}            banded, full, null, packed, reset, same
01165       \textcolor{keywordtype}{CHARACTER*1}        diag, diags, trans, transs, uplo, uplos
01166       \textcolor{keywordtype}{CHARACTER*2}        ichd, ichu
01167       \textcolor{keywordtype}{CHARACTER*3}        icht
01168 \textcolor{comment}{*     .. Local Arrays ..}
01169       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01170 \textcolor{comment}{*     .. External Functions ..}
01171       \textcolor{keywordtype}{LOGICAL}            lce, lceres
01172       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
01173 \textcolor{comment}{*     .. External Subroutines ..}
01174       \textcolor{keywordtype}{EXTERNAL}           cmake, cmvch, ctbmv, ctbsv, ctpmv, ctpsv,
01175      $                   ctrmv, ctrsv
01176 \textcolor{comment}{*     .. Intrinsic Functions ..}
01177       \textcolor{keywordtype}{INTRINSIC}          abs, max
01178 \textcolor{comment}{*     .. Scalars in Common ..}
01179       \textcolor{keywordtype}{INTEGER}            infot, noutc
01180       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01181 \textcolor{comment}{*     .. Common blocks ..}
01182       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01183 \textcolor{comment}{*     .. Data statements ..}
01184       \textcolor{keyword}{DATA}               ichu/\textcolor{stringliteral}{'UL'}/, icht/\textcolor{stringliteral}{'NTC'}/, ichd/\textcolor{stringliteral}{'UN'}/
01185 \textcolor{comment}{*     .. Executable Statements ..}
01186       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'R'}
01187       banded = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'B'}
01188       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01189 \textcolor{comment}{*     Define the number of arguments.}
01190       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01191          nargs = 8
01192       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01193          nargs = 9
01194       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01195          nargs = 7
01196 \textcolor{keywordflow}{      END IF}
01197 \textcolor{comment}{*}
01198       nc = 0
01199       reset = .true.
01200       errmax = rzero
01201 \textcolor{comment}{*     Set up zero vector for CMVCH.}
01202       \textcolor{keywordflow}{DO} 10 i = 1, nmax
01203          z( i ) = zero
01204    10 \textcolor{keywordflow}{CONTINUE}
01205 \textcolor{comment}{*}
01206       \textcolor{keywordflow}{DO} 110 in = 1, nidim
01207          n = idim( in )
01208 \textcolor{comment}{*}
01209          \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01210             nk = nkb
01211          \textcolor{keywordflow}{ELSE}
01212             nk = 1
01213 \textcolor{keywordflow}{         END IF}
01214          \textcolor{keywordflow}{DO} 100 ik = 1, nk
01215             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01216                k = kb( ik )
01217             \textcolor{keywordflow}{ELSE}
01218                k = n - 1
01219 \textcolor{keywordflow}{            END IF}
01220 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01221             \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01222                lda = k + 1
01223             \textcolor{keywordflow}{ELSE}
01224                lda = n
01225 \textcolor{keywordflow}{            END IF}
01226             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01227      $         lda = lda + 1
01228 \textcolor{comment}{*           Skip tests if not enough room.}
01229             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01230      $         \textcolor{keywordflow}{GO TO} 100
01231             \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01232                laa = ( n*( n + 1 ) )/2
01233             \textcolor{keywordflow}{ELSE}
01234                laa = lda*n
01235 \textcolor{keywordflow}{            END IF}
01236             null = n.LE.0
01237 \textcolor{comment}{*}
01238             \textcolor{keywordflow}{DO} 90 icu = 1, 2
01239                uplo = ichu( icu: icu )
01240 \textcolor{comment}{*}
01241                \textcolor{keywordflow}{DO} 80 ict = 1, 3
01242                   trans = icht( ict: ict )
01243 \textcolor{comment}{*}
01244                   \textcolor{keywordflow}{DO} 70 icd = 1, 2
01245                      diag = ichd( icd: icd )
01246 \textcolor{comment}{*}
01247 \textcolor{comment}{*                    Generate the matrix A.}
01248 \textcolor{comment}{*}
01249                      transl = zero
01250                      \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), uplo, diag, n, n, a,
01251      $                           nmax, aa, lda, k, k, reset, transl )
01252 \textcolor{comment}{*}
01253                      \textcolor{keywordflow}{DO} 60 ix = 1, ninc
01254                         incx = inc( ix )
01255                         lx = abs( incx )*n
01256 \textcolor{comment}{*}
01257 \textcolor{comment}{*                       Generate the vector X.}
01258 \textcolor{comment}{*}
01259                         transl = half
01260                         \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx,
01261      $                              abs( incx ), 0, n - 1, reset,
01262      $                              transl )
01263                         \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01264                            x( n/2 ) = zero
01265                            xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01266 \textcolor{keywordflow}{                        END IF}
01267 \textcolor{comment}{*}
01268                         nc = nc + 1
01269 \textcolor{comment}{*}
01270 \textcolor{comment}{*                       Save every datum before calling the subroutine.}
01271 \textcolor{comment}{*}
01272                         uplos = uplo
01273                         transs = trans
01274                         diags = diag
01275                         ns = n
01276                         ks = k
01277                         \textcolor{keywordflow}{DO} 20 i = 1, laa
01278                            as( i ) = aa( i )
01279    20                   \textcolor{keywordflow}{CONTINUE}
01280                         ldas = lda
01281                         \textcolor{keywordflow}{DO} 30 i = 1, lx
01282                            xs( i ) = xx( i )
01283    30                   \textcolor{keywordflow}{CONTINUE}
01284                         incxs = incx
01285 \textcolor{comment}{*}
01286 \textcolor{comment}{*                       Call the subroutine.}
01287 \textcolor{comment}{*}
01288                         \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01289                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01290                               \textcolor{keywordflow}{IF}( trace )
01291      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01292      $                           uplo, trans, diag, n, lda, incx
01293                               \textcolor{keywordflow}{IF}( rewi )
01294      $                           rewind ntra
01295                               \textcolor{keyword}{CALL }ctrmv( uplo, trans, diag, n, aa, lda,
01296      $                                    xx, incx )
01297                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01298                               \textcolor{keywordflow}{IF}( trace )
01299      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01300      $                           uplo, trans, diag, n, k, lda, incx
01301                               \textcolor{keywordflow}{IF}( rewi )
01302      $                           rewind ntra
01303                               \textcolor{keyword}{CALL }ctbmv( uplo, trans, diag, n, k, aa,
01304      $                                    lda, xx, incx )
01305                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01306                               \textcolor{keywordflow}{IF}( trace )
01307      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01308      $                           uplo, trans, diag, n, incx
01309                               \textcolor{keywordflow}{IF}( rewi )
01310      $                           rewind ntra
01311                               \textcolor{keyword}{CALL }ctpmv( uplo, trans, diag, n, aa, xx,
01312      $                                    incx )
01313 \textcolor{keywordflow}{                           END IF}
01314                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01315                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01316                               \textcolor{keywordflow}{IF}( trace )
01317      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname,
01318      $                           uplo, trans, diag, n, lda, incx
01319                               \textcolor{keywordflow}{IF}( rewi )
01320      $                           rewind ntra
01321                               \textcolor{keyword}{CALL }ctrsv( uplo, trans, diag, n, aa, lda,
01322      $                                    xx, incx )
01323                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01324                               \textcolor{keywordflow}{IF}( trace )
01325      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname,
01326      $                           uplo, trans, diag, n, k, lda, incx
01327                               \textcolor{keywordflow}{IF}( rewi )
01328      $                           rewind ntra
01329                               \textcolor{keyword}{CALL }ctbsv( uplo, trans, diag, n, k, aa,
01330      $                                    lda, xx, incx )
01331                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01332                               \textcolor{keywordflow}{IF}( trace )
01333      $                           \textcolor{keyword}{WRITE}( ntra, fmt = 9995 )nc, sname,
01334      $                           uplo, trans, diag, n, incx
01335                               \textcolor{keywordflow}{IF}( rewi )
01336      $                           rewind ntra
01337                               \textcolor{keyword}{CALL }ctpsv( uplo, trans, diag, n, aa, xx,
01338      $                                    incx )
01339 \textcolor{keywordflow}{                           END IF}
01340 \textcolor{keywordflow}{                        END IF}
01341 \textcolor{comment}{*}
01342 \textcolor{comment}{*                       Check if error-exit was taken incorrectly.}
01343 \textcolor{comment}{*}
01344                         \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01345                            \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01346                            fatal = .true.
01347                            \textcolor{keywordflow}{GO TO} 120
01348 \textcolor{keywordflow}{                        END IF}
01349 \textcolor{comment}{*}
01350 \textcolor{comment}{*                       See what data changed inside subroutines.}
01351 \textcolor{comment}{*}
01352                         isame( 1 ) = uplo.EQ.uplos
01353                         isame( 2 ) = trans.EQ.transs
01354                         isame( 3 ) = diag.EQ.diags
01355                         isame( 4 ) = ns.EQ.n
01356                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01357                            isame( 5 ) = lce( as, aa, laa )
01358                            isame( 6 ) = ldas.EQ.lda
01359                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01360                               isame( 7 ) = lce( xs, xx, lx )
01361                            \textcolor{keywordflow}{ELSE}
01362                               isame( 7 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01363      $                                     xx, abs( incx ) )
01364 \textcolor{keywordflow}{                           END IF}
01365                            isame( 8 ) = incxs.EQ.incx
01366                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01367                            isame( 5 ) = ks.EQ.k
01368                            isame( 6 ) = lce( as, aa, laa )
01369                            isame( 7 ) = ldas.EQ.lda
01370                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01371                               isame( 8 ) = lce( xs, xx, lx )
01372                            \textcolor{keywordflow}{ELSE}
01373                               isame( 8 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01374      $                                     xx, abs( incx ) )
01375 \textcolor{keywordflow}{                           END IF}
01376                            isame( 9 ) = incxs.EQ.incx
01377                         \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01378                            isame( 5 ) = lce( as, aa, laa )
01379                            \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01380                               isame( 6 ) = lce( xs, xx, lx )
01381                            \textcolor{keywordflow}{ELSE}
01382                               isame( 6 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, 1, n, xs,
01383      $                                     xx, abs( incx ) )
01384 \textcolor{keywordflow}{                           END IF}
01385                            isame( 7 ) = incxs.EQ.incx
01386 \textcolor{keywordflow}{                        END IF}
01387 \textcolor{comment}{*}
01388 \textcolor{comment}{*                       If data was incorrectly changed, report and}
01389 \textcolor{comment}{*                       return.}
01390 \textcolor{comment}{*}
01391                         same = .true.
01392                         \textcolor{keywordflow}{DO} 40 i = 1, nargs
01393                            same = same.AND.isame( i )
01394                            \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01395      $                        \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01396    40                   \textcolor{keywordflow}{CONTINUE}
01397                         \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01398                            fatal = .true.
01399                            \textcolor{keywordflow}{GO TO} 120
01400 \textcolor{keywordflow}{                        END IF}
01401 \textcolor{comment}{*}
01402                         \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01403                            \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'MV'} )\textcolor{keywordflow}{THEN}
01404 \textcolor{comment}{*}
01405 \textcolor{comment}{*                             Check the result.}
01406 \textcolor{comment}{*}
01407                               \textcolor{keyword}{CALL }cmvch( trans, n, n, one, a, nmax, x,
01408      $                                    incx, zero, z, incx, xt, g,
01409      $                                    xx, eps, err, fatal, nout,
01410      $                                    .true. )
01411                            \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( sname( 4: 5 ).EQ.\textcolor{stringliteral}{'SV'} )\textcolor{keywordflow}{THEN}
01412 \textcolor{comment}{*}
01413 \textcolor{comment}{*                             Compute approximation to original vector.}
01414 \textcolor{comment}{*}
01415                               \textcolor{keywordflow}{DO} 50 i = 1, n
01416                                  z( i ) = xx( 1 + ( i - 1 )*
01417      $                                    abs( incx ) )
01418                                  xx( 1 + ( i - 1 )*abs( incx ) )
01419      $                              = x( i )
01420    50                         \textcolor{keywordflow}{CONTINUE}
01421                               \textcolor{keyword}{CALL }cmvch( trans, n, n, one, a, nmax, z,
01422      $                                    incx, zero, x, incx, xt, g,
01423      $                                    xx, eps, err, fatal, nout,
01424      $                                    .false. )
01425 \textcolor{keywordflow}{                           END IF}
01426                            errmax = max( errmax, err )
01427 \textcolor{comment}{*                          If got really bad answer, report and return.}
01428                            \textcolor{keywordflow}{IF}( fatal )
01429      $                        \textcolor{keywordflow}{GO TO} 120
01430                         \textcolor{keywordflow}{ELSE}
01431 \textcolor{comment}{*                          Avoid repeating tests with N.le.0.}
01432                            \textcolor{keywordflow}{GO TO} 110
01433 \textcolor{keywordflow}{                        END IF}
01434 \textcolor{comment}{*}
01435    60                \textcolor{keywordflow}{CONTINUE}
01436 \textcolor{comment}{*}
01437    70             \textcolor{keywordflow}{CONTINUE}
01438 \textcolor{comment}{*}
01439    80          \textcolor{keywordflow}{CONTINUE}
01440 \textcolor{comment}{*}
01441    90       \textcolor{keywordflow}{CONTINUE}
01442 \textcolor{comment}{*}
01443   100    \textcolor{keywordflow}{CONTINUE}
01444 \textcolor{comment}{*}
01445   110 \textcolor{keywordflow}{CONTINUE}
01446 \textcolor{comment}{*}
01447 \textcolor{comment}{*     Report result.}
01448 \textcolor{comment}{*}
01449       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01450          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01451       \textcolor{keywordflow}{ELSE}
01452          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01453 \textcolor{keywordflow}{      END IF}
01454       \textcolor{keywordflow}{GO TO} 130
01455 \textcolor{comment}{*}
01456   120 \textcolor{keywordflow}{CONTINUE}
01457       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01458       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01459          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, trans, diag, n, lda,
01460      $      incx
01461       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( banded )\textcolor{keywordflow}{THEN}
01462          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, trans, diag, n, k,
01463      $      lda, incx
01464       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01465          \textcolor{keyword}{WRITE}( nout, fmt = 9995 )nc, sname, uplo, trans, diag, n, incx
01466 \textcolor{keywordflow}{      END IF}
01467 \textcolor{comment}{*}
01468   130 \textcolor{keywordflow}{CONTINUE}
01469       \textcolor{keywordflow}{RETURN}
01470 \textcolor{comment}{*}
01471  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01472      $      \textcolor{stringliteral}{'S)'} )
01473  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01474      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01475  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01476      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01477      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01478  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01479  9995 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', AP, '},
01480      $      \textcolor{stringliteral}{'X,'}, i2, \textcolor{stringliteral}{')                                      .'} )
01481  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), 2( i3, \textcolor{stringliteral}{','} ),
01482      $      \textcolor{stringliteral}{' A,'}, i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                               .'} )
01483  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 3( \textcolor{stringliteral}{''}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','} ), i3, \textcolor{stringliteral}{', A,'},
01484      $      i3, \textcolor{stringliteral}{', X,'}, i2, \textcolor{stringliteral}{')                                   .'} )
01485  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01486      $      \textcolor{stringliteral}{'******'} )
01487 \textcolor{comment}{*}
01488 \textcolor{comment}{*     End of CCHK3.}
01489 \textcolor{comment}{*}
01490 \textcolor{keyword}{      END}
01491 \textcolor{keyword}{      SUBROUTINE }cchk4( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01492      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01493      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01494      $                  Z )
01495 \textcolor{comment}{*}
01496 \textcolor{comment}{*  Tests CGERC and CGERU.}
01497 \textcolor{comment}{*}
01498 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01499 \textcolor{comment}{*}
01500 \textcolor{comment}{*  -- Written on 10-August-1987.}
01501 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01502 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01503 \textcolor{comment}{*}
01504 \textcolor{comment}{*     .. Parameters ..}
01505       \textcolor{keywordtype}{COMPLEX}            zero, half, one
01506       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ),
01507      $                   one = ( 1.0, 0.0 ) )
01508       \textcolor{keywordtype}{REAL}               rzero
01509       parameter( rzero = 0.0 )
01510 \textcolor{comment}{*     .. Scalar Arguments ..}
01511       \textcolor{keywordtype}{REAL}               eps, thresh
01512       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01513       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01514       \textcolor{keywordtype}{CHARACTER*6}        sname
01515 \textcolor{comment}{*     .. Array Arguments ..}
01516       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01517      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01518      $                   xx( nmax*incmax ), y( nmax ),
01519      $                   ys( nmax*incmax ), yt( nmax ),
01520      $                   yy( nmax*incmax ), z( nmax )
01521       \textcolor{keywordtype}{REAL}               g( nmax )
01522       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01523 \textcolor{comment}{*     .. Local Scalars ..}
01524       \textcolor{keywordtype}{COMPLEX}            alpha, als, transl
01525       \textcolor{keywordtype}{REAL}               err, errmax
01526       \textcolor{keywordtype}{INTEGER}            i, ia, im, in, incx, incxs, incy, incys, ix,
01527      $                   iy, j, laa, lda, ldas, lx, ly, m, ms, n, nargs,
01528      $                   nc, nd, ns
01529       \textcolor{keywordtype}{LOGICAL}            conj, null, reset, same
01530 \textcolor{comment}{*     .. Local Arrays ..}
01531       \textcolor{keywordtype}{COMPLEX}            w( 1 )
01532       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01533 \textcolor{comment}{*     .. External Functions ..}
01534       \textcolor{keywordtype}{LOGICAL}            lce, lceres
01535       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
01536 \textcolor{comment}{*     .. External Subroutines ..}
01537       \textcolor{keywordtype}{EXTERNAL}           cgerc, cgeru, cmake, cmvch
01538 \textcolor{comment}{*     .. Intrinsic Functions ..}
01539       \textcolor{keywordtype}{INTRINSIC}          abs, conjg, max, min
01540 \textcolor{comment}{*     .. Scalars in Common ..}
01541       \textcolor{keywordtype}{INTEGER}            infot, noutc
01542       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01543 \textcolor{comment}{*     .. Common blocks ..}
01544       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01545 \textcolor{comment}{*     .. Executable Statements ..}
01546       conj = sname( 5: 5 ).EQ.\textcolor{stringliteral}{'C'}
01547 \textcolor{comment}{*     Define the number of arguments.}
01548       nargs = 9
01549 \textcolor{comment}{*}
01550       nc = 0
01551       reset = .true.
01552       errmax = rzero
01553 \textcolor{comment}{*}
01554       \textcolor{keywordflow}{DO} 120 in = 1, nidim
01555          n = idim( in )
01556          nd = n/2 + 1
01557 \textcolor{comment}{*}
01558          \textcolor{keywordflow}{DO} 110 im = 1, 2
01559             \textcolor{keywordflow}{IF}( im.EQ.1 )
01560      $         m = max( n - nd, 0 )
01561             \textcolor{keywordflow}{IF}( im.EQ.2 )
01562      $         m = min( n + nd, nmax )
01563 \textcolor{comment}{*}
01564 \textcolor{comment}{*           Set LDA to 1 more than minimum value if room.}
01565             lda = m
01566             \textcolor{keywordflow}{IF}( lda.LT.nmax )
01567      $         lda = lda + 1
01568 \textcolor{comment}{*           Skip tests if not enough room.}
01569             \textcolor{keywordflow}{IF}( lda.GT.nmax )
01570      $         \textcolor{keywordflow}{GO TO} 110
01571             laa = lda*n
01572             null = n.LE.0.OR.m.LE.0
01573 \textcolor{comment}{*}
01574             \textcolor{keywordflow}{DO} 100 ix = 1, ninc
01575                incx = inc( ix )
01576                lx = abs( incx )*m
01577 \textcolor{comment}{*}
01578 \textcolor{comment}{*              Generate the vector X.}
01579 \textcolor{comment}{*}
01580                transl = half
01581                \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, m, x, 1, xx, abs( incx ),
01582      $                     0, m - 1, reset, transl )
01583                \textcolor{keywordflow}{IF}( m.GT.1 )\textcolor{keywordflow}{THEN}
01584                   x( m/2 ) = zero
01585                   xx( 1 + abs( incx )*( m/2 - 1 ) ) = zero
01586 \textcolor{keywordflow}{               END IF}
01587 \textcolor{comment}{*}
01588                \textcolor{keywordflow}{DO} 90 iy = 1, ninc
01589                   incy = inc( iy )
01590                   ly = abs( incy )*n
01591 \textcolor{comment}{*}
01592 \textcolor{comment}{*                 Generate the vector Y.}
01593 \textcolor{comment}{*}
01594                   transl = zero
01595                   \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
01596      $                        abs( incy ), 0, n - 1, reset, transl )
01597                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01598                      y( n/2 ) = zero
01599                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
01600 \textcolor{keywordflow}{                  END IF}
01601 \textcolor{comment}{*}
01602                   \textcolor{keywordflow}{DO} 80 ia = 1, nalf
01603                      alpha = alf( ia )
01604 \textcolor{comment}{*}
01605 \textcolor{comment}{*                    Generate the matrix A.}
01606 \textcolor{comment}{*}
01607                      transl = zero
01608                      \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, m, n, a, nmax,
01609      $                           aa, lda, m - 1, n - 1, reset, transl )
01610 \textcolor{comment}{*}
01611                      nc = nc + 1
01612 \textcolor{comment}{*}
01613 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
01614 \textcolor{comment}{*}
01615                      ms = m
01616                      ns = n
01617                      als = alpha
01618                      \textcolor{keywordflow}{DO} 10 i = 1, laa
01619                         as( i ) = aa( i )
01620    10                \textcolor{keywordflow}{CONTINUE}
01621                      ldas = lda
01622                      \textcolor{keywordflow}{DO} 20 i = 1, lx
01623                         xs( i ) = xx( i )
01624    20                \textcolor{keywordflow}{CONTINUE}
01625                      incxs = incx
01626                      \textcolor{keywordflow}{DO} 30 i = 1, ly
01627                         ys( i ) = yy( i )
01628    30                \textcolor{keywordflow}{CONTINUE}
01629                      incys = incy
01630 \textcolor{comment}{*}
01631 \textcolor{comment}{*                    Call the subroutine.}
01632 \textcolor{comment}{*}
01633                      \textcolor{keywordflow}{IF}( trace )
01634      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, m, n,
01635      $                  alpha, incx, incy, lda
01636                      \textcolor{keywordflow}{IF}( conj )\textcolor{keywordflow}{THEN}
01637                         \textcolor{keywordflow}{IF}( rewi )
01638      $                     rewind ntra
01639                         \textcolor{keyword}{CALL }cgerc( m, n, alpha, xx, incx, yy, incy, aa,
01640      $                              lda )
01641                      \textcolor{keywordflow}{ELSE}
01642                         \textcolor{keywordflow}{IF}( rewi )
01643      $                     rewind ntra
01644                         \textcolor{keyword}{CALL }cgeru( m, n, alpha, xx, incx, yy, incy, aa,
01645      $                              lda )
01646 \textcolor{keywordflow}{                     END IF}
01647 \textcolor{comment}{*}
01648 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
01649 \textcolor{comment}{*}
01650                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01651                         \textcolor{keyword}{WRITE}( nout, fmt = 9993 )
01652                         fatal = .true.
01653                         \textcolor{keywordflow}{GO TO} 140
01654 \textcolor{keywordflow}{                     END IF}
01655 \textcolor{comment}{*}
01656 \textcolor{comment}{*                    See what data changed inside subroutine.}
01657 \textcolor{comment}{*}
01658                      isame( 1 ) = ms.EQ.m
01659                      isame( 2 ) = ns.EQ.n
01660                      isame( 3 ) = als.EQ.alpha
01661                      isame( 4 ) = lce( xs, xx, lx )
01662                      isame( 5 ) = incxs.EQ.incx
01663                      isame( 6 ) = lce( ys, yy, ly )
01664                      isame( 7 ) = incys.EQ.incy
01665                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01666                         isame( 8 ) = lce( as, aa, laa )
01667                      \textcolor{keywordflow}{ELSE}
01668                         isame( 8 ) = lceres( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, m, n, as, aa,
01669      $                               lda )
01670 \textcolor{keywordflow}{                     END IF}
01671                      isame( 9 ) = ldas.EQ.lda
01672 \textcolor{comment}{*}
01673 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
01674 \textcolor{comment}{*}
01675                      same = .true.
01676                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
01677                         same = same.AND.isame( i )
01678                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01679      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01680    40                \textcolor{keywordflow}{CONTINUE}
01681                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01682                         fatal = .true.
01683                         \textcolor{keywordflow}{GO TO} 140
01684 \textcolor{keywordflow}{                     END IF}
01685 \textcolor{comment}{*}
01686                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01687 \textcolor{comment}{*}
01688 \textcolor{comment}{*                       Check the result column by column.}
01689 \textcolor{comment}{*}
01690                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01691                            \textcolor{keywordflow}{DO} 50 i = 1, m
01692                               z( i ) = x( i )
01693    50                      \textcolor{keywordflow}{CONTINUE}
01694                         \textcolor{keywordflow}{ELSE}
01695                            \textcolor{keywordflow}{DO} 60 i = 1, m
01696                               z( i ) = x( m - i + 1 )
01697    60                      \textcolor{keywordflow}{CONTINUE}
01698 \textcolor{keywordflow}{                        END IF}
01699                         \textcolor{keywordflow}{DO} 70 j = 1, n
01700                            \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
01701                               w( 1 ) = y( j )
01702                            \textcolor{keywordflow}{ELSE}
01703                               w( 1 ) = y( n - j + 1 )
01704 \textcolor{keywordflow}{                           END IF}
01705                            \textcolor{keywordflow}{IF}( conj )
01706      $                        w( 1 ) = conjg( w( 1 ) )
01707                            \textcolor{keyword}{CALL }cmvch( \textcolor{stringliteral}{'N'}, m, 1, alpha, z, nmax, w, 1,
01708      $                                 one, a( 1, j ), 1, yt, g,
01709      $                                 aa( 1 + ( j - 1 )*lda ), eps,
01710      $                                 err, fatal, nout, .true. )
01711                            errmax = max( errmax, err )
01712 \textcolor{comment}{*                          If got really bad answer, report and return.}
01713                            \textcolor{keywordflow}{IF}( fatal )
01714      $                        \textcolor{keywordflow}{GO TO} 130
01715    70                   \textcolor{keywordflow}{CONTINUE}
01716                      \textcolor{keywordflow}{ELSE}
01717 \textcolor{comment}{*                       Avoid repeating tests with M.le.0 or N.le.0.}
01718                         \textcolor{keywordflow}{GO TO} 110
01719 \textcolor{keywordflow}{                     END IF}
01720 \textcolor{comment}{*}
01721    80             \textcolor{keywordflow}{CONTINUE}
01722 \textcolor{comment}{*}
01723    90          \textcolor{keywordflow}{CONTINUE}
01724 \textcolor{comment}{*}
01725   100       \textcolor{keywordflow}{CONTINUE}
01726 \textcolor{comment}{*}
01727   110    \textcolor{keywordflow}{CONTINUE}
01728 \textcolor{comment}{*}
01729   120 \textcolor{keywordflow}{CONTINUE}
01730 \textcolor{comment}{*}
01731 \textcolor{comment}{*     Report result.}
01732 \textcolor{comment}{*}
01733       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
01734          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
01735       \textcolor{keywordflow}{ELSE}
01736          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
01737 \textcolor{keywordflow}{      END IF}
01738       \textcolor{keywordflow}{GO TO} 150
01739 \textcolor{comment}{*}
01740   130 \textcolor{keywordflow}{CONTINUE}
01741       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
01742 \textcolor{comment}{*}
01743   140 \textcolor{keywordflow}{CONTINUE}
01744       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
01745       \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, m, n, alpha, incx, incy, lda
01746 \textcolor{comment}{*}
01747   150 \textcolor{keywordflow}{CONTINUE}
01748       \textcolor{keywordflow}{RETURN}
01749 \textcolor{comment}{*}
01750  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
01751      $      \textcolor{stringliteral}{'S)'} )
01752  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
01753      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
01754  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
01755      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
01756      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
01757  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
01758  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
01759  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}, 2( i3, \textcolor{stringliteral}{','} ), \textcolor{stringliteral}{'('}, f4.1, \textcolor{stringliteral}{','}, f4.1,
01760      $      \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                   '},
01761      $      \textcolor{stringliteral}{'      .'} )
01762  9993 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
01763      $      \textcolor{stringliteral}{'******'} )
01764 \textcolor{comment}{*}
01765 \textcolor{comment}{*     End of CCHK4.}
01766 \textcolor{comment}{*}
01767 \textcolor{keyword}{      END}
01768 \textcolor{keyword}{      SUBROUTINE }cchk5( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
01769      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
01770      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
01771      $                  Z )
01772 \textcolor{comment}{*}
01773 \textcolor{comment}{*  Tests CHER and CHPR.}
01774 \textcolor{comment}{*}
01775 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
01776 \textcolor{comment}{*}
01777 \textcolor{comment}{*  -- Written on 10-August-1987.}
01778 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
01779 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
01780 \textcolor{comment}{*}
01781 \textcolor{comment}{*     .. Parameters ..}
01782       \textcolor{keywordtype}{COMPLEX}            zero, half, one
01783       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ),
01784      $                   one = ( 1.0, 0.0 ) )
01785       \textcolor{keywordtype}{REAL}               rzero
01786       parameter( rzero = 0.0 )
01787 \textcolor{comment}{*     .. Scalar Arguments ..}
01788       \textcolor{keywordtype}{REAL}               eps, thresh
01789       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
01790       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
01791       \textcolor{keywordtype}{CHARACTER*6}        sname
01792 \textcolor{comment}{*     .. Array Arguments ..}
01793       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
01794      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
01795      $                   xx( nmax*incmax ), y( nmax ),
01796      $                   ys( nmax*incmax ), yt( nmax ),
01797      $                   yy( nmax*incmax ), z( nmax )
01798       \textcolor{keywordtype}{REAL}               g( nmax )
01799       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
01800 \textcolor{comment}{*     .. Local Scalars ..}
01801       \textcolor{keywordtype}{COMPLEX}            alpha, transl
01802       \textcolor{keywordtype}{REAL}               err, errmax, ralpha, rals
01803       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, ix, j, ja, jj, laa,
01804      $                   lda, ldas, lj, lx, n, nargs, nc, ns
01805       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
01806       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
01807       \textcolor{keywordtype}{CHARACTER*2}        ich
01808 \textcolor{comment}{*     .. Local Arrays ..}
01809       \textcolor{keywordtype}{COMPLEX}            w( 1 )
01810       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
01811 \textcolor{comment}{*     .. External Functions ..}
01812       \textcolor{keywordtype}{LOGICAL}            lce, lceres
01813       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
01814 \textcolor{comment}{*     .. External Subroutines ..}
01815       \textcolor{keywordtype}{EXTERNAL}           cher, chpr, cmake, cmvch
01816 \textcolor{comment}{*     .. Intrinsic Functions ..}
01817       \textcolor{keywordtype}{INTRINSIC}          abs, cmplx, conjg, max, real
01818 \textcolor{comment}{*     .. Scalars in Common ..}
01819       \textcolor{keywordtype}{INTEGER}            infot, noutc
01820       \textcolor{keywordtype}{LOGICAL}            lerr, ok
01821 \textcolor{comment}{*     .. Common blocks ..}
01822       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
01823 \textcolor{comment}{*     .. Data statements ..}
01824       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
01825 \textcolor{comment}{*     .. Executable Statements ..}
01826       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
01827       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
01828 \textcolor{comment}{*     Define the number of arguments.}
01829       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01830          nargs = 7
01831       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01832          nargs = 6
01833 \textcolor{keywordflow}{      END IF}
01834 \textcolor{comment}{*}
01835       nc = 0
01836       reset = .true.
01837       errmax = rzero
01838 \textcolor{comment}{*}
01839       \textcolor{keywordflow}{DO} 100 in = 1, nidim
01840          n = idim( in )
01841 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
01842          lda = n
01843          \textcolor{keywordflow}{IF}( lda.LT.nmax )
01844      $      lda = lda + 1
01845 \textcolor{comment}{*        Skip tests if not enough room.}
01846          \textcolor{keywordflow}{IF}( lda.GT.nmax )
01847      $      \textcolor{keywordflow}{GO TO} 100
01848          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01849             laa = ( n*( n + 1 ) )/2
01850          \textcolor{keywordflow}{ELSE}
01851             laa = lda*n
01852 \textcolor{keywordflow}{         END IF}
01853 \textcolor{comment}{*}
01854          \textcolor{keywordflow}{DO} 90 ic = 1, 2
01855             uplo = ich( ic: ic )
01856             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
01857 \textcolor{comment}{*}
01858             \textcolor{keywordflow}{DO} 80 ix = 1, ninc
01859                incx = inc( ix )
01860                lx = abs( incx )*n
01861 \textcolor{comment}{*}
01862 \textcolor{comment}{*              Generate the vector X.}
01863 \textcolor{comment}{*}
01864                transl = half
01865                \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
01866      $                     0, n - 1, reset, transl )
01867                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
01868                   x( n/2 ) = zero
01869                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
01870 \textcolor{keywordflow}{               END IF}
01871 \textcolor{comment}{*}
01872                \textcolor{keywordflow}{DO} 70 ia = 1, nalf
01873                   ralpha = \textcolor{keywordtype}{REAL( ALF( IA )} )
01874                   alpha = cmplx( ralpha, rzero )
01875                   null = n.LE.0.OR.ralpha.EQ.rzero
01876 \textcolor{comment}{*}
01877 \textcolor{comment}{*                 Generate the matrix A.}
01878 \textcolor{comment}{*}
01879                   transl = zero
01880                   \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a, nmax,
01881      $                        aa, lda, n - 1, n - 1, reset, transl )
01882 \textcolor{comment}{*}
01883                   nc = nc + 1
01884 \textcolor{comment}{*}
01885 \textcolor{comment}{*                 Save every datum before calling the subroutine.}
01886 \textcolor{comment}{*}
01887                   uplos = uplo
01888                   ns = n
01889                   rals = ralpha
01890                   \textcolor{keywordflow}{DO} 10 i = 1, laa
01891                      as( i ) = aa( i )
01892    10             \textcolor{keywordflow}{CONTINUE}
01893                   ldas = lda
01894                   \textcolor{keywordflow}{DO} 20 i = 1, lx
01895                      xs( i ) = xx( i )
01896    20             \textcolor{keywordflow}{CONTINUE}
01897                   incxs = incx
01898 \textcolor{comment}{*}
01899 \textcolor{comment}{*                 Call the subroutine.}
01900 \textcolor{comment}{*}
01901                   \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01902                      \textcolor{keywordflow}{IF}( trace )
01903      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
01904      $                  ralpha, incx, lda
01905                      \textcolor{keywordflow}{IF}( rewi )
01906      $                  rewind ntra
01907                      \textcolor{keyword}{CALL }cher( uplo, n, ralpha, xx, incx, aa, lda )
01908                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
01909                      \textcolor{keywordflow}{IF}( trace )
01910      $                  \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
01911      $                  ralpha, incx
01912                      \textcolor{keywordflow}{IF}( rewi )
01913      $                  rewind ntra
01914                      \textcolor{keyword}{CALL }chpr( uplo, n, ralpha, xx, incx, aa )
01915 \textcolor{keywordflow}{                  END IF}
01916 \textcolor{comment}{*}
01917 \textcolor{comment}{*                 Check if error-exit was taken incorrectly.}
01918 \textcolor{comment}{*}
01919                   \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
01920                      \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
01921                      fatal = .true.
01922                      \textcolor{keywordflow}{GO TO} 120
01923 \textcolor{keywordflow}{                  END IF}
01924 \textcolor{comment}{*}
01925 \textcolor{comment}{*                 See what data changed inside subroutines.}
01926 \textcolor{comment}{*}
01927                   isame( 1 ) = uplo.EQ.uplos
01928                   isame( 2 ) = ns.EQ.n
01929                   isame( 3 ) = rals.EQ.ralpha
01930                   isame( 4 ) = lce( xs, xx, lx )
01931                   isame( 5 ) = incxs.EQ.incx
01932                   \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
01933                      isame( 6 ) = lce( as, aa, laa )
01934                   \textcolor{keywordflow}{ELSE}
01935                      isame( 6 ) = lceres( sname( 2: 3 ), uplo, n, n, as,
01936      $                            aa, lda )
01937 \textcolor{keywordflow}{                  END IF}
01938                   \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
01939                      isame( 7 ) = ldas.EQ.lda
01940 \textcolor{keywordflow}{                  END IF}
01941 \textcolor{comment}{*}
01942 \textcolor{comment}{*                 If data was incorrectly changed, report and return.}
01943 \textcolor{comment}{*}
01944                   same = .true.
01945                   \textcolor{keywordflow}{DO} 30 i = 1, nargs
01946                      same = same.AND.isame( i )
01947                      \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
01948      $                  \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
01949    30             \textcolor{keywordflow}{CONTINUE}
01950                   \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
01951                      fatal = .true.
01952                      \textcolor{keywordflow}{GO TO} 120
01953 \textcolor{keywordflow}{                  END IF}
01954 \textcolor{comment}{*}
01955                   \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
01956 \textcolor{comment}{*}
01957 \textcolor{comment}{*                    Check the result column by column.}
01958 \textcolor{comment}{*}
01959                      \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
01960                         \textcolor{keywordflow}{DO} 40 i = 1, n
01961                            z( i ) = x( i )
01962    40                   \textcolor{keywordflow}{CONTINUE}
01963                      \textcolor{keywordflow}{ELSE}
01964                         \textcolor{keywordflow}{DO} 50 i = 1, n
01965                            z( i ) = x( n - i + 1 )
01966    50                   \textcolor{keywordflow}{CONTINUE}
01967 \textcolor{keywordflow}{                     END IF}
01968                      ja = 1
01969                      \textcolor{keywordflow}{DO} 60 j = 1, n
01970                         w( 1 ) = conjg( z( j ) )
01971                         \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01972                            jj = 1
01973                            lj = j
01974                         \textcolor{keywordflow}{ELSE}
01975                            jj = j
01976                            lj = n - j + 1
01977 \textcolor{keywordflow}{                        END IF}
01978                         \textcolor{keyword}{CALL }cmvch( \textcolor{stringliteral}{'N'}, lj, 1, alpha, z( jj ), lj, w,
01979      $                              1, one, a( jj, j ), 1, yt, g,
01980      $                              aa( ja ), eps, err, fatal, nout,
01981      $                              .true. )
01982                         \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
01983                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
01984                               ja = ja + lda
01985                            \textcolor{keywordflow}{ELSE}
01986                               ja = ja + lda + 1
01987 \textcolor{keywordflow}{                           END IF}
01988                         \textcolor{keywordflow}{ELSE}
01989                            ja = ja + lj
01990 \textcolor{keywordflow}{                        END IF}
01991                         errmax = max( errmax, err )
01992 \textcolor{comment}{*                       If got really bad answer, report and return.}
01993                         \textcolor{keywordflow}{IF}( fatal )
01994      $                     \textcolor{keywordflow}{GO TO} 110
01995    60                \textcolor{keywordflow}{CONTINUE}
01996                   \textcolor{keywordflow}{ELSE}
01997 \textcolor{comment}{*                    Avoid repeating tests if N.le.0.}
01998                      \textcolor{keywordflow}{IF}( n.LE.0 )
01999      $                  \textcolor{keywordflow}{GO TO} 100
02000 \textcolor{keywordflow}{                  END IF}
02001 \textcolor{comment}{*}
02002    70          \textcolor{keywordflow}{CONTINUE}
02003 \textcolor{comment}{*}
02004    80       \textcolor{keywordflow}{CONTINUE}
02005 \textcolor{comment}{*}
02006    90    \textcolor{keywordflow}{CONTINUE}
02007 \textcolor{comment}{*}
02008   100 \textcolor{keywordflow}{CONTINUE}
02009 \textcolor{comment}{*}
02010 \textcolor{comment}{*     Report result.}
02011 \textcolor{comment}{*}
02012       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
02013          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
02014       \textcolor{keywordflow}{ELSE}
02015          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
02016 \textcolor{keywordflow}{      END IF}
02017       \textcolor{keywordflow}{GO TO} 130
02018 \textcolor{comment}{*}
02019   110 \textcolor{keywordflow}{CONTINUE}
02020       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
02021 \textcolor{comment}{*}
02022   120 \textcolor{keywordflow}{CONTINUE}
02023       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
02024       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02025          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, ralpha, incx, lda
02026       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02027          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, ralpha, incx
02028 \textcolor{keywordflow}{      END IF}
02029 \textcolor{comment}{*}
02030   130 \textcolor{keywordflow}{CONTINUE}
02031       \textcolor{keywordflow}{RETURN}
02032 \textcolor{comment}{*}
02033  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
02034      $      \textcolor{stringliteral}{'S)'} )
02035  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
02036      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
02037  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
02038      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
02039      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
02040  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
02041  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02042  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02043      $      i2, \textcolor{stringliteral}{', AP)                                         .'} )
02044  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{','}, f4.1, \textcolor{stringliteral}{', X,'},
02045      $      i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')                                      .'} )
02046  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02047      $      \textcolor{stringliteral}{'******'} )
02048 \textcolor{comment}{*}
02049 \textcolor{comment}{*     End of CCHK5.}
02050 \textcolor{comment}{*}
02051 \textcolor{keyword}{      END}
02052 \textcolor{keyword}{      SUBROUTINE }cchk6( SNAME, EPS, THRESH, NOUT, NTRA, TRACE, REWI,
02053      $                  FATAL, NIDIM, IDIM, NALF, ALF, NINC, INC, NMAX,
02054      $                  INCMAX, A, AA, AS, X, XX, XS, Y, YY, YS, YT, G,
02055      $                  Z )
02056 \textcolor{comment}{*}
02057 \textcolor{comment}{*  Tests CHER2 and CHPR2.}
02058 \textcolor{comment}{*}
02059 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02060 \textcolor{comment}{*}
02061 \textcolor{comment}{*  -- Written on 10-August-1987.}
02062 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02063 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02064 \textcolor{comment}{*}
02065 \textcolor{comment}{*     .. Parameters ..}
02066       \textcolor{keywordtype}{COMPLEX}            zero, half, one
02067       parameter( zero = ( 0.0, 0.0 ), half = ( 0.5, 0.0 ),
02068      $                   one = ( 1.0, 0.0 ) )
02069       \textcolor{keywordtype}{REAL}               rzero
02070       parameter( rzero = 0.0 )
02071 \textcolor{comment}{*     .. Scalar Arguments ..}
02072       \textcolor{keywordtype}{REAL}               eps, thresh
02073       \textcolor{keywordtype}{INTEGER}            incmax, nalf, nidim, ninc, nmax, nout, ntra
02074       \textcolor{keywordtype}{LOGICAL}            fatal, rewi, trace
02075       \textcolor{keywordtype}{CHARACTER*6}        sname
02076 \textcolor{comment}{*     .. Array Arguments ..}
02077       \textcolor{keywordtype}{COMPLEX}            a( nmax, nmax ), aa( nmax*nmax ), alf( nalf ),
02078      $                   as( nmax*nmax ), x( nmax ), xs( nmax*incmax ),
02079      $                   xx( nmax*incmax ), y( nmax ),
02080      $                   ys( nmax*incmax ), yt( nmax ),
02081      $                   yy( nmax*incmax ), z( nmax, 2 )
02082       \textcolor{keywordtype}{REAL}               g( nmax )
02083       \textcolor{keywordtype}{INTEGER}            idim( nidim ), inc( ninc )
02084 \textcolor{comment}{*     .. Local Scalars ..}
02085       \textcolor{keywordtype}{COMPLEX}            alpha, als, transl
02086       \textcolor{keywordtype}{REAL}               err, errmax
02087       \textcolor{keywordtype}{INTEGER}            i, ia, ic, in, incx, incxs, incy, incys, ix,
02088      $                   iy, j, ja, jj, laa, lda, ldas, lj, lx, ly, n,
02089      $                   nargs, nc, ns
02090       \textcolor{keywordtype}{LOGICAL}            full, null, packed, reset, same, upper
02091       \textcolor{keywordtype}{CHARACTER*1}        uplo, uplos
02092       \textcolor{keywordtype}{CHARACTER*2}        ich
02093 \textcolor{comment}{*     .. Local Arrays ..}
02094       \textcolor{keywordtype}{COMPLEX}            w( 2 )
02095       \textcolor{keywordtype}{LOGICAL}            isame( 13 )
02096 \textcolor{comment}{*     .. External Functions ..}
02097       \textcolor{keywordtype}{LOGICAL}            lce, lceres
02098       \textcolor{keywordtype}{EXTERNAL}           lce, lceres
02099 \textcolor{comment}{*     .. External Subroutines ..}
02100       \textcolor{keywordtype}{EXTERNAL}           cher2, chpr2, cmake, cmvch
02101 \textcolor{comment}{*     .. Intrinsic Functions ..}
02102       \textcolor{keywordtype}{INTRINSIC}          abs, conjg, max
02103 \textcolor{comment}{*     .. Scalars in Common ..}
02104       \textcolor{keywordtype}{INTEGER}            infot, noutc
02105       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02106 \textcolor{comment}{*     .. Common blocks ..}
02107       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02108 \textcolor{comment}{*     .. Data statements ..}
02109       \textcolor{keyword}{DATA}               ich/\textcolor{stringliteral}{'UL'}/
02110 \textcolor{comment}{*     .. Executable Statements ..}
02111       full = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'E'}
02112       packed = sname( 3: 3 ).EQ.\textcolor{stringliteral}{'P'}
02113 \textcolor{comment}{*     Define the number of arguments.}
02114       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02115          nargs = 9
02116       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02117          nargs = 8
02118 \textcolor{keywordflow}{      END IF}
02119 \textcolor{comment}{*}
02120       nc = 0
02121       reset = .true.
02122       errmax = rzero
02123 \textcolor{comment}{*}
02124       \textcolor{keywordflow}{DO} 140 in = 1, nidim
02125          n = idim( in )
02126 \textcolor{comment}{*        Set LDA to 1 more than minimum value if room.}
02127          lda = n
02128          \textcolor{keywordflow}{IF}( lda.LT.nmax )
02129      $      lda = lda + 1
02130 \textcolor{comment}{*        Skip tests if not enough room.}
02131          \textcolor{keywordflow}{IF}( lda.GT.nmax )
02132      $      \textcolor{keywordflow}{GO TO} 140
02133          \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02134             laa = ( n*( n + 1 ) )/2
02135          \textcolor{keywordflow}{ELSE}
02136             laa = lda*n
02137 \textcolor{keywordflow}{         END IF}
02138 \textcolor{comment}{*}
02139          \textcolor{keywordflow}{DO} 130 ic = 1, 2
02140             uplo = ich( ic: ic )
02141             upper = uplo.EQ.\textcolor{stringliteral}{'U'}
02142 \textcolor{comment}{*}
02143             \textcolor{keywordflow}{DO} 120 ix = 1, ninc
02144                incx = inc( ix )
02145                lx = abs( incx )*n
02146 \textcolor{comment}{*}
02147 \textcolor{comment}{*              Generate the vector X.}
02148 \textcolor{comment}{*}
02149                transl = half
02150                \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, x, 1, xx, abs( incx ),
02151      $                     0, n - 1, reset, transl )
02152                \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02153                   x( n/2 ) = zero
02154                   xx( 1 + abs( incx )*( n/2 - 1 ) ) = zero
02155 \textcolor{keywordflow}{               END IF}
02156 \textcolor{comment}{*}
02157                \textcolor{keywordflow}{DO} 110 iy = 1, ninc
02158                   incy = inc( iy )
02159                   ly = abs( incy )*n
02160 \textcolor{comment}{*}
02161 \textcolor{comment}{*                 Generate the vector Y.}
02162 \textcolor{comment}{*}
02163                   transl = zero
02164                   \textcolor{keyword}{CALL }cmake( \textcolor{stringliteral}{'GE'}, \textcolor{stringliteral}{' '}, \textcolor{stringliteral}{' '}, 1, n, y, 1, yy,
02165      $                        abs( incy ), 0, n - 1, reset, transl )
02166                   \textcolor{keywordflow}{IF}( n.GT.1 )\textcolor{keywordflow}{THEN}
02167                      y( n/2 ) = zero
02168                      yy( 1 + abs( incy )*( n/2 - 1 ) ) = zero
02169 \textcolor{keywordflow}{                  END IF}
02170 \textcolor{comment}{*}
02171                   \textcolor{keywordflow}{DO} 100 ia = 1, nalf
02172                      alpha = alf( ia )
02173                      null = n.LE.0.OR.alpha.EQ.zero
02174 \textcolor{comment}{*}
02175 \textcolor{comment}{*                    Generate the matrix A.}
02176 \textcolor{comment}{*}
02177                      transl = zero
02178                      \textcolor{keyword}{CALL }cmake( sname( 2: 3 ), uplo, \textcolor{stringliteral}{' '}, n, n, a,
02179      $                           nmax, aa, lda, n - 1, n - 1, reset,
02180      $                           transl )
02181 \textcolor{comment}{*}
02182                      nc = nc + 1
02183 \textcolor{comment}{*}
02184 \textcolor{comment}{*                    Save every datum before calling the subroutine.}
02185 \textcolor{comment}{*}
02186                      uplos = uplo
02187                      ns = n
02188                      als = alpha
02189                      \textcolor{keywordflow}{DO} 10 i = 1, laa
02190                         as( i ) = aa( i )
02191    10                \textcolor{keywordflow}{CONTINUE}
02192                      ldas = lda
02193                      \textcolor{keywordflow}{DO} 20 i = 1, lx
02194                         xs( i ) = xx( i )
02195    20                \textcolor{keywordflow}{CONTINUE}
02196                      incxs = incx
02197                      \textcolor{keywordflow}{DO} 30 i = 1, ly
02198                         ys( i ) = yy( i )
02199    30                \textcolor{keywordflow}{CONTINUE}
02200                      incys = incy
02201 \textcolor{comment}{*}
02202 \textcolor{comment}{*                    Call the subroutine.}
02203 \textcolor{comment}{*}
02204                      \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02205                         \textcolor{keywordflow}{IF}( trace )
02206      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9993 )nc, sname, uplo, n,
02207      $                     alpha, incx, incy, lda
02208                         \textcolor{keywordflow}{IF}( rewi )
02209      $                     rewind ntra
02210                         \textcolor{keyword}{CALL }cher2( uplo, n, alpha, xx, incx, yy, incy,
02211      $                              aa, lda )
02212                      \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02213                         \textcolor{keywordflow}{IF}( trace )
02214      $                     \textcolor{keyword}{WRITE}( ntra, fmt = 9994 )nc, sname, uplo, n,
02215      $                     alpha, incx, incy
02216                         \textcolor{keywordflow}{IF}( rewi )
02217      $                     rewind ntra
02218                         \textcolor{keyword}{CALL }chpr2( uplo, n, alpha, xx, incx, yy, incy,
02219      $                              aa )
02220 \textcolor{keywordflow}{                     END IF}
02221 \textcolor{comment}{*}
02222 \textcolor{comment}{*                    Check if error-exit was taken incorrectly.}
02223 \textcolor{comment}{*}
02224                      \textcolor{keywordflow}{IF}( .NOT.ok )\textcolor{keywordflow}{THEN}
02225                         \textcolor{keyword}{WRITE}( nout, fmt = 9992 )
02226                         fatal = .true.
02227                         \textcolor{keywordflow}{GO TO} 160
02228 \textcolor{keywordflow}{                     END IF}
02229 \textcolor{comment}{*}
02230 \textcolor{comment}{*                    See what data changed inside subroutines.}
02231 \textcolor{comment}{*}
02232                      isame( 1 ) = uplo.EQ.uplos
02233                      isame( 2 ) = ns.EQ.n
02234                      isame( 3 ) = als.EQ.alpha
02235                      isame( 4 ) = lce( xs, xx, lx )
02236                      isame( 5 ) = incxs.EQ.incx
02237                      isame( 6 ) = lce( ys, yy, ly )
02238                      isame( 7 ) = incys.EQ.incy
02239                      \textcolor{keywordflow}{IF}( null )\textcolor{keywordflow}{THEN}
02240                         isame( 8 ) = lce( as, aa, laa )
02241                      \textcolor{keywordflow}{ELSE}
02242                         isame( 8 ) = lceres( sname( 2: 3 ), uplo, n, n,
02243      $                               as, aa, lda )
02244 \textcolor{keywordflow}{                     END IF}
02245                      \textcolor{keywordflow}{IF}( .NOT.packed )\textcolor{keywordflow}{THEN}
02246                         isame( 9 ) = ldas.EQ.lda
02247 \textcolor{keywordflow}{                     END IF}
02248 \textcolor{comment}{*}
02249 \textcolor{comment}{*                    If data was incorrectly changed, report and return.}
02250 \textcolor{comment}{*}
02251                      same = .true.
02252                      \textcolor{keywordflow}{DO} 40 i = 1, nargs
02253                         same = same.AND.isame( i )
02254                         \textcolor{keywordflow}{IF}( .NOT.isame( i ) )
02255      $                     \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i
02256    40                \textcolor{keywordflow}{CONTINUE}
02257                      \textcolor{keywordflow}{IF}( .NOT.same )\textcolor{keywordflow}{THEN}
02258                         fatal = .true.
02259                         \textcolor{keywordflow}{GO TO} 160
02260 \textcolor{keywordflow}{                     END IF}
02261 \textcolor{comment}{*}
02262                      \textcolor{keywordflow}{IF}( .NOT.null )\textcolor{keywordflow}{THEN}
02263 \textcolor{comment}{*}
02264 \textcolor{comment}{*                       Check the result column by column.}
02265 \textcolor{comment}{*}
02266                         \textcolor{keywordflow}{IF}( incx.GT.0 )\textcolor{keywordflow}{THEN}
02267                            \textcolor{keywordflow}{DO} 50 i = 1, n
02268                               z( i, 1 ) = x( i )
02269    50                      \textcolor{keywordflow}{CONTINUE}
02270                         \textcolor{keywordflow}{ELSE}
02271                            \textcolor{keywordflow}{DO} 60 i = 1, n
02272                               z( i, 1 ) = x( n - i + 1 )
02273    60                      \textcolor{keywordflow}{CONTINUE}
02274 \textcolor{keywordflow}{                        END IF}
02275                         \textcolor{keywordflow}{IF}( incy.GT.0 )\textcolor{keywordflow}{THEN}
02276                            \textcolor{keywordflow}{DO} 70 i = 1, n
02277                               z( i, 2 ) = y( i )
02278    70                      \textcolor{keywordflow}{CONTINUE}
02279                         \textcolor{keywordflow}{ELSE}
02280                            \textcolor{keywordflow}{DO} 80 i = 1, n
02281                               z( i, 2 ) = y( n - i + 1 )
02282    80                      \textcolor{keywordflow}{CONTINUE}
02283 \textcolor{keywordflow}{                        END IF}
02284                         ja = 1
02285                         \textcolor{keywordflow}{DO} 90 j = 1, n
02286                            w( 1 ) = alpha*conjg( z( j, 2 ) )
02287                            w( 2 ) = conjg( alpha )*conjg( z( j, 1 ) )
02288                            \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02289                               jj = 1
02290                               lj = j
02291                            \textcolor{keywordflow}{ELSE}
02292                               jj = j
02293                               lj = n - j + 1
02294 \textcolor{keywordflow}{                           END IF}
02295                            \textcolor{keyword}{CALL }cmvch( \textcolor{stringliteral}{'N'}, lj, 2, one, z( jj, 1 ),
02296      $                                 nmax, w, 1, one, a( jj, j ), 1,
02297      $                                 yt, g, aa( ja ), eps, err, fatal,
02298      $                                 nout, .true. )
02299                            \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02300                               \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02301                                  ja = ja + lda
02302                               \textcolor{keywordflow}{ELSE}
02303                                  ja = ja + lda + 1
02304 \textcolor{keywordflow}{                              END IF}
02305                            \textcolor{keywordflow}{ELSE}
02306                               ja = ja + lj
02307 \textcolor{keywordflow}{                           END IF}
02308                            errmax = max( errmax, err )
02309 \textcolor{comment}{*                          If got really bad answer, report and return.}
02310                            \textcolor{keywordflow}{IF}( fatal )
02311      $                        \textcolor{keywordflow}{GO TO} 150
02312    90                   \textcolor{keywordflow}{CONTINUE}
02313                      \textcolor{keywordflow}{ELSE}
02314 \textcolor{comment}{*                       Avoid repeating tests with N.le.0.}
02315                         \textcolor{keywordflow}{IF}( n.LE.0 )
02316      $                     \textcolor{keywordflow}{GO TO} 140
02317 \textcolor{keywordflow}{                     END IF}
02318 \textcolor{comment}{*}
02319   100             \textcolor{keywordflow}{CONTINUE}
02320 \textcolor{comment}{*}
02321   110          \textcolor{keywordflow}{CONTINUE}
02322 \textcolor{comment}{*}
02323   120       \textcolor{keywordflow}{CONTINUE}
02324 \textcolor{comment}{*}
02325   130    \textcolor{keywordflow}{CONTINUE}
02326 \textcolor{comment}{*}
02327   140 \textcolor{keywordflow}{CONTINUE}
02328 \textcolor{comment}{*}
02329 \textcolor{comment}{*     Report result.}
02330 \textcolor{comment}{*}
02331       \textcolor{keywordflow}{IF}( errmax.LT.thresh )\textcolor{keywordflow}{THEN}
02332          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )sname, nc
02333       \textcolor{keywordflow}{ELSE}
02334          \textcolor{keyword}{WRITE}( nout, fmt = 9997 )sname, nc, errmax
02335 \textcolor{keywordflow}{      END IF}
02336       \textcolor{keywordflow}{GO TO} 170
02337 \textcolor{comment}{*}
02338   150 \textcolor{keywordflow}{CONTINUE}
02339       \textcolor{keyword}{WRITE}( nout, fmt = 9995 )j
02340 \textcolor{comment}{*}
02341   160 \textcolor{keywordflow}{CONTINUE}
02342       \textcolor{keyword}{WRITE}( nout, fmt = 9996 )sname
02343       \textcolor{keywordflow}{IF}( full )\textcolor{keywordflow}{THEN}
02344          \textcolor{keyword}{WRITE}( nout, fmt = 9993 )nc, sname, uplo, n, alpha, incx,
02345      $      incy, lda
02346       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( packed )\textcolor{keywordflow}{THEN}
02347          \textcolor{keyword}{WRITE}( nout, fmt = 9994 )nc, sname, uplo, n, alpha, incx, incy
02348 \textcolor{keywordflow}{      END IF}
02349 \textcolor{comment}{*}
02350   170 \textcolor{keywordflow}{CONTINUE}
02351       \textcolor{keywordflow}{RETURN}
02352 \textcolor{comment}{*}
02353  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' CALL'},
02354      $      \textcolor{stringliteral}{'S)'} )
02355  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' WAS CH'},
02356      $      \textcolor{stringliteral}{'ANGED INCORRECTLY *******'} )
02357  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' COMPLETED THE COMPUTATIONAL TESTS ('}, i6, \textcolor{stringliteral}{' C'},
02358      $      \textcolor{stringliteral}{'ALLS)'}, /\textcolor{stringliteral}{' ******* BUT WITH MAXIMUM TEST RATIO'}, f8.2,
02359      $      \textcolor{stringliteral}{' - SUSPECT *******'} )
02360  9996 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED ON CALL NUMBER:'} )
02361  9995 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{'      THESE ARE THE RESULTS FOR COLUMN '}, i3 )
02362  9994 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
02363      $      f4.1, \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', AP)                     '},
02364      $      \textcolor{stringliteral}{'       .'} )
02365  9993 \textcolor{keyword}{FORMAT}( 1x, i6, \textcolor{stringliteral}{': '}, a6, \textcolor{stringliteral}{'('}\textcolor{stringliteral}{''}, a1, \textcolor{stringliteral}{''}\textcolor{stringliteral}{','}, i3, \textcolor{stringliteral}{',('}, f4.1, \textcolor{stringliteral}{','},
02366      $      f4.1, \textcolor{stringliteral}{'), X,'}, i2, \textcolor{stringliteral}{', Y,'}, i2, \textcolor{stringliteral}{', A,'}, i3, \textcolor{stringliteral}{')             '},
02367      $      \textcolor{stringliteral}{'            .'} )
02368  9992 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - ERROR-EXIT TAKEN ON VALID CALL *'},
02369      $      \textcolor{stringliteral}{'******'} )
02370 \textcolor{comment}{*}
02371 \textcolor{comment}{*     End of CCHK6.}
02372 \textcolor{comment}{*}
02373 \textcolor{keyword}{      END}
02374 \textcolor{keyword}{      SUBROUTINE }cchke( ISNUM, SRNAMT, NOUT )
02375 \textcolor{comment}{*}
02376 \textcolor{comment}{*  Tests the error exits from the Level 2 Blas.}
02377 \textcolor{comment}{*  Requires a special version of the error-handling routine XERBLA.}
02378 \textcolor{comment}{*  ALPHA, RALPHA, BETA, A, X and Y should not need to be defined.}
02379 \textcolor{comment}{*}
02380 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02381 \textcolor{comment}{*}
02382 \textcolor{comment}{*  -- Written on 10-August-1987.}
02383 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02384 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02385 \textcolor{comment}{*}
02386 \textcolor{comment}{*     .. Scalar Arguments ..}
02387       \textcolor{keywordtype}{INTEGER}            isnum, nout
02388       \textcolor{keywordtype}{CHARACTER*6}        srnamt
02389 \textcolor{comment}{*     .. Scalars in Common ..}
02390       \textcolor{keywordtype}{INTEGER}            infot, noutc
02391       \textcolor{keywordtype}{LOGICAL}            lerr, ok
02392 \textcolor{comment}{*     .. Local Scalars ..}
02393       \textcolor{keywordtype}{COMPLEX}            alpha, beta
02394       \textcolor{keywordtype}{REAL}               ralpha
02395 \textcolor{comment}{*     .. Local Arrays ..}
02396       \textcolor{keywordtype}{COMPLEX}            a( 1, 1 ), x( 1 ), y( 1 )
02397 \textcolor{comment}{*     .. External Subroutines ..}
02398       \textcolor{keywordtype}{EXTERNAL}           cgbmv, cgemv, cgerc, cgeru, chbmv, chemv, cher,
02399      $                   cher2, chkxer, chpmv, chpr, chpr2, ctbmv,
02400      $                   ctbsv, ctpmv, ctpsv, ctrmv, ctrsv
02401 \textcolor{comment}{*     .. Common blocks ..}
02402       \textcolor{keyword}{COMMON}             /infoc/infot, noutc, ok, lerr
02403 \textcolor{comment}{*     .. Executable Statements ..}
02404 \textcolor{comment}{*     OK is set to .FALSE. by the special version of XERBLA or by CHKXER}
02405 \textcolor{comment}{*     if anything is wrong.}
02406       ok = .true.
02407 \textcolor{comment}{*     LERR is set to .TRUE. by the special version of XERBLA each time}
02408 \textcolor{comment}{*     it is called, and is then tested and re-set by CHKXER.}
02409       lerr = .false.
02410       \textcolor{keywordflow}{GO TO} ( 10, 20, 30, 40, 50, 60, 70, 80,
02411      $        90, 100, 110, 120, 130, 140, 150, 160,
02412      $        170 )isnum
02413    10 infot = 1
02414       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02415       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02416       infot = 2
02417       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'N'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02418       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02419       infot = 3
02420       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'N'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02421       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02422       infot = 6
02423       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'N'}, 2, 0, alpha, a, 1, x, 1, beta, y, 1 )
02424       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02425       infot = 8
02426       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02427       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02428       infot = 11
02429       \textcolor{keyword}{CALL }cgemv( \textcolor{stringliteral}{'N'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02430       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02431       \textcolor{keywordflow}{GO TO} 180
02432    20 infot = 1
02433       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'/'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02434       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02435       infot = 2
02436       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, -1, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02437       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02438       infot = 3
02439       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 0, -1, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02440       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02441       infot = 4
02442       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 0, 0, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02443       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02444       infot = 5
02445       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 2, 0, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02446       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02447       infot = 8
02448       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02449       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02450       infot = 10
02451       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02452       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02453       infot = 13
02454       \textcolor{keyword}{CALL }cgbmv( \textcolor{stringliteral}{'N'}, 0, 0, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02455       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02456       \textcolor{keywordflow}{GO TO} 180
02457    30 infot = 1
02458       \textcolor{keyword}{CALL }chemv( \textcolor{stringliteral}{'/'}, 0, alpha, a, 1, x, 1, beta, y, 1 )
02459       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02460       infot = 2
02461       \textcolor{keyword}{CALL }chemv( \textcolor{stringliteral}{'U'}, -1, alpha, a, 1, x, 1, beta, y, 1 )
02462       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02463       infot = 5
02464       \textcolor{keyword}{CALL }chemv( \textcolor{stringliteral}{'U'}, 2, alpha, a, 1, x, 1, beta, y, 1 )
02465       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02466       infot = 7
02467       \textcolor{keyword}{CALL }chemv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 0, beta, y, 1 )
02468       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02469       infot = 10
02470       \textcolor{keyword}{CALL }chemv( \textcolor{stringliteral}{'U'}, 0, alpha, a, 1, x, 1, beta, y, 0 )
02471       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02472       \textcolor{keywordflow}{GO TO} 180
02473    40 infot = 1
02474       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'/'}, 0, 0, alpha, a, 1, x, 1, beta, y, 1 )
02475       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02476       infot = 2
02477       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'U'}, -1, 0, alpha, a, 1, x, 1, beta, y, 1 )
02478       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02479       infot = 3
02480       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'U'}, 0, -1, alpha, a, 1, x, 1, beta, y, 1 )
02481       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02482       infot = 6
02483       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'U'}, 0, 1, alpha, a, 1, x, 1, beta, y, 1 )
02484       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02485       infot = 8
02486       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 0, beta, y, 1 )
02487       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02488       infot = 11
02489       \textcolor{keyword}{CALL }chbmv( \textcolor{stringliteral}{'U'}, 0, 0, alpha, a, 1, x, 1, beta, y, 0 )
02490       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02491       \textcolor{keywordflow}{GO TO} 180
02492    50 infot = 1
02493       \textcolor{keyword}{CALL }chpmv( \textcolor{stringliteral}{'/'}, 0, alpha, a, x, 1, beta, y, 1 )
02494       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02495       infot = 2
02496       \textcolor{keyword}{CALL }chpmv( \textcolor{stringliteral}{'U'}, -1, alpha, a, x, 1, beta, y, 1 )
02497       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02498       infot = 6
02499       \textcolor{keyword}{CALL }chpmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 0, beta, y, 1 )
02500       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02501       infot = 9
02502       \textcolor{keyword}{CALL }chpmv( \textcolor{stringliteral}{'U'}, 0, alpha, a, x, 1, beta, y, 0 )
02503       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02504       \textcolor{keywordflow}{GO TO} 180
02505    60 infot = 1
02506       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02507       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02508       infot = 2
02509       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02510       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02511       infot = 3
02512       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02513       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02514       infot = 4
02515       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02516       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02517       infot = 6
02518       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02519       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02520       infot = 8
02521       \textcolor{keyword}{CALL }ctrmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02522       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02523       \textcolor{keywordflow}{GO TO} 180
02524    70 infot = 1
02525       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02526       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02527       infot = 2
02528       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02529       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02530       infot = 3
02531       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02532       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02533       infot = 4
02534       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02535       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02536       infot = 5
02537       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02538       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02539       infot = 7
02540       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02541       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02542       infot = 9
02543       \textcolor{keyword}{CALL }ctbmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02544       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02545       \textcolor{keywordflow}{GO TO} 180
02546    80 infot = 1
02547       \textcolor{keyword}{CALL }ctpmv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02548       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02549       infot = 2
02550       \textcolor{keyword}{CALL }ctpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02551       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02552       infot = 3
02553       \textcolor{keyword}{CALL }ctpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02554       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02555       infot = 4
02556       \textcolor{keyword}{CALL }ctpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02557       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02558       infot = 7
02559       \textcolor{keyword}{CALL }ctpmv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02560       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02561       \textcolor{keywordflow}{GO TO} 180
02562    90 infot = 1
02563       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02564       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02565       infot = 2
02566       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 1 )
02567       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02568       infot = 3
02569       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, 1, x, 1 )
02570       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02571       infot = 4
02572       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, 1, x, 1 )
02573       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02574       infot = 6
02575       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 2, a, 1, x, 1 )
02576       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02577       infot = 8
02578       \textcolor{keyword}{CALL }ctrsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, 1, x, 0 )
02579       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02580       \textcolor{keywordflow}{GO TO} 180
02581   100 infot = 1
02582       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02583       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02584       infot = 2
02585       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 1 )
02586       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02587       infot = 3
02588       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, 0, a, 1, x, 1 )
02589       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02590       infot = 4
02591       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, 0, a, 1, x, 1 )
02592       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02593       infot = 5
02594       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, -1, a, 1, x, 1 )
02595       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02596       infot = 7
02597       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 1, a, 1, x, 1 )
02598       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02599       infot = 9
02600       \textcolor{keyword}{CALL }ctbsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, 0, a, 1, x, 0 )
02601       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02602       \textcolor{keywordflow}{GO TO} 180
02603   110 infot = 1
02604       \textcolor{keyword}{CALL }ctpsv( \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02605       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02606       infot = 2
02607       \textcolor{keyword}{CALL }ctpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'/'}, \textcolor{stringliteral}{'N'}, 0, a, x, 1 )
02608       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02609       infot = 3
02610       \textcolor{keyword}{CALL }ctpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'/'}, 0, a, x, 1 )
02611       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02612       infot = 4
02613       \textcolor{keyword}{CALL }ctpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, -1, a, x, 1 )
02614       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02615       infot = 7
02616       \textcolor{keyword}{CALL }ctpsv( \textcolor{stringliteral}{'U'}, \textcolor{stringliteral}{'N'}, \textcolor{stringliteral}{'N'}, 0, a, x, 0 )
02617       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02618       \textcolor{keywordflow}{GO TO} 180
02619   120 infot = 1
02620       \textcolor{keyword}{CALL }cgerc( -1, 0, alpha, x, 1, y, 1, a, 1 )
02621       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02622       infot = 2
02623       \textcolor{keyword}{CALL }cgerc( 0, -1, alpha, x, 1, y, 1, a, 1 )
02624       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02625       infot = 5
02626       \textcolor{keyword}{CALL }cgerc( 0, 0, alpha, x, 0, y, 1, a, 1 )
02627       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02628       infot = 7
02629       \textcolor{keyword}{CALL }cgerc( 0, 0, alpha, x, 1, y, 0, a, 1 )
02630       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02631       infot = 9
02632       \textcolor{keyword}{CALL }cgerc( 2, 0, alpha, x, 1, y, 1, a, 1 )
02633       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02634       \textcolor{keywordflow}{GO TO} 180
02635   130 infot = 1
02636       \textcolor{keyword}{CALL }cgeru( -1, 0, alpha, x, 1, y, 1, a, 1 )
02637       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02638       infot = 2
02639       \textcolor{keyword}{CALL }cgeru( 0, -1, alpha, x, 1, y, 1, a, 1 )
02640       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02641       infot = 5
02642       \textcolor{keyword}{CALL }cgeru( 0, 0, alpha, x, 0, y, 1, a, 1 )
02643       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02644       infot = 7
02645       \textcolor{keyword}{CALL }cgeru( 0, 0, alpha, x, 1, y, 0, a, 1 )
02646       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02647       infot = 9
02648       \textcolor{keyword}{CALL }cgeru( 2, 0, alpha, x, 1, y, 1, a, 1 )
02649       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02650       \textcolor{keywordflow}{GO TO} 180
02651   140 infot = 1
02652       \textcolor{keyword}{CALL }cher( \textcolor{stringliteral}{'/'}, 0, ralpha, x, 1, a, 1 )
02653       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02654       infot = 2
02655       \textcolor{keyword}{CALL }cher( \textcolor{stringliteral}{'U'}, -1, ralpha, x, 1, a, 1 )
02656       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02657       infot = 5
02658       \textcolor{keyword}{CALL }cher( \textcolor{stringliteral}{'U'}, 0, ralpha, x, 0, a, 1 )
02659       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02660       infot = 7
02661       \textcolor{keyword}{CALL }cher( \textcolor{stringliteral}{'U'}, 2, ralpha, x, 1, a, 1 )
02662       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02663       \textcolor{keywordflow}{GO TO} 180
02664   150 infot = 1
02665       \textcolor{keyword}{CALL }chpr( \textcolor{stringliteral}{'/'}, 0, ralpha, x, 1, a )
02666       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02667       infot = 2
02668       \textcolor{keyword}{CALL }chpr( \textcolor{stringliteral}{'U'}, -1, ralpha, x, 1, a )
02669       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02670       infot = 5
02671       \textcolor{keyword}{CALL }chpr( \textcolor{stringliteral}{'U'}, 0, ralpha, x, 0, a )
02672       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02673       \textcolor{keywordflow}{GO TO} 180
02674   160 infot = 1
02675       \textcolor{keyword}{CALL }cher2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a, 1 )
02676       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02677       infot = 2
02678       \textcolor{keyword}{CALL }cher2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a, 1 )
02679       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02680       infot = 5
02681       \textcolor{keyword}{CALL }cher2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a, 1 )
02682       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02683       infot = 7
02684       \textcolor{keyword}{CALL }cher2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a, 1 )
02685       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02686       infot = 9
02687       \textcolor{keyword}{CALL }cher2( \textcolor{stringliteral}{'U'}, 2, alpha, x, 1, y, 1, a, 1 )
02688       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02689       \textcolor{keywordflow}{GO TO} 180
02690   170 infot = 1
02691       \textcolor{keyword}{CALL }chpr2( \textcolor{stringliteral}{'/'}, 0, alpha, x, 1, y, 1, a )
02692       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02693       infot = 2
02694       \textcolor{keyword}{CALL }chpr2( \textcolor{stringliteral}{'U'}, -1, alpha, x, 1, y, 1, a )
02695       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02696       infot = 5
02697       \textcolor{keyword}{CALL }chpr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 0, y, 1, a )
02698       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02699       infot = 7
02700       \textcolor{keyword}{CALL }chpr2( \textcolor{stringliteral}{'U'}, 0, alpha, x, 1, y, 0, a )
02701       \textcolor{keyword}{CALL }chkxer( srnamt, infot, nout, lerr, ok )
02702 \textcolor{comment}{*}
02703   180 \textcolor{keywordflow}{IF}( ok )\textcolor{keywordflow}{THEN}
02704          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )srnamt
02705       \textcolor{keywordflow}{ELSE}
02706          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srnamt
02707 \textcolor{keywordflow}{      END IF}
02708       \textcolor{keywordflow}{RETURN}
02709 \textcolor{comment}{*}
02710  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' '}, a6, \textcolor{stringliteral}{' PASSED THE TESTS OF ERROR-EXITS'} )
02711  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* '}, a6, \textcolor{stringliteral}{' FAILED THE TESTS OF ERROR-EXITS *****'},
02712      $      \textcolor{stringliteral}{'**'} )
02713 \textcolor{comment}{*}
02714 \textcolor{comment}{*     End of CCHKE.}
02715 \textcolor{comment}{*}
02716 \textcolor{keyword}{      END}
02717 \textcolor{keyword}{      SUBROUTINE }cmake( TYPE, UPLO, DIAG, M, N, A, NMAX, AA, LDA, KL,
02718      $                  KU, RESET, TRANSL )
02719 \textcolor{comment}{*}
02720 \textcolor{comment}{*  Generates values for an M by N matrix A within the bandwidth}
02721 \textcolor{comment}{*  defined by KL and KU.}
02722 \textcolor{comment}{*  Stores the values in the array AA in the data structure required}
02723 \textcolor{comment}{*  by the routine, with unwanted elements set to rogue value.}
02724 \textcolor{comment}{*}
02725 \textcolor{comment}{*  TYPE is 'GE', 'GB', 'HE', 'HB', 'HP', 'TR', 'TB' OR 'TP'.}
02726 \textcolor{comment}{*}
02727 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02728 \textcolor{comment}{*}
02729 \textcolor{comment}{*  -- Written on 10-August-1987.}
02730 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02731 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02732 \textcolor{comment}{*}
02733 \textcolor{comment}{*     .. Parameters ..}
02734       \textcolor{keywordtype}{COMPLEX}            zero, one
02735       parameter( zero = ( 0.0, 0.0 ), one = ( 1.0, 0.0 ) )
02736       \textcolor{keywordtype}{COMPLEX}            rogue
02737       parameter( rogue = ( -1.0e10, 1.0e10 ) )
02738       \textcolor{keywordtype}{REAL}               rzero
02739       parameter( rzero = 0.0 )
02740       \textcolor{keywordtype}{REAL}               rrogue
02741       parameter( rrogue = -1.0e10 )
02742 \textcolor{comment}{*     .. Scalar Arguments ..}
02743       \textcolor{keywordtype}{COMPLEX}            transl
02744       \textcolor{keywordtype}{INTEGER}            kl, ku, lda, m, n, nmax
02745       \textcolor{keywordtype}{LOGICAL}            reset
02746       \textcolor{keywordtype}{CHARACTER*1}        diag, uplo
02747       \textcolor{keywordtype}{CHARACTER*2}        type
02748 \textcolor{comment}{*     .. Array Arguments ..}
02749       \textcolor{keywordtype}{COMPLEX}            a( nmax, * ), aa( * )
02750 \textcolor{comment}{*     .. Local Scalars ..}
02751       \textcolor{keywordtype}{INTEGER}            i, i1, i2, i3, ibeg, iend, ioff, j, jj, kk
02752       \textcolor{keywordtype}{LOGICAL}            gen, lower, sym, tri, unit, upper
02753 \textcolor{comment}{*     .. External Functions ..}
02754       \textcolor{keywordtype}{COMPLEX}            cbeg
02755       \textcolor{keywordtype}{EXTERNAL}           cbeg
02756 \textcolor{comment}{*     .. Intrinsic Functions ..}
02757       \textcolor{keywordtype}{INTRINSIC}          cmplx, conjg, max, min, real
02758 \textcolor{comment}{*     .. Executable Statements ..}
02759       gen = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'G'}
02760       sym = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'H'}
02761       tri = \textcolor{keywordtype}{TYPE}( 1: 1 ).EQ.\textcolor{stringliteral}{'T'}
02762       upper = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'U'}
02763       lower = ( sym.OR.tri ).AND.uplo.EQ.\textcolor{stringliteral}{'L'}
02764       unit = tri.AND.diag.EQ.\textcolor{stringliteral}{'U'}
02765 \textcolor{comment}{*}
02766 \textcolor{comment}{*     Generate data in array A.}
02767 \textcolor{comment}{*}
02768       \textcolor{keywordflow}{DO} 20 j = 1, n
02769          \textcolor{keywordflow}{DO} 10 i = 1, m
02770             \textcolor{keywordflow}{IF}( gen.OR.( upper.AND.i.LE.j ).OR.( lower.AND.i.GE.j ) )
02771      $          \textcolor{keywordflow}{THEN}
02772                \textcolor{keywordflow}{IF}( ( i.LE.j.AND.j - i.LE.ku ).OR.
02773      $             ( i.GE.j.AND.i - j.LE.kl ) )\textcolor{keywordflow}{THEN}
02774                   a( i, j ) = cbeg( reset ) + transl
02775                \textcolor{keywordflow}{ELSE}
02776                   a( i, j ) = zero
02777 \textcolor{keywordflow}{               END IF}
02778                \textcolor{keywordflow}{IF}( i.NE.j )\textcolor{keywordflow}{THEN}
02779                   \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02780                      a( j, i ) = conjg( a( i, j ) )
02781                   \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( tri )\textcolor{keywordflow}{THEN}
02782                      a( j, i ) = zero
02783 \textcolor{keywordflow}{                  END IF}
02784 \textcolor{keywordflow}{               END IF}
02785 \textcolor{keywordflow}{            END IF}
02786    10    \textcolor{keywordflow}{CONTINUE}
02787          \textcolor{keywordflow}{IF}( sym )
02788      $      a( j, j ) = cmplx( \textcolor{keywordtype}{REAL( A( J, J ) )}, rzero )
02789          \textcolor{keywordflow}{IF}( tri )
02790      $      a( j, j ) = a( j, j ) + one
02791          \textcolor{keywordflow}{IF}( unit )
02792      $      a( j, j ) = one
02793    20 \textcolor{keywordflow}{CONTINUE}
02794 \textcolor{comment}{*}
02795 \textcolor{comment}{*     Store elements in array AS in data structure required by routine.}
02796 \textcolor{comment}{*}
02797       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
02798          \textcolor{keywordflow}{DO} 50 j = 1, n
02799             \textcolor{keywordflow}{DO} 30 i = 1, m
02800                aa( i + ( j - 1 )*lda ) = a( i, j )
02801    30       \textcolor{keywordflow}{CONTINUE}
02802             \textcolor{keywordflow}{DO} 40 i = m + 1, lda
02803                aa( i + ( j - 1 )*lda ) = rogue
02804    40       \textcolor{keywordflow}{CONTINUE}
02805    50    \textcolor{keywordflow}{CONTINUE}
02806       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GB'} )\textcolor{keywordflow}{THEN}
02807          \textcolor{keywordflow}{DO} 90 j = 1, n
02808             \textcolor{keywordflow}{DO} 60 i1 = 1, ku + 1 - j
02809                aa( i1 + ( j - 1 )*lda ) = rogue
02810    60       \textcolor{keywordflow}{CONTINUE}
02811             \textcolor{keywordflow}{DO} 70 i2 = i1, min( kl + ku + 1, ku + 1 + m - j )
02812                aa( i2 + ( j - 1 )*lda ) = a( i2 + j - ku - 1, j )
02813    70       \textcolor{keywordflow}{CONTINUE}
02814             \textcolor{keywordflow}{DO} 80 i3 = i2, lda
02815                aa( i3 + ( j - 1 )*lda ) = rogue
02816    80       \textcolor{keywordflow}{CONTINUE}
02817    90    \textcolor{keywordflow}{CONTINUE}
02818       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HE'}.OR.type.EQ.\textcolor{stringliteral}{'TR'} )\textcolor{keywordflow}{THEN}
02819          \textcolor{keywordflow}{DO} 130 j = 1, n
02820             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02821                ibeg = 1
02822                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02823                   iend = j - 1
02824                \textcolor{keywordflow}{ELSE}
02825                   iend = j
02826 \textcolor{keywordflow}{               END IF}
02827             \textcolor{keywordflow}{ELSE}
02828                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02829                   ibeg = j + 1
02830                \textcolor{keywordflow}{ELSE}
02831                   ibeg = j
02832 \textcolor{keywordflow}{               END IF}
02833                iend = n
02834 \textcolor{keywordflow}{            END IF}
02835             \textcolor{keywordflow}{DO} 100 i = 1, ibeg - 1
02836                aa( i + ( j - 1 )*lda ) = rogue
02837   100       \textcolor{keywordflow}{CONTINUE}
02838             \textcolor{keywordflow}{DO} 110 i = ibeg, iend
02839                aa( i + ( j - 1 )*lda ) = a( i, j )
02840   110       \textcolor{keywordflow}{CONTINUE}
02841             \textcolor{keywordflow}{DO} 120 i = iend + 1, lda
02842                aa( i + ( j - 1 )*lda ) = rogue
02843   120       \textcolor{keywordflow}{CONTINUE}
02844             \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02845                jj = j + ( j - 1 )*lda
02846                aa( jj ) = cmplx( \textcolor{keywordtype}{REAL( AA( JJ ) )}, rrogue )
02847 \textcolor{keywordflow}{            END IF}
02848   130    \textcolor{keywordflow}{CONTINUE}
02849       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HB'}.OR.type.EQ.\textcolor{stringliteral}{'TB'} )\textcolor{keywordflow}{THEN}
02850          \textcolor{keywordflow}{DO} 170 j = 1, n
02851             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02852                kk = kl + 1
02853                ibeg = max( 1, kl + 2 - j )
02854                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02855                   iend = kl
02856                \textcolor{keywordflow}{ELSE}
02857                   iend = kl + 1
02858 \textcolor{keywordflow}{               END IF}
02859             \textcolor{keywordflow}{ELSE}
02860                kk = 1
02861                \textcolor{keywordflow}{IF}( unit )\textcolor{keywordflow}{THEN}
02862                   ibeg = 2
02863                \textcolor{keywordflow}{ELSE}
02864                   ibeg = 1
02865 \textcolor{keywordflow}{               END IF}
02866                iend = min( kl + 1, 1 + m - j )
02867 \textcolor{keywordflow}{            END IF}
02868             \textcolor{keywordflow}{DO} 140 i = 1, ibeg - 1
02869                aa( i + ( j - 1 )*lda ) = rogue
02870   140       \textcolor{keywordflow}{CONTINUE}
02871             \textcolor{keywordflow}{DO} 150 i = ibeg, iend
02872                aa( i + ( j - 1 )*lda ) = a( i + j - kk, j )
02873   150       \textcolor{keywordflow}{CONTINUE}
02874             \textcolor{keywordflow}{DO} 160 i = iend + 1, lda
02875                aa( i + ( j - 1 )*lda ) = rogue
02876   160       \textcolor{keywordflow}{CONTINUE}
02877             \textcolor{keywordflow}{IF}( sym )\textcolor{keywordflow}{THEN}
02878                jj = kk + ( j - 1 )*lda
02879                aa( jj ) = cmplx( \textcolor{keywordtype}{REAL( AA( JJ ) )}, rrogue )
02880 \textcolor{keywordflow}{            END IF}
02881   170    \textcolor{keywordflow}{CONTINUE}
02882       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HP'}.OR.type.EQ.\textcolor{stringliteral}{'TP'} )\textcolor{keywordflow}{THEN}
02883          ioff = 0
02884          \textcolor{keywordflow}{DO} 190 j = 1, n
02885             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
02886                ibeg = 1
02887                iend = j
02888             \textcolor{keywordflow}{ELSE}
02889                ibeg = j
02890                iend = n
02891 \textcolor{keywordflow}{            END IF}
02892             \textcolor{keywordflow}{DO} 180 i = ibeg, iend
02893                ioff = ioff + 1
02894                aa( ioff ) = a( i, j )
02895                \textcolor{keywordflow}{IF}( i.EQ.j )\textcolor{keywordflow}{THEN}
02896                   \textcolor{keywordflow}{IF}( unit )
02897      $               aa( ioff ) = rogue
02898                   \textcolor{keywordflow}{IF}( sym )
02899      $               aa( ioff ) = cmplx( \textcolor{keywordtype}{REAL( AA( IOFF ) )}, rrogue )
02900 \textcolor{keywordflow}{               END IF}
02901   180       \textcolor{keywordflow}{CONTINUE}
02902   190    \textcolor{keywordflow}{CONTINUE}
02903 \textcolor{keywordflow}{      END IF}
02904       \textcolor{keywordflow}{RETURN}
02905 \textcolor{comment}{*}
02906 \textcolor{comment}{*     End of CMAKE.}
02907 \textcolor{comment}{*}
02908 \textcolor{keyword}{      END}
02909 \textcolor{keyword}{      SUBROUTINE }cmvch( TRANS, M, N, ALPHA, A, NMAX, X, INCX, BETA, Y,
02910      $                  INCY, YT, G, YY, EPS, ERR, FATAL, NOUT, MV )
02911 \textcolor{comment}{*}
02912 \textcolor{comment}{*  Checks the results of the computational tests.}
02913 \textcolor{comment}{*}
02914 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
02915 \textcolor{comment}{*}
02916 \textcolor{comment}{*  -- Written on 10-August-1987.}
02917 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
02918 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
02919 \textcolor{comment}{*}
02920 \textcolor{comment}{*     .. Parameters ..}
02921       \textcolor{keywordtype}{COMPLEX}            zero
02922       parameter( zero = ( 0.0, 0.0 ) )
02923       \textcolor{keywordtype}{REAL}               rzero, rone
02924       parameter( rzero = 0.0, rone = 1.0 )
02925 \textcolor{comment}{*     .. Scalar Arguments ..}
02926       \textcolor{keywordtype}{COMPLEX}            alpha, beta
02927       \textcolor{keywordtype}{REAL}               eps, err
02928       \textcolor{keywordtype}{INTEGER}            incx, incy, m, n, nmax, nout
02929       \textcolor{keywordtype}{LOGICAL}            fatal, mv
02930       \textcolor{keywordtype}{CHARACTER*1}        trans
02931 \textcolor{comment}{*     .. Array Arguments ..}
02932       \textcolor{keywordtype}{COMPLEX}            a( nmax, * ), x( * ), y( * ), yt( * ), yy( * )
02933       \textcolor{keywordtype}{REAL}               g( * )
02934 \textcolor{comment}{*     .. Local Scalars ..}
02935       \textcolor{keywordtype}{COMPLEX}            c
02936       \textcolor{keywordtype}{REAL}               erri
02937       \textcolor{keywordtype}{INTEGER}            i, incxl, incyl, iy, j, jx, kx, ky, ml, nl
02938       \textcolor{keywordtype}{LOGICAL}            ctran, tran
02939 \textcolor{comment}{*     .. Intrinsic Functions ..}
02940       \textcolor{keywordtype}{INTRINSIC}          abs, aimag, conjg, max, \textcolor{keywordtype}{REAL}, sqrt
02941 \textcolor{comment}{*     .. Statement Functions ..}
02942       \textcolor{keywordtype}{REAL}               abs1
02943 \textcolor{comment}{*     .. Statement Function definitions ..}
02944       abs1( c ) = abs( \textcolor{keywordtype}{REAL( C )} ) + abs( aimag( c ) )
02945 \textcolor{comment}{*     .. Executable Statements ..}
02946       tran = trans.EQ.\textcolor{stringliteral}{'T'}
02947       ctran = trans.EQ.\textcolor{stringliteral}{'C'}
02948       \textcolor{keywordflow}{IF}( tran.OR.ctran )\textcolor{keywordflow}{THEN}
02949          ml = n
02950          nl = m
02951       \textcolor{keywordflow}{ELSE}
02952          ml = m
02953          nl = n
02954 \textcolor{keywordflow}{      END IF}
02955       \textcolor{keywordflow}{IF}( incx.LT.0 )\textcolor{keywordflow}{THEN}
02956          kx = nl
02957          incxl = -1
02958       \textcolor{keywordflow}{ELSE}
02959          kx = 1
02960          incxl = 1
02961 \textcolor{keywordflow}{      END IF}
02962       \textcolor{keywordflow}{IF}( incy.LT.0 )\textcolor{keywordflow}{THEN}
02963          ky = ml
02964          incyl = -1
02965       \textcolor{keywordflow}{ELSE}
02966          ky = 1
02967          incyl = 1
02968 \textcolor{keywordflow}{      END IF}
02969 \textcolor{comment}{*}
02970 \textcolor{comment}{*     Compute expected result in YT using data in A, X and Y.}
02971 \textcolor{comment}{*     Compute gauges in G.}
02972 \textcolor{comment}{*}
02973       iy = ky
02974       \textcolor{keywordflow}{DO} 40 i = 1, ml
02975          yt( iy ) = zero
02976          g( iy ) = rzero
02977          jx = kx
02978          \textcolor{keywordflow}{IF}( tran )\textcolor{keywordflow}{THEN}
02979             \textcolor{keywordflow}{DO} 10 j = 1, nl
02980                yt( iy ) = yt( iy ) + a( j, i )*x( jx )
02981                g( iy ) = g( iy ) + abs1( a( j, i ) )*abs1( x( jx ) )
02982                jx = jx + incxl
02983    10       \textcolor{keywordflow}{CONTINUE}
02984          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( ctran )\textcolor{keywordflow}{THEN}
02985             \textcolor{keywordflow}{DO} 20 j = 1, nl
02986                yt( iy ) = yt( iy ) + conjg( a( j, i ) )*x( jx )
02987                g( iy ) = g( iy ) + abs1( a( j, i ) )*abs1( x( jx ) )
02988                jx = jx + incxl
02989    20       \textcolor{keywordflow}{CONTINUE}
02990          \textcolor{keywordflow}{ELSE}
02991             \textcolor{keywordflow}{DO} 30 j = 1, nl
02992                yt( iy ) = yt( iy ) + a( i, j )*x( jx )
02993                g( iy ) = g( iy ) + abs1( a( i, j ) )*abs1( x( jx ) )
02994                jx = jx + incxl
02995    30       \textcolor{keywordflow}{CONTINUE}
02996 \textcolor{keywordflow}{         END IF}
02997          yt( iy ) = alpha*yt( iy ) + beta*y( iy )
02998          g( iy ) = abs1( alpha )*g( iy ) + abs1( beta )*abs1( y( iy ) )
02999          iy = iy + incyl
03000    40 \textcolor{keywordflow}{CONTINUE}
03001 \textcolor{comment}{*}
03002 \textcolor{comment}{*     Compute the error ratio for this result.}
03003 \textcolor{comment}{*}
03004       err = zero
03005       \textcolor{keywordflow}{DO} 50 i = 1, ml
03006          erri = abs( yt( i ) - yy( 1 + ( i - 1 )*abs( incy ) ) )/eps
03007          \textcolor{keywordflow}{IF}( g( i ).NE.rzero )
03008      $      erri = erri/g( i )
03009          err = max( err, erri )
03010          \textcolor{keywordflow}{IF}( err*sqrt( eps ).GE.rone )
03011      $      \textcolor{keywordflow}{GO TO} 60
03012    50 \textcolor{keywordflow}{CONTINUE}
03013 \textcolor{comment}{*     If the loop completes, all results are at least half accurate.}
03014       \textcolor{keywordflow}{GO TO} 80
03015 \textcolor{comment}{*}
03016 \textcolor{comment}{*     Report fatal error.}
03017 \textcolor{comment}{*}
03018    60 fatal = .true.
03019       \textcolor{keyword}{WRITE}( nout, fmt = 9999 )
03020       \textcolor{keywordflow}{DO} 70 i = 1, ml
03021          \textcolor{keywordflow}{IF}( mv )\textcolor{keywordflow}{THEN}
03022             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i, yt( i ),
03023      $         yy( 1 + ( i - 1 )*abs( incy ) )
03024          \textcolor{keywordflow}{ELSE}
03025             \textcolor{keyword}{WRITE}( nout, fmt = 9998 )i,
03026      $         yy( 1 + ( i - 1 )*abs( incy ) ), yt( i )
03027 \textcolor{keywordflow}{         END IF}
03028    70 \textcolor{keywordflow}{CONTINUE}
03029 \textcolor{comment}{*}
03030    80 \textcolor{keywordflow}{CONTINUE}
03031       \textcolor{keywordflow}{RETURN}
03032 \textcolor{comment}{*}
03033  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* FATAL ERROR - COMPUTED RESULT IS LESS THAN HAL'},
03034      $      \textcolor{stringliteral}{'F ACCURATE *******'}, /\textcolor{stringliteral}{'                       EXPECTED RE'},
03035      $      \textcolor{stringliteral}{'SULT                    COMPUTED RESULT'} )
03036  9998 \textcolor{keyword}{FORMAT}( 1x, i7, 2( \textcolor{stringliteral}{'  ('}, g15.6, \textcolor{stringliteral}{','}, g15.6, \textcolor{stringliteral}{')'} ) )
03037 \textcolor{comment}{*}
03038 \textcolor{comment}{*     End of CMVCH.}
03039 \textcolor{comment}{*}
03040 \textcolor{keyword}{      END}
03041 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lce( RI, RJ, LR )
03042 \textcolor{comment}{*}
03043 \textcolor{comment}{*  Tests if two arrays are identical.}
03044 \textcolor{comment}{*}
03045 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03046 \textcolor{comment}{*}
03047 \textcolor{comment}{*  -- Written on 10-August-1987.}
03048 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03049 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03050 \textcolor{comment}{*}
03051 \textcolor{comment}{*     .. Scalar Arguments ..}
03052       \textcolor{keywordtype}{INTEGER}            lr
03053 \textcolor{comment}{*     .. Array Arguments ..}
03054       \textcolor{keywordtype}{COMPLEX}            ri( * ), rj( * )
03055 \textcolor{comment}{*     .. Local Scalars ..}
03056       \textcolor{keywordtype}{INTEGER}            i
03057 \textcolor{comment}{*     .. Executable Statements ..}
03058       \textcolor{keywordflow}{DO} 10 i = 1, lr
03059          \textcolor{keywordflow}{IF}( ri( i ).NE.rj( i ) )
03060      $      \textcolor{keywordflow}{GO TO} 20
03061    10 \textcolor{keywordflow}{CONTINUE}
03062       lce = .true.
03063       \textcolor{keywordflow}{GO TO} 30
03064    20 \textcolor{keywordflow}{CONTINUE}
03065       lce = .false.
03066    30 \textcolor{keywordflow}{RETURN}
03067 \textcolor{comment}{*}
03068 \textcolor{comment}{*     End of LCE.}
03069 \textcolor{comment}{*}
03070 \textcolor{keyword}{      END}
03071 \textcolor{keyword}{      LOGICAL }\textcolor{keyword}{FUNCTION }lceres( TYPE, UPLO, M, N, AA, AS, LDA )
03072 \textcolor{comment}{*}
03073 \textcolor{comment}{*  Tests if selected elements in two arrays are equal.}
03074 \textcolor{comment}{*}
03075 \textcolor{comment}{*  TYPE is 'GE', 'HE' or 'HP'.}
03076 \textcolor{comment}{*}
03077 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03078 \textcolor{comment}{*}
03079 \textcolor{comment}{*  -- Written on 10-August-1987.}
03080 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03081 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03082 \textcolor{comment}{*}
03083 \textcolor{comment}{*     .. Scalar Arguments ..}
03084       \textcolor{keywordtype}{INTEGER}            lda, m, n
03085       \textcolor{keywordtype}{CHARACTER*1}        uplo
03086       \textcolor{keywordtype}{CHARACTER*2}        type
03087 \textcolor{comment}{*     .. Array Arguments ..}
03088       \textcolor{keywordtype}{COMPLEX}            aa( lda, * ), as( lda, * )
03089 \textcolor{comment}{*     .. Local Scalars ..}
03090       \textcolor{keywordtype}{INTEGER}            i, ibeg, iend, j
03091       \textcolor{keywordtype}{LOGICAL}            upper
03092 \textcolor{comment}{*     .. Executable Statements ..}
03093       upper = uplo.EQ.\textcolor{stringliteral}{'U'}
03094       \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'GE'} )\textcolor{keywordflow}{THEN}
03095          \textcolor{keywordflow}{DO} 20 j = 1, n
03096             \textcolor{keywordflow}{DO} 10 i = m + 1, lda
03097                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03098      $            \textcolor{keywordflow}{GO TO} 70
03099    10       \textcolor{keywordflow}{CONTINUE}
03100    20    \textcolor{keywordflow}{CONTINUE}
03101       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF}( type.EQ.\textcolor{stringliteral}{'HE'} )\textcolor{keywordflow}{THEN}
03102          \textcolor{keywordflow}{DO} 50 j = 1, n
03103             \textcolor{keywordflow}{IF}( upper )\textcolor{keywordflow}{THEN}
03104                ibeg = 1
03105                iend = j
03106             \textcolor{keywordflow}{ELSE}
03107                ibeg = j
03108                iend = n
03109 \textcolor{keywordflow}{            END IF}
03110             \textcolor{keywordflow}{DO} 30 i = 1, ibeg - 1
03111                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03112      $            \textcolor{keywordflow}{GO TO} 70
03113    30       \textcolor{keywordflow}{CONTINUE}
03114             \textcolor{keywordflow}{DO} 40 i = iend + 1, lda
03115                \textcolor{keywordflow}{IF}( aa( i, j ).NE.as( i, j ) )
03116      $            \textcolor{keywordflow}{GO TO} 70
03117    40       \textcolor{keywordflow}{CONTINUE}
03118    50    \textcolor{keywordflow}{CONTINUE}
03119 \textcolor{keywordflow}{      END IF}
03120 \textcolor{comment}{*}
03121       lceres = .true.
03122       \textcolor{keywordflow}{GO TO} 80
03123    70 \textcolor{keywordflow}{CONTINUE}
03124       lceres = .false.
03125    80 \textcolor{keywordflow}{RETURN}
03126 \textcolor{comment}{*}
03127 \textcolor{comment}{*     End of LCERES.}
03128 \textcolor{comment}{*}
03129 \textcolor{keyword}{      END}
03130 \textcolor{keyword}{      COMPLEX }\textcolor{keyword}{FUNCTION }cbeg( RESET )
03131 \textcolor{comment}{*}
03132 \textcolor{comment}{*  Generates complex numbers as pairs of random numbers uniformly}
03133 \textcolor{comment}{*  distributed between -0.5 and 0.5.}
03134 \textcolor{comment}{*}
03135 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03136 \textcolor{comment}{*}
03137 \textcolor{comment}{*  -- Written on 10-August-1987.}
03138 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03139 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03140 \textcolor{comment}{*}
03141 \textcolor{comment}{*     .. Scalar Arguments ..}
03142       \textcolor{keywordtype}{LOGICAL}            reset
03143 \textcolor{comment}{*     .. Local Scalars ..}
03144       \textcolor{keywordtype}{INTEGER}            i, ic, j, mi, mj
03145 \textcolor{comment}{*     .. Save statement ..}
03146       \textcolor{keywordtype}{SAVE}               i, ic, j, mi, mj
03147 \textcolor{comment}{*     .. Intrinsic Functions ..}
03148       \textcolor{keywordtype}{INTRINSIC}          cmplx
03149 \textcolor{comment}{*     .. Executable Statements ..}
03150       \textcolor{keywordflow}{IF}( reset )\textcolor{keywordflow}{THEN}
03151 \textcolor{comment}{*        Initialize local variables.}
03152          mi = 891
03153          mj = 457
03154          i = 7
03155          j = 7
03156          ic = 0
03157          reset = .false.
03158 \textcolor{keywordflow}{      END IF}
03159 \textcolor{comment}{*}
03160 \textcolor{comment}{*     The sequence of values of I or J is bounded between 1 and 999.}
03161 \textcolor{comment}{*     If initial I or J = 1,2,3,6,7 or 9, the period will be 50.}
03162 \textcolor{comment}{*     If initial I or J = 4 or 8, the period will be 25.}
03163 \textcolor{comment}{*     If initial I or J = 5, the period will be 10.}
03164 \textcolor{comment}{*     IC is used to break up the period by skipping 1 value of I or J}
03165 \textcolor{comment}{*     in 6.}
03166 \textcolor{comment}{*}
03167       ic = ic + 1
03168    10 i = i*mi
03169       j = j*mj
03170       i = i - 1000*( i/1000 )
03171       j = j - 1000*( j/1000 )
03172       \textcolor{keywordflow}{IF}( ic.GE.5 )\textcolor{keywordflow}{THEN}
03173          ic = 0
03174          \textcolor{keywordflow}{GO TO} 10
03175 \textcolor{keywordflow}{      END IF}
03176       cbeg = cmplx( ( i - 500 )/1001.0, ( j - 500 )/1001.0 )
03177       \textcolor{keywordflow}{RETURN}
03178 \textcolor{comment}{*}
03179 \textcolor{comment}{*     End of CBEG.}
03180 \textcolor{comment}{*}
03181 \textcolor{keyword}{      END}
03182 \textcolor{keyword}{      REAL }\textcolor{keyword}{FUNCTION }sdiff( X, Y )
03183 \textcolor{comment}{*}
03184 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03185 \textcolor{comment}{*}
03186 \textcolor{comment}{*  -- Written on 10-August-1987.}
03187 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03188 \textcolor{comment}{*}
03189 \textcolor{comment}{*     .. Scalar Arguments ..}
03190       \textcolor{keywordtype}{REAL}               x, y
03191 \textcolor{comment}{*     .. Executable Statements ..}
03192       sdiff = x - y
03193       \textcolor{keywordflow}{RETURN}
03194 \textcolor{comment}{*}
03195 \textcolor{comment}{*     End of SDIFF.}
03196 \textcolor{comment}{*}
03197 \textcolor{keyword}{      END}
03198 \textcolor{keyword}{      SUBROUTINE }chkxer( SRNAMT, INFOT, NOUT, LERR, OK )
03199 \textcolor{comment}{*}
03200 \textcolor{comment}{*  Tests whether XERBLA has detected an error when it should.}
03201 \textcolor{comment}{*}
03202 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03203 \textcolor{comment}{*}
03204 \textcolor{comment}{*  -- Written on 10-August-1987.}
03205 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03206 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03207 \textcolor{comment}{*}
03208 \textcolor{comment}{*     .. Scalar Arguments ..}
03209       \textcolor{keywordtype}{INTEGER}            infot, nout
03210       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03211       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03212 \textcolor{comment}{*     .. Executable Statements ..}
03213       \textcolor{keywordflow}{IF}( .NOT.lerr )\textcolor{keywordflow}{THEN}
03214          \textcolor{keyword}{WRITE}( nout, fmt = 9999 )infot, srnamt
03215          ok = .false.
03216 \textcolor{keywordflow}{      END IF}
03217       lerr = .false.
03218       \textcolor{keywordflow}{RETURN}
03219 \textcolor{comment}{*}
03220  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ***** ILLEGAL VALUE OF PARAMETER NUMBER '}, i2, \textcolor{stringliteral}{' NOT D'},
03221      $      \textcolor{stringliteral}{'ETECTED BY '}, a6, \textcolor{stringliteral}{' *****'} )
03222 \textcolor{comment}{*}
03223 \textcolor{comment}{*     End of CHKXER.}
03224 \textcolor{comment}{*}
03225 \textcolor{keyword}{      END}
03226 \textcolor{keyword}{      SUBROUTINE }xerbla( SRNAME, INFO )
03227 \textcolor{comment}{*}
03228 \textcolor{comment}{*  This is a special version of XERBLA to be used only as part of}
03229 \textcolor{comment}{*  the test program for testing error exits from the Level 2 BLAS}
03230 \textcolor{comment}{*  routines.}
03231 \textcolor{comment}{*}
03232 \textcolor{comment}{*  XERBLA  is an error handler for the Level 2 BLAS routines.}
03233 \textcolor{comment}{*}
03234 \textcolor{comment}{*  It is called by the Level 2 BLAS routines if an input parameter is}
03235 \textcolor{comment}{*  invalid.}
03236 \textcolor{comment}{*}
03237 \textcolor{comment}{*  Auxiliary routine for test program for Level 2 Blas.}
03238 \textcolor{comment}{*}
03239 \textcolor{comment}{*  -- Written on 10-August-1987.}
03240 \textcolor{comment}{*     Richard Hanson, Sandia National Labs.}
03241 \textcolor{comment}{*     Jeremy Du Croz, NAG Central Office.}
03242 \textcolor{comment}{*}
03243 \textcolor{comment}{*     .. Scalar Arguments ..}
03244       \textcolor{keywordtype}{INTEGER}            info
03245       \textcolor{keywordtype}{CHARACTER*6}        srname
03246 \textcolor{comment}{*     .. Scalars in Common ..}
03247       \textcolor{keywordtype}{INTEGER}            infot, nout
03248       \textcolor{keywordtype}{LOGICAL}            lerr, ok
03249       \textcolor{keywordtype}{CHARACTER*6}        srnamt
03250 \textcolor{comment}{*     .. Common blocks ..}
03251       \textcolor{keyword}{COMMON}             /infoc/infot, nout, ok, lerr
03252       \textcolor{keyword}{COMMON}             /srnamc/srnamt
03253 \textcolor{comment}{*     .. Executable Statements ..}
03254       lerr = .true.
03255       \textcolor{keywordflow}{IF}( info.NE.infot )\textcolor{keywordflow}{THEN}
03256          \textcolor{keywordflow}{IF}( infot.NE.0 )\textcolor{keywordflow}{THEN}
03257             \textcolor{keyword}{WRITE}( nout, fmt = 9999 )info, infot
03258          \textcolor{keywordflow}{ELSE}
03259             \textcolor{keyword}{WRITE}( nout, fmt = 9997 )info
03260 \textcolor{keywordflow}{         END IF}
03261          ok = .false.
03262 \textcolor{keywordflow}{      END IF}
03263       \textcolor{keywordflow}{IF}( srname.NE.srnamt )\textcolor{keywordflow}{THEN}
03264          \textcolor{keyword}{WRITE}( nout, fmt = 9998 )srname, srnamt
03265          ok = .false.
03266 \textcolor{keywordflow}{      END IF}
03267       \textcolor{keywordflow}{RETURN}
03268 \textcolor{comment}{*}
03269  9999 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6, \textcolor{stringliteral}{' INSTEAD'},
03270      $      \textcolor{stringliteral}{' OF '}, i2, \textcolor{stringliteral}{' *******'} )
03271  9998 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH SRNAME = '}, a6, \textcolor{stringliteral}{' INSTE'},
03272      $      \textcolor{stringliteral}{'AD OF '}, a6, \textcolor{stringliteral}{' *******'} )
03273  9997 \textcolor{keyword}{FORMAT}( \textcolor{stringliteral}{' ******* XERBLA WAS CALLED WITH INFO = '}, i6,
03274      $      \textcolor{stringliteral}{' *******'} )
03275 \textcolor{comment}{*}
03276 \textcolor{comment}{*     End of XERBLA}
03277 \textcolor{comment}{*}
03278 \textcolor{keyword}{      END}
03279 
\end{DoxyCode}
