\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2testing_2zblat1_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/testing/zblat1.f}
\label{matio_2visual__studio_2test_2eigen_2blas_2testing_2zblat1_8f_source}\index{zblat1.\+f@{zblat1.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b ZBLAT1}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*  Definition:}
00009 \textcolor{comment}{*  ===========}
00010 \textcolor{comment}{*}
00011 \textcolor{comment}{*       PROGRAM ZBLAT1}
00012 \textcolor{comment}{* }
00013 \textcolor{comment}{*}
00014 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00015 \textcolor{comment}{*  =============}
00016 \textcolor{comment}{*>}
00017 \textcolor{comment}{*> \(\backslash\)verbatim}
00018 \textcolor{comment}{*>}
00019 \textcolor{comment}{*>    Test program for the COMPLEX*16 Level 1 BLAS.}
00020 \textcolor{comment}{*>}
00021 \textcolor{comment}{*>    Based upon the original BLAS test routine together with:}
00022 \textcolor{comment}{*>    F06GAF Example Program Text}
00023 \textcolor{comment}{*> \(\backslash\)endverbatim}
00024 \textcolor{comment}{*}
00025 \textcolor{comment}{*  Authors:}
00026 \textcolor{comment}{*  ========}
00027 \textcolor{comment}{*}
00028 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00029 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00030 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00031 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00032 \textcolor{comment}{*}
00033 \textcolor{comment}{*> \(\backslash\)date April 2012}
00034 \textcolor{comment}{*}
00035 \textcolor{comment}{*> \(\backslash\)ingroup complex16\_blas\_testing}
00036 \textcolor{comment}{*}
00037 \textcolor{comment}{*  =====================================================================}
00038       \textcolor{keyword}{PROGRAM} zblat1
00039 \textcolor{comment}{*}
00040 \textcolor{comment}{*  -- Reference BLAS test routine (version 3.4.1) --}
00041 \textcolor{comment}{*  -- Reference BLAS is a software package provided by Univ. of Tennessee,    --}
00042 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00043 \textcolor{comment}{*     April 2012}
00044 \textcolor{comment}{*}
00045 \textcolor{comment}{*  =====================================================================}
00046 \textcolor{comment}{*}
00047 \textcolor{comment}{*     .. Parameters ..}
00048       \textcolor{keywordtype}{INTEGER}          nout
00049       parameter(nout=6)
00050 \textcolor{comment}{*     .. Scalars in Common ..}
00051       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, mode, n
00052       \textcolor{keywordtype}{LOGICAL}          pass
00053 \textcolor{comment}{*     .. Local Scalars ..}
00054       \textcolor{keywordtype}{DOUBLE PRECISION} sfac
00055       \textcolor{keywordtype}{INTEGER}          ic
00056 \textcolor{comment}{*     .. External Subroutines ..}
00057       \textcolor{keywordtype}{EXTERNAL}         check1, check2, header
00058 \textcolor{comment}{*     .. Common blocks ..}
00059       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, mode, pass
00060 \textcolor{comment}{*     .. Data statements ..}
00061       \textcolor{keyword}{DATA}             sfac/9.765625d-4/
00062 \textcolor{comment}{*     .. Executable Statements ..}
00063       \textcolor{keyword}{WRITE} (nout,99999)
00064       \textcolor{keywordflow}{DO} 20 ic = 1, 10
00065          icase = ic
00066          \textcolor{keyword}{CALL }header
00067 \textcolor{comment}{*}
00068 \textcolor{comment}{*        Initialize PASS, INCX, INCY, and MODE for a new case.}
00069 \textcolor{comment}{*        The value 9999 for INCX, INCY or MODE will appear in the}
00070 \textcolor{comment}{*        detailed  output, if any, for cases that do not involve}
00071 \textcolor{comment}{*        these parameters.}
00072 \textcolor{comment}{*}
00073          pass = .true.
00074          incx = 9999
00075          incy = 9999
00076          mode = 9999
00077          \textcolor{keywordflow}{IF} (icase.LE.5) \textcolor{keywordflow}{THEN}
00078             \textcolor{keyword}{CALL }check2(sfac)
00079          \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.GE.6) \textcolor{keywordflow}{THEN}
00080             \textcolor{keyword}{CALL }check1(sfac)
00081 \textcolor{keywordflow}{         END IF}
00082 \textcolor{comment}{*        -- Print}
00083          \textcolor{keywordflow}{IF} (pass) \textcolor{keyword}{WRITE} (nout,99998)
00084    20 \textcolor{keywordflow}{CONTINUE}
00085       stop
00086 \textcolor{comment}{*}
00087 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{' Complex BLAS Test Program Results'},/1x)
00088 99998 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                    ----- PASS -----'})
00089 \textcolor{keyword}{      END}
00090 \textcolor{keyword}{      SUBROUTINE }header
00091 \textcolor{comment}{*     .. Parameters ..}
00092       \textcolor{keywordtype}{INTEGER}          nout
00093       parameter(nout=6)
00094 \textcolor{comment}{*     .. Scalars in Common ..}
00095       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, mode, n
00096       \textcolor{keywordtype}{LOGICAL}          pass
00097 \textcolor{comment}{*     .. Local Arrays ..}
00098       \textcolor{keywordtype}{CHARACTER*6}      l(10)
00099 \textcolor{comment}{*     .. Common blocks ..}
00100       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, mode, pass
00101 \textcolor{comment}{*     .. Data statements ..}
00102       \textcolor{keyword}{DATA}             l(1)/\textcolor{stringliteral}{'ZDOTC '}/
00103       \textcolor{keyword}{DATA}             l(2)/\textcolor{stringliteral}{'ZDOTU '}/
00104       \textcolor{keyword}{DATA}             l(3)/\textcolor{stringliteral}{'ZAXPY '}/
00105       \textcolor{keyword}{DATA}             l(4)/\textcolor{stringliteral}{'ZCOPY '}/
00106       \textcolor{keyword}{DATA}             l(5)/\textcolor{stringliteral}{'ZSWAP '}/
00107       \textcolor{keyword}{DATA}             l(6)/\textcolor{stringliteral}{'DZNRM2'}/
00108       \textcolor{keyword}{DATA}             l(7)/\textcolor{stringliteral}{'DZASUM'}/
00109       \textcolor{keyword}{DATA}             l(8)/\textcolor{stringliteral}{'ZSCAL '}/
00110       \textcolor{keyword}{DATA}             l(9)/\textcolor{stringliteral}{'ZDSCAL'}/
00111       \textcolor{keyword}{DATA}             l(10)/\textcolor{stringliteral}{'IZAMAX'}/
00112 \textcolor{comment}{*     .. Executable Statements ..}
00113       \textcolor{keyword}{WRITE} (nout,99999) icase, l(icase)
00114       \textcolor{keywordflow}{RETURN}
00115 \textcolor{comment}{*}
00116 99999 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' Test of subprogram number'},i3,12x,a6)
00117 \textcolor{keyword}{      END}
00118 \textcolor{keyword}{      SUBROUTINE }check1(SFAC)
00119 \textcolor{comment}{*     .. Parameters ..}
00120       \textcolor{keywordtype}{INTEGER}           nout
00121       parameter(nout=6)
00122 \textcolor{comment}{*     .. Scalar Arguments ..}
00123       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00124 \textcolor{comment}{*     .. Scalars in Common ..}
00125       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, mode, n
00126       \textcolor{keywordtype}{LOGICAL}           pass
00127 \textcolor{comment}{*     .. Local Scalars ..}
00128       \textcolor{keywordtype}{COMPLEX*16}        ca
00129       \textcolor{keywordtype}{DOUBLE PRECISION}  sa
00130       \textcolor{keywordtype}{INTEGER}           i, j, len, np1
00131 \textcolor{comment}{*     .. Local Arrays ..}
00132       \textcolor{keywordtype}{COMPLEX*16}        ctrue5(8,5,2), ctrue6(8,5,2), cv(8,5,2), cx(8),
00133      +                  mwpcs(5), mwpct(5)
00134       \textcolor{keywordtype}{DOUBLE PRECISION}  strue2(5), strue4(5)
00135       \textcolor{keywordtype}{INTEGER}           itrue3(5)
00136 \textcolor{comment}{*     .. External Functions ..}
00137       \textcolor{keywordtype}{DOUBLE PRECISION}  dzasum, dznrm2
00138       \textcolor{keywordtype}{INTEGER}           izamax
00139       \textcolor{keywordtype}{EXTERNAL}          dzasum, dznrm2, izamax
00140 \textcolor{comment}{*     .. External Subroutines ..}
00141       \textcolor{keywordtype}{EXTERNAL}          zscal, zdscal, ctest, itest1, stest1
00142 \textcolor{comment}{*     .. Intrinsic Functions ..}
00143       \textcolor{keywordtype}{INTRINSIC}         max
00144 \textcolor{comment}{*     .. Common blocks ..}
00145       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, mode, pass
00146 \textcolor{comment}{*     .. Data statements ..}
00147       \textcolor{keyword}{DATA}              sa, ca/0.3d0, (0.4d0,-0.7d0)/
00148       \textcolor{keyword}{DATA}              ((cv(i,j,1),i=1,8),j=1,5)/(0.1d0,0.1d0),
00149      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00150      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00151      +                  (1.0d0,2.0d0), (0.3d0,-0.4d0), (3.0d0,4.0d0),
00152      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00153      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00154      +                  (0.1d0,-0.3d0), (0.5d0,-0.1d0), (5.0d0,6.0d0),
00155      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (5.0d0,6.0d0),
00156      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (0.1d0,0.1d0),
00157      +                  (-0.6d0,0.1d0), (0.1d0,-0.3d0), (7.0d0,8.0d0),
00158      +                  (7.0d0,8.0d0), (7.0d0,8.0d0), (7.0d0,8.0d0),
00159      +                  (7.0d0,8.0d0), (0.3d0,0.1d0), (0.5d0,0.0d0),
00160      +                  (0.0d0,0.5d0), (0.0d0,0.2d0), (2.0d0,3.0d0),
00161      +                  (2.0d0,3.0d0), (2.0d0,3.0d0), (2.0d0,3.0d0)/
00162       \textcolor{keyword}{DATA}              ((cv(i,j,2),i=1,8),j=1,5)/(0.1d0,0.1d0),
00163      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00164      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00165      +                  (4.0d0,5.0d0), (0.3d0,-0.4d0), (6.0d0,7.0d0),
00166      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00167      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00168      +                  (0.1d0,-0.3d0), (8.0d0,9.0d0), (0.5d0,-0.1d0),
00169      +                  (2.0d0,5.0d0), (2.0d0,5.0d0), (2.0d0,5.0d0),
00170      +                  (2.0d0,5.0d0), (2.0d0,5.0d0), (0.1d0,0.1d0),
00171      +                  (3.0d0,6.0d0), (-0.6d0,0.1d0), (4.0d0,7.0d0),
00172      +                  (0.1d0,-0.3d0), (7.0d0,2.0d0), (7.0d0,2.0d0),
00173      +                  (7.0d0,2.0d0), (0.3d0,0.1d0), (5.0d0,8.0d0),
00174      +                  (0.5d0,0.0d0), (6.0d0,9.0d0), (0.0d0,0.5d0),
00175      +                  (8.0d0,3.0d0), (0.0d0,0.2d0), (9.0d0,4.0d0)/
00176       \textcolor{keyword}{DATA}              strue2/0.0d0, 0.5d0, 0.6d0, 0.7d0, 0.8d0/
00177       \textcolor{keyword}{DATA}              strue4/0.0d0, 0.7d0, 1.0d0, 1.3d0, 1.6d0/
00178       \textcolor{keyword}{DATA}              ((ctrue5(i,j,1),i=1,8),j=1,5)/(0.1d0,0.1d0),
00179      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00180      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00181      +                  (1.0d0,2.0d0), (-0.16d0,-0.37d0), (3.0d0,4.0d0),
00182      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00183      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00184      +                  (-0.17d0,-0.19d0), (0.13d0,-0.39d0),
00185      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (5.0d0,6.0d0),
00186      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (5.0d0,6.0d0),
00187      +                  (0.11d0,-0.03d0), (-0.17d0,0.46d0),
00188      +                  (-0.17d0,-0.19d0), (7.0d0,8.0d0), (7.0d0,8.0d0),
00189      +                  (7.0d0,8.0d0), (7.0d0,8.0d0), (7.0d0,8.0d0),
00190      +                  (0.19d0,-0.17d0), (0.20d0,-0.35d0),
00191      +                  (0.35d0,0.20d0), (0.14d0,0.08d0),
00192      +                  (2.0d0,3.0d0), (2.0d0,3.0d0), (2.0d0,3.0d0),
00193      +                  (2.0d0,3.0d0)/
00194       \textcolor{keyword}{DATA}              ((ctrue5(i,j,2),i=1,8),j=1,5)/(0.1d0,0.1d0),
00195      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00196      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00197      +                  (4.0d0,5.0d0), (-0.16d0,-0.37d0), (6.0d0,7.0d0),
00198      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00199      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00200      +                  (-0.17d0,-0.19d0), (8.0d0,9.0d0),
00201      +                  (0.13d0,-0.39d0), (2.0d0,5.0d0), (2.0d0,5.0d0),
00202      +                  (2.0d0,5.0d0), (2.0d0,5.0d0), (2.0d0,5.0d0),
00203      +                  (0.11d0,-0.03d0), (3.0d0,6.0d0),
00204      +                  (-0.17d0,0.46d0), (4.0d0,7.0d0),
00205      +                  (-0.17d0,-0.19d0), (7.0d0,2.0d0), (7.0d0,2.0d0),
00206      +                  (7.0d0,2.0d0), (0.19d0,-0.17d0), (5.0d0,8.0d0),
00207      +                  (0.20d0,-0.35d0), (6.0d0,9.0d0),
00208      +                  (0.35d0,0.20d0), (8.0d0,3.0d0),
00209      +                  (0.14d0,0.08d0), (9.0d0,4.0d0)/
00210       \textcolor{keyword}{DATA}              ((ctrue6(i,j,1),i=1,8),j=1,5)/(0.1d0,0.1d0),
00211      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00212      +                  (1.0d0,2.0d0), (1.0d0,2.0d0), (1.0d0,2.0d0),
00213      +                  (1.0d0,2.0d0), (0.09d0,-0.12d0), (3.0d0,4.0d0),
00214      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00215      +                  (3.0d0,4.0d0), (3.0d0,4.0d0), (3.0d0,4.0d0),
00216      +                  (0.03d0,-0.09d0), (0.15d0,-0.03d0),
00217      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (5.0d0,6.0d0),
00218      +                  (5.0d0,6.0d0), (5.0d0,6.0d0), (5.0d0,6.0d0),
00219      +                  (0.03d0,0.03d0), (-0.18d0,0.03d0),
00220      +                  (0.03d0,-0.09d0), (7.0d0,8.0d0), (7.0d0,8.0d0),
00221      +                  (7.0d0,8.0d0), (7.0d0,8.0d0), (7.0d0,8.0d0),
00222      +                  (0.09d0,0.03d0), (0.15d0,0.00d0),
00223      +                  (0.00d0,0.15d0), (0.00d0,0.06d0), (2.0d0,3.0d0),
00224      +                  (2.0d0,3.0d0), (2.0d0,3.0d0), (2.0d0,3.0d0)/
00225       \textcolor{keyword}{DATA}              ((ctrue6(i,j,2),i=1,8),j=1,5)/(0.1d0,0.1d0),
00226      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00227      +                  (4.0d0,5.0d0), (4.0d0,5.0d0), (4.0d0,5.0d0),
00228      +                  (4.0d0,5.0d0), (0.09d0,-0.12d0), (6.0d0,7.0d0),
00229      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00230      +                  (6.0d0,7.0d0), (6.0d0,7.0d0), (6.0d0,7.0d0),
00231      +                  (0.03d0,-0.09d0), (8.0d0,9.0d0),
00232      +                  (0.15d0,-0.03d0), (2.0d0,5.0d0), (2.0d0,5.0d0),
00233      +                  (2.0d0,5.0d0), (2.0d0,5.0d0), (2.0d0,5.0d0),
00234      +                  (0.03d0,0.03d0), (3.0d0,6.0d0),
00235      +                  (-0.18d0,0.03d0), (4.0d0,7.0d0),
00236      +                  (0.03d0,-0.09d0), (7.0d0,2.0d0), (7.0d0,2.0d0),
00237      +                  (7.0d0,2.0d0), (0.09d0,0.03d0), (5.0d0,8.0d0),
00238      +                  (0.15d0,0.00d0), (6.0d0,9.0d0), (0.00d0,0.15d0),
00239      +                  (8.0d0,3.0d0), (0.00d0,0.06d0), (9.0d0,4.0d0)/
00240       \textcolor{keyword}{DATA}              itrue3/0, 1, 2, 2, 2/
00241 \textcolor{comment}{*     .. Executable Statements ..}
00242       \textcolor{keywordflow}{DO} 60 incx = 1, 2
00243          \textcolor{keywordflow}{DO} 40 np1 = 1, 5
00244             n = np1 - 1
00245             len = 2*max(n,1)
00246 \textcolor{comment}{*           .. Set vector arguments ..}
00247             \textcolor{keywordflow}{DO} 20 i = 1, len
00248                cx(i) = cv(i,np1,incx)
00249    20       \textcolor{keywordflow}{CONTINUE}
00250             \textcolor{keywordflow}{IF} (icase.EQ.6) \textcolor{keywordflow}{THEN}
00251 \textcolor{comment}{*              .. DZNRM2 ..}
00252                \textcolor{keyword}{CALL }stest1(dznrm2(n,cx,incx),strue2(np1),strue2(np1),
00253      +                     sfac)
00254             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.7) \textcolor{keywordflow}{THEN}
00255 \textcolor{comment}{*              .. DZASUM ..}
00256                \textcolor{keyword}{CALL }stest1(dzasum(n,cx,incx),strue4(np1),strue4(np1),
00257      +                     sfac)
00258             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.8) \textcolor{keywordflow}{THEN}
00259 \textcolor{comment}{*              .. ZSCAL ..}
00260                \textcolor{keyword}{CALL }zscal(n,ca,cx,incx)
00261                \textcolor{keyword}{CALL }ctest(len,cx,ctrue5(1,np1,incx),ctrue5(1,np1,incx),
00262      +                    sfac)
00263             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.9) \textcolor{keywordflow}{THEN}
00264 \textcolor{comment}{*              .. ZDSCAL ..}
00265                \textcolor{keyword}{CALL }zdscal(n,sa,cx,incx)
00266                \textcolor{keyword}{CALL }ctest(len,cx,ctrue6(1,np1,incx),ctrue6(1,np1,incx),
00267      +                    sfac)
00268             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.10) \textcolor{keywordflow}{THEN}
00269 \textcolor{comment}{*              .. IZAMAX ..}
00270                \textcolor{keyword}{CALL }itest1(izamax(n,cx,incx),itrue3(np1))
00271             \textcolor{keywordflow}{ELSE}
00272                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK1'}
00273                stop
00274 \textcolor{keywordflow}{            END IF}
00275 \textcolor{comment}{*}
00276    40    \textcolor{keywordflow}{CONTINUE}
00277    60 \textcolor{keywordflow}{CONTINUE}
00278 \textcolor{comment}{*}
00279       incx = 1
00280       \textcolor{keywordflow}{IF} (icase.EQ.8) \textcolor{keywordflow}{THEN}
00281 \textcolor{comment}{*        ZSCAL}
00282 \textcolor{comment}{*        Add a test for alpha equal to zero.}
00283          ca = (0.0d0,0.0d0)
00284          \textcolor{keywordflow}{DO} 80 i = 1, 5
00285             mwpct(i) = (0.0d0,0.0d0)
00286             mwpcs(i) = (1.0d0,1.0d0)
00287    80    \textcolor{keywordflow}{CONTINUE}
00288          \textcolor{keyword}{CALL }zscal(5,ca,cx,incx)
00289          \textcolor{keyword}{CALL }ctest(5,cx,mwpct,mwpcs,sfac)
00290       \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.9) \textcolor{keywordflow}{THEN}
00291 \textcolor{comment}{*        ZDSCAL}
00292 \textcolor{comment}{*        Add a test for alpha equal to zero.}
00293          sa = 0.0d0
00294          \textcolor{keywordflow}{DO} 100 i = 1, 5
00295             mwpct(i) = (0.0d0,0.0d0)
00296             mwpcs(i) = (1.0d0,1.0d0)
00297   100    \textcolor{keywordflow}{CONTINUE}
00298          \textcolor{keyword}{CALL }zdscal(5,sa,cx,incx)
00299          \textcolor{keyword}{CALL }ctest(5,cx,mwpct,mwpcs,sfac)
00300 \textcolor{comment}{*        Add a test for alpha equal to one.}
00301          sa = 1.0d0
00302          \textcolor{keywordflow}{DO} 120 i = 1, 5
00303             mwpct(i) = cx(i)
00304             mwpcs(i) = cx(i)
00305   120    \textcolor{keywordflow}{CONTINUE}
00306          \textcolor{keyword}{CALL }zdscal(5,sa,cx,incx)
00307          \textcolor{keyword}{CALL }ctest(5,cx,mwpct,mwpcs,sfac)
00308 \textcolor{comment}{*        Add a test for alpha equal to minus one.}
00309          sa = -1.0d0
00310          \textcolor{keywordflow}{DO} 140 i = 1, 5
00311             mwpct(i) = -cx(i)
00312             mwpcs(i) = -cx(i)
00313   140    \textcolor{keywordflow}{CONTINUE}
00314          \textcolor{keyword}{CALL }zdscal(5,sa,cx,incx)
00315          \textcolor{keyword}{CALL }ctest(5,cx,mwpct,mwpcs,sfac)
00316 \textcolor{keywordflow}{      END IF}
00317       \textcolor{keywordflow}{RETURN}
00318 \textcolor{keyword}{      END}
00319 \textcolor{keyword}{      SUBROUTINE }check2(SFAC)
00320 \textcolor{comment}{*     .. Parameters ..}
00321       \textcolor{keywordtype}{INTEGER}           nout
00322       parameter(nout=6)
00323 \textcolor{comment}{*     .. Scalar Arguments ..}
00324       \textcolor{keywordtype}{DOUBLE PRECISION}  sfac
00325 \textcolor{comment}{*     .. Scalars in Common ..}
00326       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, mode, n
00327       \textcolor{keywordtype}{LOGICAL}           pass
00328 \textcolor{comment}{*     .. Local Scalars ..}
00329       \textcolor{keywordtype}{COMPLEX*16}        ca
00330       \textcolor{keywordtype}{INTEGER}           i, j, ki, kn, ksize, lenx, leny, mx, my
00331 \textcolor{comment}{*     .. Local Arrays ..}
00332       \textcolor{keywordtype}{COMPLEX*16}        cdot(1), csize1(4), csize2(7,2), csize3(14),
00333      +                  ct10x(7,4,4), ct10y(7,4,4), ct6(4,4), ct7(4,4),
00334      +                  ct8(7,4,4), cx(7), cx1(7), cy(7), cy1(7)
00335       \textcolor{keywordtype}{INTEGER}           incxs(4), incys(4), lens(4,2), ns(4)
00336 \textcolor{comment}{*     .. External Functions ..}
00337       \textcolor{keywordtype}{COMPLEX*16}        zdotc, zdotu
00338       \textcolor{keywordtype}{EXTERNAL}          zdotc, zdotu
00339 \textcolor{comment}{*     .. External Subroutines ..}
00340       \textcolor{keywordtype}{EXTERNAL}          zaxpy, zcopy, zswap, ctest
00341 \textcolor{comment}{*     .. Intrinsic Functions ..}
00342       \textcolor{keywordtype}{INTRINSIC}         abs, min
00343 \textcolor{comment}{*     .. Common blocks ..}
00344       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, mode, pass
00345 \textcolor{comment}{*     .. Data statements ..}
00346       \textcolor{keyword}{DATA}              ca/(0.4d0,-0.7d0)/
00347       \textcolor{keyword}{DATA}              incxs/1, 2, -2, -1/
00348       \textcolor{keyword}{DATA}              incys/1, -2, 1, -2/
00349       \textcolor{keyword}{DATA}              lens/1, 1, 2, 4, 1, 1, 3, 7/
00350       \textcolor{keyword}{DATA}              ns/0, 1, 2, 4/
00351       \textcolor{keyword}{DATA}              cx1/(0.7d0,-0.8d0), (-0.4d0,-0.7d0),
00352      +                  (-0.1d0,-0.9d0), (0.2d0,-0.8d0),
00353      +                  (-0.9d0,-0.4d0), (0.1d0,0.4d0), (-0.6d0,0.6d0)/
00354       \textcolor{keyword}{DATA}              cy1/(0.6d0,-0.6d0), (-0.9d0,0.5d0),
00355      +                  (0.7d0,-0.6d0), (0.1d0,-0.5d0), (-0.1d0,-0.2d0),
00356      +                  (-0.5d0,-0.3d0), (0.8d0,-0.7d0)/
00357       \textcolor{keyword}{DATA}              ((ct8(i,j,1),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00358      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00359      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00360      +                  (0.32d0,-1.41d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00361      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00362      +                  (0.0d0,0.0d0), (0.32d0,-1.41d0),
00363      +                  (-1.55d0,0.5d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00364      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00365      +                  (0.32d0,-1.41d0), (-1.55d0,0.5d0),
00366      +                  (0.03d0,-0.89d0), (-0.38d0,-0.96d0),
00367      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0)/
00368       \textcolor{keyword}{DATA}              ((ct8(i,j,2),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00369      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00370      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00371      +                  (0.32d0,-1.41d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00372      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00373      +                  (0.0d0,0.0d0), (-0.07d0,-0.89d0),
00374      +                  (-0.9d0,0.5d0), (0.42d0,-1.41d0), (0.0d0,0.0d0),
00375      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00376      +                  (0.78d0,0.06d0), (-0.9d0,0.5d0),
00377      +                  (0.06d0,-0.13d0), (0.1d0,-0.5d0),
00378      +                  (-0.77d0,-0.49d0), (-0.5d0,-0.3d0),
00379      +                  (0.52d0,-1.51d0)/
00380       \textcolor{keyword}{DATA}              ((ct8(i,j,3),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00381      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00382      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00383      +                  (0.32d0,-1.41d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00384      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00385      +                  (0.0d0,0.0d0), (-0.07d0,-0.89d0),
00386      +                  (-1.18d0,-0.31d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00387      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00388      +                  (0.78d0,0.06d0), (-1.54d0,0.97d0),
00389      +                  (0.03d0,-0.89d0), (-0.18d0,-1.31d0),
00390      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0)/
00391       \textcolor{keyword}{DATA}              ((ct8(i,j,4),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00392      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00393      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00394      +                  (0.32d0,-1.41d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00395      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00396      +                  (0.0d0,0.0d0), (0.32d0,-1.41d0), (-0.9d0,0.5d0),
00397      +                  (0.05d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00398      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.32d0,-1.41d0),
00399      +                  (-0.9d0,0.5d0), (0.05d0,-0.6d0), (0.1d0,-0.5d0),
00400      +                  (-0.77d0,-0.49d0), (-0.5d0,-0.3d0),
00401      +                  (0.32d0,-1.16d0)/
00402       \textcolor{keyword}{DATA}              ct7/(0.0d0,0.0d0), (-0.06d0,-0.90d0),
00403      +                  (0.65d0,-0.47d0), (-0.34d0,-1.22d0),
00404      +                  (0.0d0,0.0d0), (-0.06d0,-0.90d0),
00405      +                  (-0.59d0,-1.46d0), (-1.04d0,-0.04d0),
00406      +                  (0.0d0,0.0d0), (-0.06d0,-0.90d0),
00407      +                  (-0.83d0,0.59d0), (0.07d0,-0.37d0),
00408      +                  (0.0d0,0.0d0), (-0.06d0,-0.90d0),
00409      +                  (-0.76d0,-1.15d0), (-1.33d0,-1.82d0)/
00410       \textcolor{keyword}{DATA}              ct6/(0.0d0,0.0d0), (0.90d0,0.06d0),
00411      +                  (0.91d0,-0.77d0), (1.80d0,-0.10d0),
00412      +                  (0.0d0,0.0d0), (0.90d0,0.06d0), (1.45d0,0.74d0),
00413      +                  (0.20d0,0.90d0), (0.0d0,0.0d0), (0.90d0,0.06d0),
00414      +                  (-0.55d0,0.23d0), (0.83d0,-0.39d0),
00415      +                  (0.0d0,0.0d0), (0.90d0,0.06d0), (1.04d0,0.79d0),
00416      +                  (1.95d0,1.22d0)/
00417       \textcolor{keyword}{DATA}              ((ct10x(i,j,1),i=1,7),j=1,4)/(0.7d0,-0.8d0),
00418      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00419      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00420      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00421      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00422      +                  (0.0d0,0.0d0), (0.6d0,-0.6d0), (-0.9d0,0.5d0),
00423      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00424      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.6d0,-0.6d0),
00425      +                  (-0.9d0,0.5d0), (0.7d0,-0.6d0), (0.1d0,-0.5d0),
00426      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0)/
00427       \textcolor{keyword}{DATA}              ((ct10x(i,j,2),i=1,7),j=1,4)/(0.7d0,-0.8d0),
00428      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00429      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00430      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00431      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00432      +                  (0.0d0,0.0d0), (0.7d0,-0.6d0), (-0.4d0,-0.7d0),
00433      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00434      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.8d0,-0.7d0),
00435      +                  (-0.4d0,-0.7d0), (-0.1d0,-0.2d0),
00436      +                  (0.2d0,-0.8d0), (0.7d0,-0.6d0), (0.1d0,0.4d0),
00437      +                  (0.6d0,-0.6d0)/
00438       \textcolor{keyword}{DATA}              ((ct10x(i,j,3),i=1,7),j=1,4)/(0.7d0,-0.8d0),
00439      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00440      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00441      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00442      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00443      +                  (0.0d0,0.0d0), (-0.9d0,0.5d0), (-0.4d0,-0.7d0),
00444      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00445      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.1d0,-0.5d0),
00446      +                  (-0.4d0,-0.7d0), (0.7d0,-0.6d0), (0.2d0,-0.8d0),
00447      +                  (-0.9d0,0.5d0), (0.1d0,0.4d0), (0.6d0,-0.6d0)/
00448       \textcolor{keyword}{DATA}              ((ct10x(i,j,4),i=1,7),j=1,4)/(0.7d0,-0.8d0),
00449      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00450      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00451      +                  (0.6d0,-0.6d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00452      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00453      +                  (0.0d0,0.0d0), (0.6d0,-0.6d0), (0.7d0,-0.6d0),
00454      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00455      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.6d0,-0.6d0),
00456      +                  (0.7d0,-0.6d0), (-0.1d0,-0.2d0), (0.8d0,-0.7d0),
00457      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0)/
00458       \textcolor{keyword}{DATA}              ((ct10y(i,j,1),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00459      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00460      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00461      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00462      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00463      +                  (0.0d0,0.0d0), (0.7d0,-0.8d0), (-0.4d0,-0.7d0),
00464      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00465      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.7d0,-0.8d0),
00466      +                  (-0.4d0,-0.7d0), (-0.1d0,-0.9d0),
00467      +                  (0.2d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00468      +                  (0.0d0,0.0d0)/
00469       \textcolor{keyword}{DATA}              ((ct10y(i,j,2),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00470      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00471      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00472      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00473      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00474      +                  (0.0d0,0.0d0), (-0.1d0,-0.9d0), (-0.9d0,0.5d0),
00475      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00476      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (-0.6d0,0.6d0),
00477      +                  (-0.9d0,0.5d0), (-0.9d0,-0.4d0), (0.1d0,-0.5d0),
00478      +                  (-0.1d0,-0.9d0), (-0.5d0,-0.3d0),
00479      +                  (0.7d0,-0.8d0)/
00480       \textcolor{keyword}{DATA}              ((ct10y(i,j,3),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00481      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00482      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00483      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00484      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00485      +                  (0.0d0,0.0d0), (-0.1d0,-0.9d0), (0.7d0,-0.8d0),
00486      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00487      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (-0.6d0,0.6d0),
00488      +                  (-0.9d0,-0.4d0), (-0.1d0,-0.9d0),
00489      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00490      +                  (0.0d0,0.0d0)/
00491       \textcolor{keyword}{DATA}              ((ct10y(i,j,4),i=1,7),j=1,4)/(0.6d0,-0.6d0),
00492      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00493      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00494      +                  (0.7d0,-0.8d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00495      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00496      +                  (0.0d0,0.0d0), (0.7d0,-0.8d0), (-0.9d0,0.5d0),
00497      +                  (-0.4d0,-0.7d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00498      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.7d0,-0.8d0),
00499      +                  (-0.9d0,0.5d0), (-0.4d0,-0.7d0), (0.1d0,-0.5d0),
00500      +                  (-0.1d0,-0.9d0), (-0.5d0,-0.3d0),
00501      +                  (0.2d0,-0.8d0)/
00502       \textcolor{keyword}{DATA}              csize1/(0.0d0,0.0d0), (0.9d0,0.9d0),
00503      +                  (1.63d0,1.73d0), (2.90d0,2.78d0)/
00504       \textcolor{keyword}{DATA}              csize3/(0.0d0,0.0d0), (0.0d0,0.0d0),
00505      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00506      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (1.17d0,1.17d0),
00507      +                  (1.17d0,1.17d0), (1.17d0,1.17d0),
00508      +                  (1.17d0,1.17d0), (1.17d0,1.17d0),
00509      +                  (1.17d0,1.17d0), (1.17d0,1.17d0)/
00510       \textcolor{keyword}{DATA}              csize2/(0.0d0,0.0d0), (0.0d0,0.0d0),
00511      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (0.0d0,0.0d0),
00512      +                  (0.0d0,0.0d0), (0.0d0,0.0d0), (1.54d0,1.54d0),
00513      +                  (1.54d0,1.54d0), (1.54d0,1.54d0),
00514      +                  (1.54d0,1.54d0), (1.54d0,1.54d0),
00515      +                  (1.54d0,1.54d0), (1.54d0,1.54d0)/
00516 \textcolor{comment}{*     .. Executable Statements ..}
00517       \textcolor{keywordflow}{DO} 60 ki = 1, 4
00518          incx = incxs(ki)
00519          incy = incys(ki)
00520          mx = abs(incx)
00521          my = abs(incy)
00522 \textcolor{comment}{*}
00523          \textcolor{keywordflow}{DO} 40 kn = 1, 4
00524             n = ns(kn)
00525             ksize = min(2,kn)
00526             lenx = lens(kn,mx)
00527             leny = lens(kn,my)
00528 \textcolor{comment}{*           .. initialize all argument arrays ..}
00529             \textcolor{keywordflow}{DO} 20 i = 1, 7
00530                cx(i) = cx1(i)
00531                cy(i) = cy1(i)
00532    20       \textcolor{keywordflow}{CONTINUE}
00533             \textcolor{keywordflow}{IF} (icase.EQ.1) \textcolor{keywordflow}{THEN}
00534 \textcolor{comment}{*              .. ZDOTC ..}
00535                cdot(1) = zdotc(n,cx,incx,cy,incy)
00536                \textcolor{keyword}{CALL }ctest(1,cdot,ct6(kn,ki),csize1(kn),sfac)
00537             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.2) \textcolor{keywordflow}{THEN}
00538 \textcolor{comment}{*              .. ZDOTU ..}
00539                cdot(1) = zdotu(n,cx,incx,cy,incy)
00540                \textcolor{keyword}{CALL }ctest(1,cdot,ct7(kn,ki),csize1(kn),sfac)
00541             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.3) \textcolor{keywordflow}{THEN}
00542 \textcolor{comment}{*              .. ZAXPY ..}
00543                \textcolor{keyword}{CALL }zaxpy(n,ca,cx,incx,cy,incy)
00544                \textcolor{keyword}{CALL }ctest(leny,cy,ct8(1,kn,ki),csize2(1,ksize),sfac)
00545             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.4) \textcolor{keywordflow}{THEN}
00546 \textcolor{comment}{*              .. ZCOPY ..}
00547                \textcolor{keyword}{CALL }zcopy(n,cx,incx,cy,incy)
00548                \textcolor{keyword}{CALL }ctest(leny,cy,ct10y(1,kn,ki),csize3,1.0d0)
00549             \textcolor{keywordflow}{ELSE} \textcolor{keywordflow}{IF} (icase.EQ.5) \textcolor{keywordflow}{THEN}
00550 \textcolor{comment}{*              .. ZSWAP ..}
00551                \textcolor{keyword}{CALL }zswap(n,cx,incx,cy,incy)
00552                \textcolor{keyword}{CALL }ctest(lenx,cx,ct10x(1,kn,ki),csize3,1.0d0)
00553                \textcolor{keyword}{CALL }ctest(leny,cy,ct10y(1,kn,ki),csize3,1.0d0)
00554             \textcolor{keywordflow}{ELSE}
00555                \textcolor{keyword}{WRITE} (nout,*) \textcolor{stringliteral}{' Shouldn'}\textcolor{stringliteral}{'t be here in CHECK2'}
00556                stop
00557 \textcolor{keywordflow}{            END IF}
00558 \textcolor{comment}{*}
00559    40    \textcolor{keywordflow}{CONTINUE}
00560    60 \textcolor{keywordflow}{CONTINUE}
00561       \textcolor{keywordflow}{RETURN}
00562 \textcolor{keyword}{      END}
00563 \textcolor{keyword}{      SUBROUTINE }stest(LEN,SCOMP,STRUE,SSIZE,SFAC)
00564 \textcolor{comment}{*     ********************************* STEST **************************}
00565 \textcolor{comment}{*}
00566 \textcolor{comment}{*     THIS SUBR COMPARES ARRAYS  SCOMP() AND STRUE() OF LENGTH LEN TO}
00567 \textcolor{comment}{*     SEE IF THE TERM BY TERM DIFFERENCES, MULTIPLIED BY SFAC, ARE}
00568 \textcolor{comment}{*     NEGLIGIBLE.}
00569 \textcolor{comment}{*}
00570 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00571 \textcolor{comment}{*}
00572 \textcolor{comment}{*     .. Parameters ..}
00573       \textcolor{keywordtype}{INTEGER}          nout
00574       \textcolor{keywordtype}{DOUBLE PRECISION} zero
00575       parameter(nout=6, zero=0.0d0)
00576 \textcolor{comment}{*     .. Scalar Arguments ..}
00577       \textcolor{keywordtype}{DOUBLE PRECISION} sfac
00578       \textcolor{keywordtype}{INTEGER}          len
00579 \textcolor{comment}{*     .. Array Arguments ..}
00580       \textcolor{keywordtype}{DOUBLE PRECISION} scomp(len), ssize(len), strue(len)
00581 \textcolor{comment}{*     .. Scalars in Common ..}
00582       \textcolor{keywordtype}{INTEGER}          icase, incx, incy, mode, n
00583       \textcolor{keywordtype}{LOGICAL}          pass
00584 \textcolor{comment}{*     .. Local Scalars ..}
00585       \textcolor{keywordtype}{DOUBLE PRECISION} sd
00586       \textcolor{keywordtype}{INTEGER}          i
00587 \textcolor{comment}{*     .. External Functions ..}
00588       \textcolor{keywordtype}{DOUBLE PRECISION} sdiff
00589       \textcolor{keywordtype}{EXTERNAL}         sdiff
00590 \textcolor{comment}{*     .. Intrinsic Functions ..}
00591       \textcolor{keywordtype}{INTRINSIC}        abs
00592 \textcolor{comment}{*     .. Common blocks ..}
00593       \textcolor{keyword}{COMMON}           /combla/icase, n, incx, incy, mode, pass
00594 \textcolor{comment}{*     .. Executable Statements ..}
00595 \textcolor{comment}{*}
00596       \textcolor{keywordflow}{DO} 40 i = 1, len
00597          sd = scomp(i) - strue(i)
00598          \textcolor{keywordflow}{IF} (abs(sfac*sd) .LE. abs(ssize(i))*epsilon(zero))
00599      +       \textcolor{keywordflow}{GO TO} 40
00600 \textcolor{comment}{*}
00601 \textcolor{comment}{*                             HERE    SCOMP(I) IS NOT CLOSE TO STRUE(I).}
00602 \textcolor{comment}{*}
00603          \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
00604 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
00605          pass = .false.
00606          \textcolor{keyword}{WRITE} (nout,99999)
00607          \textcolor{keyword}{WRITE} (nout,99998)
00608    20    \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, mode, i, scomp(i),
00609      +     strue(i), sd, ssize(i)
00610    40 \textcolor{keywordflow}{CONTINUE}
00611       \textcolor{keywordflow}{RETURN}
00612 \textcolor{comment}{*}
00613 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
00614 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY MODE  I                            '},
00615      +       \textcolor{stringliteral}{' COMP(I)                             TRUE(I)  DIFFERENCE'},
00616      +       \textcolor{stringliteral}{'     SIZE(I)'},/1x)
00617 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,3i5,i3,2d36.8,2d12.4)
00618 \textcolor{keyword}{      END}
00619 \textcolor{keyword}{      SUBROUTINE }stest1(SCOMP1,STRUE1,SSIZE,SFAC)
00620 \textcolor{comment}{*     ************************* STEST1 *****************************}
00621 \textcolor{comment}{*}
00622 \textcolor{comment}{*     THIS IS AN INTERFACE SUBROUTINE TO ACCOMODATE THE FORTRAN}
00623 \textcolor{comment}{*     REQUIREMENT THAT WHEN A DUMMY ARGUMENT IS AN ARRAY, THE}
00624 \textcolor{comment}{*     ACTUAL ARGUMENT MUST ALSO BE AN ARRAY OR AN ARRAY ELEMENT.}
00625 \textcolor{comment}{*}
00626 \textcolor{comment}{*     C.L. LAWSON, JPL, 1978 DEC 6}
00627 \textcolor{comment}{*}
00628 \textcolor{comment}{*     .. Scalar Arguments ..}
00629       \textcolor{keywordtype}{DOUBLE PRECISION}  scomp1, sfac, strue1
00630 \textcolor{comment}{*     .. Array Arguments ..}
00631       \textcolor{keywordtype}{DOUBLE PRECISION}  ssize(*)
00632 \textcolor{comment}{*     .. Local Arrays ..}
00633       \textcolor{keywordtype}{DOUBLE PRECISION}  scomp(1), strue(1)
00634 \textcolor{comment}{*     .. External Subroutines ..}
00635       \textcolor{keywordtype}{EXTERNAL}          stest
00636 \textcolor{comment}{*     .. Executable Statements ..}
00637 \textcolor{comment}{*}
00638       scomp(1) = scomp1
00639       strue(1) = strue1
00640       \textcolor{keyword}{CALL }stest(1,scomp,strue,ssize,sfac)
00641 \textcolor{comment}{*}
00642       \textcolor{keywordflow}{RETURN}
00643 \textcolor{keyword}{      END}
00644 \textcolor{keyword}{      DOUBLE PRECISION }\textcolor{keyword}{FUNCTION }sdiff(SA,SB)
00645 \textcolor{comment}{*     ********************************* SDIFF **************************}
00646 \textcolor{comment}{*     COMPUTES DIFFERENCE OF TWO NUMBERS.  C. L. LAWSON, JPL 1974 FEB 15}
00647 \textcolor{comment}{*}
00648 \textcolor{comment}{*     .. Scalar Arguments ..}
00649       \textcolor{keywordtype}{DOUBLE PRECISION}                sa, sb
00650 \textcolor{comment}{*     .. Executable Statements ..}
00651       sdiff = sa - sb
00652       \textcolor{keywordflow}{RETURN}
00653 \textcolor{keyword}{      END}
00654 \textcolor{keyword}{      SUBROUTINE }ctest(LEN,CCOMP,CTRUE,CSIZE,SFAC)
00655 \textcolor{comment}{*     **************************** CTEST *****************************}
00656 \textcolor{comment}{*}
00657 \textcolor{comment}{*     C.L. LAWSON, JPL, 1978 DEC 6}
00658 \textcolor{comment}{*}
00659 \textcolor{comment}{*     .. Scalar Arguments ..}
00660       \textcolor{keywordtype}{DOUBLE PRECISION} sfac
00661       \textcolor{keywordtype}{INTEGER}          len
00662 \textcolor{comment}{*     .. Array Arguments ..}
00663       \textcolor{keywordtype}{COMPLEX*16}       ccomp(len), csize(len), ctrue(len)
00664 \textcolor{comment}{*     .. Local Scalars ..}
00665       \textcolor{keywordtype}{INTEGER}          i
00666 \textcolor{comment}{*     .. Local Arrays ..}
00667       \textcolor{keywordtype}{DOUBLE PRECISION} scomp(20), ssize(20), strue(20)
00668 \textcolor{comment}{*     .. External Subroutines ..}
00669       \textcolor{keywordtype}{EXTERNAL}         stest
00670 \textcolor{comment}{*     .. Intrinsic Functions ..}
00671       \textcolor{keywordtype}{INTRINSIC}        dimag, dble
00672 \textcolor{comment}{*     .. Executable Statements ..}
00673       \textcolor{keywordflow}{DO} 20 i = 1, len
00674          scomp(2*i-1) = dble(ccomp(i))
00675          scomp(2*i) = dimag(ccomp(i))
00676          strue(2*i-1) = dble(ctrue(i))
00677          strue(2*i) = dimag(ctrue(i))
00678          ssize(2*i-1) = dble(csize(i))
00679          ssize(2*i) = dimag(csize(i))
00680    20 \textcolor{keywordflow}{CONTINUE}
00681 \textcolor{comment}{*}
00682       \textcolor{keyword}{CALL }stest(2*len,scomp,strue,ssize,sfac)
00683       \textcolor{keywordflow}{RETURN}
00684 \textcolor{keyword}{      END}
00685 \textcolor{keyword}{      SUBROUTINE }itest1(ICOMP,ITRUE)
00686 \textcolor{comment}{*     ********************************* ITEST1 *************************}
00687 \textcolor{comment}{*}
00688 \textcolor{comment}{*     THIS SUBROUTINE COMPARES THE VARIABLES ICOMP AND ITRUE FOR}
00689 \textcolor{comment}{*     EQUALITY.}
00690 \textcolor{comment}{*     C. L. LAWSON, JPL, 1974 DEC 10}
00691 \textcolor{comment}{*}
00692 \textcolor{comment}{*     .. Parameters ..}
00693       \textcolor{keywordtype}{INTEGER}           nout
00694       parameter(nout=6)
00695 \textcolor{comment}{*     .. Scalar Arguments ..}
00696       \textcolor{keywordtype}{INTEGER}           icomp, itrue
00697 \textcolor{comment}{*     .. Scalars in Common ..}
00698       \textcolor{keywordtype}{INTEGER}           icase, incx, incy, mode, n
00699       \textcolor{keywordtype}{LOGICAL}           pass
00700 \textcolor{comment}{*     .. Local Scalars ..}
00701       \textcolor{keywordtype}{INTEGER}           id
00702 \textcolor{comment}{*     .. Common blocks ..}
00703       \textcolor{keyword}{COMMON}            /combla/icase, n, incx, incy, mode, pass
00704 \textcolor{comment}{*     .. Executable Statements ..}
00705       \textcolor{keywordflow}{IF} (icomp.EQ.itrue) \textcolor{keywordflow}{GO TO} 40
00706 \textcolor{comment}{*}
00707 \textcolor{comment}{*                            HERE ICOMP IS NOT EQUAL TO ITRUE.}
00708 \textcolor{comment}{*}
00709       \textcolor{keywordflow}{IF} ( .NOT. pass) \textcolor{keywordflow}{GO TO} 20
00710 \textcolor{comment}{*                             PRINT FAIL MESSAGE AND HEADER.}
00711       pass = .false.
00712       \textcolor{keyword}{WRITE} (nout,99999)
00713       \textcolor{keyword}{WRITE} (nout,99998)
00714    20 id = icomp - itrue
00715       \textcolor{keyword}{WRITE} (nout,99997) icase, n, incx, incy, mode, icomp, itrue, id
00716    40 \textcolor{keywordflow}{CONTINUE}
00717       \textcolor{keywordflow}{RETURN}
00718 \textcolor{comment}{*}
00719 99999 \textcolor{keyword}{FORMAT} (\textcolor{stringliteral}{'                                       FAIL'})
00720 99998 \textcolor{keyword}{FORMAT} (/\textcolor{stringliteral}{' CASE  N INCX INCY MODE                               '},
00721      +       \textcolor{stringliteral}{' COMP                                TRUE     DIFFERENCE'},
00722      +       /1x)
00723 99997 \textcolor{keyword}{FORMAT} (1x,i4,i3,3i5,2i36,i12)
00724 \textcolor{keyword}{      END}
\end{DoxyCode}
