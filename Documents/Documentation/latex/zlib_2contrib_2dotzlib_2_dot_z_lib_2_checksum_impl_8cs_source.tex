\hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source}{}\section{zlib/contrib/dotzlib/\+Dot\+Z\+Lib/\+Checksum\+Impl.cs}
\label{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source}\index{Checksum\+Impl.\+cs@{Checksum\+Impl.\+cs}}

\begin{DoxyCode}
00001 \textcolor{comment}{//}
00002 \textcolor{comment}{// © Copyright Henrik Ravn 2004}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Use, modification and distribution are subject to the Boost Software License, Version 1.0.}
00005 \textcolor{comment}{// (See accompanying file LICENSE\_1\_0.txt or copy at http://www.boost.org/LICENSE\_1\_0.txt)}
00006 \textcolor{comment}{//}
00007 
00008 \textcolor{keyword}{using} \hyperlink{namespace_system}{System};
00009 \textcolor{keyword}{using} \hyperlink{namespace_system}{System}.Runtime.InteropServices;
00010 \textcolor{keyword}{using} \hyperlink{namespace_system}{System}.Text;
00011 
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_dot_z_lib}{DotZLib}
00014 \{
00015 \textcolor{preprocessor}{    #region ChecksumGeneratorBase}
00016     \textcolor{keyword}{public} \textcolor{keyword}{abstract} \textcolor{keyword}{class }ChecksumGeneratorBase : ChecksumGenerator
00021     \{
00025         \textcolor{keyword}{protected} uint \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current};
00026 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00031}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a4c13ec1d2cb08abadffb2c70cb4ba258}{00031}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a4c13ec1d2cb08abadffb2c70cb4ba258}{ChecksumGeneratorBase}()
00032         \{
00033             \_current = 0;
00034         \}
00035 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00040}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_ab36da84d395361311a45e88797ae8c69}{00040}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_ab36da84d395361311a45e88797ae8c69}{ChecksumGeneratorBase}(uint initialValue)
00041         \{
00042             \_current = initialValue;
00043         \}
00044 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00048}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a78ec9de09223c6f9f81e4a32d8d00b70}{00048}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a78ec9de09223c6f9f81e4a32d8d00b70}{Reset}() \{ \_current = 0; \}
00049 
00053         \textcolor{keyword}{public} uint \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_aeaf336483beafb0c2af9285bf37db5fe}{Value} \{ \textcolor{keyword}{get} \{ \textcolor{keywordflow}{return} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current}; \} \}
00054 
00066         \textcolor{keyword}{public} \textcolor{keyword}{abstract} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a7844da3e1f8af01d7cde34f3056bf24b}{Update}(byte[] data, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} count);
00067 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00072}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a3fafe3e0c2fa80fb2cbbdce82a76bc84}{00072}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a3fafe3e0c2fa80fb2cbbdce82a76bc84}{Update}(byte[] data)
00073         \{
00074             \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a7844da3e1f8af01d7cde34f3056bf24b}{Update}(data, 0, data.Length);
00075         \}
00076 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00082}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a4f0a5411dbb86714571852000932d66e}{00082}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a4f0a5411dbb86714571852000932d66e}{Update}(\textcolor{keywordtype}{string} data)
00083         \{
00084             \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a7844da3e1f8af01d7cde34f3056bf24b}{Update}(Encoding.UTF8.GetBytes(data));
00085         \}
00086 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00092}\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_ad8e1adfbbfcc12ab74c772f3292bfee3}{00092}         \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_ad8e1adfbbfcc12ab74c772f3292bfee3}{Update}(\textcolor{keywordtype}{string} data, Encoding encoding)
00093         \{
00094             \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a7844da3e1f8af01d7cde34f3056bf24b}{Update}(encoding.GetBytes(data));
00095         \}
00096 
00097     \}
00098 \textcolor{preprocessor}{    #endregion}
00099 
00100 \textcolor{preprocessor}{    #region CRC32}
00101     \textcolor{keyword}{public} sealed \textcolor{keyword}{class }\hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum}{CRC32Checksum} : \hyperlink{class_dot_z_lib_1_1_checksum_generator_base}{ChecksumGeneratorBase}
00105     \{
00106 \textcolor{preprocessor}{        #region DLL imports}
00107 
00108         [DllImport(\textcolor{stringliteral}{"ZLIB1.dll"}, CallingConvention=CallingConvention.Cdecl)]
00109         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} uint crc32(uint crc, \textcolor{keywordtype}{int} data, uint length);
00110 
00111 \textcolor{preprocessor}{        #endregion}
00112 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00116}\hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_aae1fb7dbf6c57d17c321d0065cd608ca}{00116}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_aae1fb7dbf6c57d17c321d0065cd608ca}{CRC32Checksum}() : base() \{\}
00117 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00122}\hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_a7032fdb98254bd918ff19b5251c29634}{00122}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_a7032fdb98254bd918ff19b5251c29634}{CRC32Checksum}(uint initialValue) : base(initialValue) \{\}
00123 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00133}\hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_abe29e66033fa164a7c7c0463e6c88074}{00133}         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_c_r_c32_checksum_abe29e66033fa164a7c7c0463e6c88074}{Update}(byte[] data, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} count)
00134         \{
00135             \textcolor{keywordflow}{if} (offset < 0 || count < 0) \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentOutOfRangeException();
00136             \textcolor{keywordflow}{if} ((offset+count) > data.Length) \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentException();
00137             GCHandle hData = GCHandle.Alloc(data, GCHandleType.Pinned);
00138             \textcolor{keywordflow}{try}
00139             \{
00140                 \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current} = crc32(\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current}, hData.AddrOfPinnedObject().ToInt32()+offset, (
      uint)count);
00141             \}
00142             \textcolor{keywordflow}{finally}
00143             \{
00144                 hData.Free();
00145             \}
00146         \}
00147 
00148     \}
00149 \textcolor{preprocessor}{    #endregion}
00150 
00151 \textcolor{preprocessor}{    #region Adler}
00152     \textcolor{keyword}{public} sealed \textcolor{keyword}{class }\hyperlink{class_dot_z_lib_1_1_adler_checksum}{AdlerChecksum} : \hyperlink{class_dot_z_lib_1_1_checksum_generator_base}{ChecksumGeneratorBase}
00156     \{
00157 \textcolor{preprocessor}{        #region DLL imports}
00158 
00159         [DllImport(\textcolor{stringliteral}{"ZLIB1.dll"}, CallingConvention=CallingConvention.Cdecl)]
00160         \textcolor{keyword}{private} \textcolor{keyword}{static} \textcolor{keyword}{extern} uint adler32(uint adler, \textcolor{keywordtype}{int} data, uint length);
00161 
00162 \textcolor{preprocessor}{        #endregion}
00163 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00167}\hyperlink{class_dot_z_lib_1_1_adler_checksum_a8b968384065103a827ac7bfb7bfab66d}{00167}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_adler_checksum_a8b968384065103a827ac7bfb7bfab66d}{AdlerChecksum}() : base() \{\}
00168 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00173}\hyperlink{class_dot_z_lib_1_1_adler_checksum_ab983bcafef50a5f578398d2aa83d7433}{00173}         \textcolor{keyword}{public} \hyperlink{class_dot_z_lib_1_1_adler_checksum_ab983bcafef50a5f578398d2aa83d7433}{AdlerChecksum}(uint initialValue) : base(initialValue) \{\}
00174 
\Hypertarget{zlib_2contrib_2dotzlib_2_dot_z_lib_2_checksum_impl_8cs_source_l00184}\hyperlink{class_dot_z_lib_1_1_adler_checksum_a757dd32613c477dcb7384b206b72fc34}{00184}         \textcolor{keyword}{public} \textcolor{keyword}{override} \textcolor{keywordtype}{void} \hyperlink{class_dot_z_lib_1_1_adler_checksum_a757dd32613c477dcb7384b206b72fc34}{Update}(byte[] data, \textcolor{keywordtype}{int} offset, \textcolor{keywordtype}{int} count)
00185         \{
00186             \textcolor{keywordflow}{if} (offset < 0 || count < 0) \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentOutOfRangeException();
00187             \textcolor{keywordflow}{if} ((offset+count) > data.Length) \textcolor{keywordflow}{throw} \textcolor{keyword}{new} ArgumentException();
00188             GCHandle hData = GCHandle.Alloc(data, GCHandleType.Pinned);
00189             \textcolor{keywordflow}{try}
00190             \{
00191                 \hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current} = adler32(\hyperlink{class_dot_z_lib_1_1_checksum_generator_base_a081221e827dc7d3050fbdffc2973abea}{\_current}, hData.AddrOfPinnedObject().ToInt32()+offset, (
      uint)count);
00192             \}
00193             \textcolor{keywordflow}{finally}
00194             \{
00195                 hData.Free();
00196             \}
00197         \}
00198 
00199     \}
00200 \textcolor{preprocessor}{    #endregion}
00201 
00202 \}
\end{DoxyCode}
