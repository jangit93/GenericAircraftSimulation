\hypertarget{_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_d_2h5ex__d__rdwr_8f90_source}{}\section{H\+D\+F5/1.10.1/\+H\+D\+F5\+Examples/\+F\+O\+R\+T\+R\+A\+N/\+H5\+D/h5ex\+\_\+d\+\_\+rdwr.f90}
\label{_h_d_f5_21_810_81_2_h_d_f5_examples_2_f_o_r_t_r_a_n_2_h5_d_2h5ex__d__rdwr_8f90_source}\index{h5ex\+\_\+d\+\_\+rdwr.\+f90@{h5ex\+\_\+d\+\_\+rdwr.\+f90}}

\begin{DoxyCode}
00001 \textcolor{comment}{! ************************************************************}
00002 \textcolor{comment}{!}
00003 \textcolor{comment}{!  This example shows how to read and write data to a}
00004 \textcolor{comment}{!  dataset.  The program first writes integers to a dataset}
00005 \textcolor{comment}{!  with dataspace dimensions of DIM0xDIM1, then closes the}
00006 \textcolor{comment}{!  file.  Next, it reopens the file, reads back the data, and}
00007 \textcolor{comment}{!  outputs it to the screen.}
00008 \textcolor{comment}{!}
00009 \textcolor{comment}{!  This file is intended for use with HDF5 Library verion 1.8}
00010 \textcolor{comment}{!}
00011 \textcolor{comment}{! ************************************************************}
00012 
00013 \textcolor{keyword}{PROGRAM} main
00014 
00015   \textcolor{keywordtype}{USE }hdf5
00016 
00017   \textcolor{keywordtype}{IMPLICIT NONE}
00018 
00019   \textcolor{keywordtype}{CHARACTER(LEN=14)}, \textcolor{keywordtype}{PARAMETER} :: filename = \textcolor{stringliteral}{"h5ex\_d\_rdwr.h5"}
00020   \textcolor{keywordtype}{CHARACTER(LEN=3)} , \textcolor{keywordtype}{PARAMETER} :: dataset = \textcolor{stringliteral}{"DS1"}
00021   \textcolor{keywordtype}{INTEGER}          , \textcolor{keywordtype}{PARAMETER} :: dim0     = 4
00022   \textcolor{keywordtype}{INTEGER}          , \textcolor{keywordtype}{PARAMETER} :: dim1     = 7
00023 
00024   \textcolor{keywordtype}{INTEGER} :: hdferr
00025   \textcolor{keywordtype}{INTEGER(HID\_T)} :: \hyperlink{structfile}{file}, space, dset \textcolor{comment}{! handles}
00026   \textcolor{keywordtype}{INTEGER(HSIZE\_T)}, \textcolor{keywordtype}{DIMENSION(1:2)}           :: dims = (/dim0, dim1/) \textcolor{comment}{! size read/write buffer}
00027   \textcolor{keywordtype}{INTEGER}         , \textcolor{keywordtype}{DIMENSION(1:dim0,1:dim1)} :: wdata, &  \textcolor{comment}{! Write buffer }
00028                                                 rdata     \textcolor{comment}{! Read buffer}
00029   \textcolor{keywordtype}{INTEGER} :: i, j
00030   \textcolor{comment}{!}
00031   \textcolor{comment}{! Initialize FORTRAN interface.}
00032   \textcolor{comment}{!}
00033   \textcolor{keyword}{CALL }h5open\_f(hdferr)
00034   \textcolor{comment}{!}
00035   \textcolor{comment}{! Initialize data.}
00036   \textcolor{comment}{!}
00037   \textcolor{keywordflow}{DO} i = 1, dim0
00038      \textcolor{keywordflow}{DO} j = 1, dim1
00039         wdata(i,j) = (i-1)*(j-1)-(j-1)
00040 \textcolor{keywordflow}{     ENDDO}
00041 \textcolor{keywordflow}{  ENDDO}
00042   \textcolor{comment}{!}
00043   \textcolor{comment}{! Create a new file using the default properties.}
00044   \textcolor{comment}{!}
00045   
00046   \textcolor{keyword}{CALL }h5fcreate\_f(filename, h5f\_acc\_trunc\_f, \hyperlink{structfile}{file}, hdferr)
00047   \textcolor{comment}{!}
00048   \textcolor{comment}{! Create dataspace.  Setting size to be the current size.}
00049   \textcolor{comment}{!}
00050   \textcolor{keyword}{CALL }h5screate\_simple\_f(2, dims, space, hdferr)
00051   \textcolor{comment}{!}
00052   \textcolor{comment}{! Create the dataset.  We will use all default properties for this}
00053   \textcolor{comment}{! example.}
00054   \textcolor{comment}{!}
00055   \textcolor{keyword}{CALL }h5dcreate\_f(\hyperlink{structfile}{file}, dataset, h5t\_std\_i32le, space, dset, hdferr)
00056   \textcolor{comment}{!}
00057   \textcolor{comment}{! Write the data to the dataset.}
00058   \textcolor{comment}{!}
00059   \textcolor{keyword}{CALL }h5dwrite\_f(dset, h5t\_native\_integer, wdata, dims, hdferr)
00060   \textcolor{comment}{!}
00061   \textcolor{comment}{! Close and release resources.}
00062   \textcolor{comment}{!}
00063   \textcolor{keyword}{CALL }h5dclose\_f(dset , hdferr)
00064   \textcolor{keyword}{CALL }h5sclose\_f(space, hdferr)
00065   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file} , hdferr)
00066   \textcolor{comment}{!}
00067   \textcolor{comment}{! Now we begin the read section of this example.}
00068   \textcolor{comment}{!}
00069   \textcolor{comment}{!}
00070   \textcolor{comment}{! Open file and dataset using the default properties.}
00071   \textcolor{comment}{!}
00072   \textcolor{keyword}{CALL }h5fopen\_f(filename, h5f\_acc\_rdonly\_f, \hyperlink{structfile}{file}, hdferr)
00073   \textcolor{keyword}{CALL }h5dopen\_f (\hyperlink{structfile}{file}, dataset, dset, hdferr)
00074   \textcolor{comment}{!}
00075   \textcolor{comment}{! Read the data using the default properties.}
00076   \textcolor{comment}{!}
00077   \textcolor{keyword}{CALL }h5dread\_f(dset, h5t\_native\_integer, rdata, dims, hdferr)
00078   \textcolor{comment}{!}
00079   \textcolor{comment}{! Output the data to the screen.}
00080   \textcolor{comment}{!}
00081   \textcolor{keyword}{WRITE}(*, \textcolor{stringliteral}{'(/,A,":")'}) dataset
00082   \textcolor{keywordflow}{DO} i=1, dim0
00083      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'(" [")'}, advance=\textcolor{stringliteral}{'NO'})
00084      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'(80i3)'}, advance=\textcolor{stringliteral}{'NO'}) rdata(i,:)
00085      \textcolor{keyword}{WRITE}(*,\textcolor{stringliteral}{'(" ]")'})
00086 \textcolor{keywordflow}{  ENDDO}
00087   \textcolor{keyword}{WRITE}(*, \textcolor{stringliteral}{'(/)'})
00088   \textcolor{comment}{!}
00089   \textcolor{comment}{! Close and release resources.}
00090   \textcolor{comment}{!}
00091   \textcolor{keyword}{CALL }h5dclose\_f(dset , hdferr)
00092   \textcolor{keyword}{CALL }h5fclose\_f(\hyperlink{structfile}{file} , hdferr)
00093 \textcolor{keyword}{END PROGRAM }main
\end{DoxyCode}
