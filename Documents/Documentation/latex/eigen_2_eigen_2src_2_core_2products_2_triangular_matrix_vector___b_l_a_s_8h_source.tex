\hypertarget{eigen_2_eigen_2src_2_core_2products_2_triangular_matrix_vector___b_l_a_s_8h_source}{}\section{eigen/\+Eigen/src/\+Core/products/\+Triangular\+Matrix\+Vector\+\_\+\+B\+L\+AS.h}
\label{eigen_2_eigen_2src_2_core_2products_2_triangular_matrix_vector___b_l_a_s_8h_source}\index{Triangular\+Matrix\+Vector\+\_\+\+B\+L\+A\+S.\+h@{Triangular\+Matrix\+Vector\+\_\+\+B\+L\+A\+S.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ Copyright (c) 2011, Intel Corporation. All rights reserved.}
00003 \textcolor{comment}{}
00004 \textcolor{comment}{ Redistribution and use in source and binary forms, with or without modification,}
00005 \textcolor{comment}{ are permitted provided that the following conditions are met:}
00006 \textcolor{comment}{}
00007 \textcolor{comment}{ * Redistributions of source code must retain the above copyright notice, this}
00008 \textcolor{comment}{   list of conditions and the following disclaimer.}
00009 \textcolor{comment}{ * Redistributions in binary form must reproduce the above copyright notice,}
00010 \textcolor{comment}{   this list of conditions and the following disclaimer in the documentation}
00011 \textcolor{comment}{   and/or other materials provided with the distribution.}
00012 \textcolor{comment}{ * Neither the name of Intel Corporation nor the names of its contributors may}
00013 \textcolor{comment}{   be used to endorse or promote products derived from this software without}
00014 \textcolor{comment}{   specific prior written permission.}
00015 \textcolor{comment}{}
00016 \textcolor{comment}{ THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS" AND}
00017 \textcolor{comment}{ ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED}
00018 \textcolor{comment}{ WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00019 \textcolor{comment}{ DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT OWNER OR CONTRIBUTORS BE LIABLE FOR}
00020 \textcolor{comment}{ ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL DAMAGES}
00021 \textcolor{comment}{ (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR SERVICES;}
00022 \textcolor{comment}{ LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER CAUSED AND ON}
00023 \textcolor{comment}{ ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY, OR TORT}
00024 \textcolor{comment}{ (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE OF THIS}
00025 \textcolor{comment}{ SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00026 \textcolor{comment}{}
00027 \textcolor{comment}{ ********************************************************************************}
00028 \textcolor{comment}{ *   Content : Eigen bindings to BLAS F77}
00029 \textcolor{comment}{ *   Triangular matrix-vector product functionality based on ?TRMV.}
00030 \textcolor{comment}{ ********************************************************************************}
00031 \textcolor{comment}{*/}
00032 
00033 \textcolor{preprocessor}{#ifndef EIGEN\_TRIANGULAR\_MATRIX\_VECTOR\_BLAS\_H}
00034 \textcolor{preprocessor}{#define EIGEN\_TRIANGULAR\_MATRIX\_VECTOR\_BLAS\_H}
00035 
00036 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00037 
00038 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00039 
00040 \textcolor{comment}{/**********************************************************************}
00041 \textcolor{comment}{* This file implements triangular matrix-vector multiplication using BLAS}
00042 \textcolor{comment}{**********************************************************************/}
00043 
00044 \textcolor{comment}{// trmv/hemv specialization}
00045 
00046 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} Mode, \textcolor{keyword}{typename} LhsScalar, \textcolor{keywordtype}{bool} ConjLhs, \textcolor{keyword}{typename} RhsScalar, \textcolor{keywordtype}{bool} ConjRhs, \textcolor{keywordtype}{int} 
      StorageOrder>
\Hypertarget{eigen_2_eigen_2src_2_core_2products_2_triangular_matrix_vector___b_l_a_s_8h_source_l00047}\hyperlink{struct_eigen_1_1internal_1_1triangular__matrix__vector__product__trmv}{00047} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1triangular__matrix__vector__product__trmv}{triangular\_matrix\_vector\_product\_trmv} :
00048   \hyperlink{struct_eigen_1_1internal_1_1triangular__matrix__vector__product}{triangular\_matrix\_vector\_product}<Index,Mode,LhsScalar,ConjLhs,RhsScalar,C
      onjRhs,StorageOrder,BuiltIn> \{\};
00049 
00050 \textcolor{preprocessor}{#define EIGEN\_BLAS\_TRMV\_SPECIALIZE(Scalar) \(\backslash\)}
00051 \textcolor{preprocessor}{template<typename Index, int Mode, bool ConjLhs, bool ConjRhs> \(\backslash\)}
00052 \textcolor{preprocessor}{struct triangular\_matrix\_vector\_product<Index,Mode,Scalar,ConjLhs,Scalar,ConjRhs,ColMajor,Specialized> \{ \(\backslash\)}
00053 \textcolor{preprocessor}{ static void run(Index \_rows, Index \_cols, const Scalar* \_lhs, Index lhsStride, \(\backslash\)}
00054 \textcolor{preprocessor}{                                     const Scalar* \_rhs, Index rhsIncr, Scalar* \_res, Index resIncr, Scalar
       alpha) \{ \(\backslash\)}
00055 \textcolor{preprocessor}{      triangular\_matrix\_vector\_product\_trmv<Index,Mode,Scalar,ConjLhs,Scalar,ConjRhs,ColMajor>::run( \(\backslash\)}
00056 \textcolor{preprocessor}{        \_rows, \_cols, \_lhs, lhsStride, \_rhs, rhsIncr, \_res, resIncr, alpha); \(\backslash\)}
00057 \textcolor{preprocessor}{  \} \(\backslash\)}
00058 \textcolor{preprocessor}{\}; \(\backslash\)}
00059 \textcolor{preprocessor}{template<typename Index, int Mode, bool ConjLhs, bool ConjRhs> \(\backslash\)}
00060 \textcolor{preprocessor}{struct triangular\_matrix\_vector\_product<Index,Mode,Scalar,ConjLhs,Scalar,ConjRhs,RowMajor,Specialized> \{ \(\backslash\)}
00061 \textcolor{preprocessor}{ static void run(Index \_rows, Index \_cols, const Scalar* \_lhs, Index lhsStride, \(\backslash\)}
00062 \textcolor{preprocessor}{                                     const Scalar* \_rhs, Index rhsIncr, Scalar* \_res, Index resIncr, Scalar
       alpha) \{ \(\backslash\)}
00063 \textcolor{preprocessor}{      triangular\_matrix\_vector\_product\_trmv<Index,Mode,Scalar,ConjLhs,Scalar,ConjRhs,RowMajor>::run( \(\backslash\)}
00064 \textcolor{preprocessor}{        \_rows, \_cols, \_lhs, lhsStride, \_rhs, rhsIncr, \_res, resIncr, alpha); \(\backslash\)}
00065 \textcolor{preprocessor}{  \} \(\backslash\)}
00066 \textcolor{preprocessor}{\};}
00067 
00068 EIGEN\_BLAS\_TRMV\_SPECIALIZE(\textcolor{keywordtype}{double})
00069 EIGEN\_BLAS\_TRMV\_SPECIALIZE(\textcolor{keywordtype}{float})
00070 EIGEN\_BLAS\_TRMV\_SPECIALIZE(dcomplex)
00071 EIGEN\_BLAS\_TRMV\_SPECIALIZE(scomplex)
00072 
00073 \textcolor{comment}{// implements col-major: res += alpha * op(triangular) * vector}
00074 \textcolor{preprocessor}{#define EIGEN\_BLAS\_TRMV\_CM(EIGTYPE, BLASTYPE, EIGPREFIX, BLASPREFIX) \(\backslash\)}
00075 \textcolor{preprocessor}{template<typename Index, int Mode, bool ConjLhs, bool ConjRhs> \(\backslash\)}
00076 \textcolor{preprocessor}{struct triangular\_matrix\_vector\_product\_trmv<Index,Mode,EIGTYPE,ConjLhs,EIGTYPE,ConjRhs,ColMajor> \{ \(\backslash\)}
00077 \textcolor{preprocessor}{  enum \{ \(\backslash\)}
00078 \textcolor{preprocessor}{    IsLower = (Mode&Lower) == Lower, \(\backslash\)}
00079 \textcolor{preprocessor}{    SetDiag = (Mode&(ZeroDiag|UnitDiag)) ? 0 : 1, \(\backslash\)}
00080 \textcolor{preprocessor}{    IsUnitDiag  = (Mode&UnitDiag) ? 1 : 0, \(\backslash\)}
00081 \textcolor{preprocessor}{    IsZeroDiag  = (Mode&ZeroDiag) ? 1 : 0, \(\backslash\)}
00082 \textcolor{preprocessor}{    LowUp = IsLower ? Lower : Upper \(\backslash\)}
00083 \textcolor{preprocessor}{  \}; \(\backslash\)}
00084 \textcolor{preprocessor}{ static void run(Index \_rows, Index \_cols, const EIGTYPE* \_lhs, Index lhsStride, \(\backslash\)}
00085 \textcolor{preprocessor}{                 const EIGTYPE* \_rhs, Index rhsIncr, EIGTYPE* \_res, Index resIncr, EIGTYPE alpha) \(\backslash\)}
00086 \textcolor{preprocessor}{ \{ \(\backslash\)}
00087 \textcolor{preprocessor}{   if (ConjLhs || IsZeroDiag) \{ \(\backslash\)}
00088 \textcolor{preprocessor}{     triangular\_matrix\_vector\_product<Index,Mode,EIGTYPE,ConjLhs,EIGTYPE,ConjRhs,ColMajor,BuiltIn>::run( \(\backslash\)}
00089 \textcolor{preprocessor}{       \_rows, \_cols, \_lhs, lhsStride, \_rhs, rhsIncr, \_res, resIncr, alpha); \(\backslash\)}
00090 \textcolor{preprocessor}{     return; \(\backslash\)}
00091 \textcolor{preprocessor}{   \}\(\backslash\)}
00092 \textcolor{preprocessor}{   Index size = (std::min)(\_rows,\_cols); \(\backslash\)}
00093 \textcolor{preprocessor}{   Index rows = IsLower ? \_rows : size; \(\backslash\)}
00094 \textcolor{preprocessor}{   Index cols = IsLower ? size : \_cols; \(\backslash\)}
00095 \textcolor{preprocessor}{\(\backslash\)}
00096 \textcolor{preprocessor}{   typedef VectorX##EIGPREFIX VectorRhs; \(\backslash\)}
00097 \textcolor{preprocessor}{   EIGTYPE *x, *y;\(\backslash\)}
00098 \textcolor{preprocessor}{\(\backslash\)}
00099 \textcolor{preprocessor}{}\textcolor{comment}{/* Set x*/}\textcolor{preprocessor}{ \(\backslash\)}
00100 \textcolor{preprocessor}{   Map<const VectorRhs, 0, InnerStride<> > rhs(\_rhs,cols,InnerStride<>(rhsIncr)); \(\backslash\)}
00101 \textcolor{preprocessor}{   VectorRhs x\_tmp; \(\backslash\)}
00102 \textcolor{preprocessor}{   if (ConjRhs) x\_tmp = rhs.conjugate(); else x\_tmp = rhs; \(\backslash\)}
00103 \textcolor{preprocessor}{   x = x\_tmp.data(); \(\backslash\)}
00104 \textcolor{preprocessor}{\(\backslash\)}
00105 \textcolor{preprocessor}{}\textcolor{comment}{/* Square part handling */}\textcolor{preprocessor}{\(\backslash\)}
00106 \textcolor{preprocessor}{\(\backslash\)}
00107 \textcolor{preprocessor}{   char trans, uplo, diag; \(\backslash\)}
00108 \textcolor{preprocessor}{   BlasIndex m, n, lda, incx, incy; \(\backslash\)}
00109 \textcolor{preprocessor}{   EIGTYPE const *a; \(\backslash\)}
00110 \textcolor{preprocessor}{   EIGTYPE beta(1); \(\backslash\)}
00111 \textcolor{preprocessor}{\(\backslash\)}
00112 \textcolor{preprocessor}{}\textcolor{comment}{/* Set m, n */}\textcolor{preprocessor}{ \(\backslash\)}
00113 \textcolor{preprocessor}{   n = convert\_index<BlasIndex>(size); \(\backslash\)}
00114 \textcolor{preprocessor}{   lda = convert\_index<BlasIndex>(lhsStride); \(\backslash\)}
00115 \textcolor{preprocessor}{   incx = 1; \(\backslash\)}
00116 \textcolor{preprocessor}{   incy = convert\_index<BlasIndex>(resIncr); \(\backslash\)}
00117 \textcolor{preprocessor}{\(\backslash\)}
00118 \textcolor{preprocessor}{}\textcolor{comment}{/* Set uplo, trans and diag*/}\textcolor{preprocessor}{ \(\backslash\)}
00119 \textcolor{preprocessor}{   trans = 'N'; \(\backslash\)}
00120 \textcolor{preprocessor}{   uplo = IsLower ? 'L' : 'U'; \(\backslash\)}
00121 \textcolor{preprocessor}{   diag = IsUnitDiag ? 'U' : 'N'; \(\backslash\)}
00122 \textcolor{preprocessor}{\(\backslash\)}
00123 \textcolor{preprocessor}{}\textcolor{comment}{/* call ?TRMV*/}\textcolor{preprocessor}{ \(\backslash\)}
00124 \textcolor{preprocessor}{   BLASPREFIX##trmv\_(&uplo, &trans, &diag, &n, (const BLASTYPE*)\_lhs, &lda, (BLASTYPE*)x, &incx); \(\backslash\)}
00125 \textcolor{preprocessor}{\(\backslash\)}
00126 \textcolor{preprocessor}{}\textcolor{comment}{/* Add op(a\_tr)rhs into res*/}\textcolor{preprocessor}{ \(\backslash\)}
00127 \textcolor{preprocessor}{   BLASPREFIX##axpy\_(&n, &numext::real\_ref(alpha),(const BLASTYPE*)x, &incx, (BLASTYPE*)\_res, &incy); \(\backslash\)}
00128 \textcolor{preprocessor}{}\textcolor{comment}{/* Non-square case - doesn't fit to BLAS ?TRMV. Fall to default triangular product*/}\textcolor{preprocessor}{ \(\backslash\)}
00129 \textcolor{preprocessor}{   if (size<(std::max)(rows,cols)) \{ \(\backslash\)}
00130 \textcolor{preprocessor}{     if (ConjRhs) x\_tmp = rhs.conjugate(); else x\_tmp = rhs; \(\backslash\)}
00131 \textcolor{preprocessor}{     x = x\_tmp.data(); \(\backslash\)}
00132 \textcolor{preprocessor}{     if (size<rows) \{ \(\backslash\)}
00133 \textcolor{preprocessor}{       y = \_res + size*resIncr; \(\backslash\)}
00134 \textcolor{preprocessor}{       a = \_lhs + size; \(\backslash\)}
00135 \textcolor{preprocessor}{       m = convert\_index<BlasIndex>(rows-size); \(\backslash\)}
00136 \textcolor{preprocessor}{       n = convert\_index<BlasIndex>(size); \(\backslash\)}
00137 \textcolor{preprocessor}{     \} \(\backslash\)}
00138 \textcolor{preprocessor}{     else \{ \(\backslash\)}
00139 \textcolor{preprocessor}{       x += size; \(\backslash\)}
00140 \textcolor{preprocessor}{       y = \_res; \(\backslash\)}
00141 \textcolor{preprocessor}{       a = \_lhs + size*lda; \(\backslash\)}
00142 \textcolor{preprocessor}{       m = convert\_index<BlasIndex>(size); \(\backslash\)}
00143 \textcolor{preprocessor}{       n = convert\_index<BlasIndex>(cols-size); \(\backslash\)}
00144 \textcolor{preprocessor}{     \} \(\backslash\)}
00145 \textcolor{preprocessor}{     BLASPREFIX##gemv\_(&trans, &m, &n, &numext::real\_ref(alpha), (const BLASTYPE*)a, &lda, (const
       BLASTYPE*)x, &incx, &numext::real\_ref(beta), (BLASTYPE*)y, &incy); \(\backslash\)}
00146 \textcolor{preprocessor}{   \} \(\backslash\)}
00147 \textcolor{preprocessor}{  \} \(\backslash\)}
00148 \textcolor{preprocessor}{\};}
00149 
00150 EIGEN\_BLAS\_TRMV\_CM(\textcolor{keywordtype}{double},   \textcolor{keywordtype}{double}, d,  d)
00151 EIGEN\_BLAS\_TRMV\_CM(dcomplex, \textcolor{keywordtype}{double}, cd, z)
00152 EIGEN\_BLAS\_TRMV\_CM(\textcolor{keywordtype}{float},    \textcolor{keywordtype}{float},  f,  s)
00153 EIGEN\_BLAS\_TRMV\_CM(scomplex, \textcolor{keywordtype}{float},  cf, c)
00154 
00155 \textcolor{comment}{// implements row-major: res += alpha * op(triangular) * vector}
00156 \textcolor{preprocessor}{#define EIGEN\_BLAS\_TRMV\_RM(EIGTYPE, BLASTYPE, EIGPREFIX, BLASPREFIX) \(\backslash\)}
00157 \textcolor{preprocessor}{template<typename Index, int Mode, bool ConjLhs, bool ConjRhs> \(\backslash\)}
00158 \textcolor{preprocessor}{struct triangular\_matrix\_vector\_product\_trmv<Index,Mode,EIGTYPE,ConjLhs,EIGTYPE,ConjRhs,RowMajor> \{ \(\backslash\)}
00159 \textcolor{preprocessor}{  enum \{ \(\backslash\)}
00160 \textcolor{preprocessor}{    IsLower = (Mode&Lower) == Lower, \(\backslash\)}
00161 \textcolor{preprocessor}{    SetDiag = (Mode&(ZeroDiag|UnitDiag)) ? 0 : 1, \(\backslash\)}
00162 \textcolor{preprocessor}{    IsUnitDiag  = (Mode&UnitDiag) ? 1 : 0, \(\backslash\)}
00163 \textcolor{preprocessor}{    IsZeroDiag  = (Mode&ZeroDiag) ? 1 : 0, \(\backslash\)}
00164 \textcolor{preprocessor}{    LowUp = IsLower ? Lower : Upper \(\backslash\)}
00165 \textcolor{preprocessor}{  \}; \(\backslash\)}
00166 \textcolor{preprocessor}{ static void run(Index \_rows, Index \_cols, const EIGTYPE* \_lhs, Index lhsStride, \(\backslash\)}
00167 \textcolor{preprocessor}{                 const EIGTYPE* \_rhs, Index rhsIncr, EIGTYPE* \_res, Index resIncr, EIGTYPE alpha) \(\backslash\)}
00168 \textcolor{preprocessor}{ \{ \(\backslash\)}
00169 \textcolor{preprocessor}{   if (IsZeroDiag) \{ \(\backslash\)}
00170 \textcolor{preprocessor}{     triangular\_matrix\_vector\_product<Index,Mode,EIGTYPE,ConjLhs,EIGTYPE,ConjRhs,RowMajor,BuiltIn>::run( \(\backslash\)}
00171 \textcolor{preprocessor}{       \_rows, \_cols, \_lhs, lhsStride, \_rhs, rhsIncr, \_res, resIncr, alpha); \(\backslash\)}
00172 \textcolor{preprocessor}{     return; \(\backslash\)}
00173 \textcolor{preprocessor}{   \}\(\backslash\)}
00174 \textcolor{preprocessor}{   Index size = (std::min)(\_rows,\_cols); \(\backslash\)}
00175 \textcolor{preprocessor}{   Index rows = IsLower ? \_rows : size; \(\backslash\)}
00176 \textcolor{preprocessor}{   Index cols = IsLower ? size : \_cols; \(\backslash\)}
00177 \textcolor{preprocessor}{\(\backslash\)}
00178 \textcolor{preprocessor}{   typedef VectorX##EIGPREFIX VectorRhs; \(\backslash\)}
00179 \textcolor{preprocessor}{   EIGTYPE *x, *y;\(\backslash\)}
00180 \textcolor{preprocessor}{\(\backslash\)}
00181 \textcolor{preprocessor}{}\textcolor{comment}{/* Set x*/}\textcolor{preprocessor}{ \(\backslash\)}
00182 \textcolor{preprocessor}{   Map<const VectorRhs, 0, InnerStride<> > rhs(\_rhs,cols,InnerStride<>(rhsIncr)); \(\backslash\)}
00183 \textcolor{preprocessor}{   VectorRhs x\_tmp; \(\backslash\)}
00184 \textcolor{preprocessor}{   if (ConjRhs) x\_tmp = rhs.conjugate(); else x\_tmp = rhs; \(\backslash\)}
00185 \textcolor{preprocessor}{   x = x\_tmp.data(); \(\backslash\)}
00186 \textcolor{preprocessor}{\(\backslash\)}
00187 \textcolor{preprocessor}{}\textcolor{comment}{/* Square part handling */}\textcolor{preprocessor}{\(\backslash\)}
00188 \textcolor{preprocessor}{\(\backslash\)}
00189 \textcolor{preprocessor}{   char trans, uplo, diag; \(\backslash\)}
00190 \textcolor{preprocessor}{   BlasIndex m, n, lda, incx, incy; \(\backslash\)}
00191 \textcolor{preprocessor}{   EIGTYPE const *a; \(\backslash\)}
00192 \textcolor{preprocessor}{   EIGTYPE beta(1); \(\backslash\)}
00193 \textcolor{preprocessor}{\(\backslash\)}
00194 \textcolor{preprocessor}{}\textcolor{comment}{/* Set m, n */}\textcolor{preprocessor}{ \(\backslash\)}
00195 \textcolor{preprocessor}{   n = convert\_index<BlasIndex>(size); \(\backslash\)}
00196 \textcolor{preprocessor}{   lda = convert\_index<BlasIndex>(lhsStride); \(\backslash\)}
00197 \textcolor{preprocessor}{   incx = 1; \(\backslash\)}
00198 \textcolor{preprocessor}{   incy = convert\_index<BlasIndex>(resIncr); \(\backslash\)}
00199 \textcolor{preprocessor}{\(\backslash\)}
00200 \textcolor{preprocessor}{}\textcolor{comment}{/* Set uplo, trans and diag*/}\textcolor{preprocessor}{ \(\backslash\)}
00201 \textcolor{preprocessor}{   trans = ConjLhs ? 'C' : 'T'; \(\backslash\)}
00202 \textcolor{preprocessor}{   uplo = IsLower ? 'U' : 'L'; \(\backslash\)}
00203 \textcolor{preprocessor}{   diag = IsUnitDiag ? 'U' : 'N'; \(\backslash\)}
00204 \textcolor{preprocessor}{\(\backslash\)}
00205 \textcolor{preprocessor}{}\textcolor{comment}{/* call ?TRMV*/}\textcolor{preprocessor}{ \(\backslash\)}
00206 \textcolor{preprocessor}{   BLASPREFIX##trmv\_(&uplo, &trans, &diag, &n, (const BLASTYPE*)\_lhs, &lda, (BLASTYPE*)x, &incx); \(\backslash\)}
00207 \textcolor{preprocessor}{\(\backslash\)}
00208 \textcolor{preprocessor}{}\textcolor{comment}{/* Add op(a\_tr)rhs into res*/}\textcolor{preprocessor}{ \(\backslash\)}
00209 \textcolor{preprocessor}{   BLASPREFIX##axpy\_(&n, &numext::real\_ref(alpha),(const BLASTYPE*)x, &incx, (BLASTYPE*)\_res, &incy); \(\backslash\)}
00210 \textcolor{preprocessor}{}\textcolor{comment}{/* Non-square case - doesn't fit to BLAS ?TRMV. Fall to default triangular product*/}\textcolor{preprocessor}{ \(\backslash\)}
00211 \textcolor{preprocessor}{   if (size<(std::max)(rows,cols)) \{ \(\backslash\)}
00212 \textcolor{preprocessor}{     if (ConjRhs) x\_tmp = rhs.conjugate(); else x\_tmp = rhs; \(\backslash\)}
00213 \textcolor{preprocessor}{     x = x\_tmp.data(); \(\backslash\)}
00214 \textcolor{preprocessor}{     if (size<rows) \{ \(\backslash\)}
00215 \textcolor{preprocessor}{       y = \_res + size*resIncr; \(\backslash\)}
00216 \textcolor{preprocessor}{       a = \_lhs + size*lda; \(\backslash\)}
00217 \textcolor{preprocessor}{       m = convert\_index<BlasIndex>(rows-size); \(\backslash\)}
00218 \textcolor{preprocessor}{       n = convert\_index<BlasIndex>(size); \(\backslash\)}
00219 \textcolor{preprocessor}{     \} \(\backslash\)}
00220 \textcolor{preprocessor}{     else \{ \(\backslash\)}
00221 \textcolor{preprocessor}{       x += size; \(\backslash\)}
00222 \textcolor{preprocessor}{       y = \_res; \(\backslash\)}
00223 \textcolor{preprocessor}{       a = \_lhs + size; \(\backslash\)}
00224 \textcolor{preprocessor}{       m = convert\_index<BlasIndex>(size); \(\backslash\)}
00225 \textcolor{preprocessor}{       n = convert\_index<BlasIndex>(cols-size); \(\backslash\)}
00226 \textcolor{preprocessor}{     \} \(\backslash\)}
00227 \textcolor{preprocessor}{     BLASPREFIX##gemv\_(&trans, &n, &m, &numext::real\_ref(alpha), (const BLASTYPE*)a, &lda, (const
       BLASTYPE*)x, &incx, &numext::real\_ref(beta), (BLASTYPE*)y, &incy); \(\backslash\)}
00228 \textcolor{preprocessor}{   \} \(\backslash\)}
00229 \textcolor{preprocessor}{  \} \(\backslash\)}
00230 \textcolor{preprocessor}{\};}
00231 
00232 EIGEN\_BLAS\_TRMV\_RM(\textcolor{keywordtype}{double},   \textcolor{keywordtype}{double}, d,  d)
00233 EIGEN\_BLAS\_TRMV\_RM(dcomplex, \textcolor{keywordtype}{double}, cd, z)
00234 EIGEN\_BLAS\_TRMV\_RM(\textcolor{keywordtype}{float},    \textcolor{keywordtype}{float},  f,  s)
00235 EIGEN\_BLAS\_TRMV\_RM(scomplex, \textcolor{keywordtype}{float},  cf, c)
00236 
00237 \} \textcolor{comment}{// end namespase internal}
00238 
00239 \} \textcolor{comment}{// end namespace Eigen}
00240 
00241 \textcolor{preprocessor}{#endif // EIGEN\_TRIANGULAR\_MATRIX\_VECTOR\_BLAS\_H}
\end{DoxyCode}
