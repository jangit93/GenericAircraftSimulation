\hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source}{}\section{eigen/\+Eigen/src/\+Q\+R/\+Col\+Piv\+Householder\+QR.h}
\label{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source}\index{Col\+Piv\+Householder\+Q\+R.\+h@{Col\+Piv\+Householder\+Q\+R.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2008-2009 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{// Copyright (C) 2009 Benoit Jacob <jacob.benoit.1@gmail.com>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_COLPIVOTINGHOUSEHOLDERQR\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_COLPIVOTINGHOUSEHOLDERQR\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00017}\hyperlink{struct_eigen_1_1internal_1_1traits_3_01_col_piv_householder_q_r_3_01___matrix_type_01_4_01_4}{00017} \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1traits}{traits}<\hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}<\_MatrixType> >
00018  : \hyperlink{struct_eigen_1_1internal_1_1traits}{traits}<\_MatrixType>
00019 \{
00020   \textcolor{keyword}{enum} \{ Flags = 0 \};
00021 \};
00022 
00023 \} \textcolor{comment}{// end namespace internal}
00024 
00048 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType> \textcolor{keyword}{class }\hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}
00049 \{
00050   \textcolor{keyword}{public}:
00051 
00052     \textcolor{keyword}{typedef} \_MatrixType MatrixType;
00053     \textcolor{keyword}{enum} \{
00054       RowsAtCompileTime = MatrixType::RowsAtCompileTime,
00055       ColsAtCompileTime = MatrixType::ColsAtCompileTime,
00056       MaxRowsAtCompileTime = MatrixType::MaxRowsAtCompileTime,
00057       MaxColsAtCompileTime = MatrixType::MaxColsAtCompileTime
00058     \};
00059     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00060     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::RealScalar RealScalar;
00061     \textcolor{comment}{// FIXME should be int}
00062     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::StorageIndex StorageIndex;
00063     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_diag\_type<MatrixType>::type}
       HCoeffsType;
00064     \textcolor{keyword}{typedef} \hyperlink{group___core___module}{PermutationMatrix<ColsAtCompileTime, MaxColsAtCompileTime>}
       PermutationType;
00065     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_row\_type<MatrixType, Index>::type}
       IntRowVectorType;
00066     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_row\_type<MatrixType>::type} 
      RowVectorType;
00067     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} \hyperlink{class_eigen_1_1internal_1_1_tensor_lazy_evaluator_writable}{internal::plain\_row\_type<MatrixType, RealScalar>::type}
       RealRowVectorType;
00068     \textcolor{keyword}{typedef} 
      \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{HouseholderSequence<MatrixType,typename internal::remove\_all<typename
       HCoeffsType::ConjugateReturnType>::type}
      > HouseholderSequenceType;
00069     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::PlainObject PlainObject;
00070 
00071   \textcolor{keyword}{private}:
00072 
00073     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} PermutationType::StorageIndex PermIndexType;
00074 
00075   \textcolor{keyword}{public}:
00076 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00083}\hyperlink{group___q_r___module_a9d8a92c2a2f0debe5454812372237ed4}{00083}     \hyperlink{group___q_r___module_a9d8a92c2a2f0debe5454812372237ed4}{ColPivHouseholderQR}()
00084       : m\_qr(),
00085         m\_hCoeffs(),
00086         m\_colsPermutation(),
00087         m\_colsTranspositions(),
00088         m\_temp(),
00089         m\_colNormsUpdated(),
00090         m\_colNormsDirect(),
00091         m\_isInitialized(false),
00092         m\_usePrescribedThreshold(false) \{\}
00093 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00100}\hyperlink{group___q_r___module_a5965d4fdebc04b2df71d67ff0b2d0c2c}{00100}     \hyperlink{group___q_r___module_a5965d4fdebc04b2df71d67ff0b2d0c2c}{ColPivHouseholderQR}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols)
00101       : m\_qr(rows, cols),
00102         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(rows,cols)),
00103         m\_colsPermutation(PermIndexType(cols)),
00104         m\_colsTranspositions(cols),
00105         m\_temp(cols),
00106         m\_colNormsUpdated(cols),
00107         m\_colNormsDirect(cols),
00108         m\_isInitialized(false),
00109         m\_usePrescribedThreshold(false) \{\}
00110 
00123     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00124}\hyperlink{group___q_r___module_a1aa6a5b95380df0ceb224cb833316d4f}{00124}     \textcolor{keyword}{explicit} \hyperlink{group___q_r___module_a1aa6a5b95380df0ceb224cb833316d4f}{ColPivHouseholderQR}(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00125       : m\_qr(matrix.rows(), matrix.cols()),
00126         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(matrix.rows(),matrix.cols())),
00127         m\_colsPermutation(PermIndexType(matrix.cols())),
00128         m\_colsTranspositions(matrix.cols()),
00129         m\_temp(matrix.cols()),
00130         m\_colNormsUpdated(matrix.cols()),
00131         m\_colNormsDirect(matrix.cols()),
00132         m\_isInitialized(false),
00133         m\_usePrescribedThreshold(false)
00134     \{
00135       compute(matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}());
00136     \}
00137 
00144     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00145}\hyperlink{group___q_r___module_a65782010a93a4c9ef4a9191ac8fe30bc}{00145}     \textcolor{keyword}{explicit} \hyperlink{group___q_r___module_a65782010a93a4c9ef4a9191ac8fe30bc}{ColPivHouseholderQR}(\hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00146       : m\_qr(matrix.derived()),
00147         m\_hCoeffs((\hyperlink{namespacestd}{std}::min)(matrix.rows(),matrix.cols())),
00148         m\_colsPermutation(PermIndexType(matrix.cols())),
00149         m\_colsTranspositions(matrix.cols()),
00150         m\_temp(matrix.cols()),
00151         m\_colNormsUpdated(matrix.cols()),
00152         m\_colNormsDirect(matrix.cols()),
00153         m\_isInitialized(false),
00154         m\_usePrescribedThreshold(false)
00155     \{
00156       computeInPlace();
00157     \}
00158 
00173     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs>
00174     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<ColPivHouseholderQR, Rhs>}
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00175}\hyperlink{group___q_r___module_aaa9c4af89930ab3bb7612ed9ae33d3f5}{00175}     \hyperlink{group___q_r___module_aaa9c4af89930ab3bb7612ed9ae33d3f5}{solve}(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Rhs>}& b)\textcolor{keyword}{ const}
00176 \textcolor{keyword}{    }\{
00177       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00178       \textcolor{keywordflow}{return} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<ColPivHouseholderQR, Rhs>}(*\textcolor{keyword}{this}, b.derived());
00179     \}
00180 
00181     HouseholderSequenceType householderQ() \textcolor{keyword}{const};
00182     HouseholderSequenceType matrixQ()\textcolor{keyword}{ const}
00183 \textcolor{keyword}{    }\{
00184       \textcolor{keywordflow}{return} householderQ();
00185     \}
00186 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00189}\hyperlink{group___q_r___module_aa572ac050c8d4fadd4f08a87f6b1e62b}{00189}     \textcolor{keyword}{const} MatrixType& \hyperlink{group___q_r___module_aa572ac050c8d4fadd4f08a87f6b1e62b}{matrixQR}()\textcolor{keyword}{ const}
00190 \textcolor{keyword}{    }\{
00191       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00192       \textcolor{keywordflow}{return} m\_qr;
00193     \}
00194 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00204}\hyperlink{group___q_r___module_a44c534d47bde6b67ce4b5247d142ef30}{00204}     \textcolor{keyword}{const} MatrixType& \hyperlink{group___q_r___module_a44c534d47bde6b67ce4b5247d142ef30}{matrixR}()\textcolor{keyword}{ const}
00205 \textcolor{keyword}{    }\{
00206       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00207       \textcolor{keywordflow}{return} m\_qr;
00208     \}
00209 
00210     \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
00211     \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}& compute(\textcolor{keyword}{const} \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
      ;
00212 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00214}\hyperlink{group___q_r___module_ab6ad43e6a6fb75726eae0d5499948f4a}{00214}     \textcolor{keyword}{const} PermutationType& \hyperlink{group___q_r___module_ab6ad43e6a6fb75726eae0d5499948f4a}{colsPermutation}()\textcolor{keyword}{ const}
00215 \textcolor{keyword}{    }\{
00216       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00217       \textcolor{keywordflow}{return} m\_colsPermutation;
00218     \}
00219 
00233     \textcolor{keyword}{typename} MatrixType::RealScalar absDeterminant() \textcolor{keyword}{const};
00234 
00247     \textcolor{keyword}{typename} MatrixType::RealScalar logAbsDeterminant() \textcolor{keyword}{const};
00248 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00255}\hyperlink{group___q_r___module_a2a59aaa689613ce5ef0c9130ad33940e}{00255}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_a2a59aaa689613ce5ef0c9130ad33940e}{rank}()\textcolor{keyword}{ const}
00256 \textcolor{keyword}{    }\{
00257       \textcolor{keyword}{using} std::abs;
00258       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00259       RealScalar premultiplied\_threshold = abs(m\_maxpivot) * threshold();
00260       \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} result = 0;
00261       \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < m\_nonzero\_pivots; ++i)
00262         result += (abs(m\_qr.coeff(i,i)) > premultiplied\_threshold);
00263       \textcolor{keywordflow}{return} result;
00264     \}
00265 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00272}\hyperlink{group___q_r___module_a7c9294565d179226133770160b827be1}{00272}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_a7c9294565d179226133770160b827be1}{dimensionOfKernel}()\textcolor{keyword}{ const}
00273 \textcolor{keyword}{    }\{
00274       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00275       \textcolor{keywordflow}{return} cols() - rank();
00276     \}
00277 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00285}\hyperlink{group___q_r___module_a0031998053c9c7345c9458f7443aa263}{00285}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_a0031998053c9c7345c9458f7443aa263}{isInjective}()\textcolor{keyword}{ const}
00286 \textcolor{keyword}{    }\{
00287       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00288       \textcolor{keywordflow}{return} rank() == cols();
00289     \}
00290 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00298}\hyperlink{group___q_r___module_a87a7d06e0b0479e5b56b19c2a4f56365}{00298}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_a87a7d06e0b0479e5b56b19c2a4f56365}{isSurjective}()\textcolor{keyword}{ const}
00299 \textcolor{keyword}{    }\{
00300       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00301       \textcolor{keywordflow}{return} rank() == rows();
00302     \}
00303 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00310}\hyperlink{group___q_r___module_a945720f8d683f8ebe97fa807edd3142a}{00310}     \textcolor{keyword}{inline} \textcolor{keywordtype}{bool} \hyperlink{group___q_r___module_a945720f8d683f8ebe97fa807edd3142a}{isInvertible}()\textcolor{keyword}{ const}
00311 \textcolor{keyword}{    }\{
00312       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00313       \textcolor{keywordflow}{return} isInjective() && isSurjective();
00314     \}
00315 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00321}\hyperlink{group___q_r___module_a31c45402e74774d9cd13af0e57a6b72f}{00321}     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{class_eigen_1_1_inverse}{Inverse<ColPivHouseholderQR>} 
      \hyperlink{group___q_r___module_a31c45402e74774d9cd13af0e57a6b72f}{inverse}()\textcolor{keyword}{ const}
00322 \textcolor{keyword}{    }\{
00323       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00324       \textcolor{keywordflow}{return} \hyperlink{class_eigen_1_1_inverse}{Inverse<ColPivHouseholderQR>}(*this);
00325     \}
00326 
00327     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.rows(); \}
00328     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_qr.cols(); \}
00329 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00334}\hyperlink{group___q_r___module_ac5943d19aa5fd96340c7df6874fcb1b9}{00334}     \textcolor{keyword}{const} HCoeffsType& \hyperlink{group___q_r___module_ac5943d19aa5fd96340c7df6874fcb1b9}{hCoeffs}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_hCoeffs; \}
00335 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00353}\hyperlink{group___q_r___module_ae712cdc9f0e521cfc8061bee58ff55ee}{00353}     \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}& \hyperlink{group___q_r___module_ae712cdc9f0e521cfc8061bee58ff55ee}{setThreshold}(\textcolor{keyword}{const} RealScalar& threshold)
00354     \{
00355       m\_usePrescribedThreshold = \textcolor{keyword}{true};
00356       m\_prescribedThreshold = threshold;
00357       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00358     \}
00359 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00368}\hyperlink{group___q_r___module_a648df14c457ceceb09d933d06d3bdded}{00368}     \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}& \hyperlink{group___q_r___module_a648df14c457ceceb09d933d06d3bdded}{setThreshold}(Default\_t)
00369     \{
00370       m\_usePrescribedThreshold = \textcolor{keyword}{false};
00371       \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00372     \}
00373 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00378}\hyperlink{group___q_r___module_a72276adb1aa11f870f50d0bd58af014d}{00378}     RealScalar \hyperlink{group___q_r___module_a72276adb1aa11f870f50d0bd58af014d}{threshold}()\textcolor{keyword}{ const}
00379 \textcolor{keyword}{    }\{
00380       eigen\_assert(m\_isInitialized || m\_usePrescribedThreshold);
00381       \textcolor{keywordflow}{return} m\_usePrescribedThreshold ? m\_prescribedThreshold
00382       \textcolor{comment}{// this formula comes from experimenting (see "LU precision tuning" thread on the list)}
00383       \textcolor{comment}{// and turns out to be identical to Higham's formula used already in LDLt.}
00384                                       : \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::epsilon}() * RealScalar
      (m\_qr.diagonalSize());
00385     \}
00386 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00394}\hyperlink{group___q_r___module_a796610bab81f0527aa1ae440c71f58a4}{00394}     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} \hyperlink{group___q_r___module_a796610bab81f0527aa1ae440c71f58a4}{nonzeroPivots}()\textcolor{keyword}{ const}
00395 \textcolor{keyword}{    }\{
00396       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00397       \textcolor{keywordflow}{return} m\_nonzero\_pivots;
00398     \}
00399 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00403}\hyperlink{group___q_r___module_aac8c43d720170980f582d01494df9e8f}{00403}     RealScalar \hyperlink{group___q_r___module_aac8c43d720170980f582d01494df9e8f}{maxPivot}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_maxpivot; \}
00404 
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00411}\hyperlink{group___q_r___module_a5c756a789175197cab3eff3a3e479ef2}{00411}     \hyperlink{group__enums_ga85fad7b87587764e5cf6b513a9e0ee5e}{ComputationInfo} \hyperlink{group___q_r___module_a5c756a789175197cab3eff3a3e479ef2}{info}()\textcolor{keyword}{ const}
00412 \textcolor{keyword}{    }\{
00413       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Decomposition is not initialized."});
00414       \textcolor{keywordflow}{return} \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Success};
00415     \}
00416 
00417 \textcolor{preprocessor}{    #ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00418     \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00419     EIGEN\_DEVICE\_FUNC
00420     \textcolor{keywordtype}{void} \_solve\_impl(\textcolor{keyword}{const} RhsType &rhs, DstType &dst) \textcolor{keyword}{const};
00421 \textcolor{preprocessor}{    #endif}
00422 
00423   \textcolor{keyword}{protected}:
00424 
00425     \textcolor{keyword}{friend} \textcolor{keyword}{class }\hyperlink{group___q_r___module_class_eigen_1_1_complete_orthogonal_decomposition}{CompleteOrthogonalDecomposition}<MatrixType>;
00426 
00427     \textcolor{keyword}{static} \textcolor{keywordtype}{void} check\_template\_parameters()
00428     \{
00429       EIGEN\_STATIC\_ASSERT\_NON\_INTEGER(Scalar);
00430     \}
00431 
00432     \textcolor{keywordtype}{void} computeInPlace();
00433 
00434     MatrixType m\_qr;
00435     HCoeffsType m\_hCoeffs;
00436     PermutationType m\_colsPermutation;
00437     IntRowVectorType m\_colsTranspositions;
00438     RowVectorType m\_temp;
00439     RealRowVectorType m\_colNormsUpdated;
00440     RealRowVectorType m\_colNormsDirect;
00441     \textcolor{keywordtype}{bool} m\_isInitialized, m\_usePrescribedThreshold;
00442     RealScalar m\_prescribedThreshold, m\_maxpivot;
00443     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_nonzero\_pivots;
00444     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} m\_det\_pq;
00445 \};
00446 
00447 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00448}\hyperlink{group___q_r___module_ac87c3bf42098d6f7324dafbc50fa83f7}{00448} \textcolor{keyword}{typename} MatrixType::RealScalar \hyperlink{group___q_r___module_ac87c3bf42098d6f7324dafbc50fa83f7}{ColPivHouseholderQR<MatrixType>::absDeterminant}
      ()\textcolor{keyword}{ const}
00449 \textcolor{keyword}{}\{
00450   \textcolor{keyword}{using} std::abs;
00451   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00452   eigen\_assert(m\_qr.rows() == m\_qr.cols() && \textcolor{stringliteral}{"You can't take the determinant of a non-square matrix!"});
00453   \textcolor{keywordflow}{return} abs(m\_qr.diagonal().prod());
00454 \}
00455 
00456 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00457}\hyperlink{group___q_r___module_afdc29438a335871f67449c253369ce12}{00457} \textcolor{keyword}{typename} MatrixType::RealScalar 
      \hyperlink{group___q_r___module_afdc29438a335871f67449c253369ce12}{ColPivHouseholderQR<MatrixType>::logAbsDeterminant}()\textcolor{keyword}{
       const}
00458 \textcolor{keyword}{}\{
00459   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00460   eigen\_assert(m\_qr.rows() == m\_qr.cols() && \textcolor{stringliteral}{"You can't take the determinant of a non-square matrix!"});
00461   \textcolor{keywordflow}{return} m\_qr.diagonal().cwiseAbs().array().log().sum();
00462 \}
00463 
00470 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00471 \textcolor{keyword}{template}<\textcolor{keyword}{typename} InputType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00472}\hyperlink{group___q_r___module_a768c98c092250c9e319c3298b05f0f2d}{00472} \hyperlink{group___q_r___module}{ColPivHouseholderQR<MatrixType>}& 
      \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<MatrixType>::compute}(\textcolor{keyword}{const} 
      \hyperlink{group___core___module_struct_eigen_1_1_eigen_base}{EigenBase<InputType>}& matrix)
00473 \{
00474   m\_qr = matrix.\hyperlink{group___core___module_a324b16961a11d2ecfd2d1b7dd7946545}{derived}();
00475   computeInPlace();
00476   \textcolor{keywordflow}{return} *\textcolor{keyword}{this};
00477 \}
00478 
00479 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00480 \textcolor{keywordtype}{void} \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<MatrixType>::computeInPlace}()
00481 \{
00482   check\_template\_parameters();
00483 
00484   \textcolor{comment}{// the column permutation is stored as int indices, so just to be sure:}
00485   eigen\_assert(m\_qr.cols()<=\hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<int>::highest}());
00486 
00487   \textcolor{keyword}{using} std::abs;
00488 
00489   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows = m\_qr.rows();
00490   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols = m\_qr.cols();
00491   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = m\_qr.diagonalSize();
00492 
00493   m\_hCoeffs.resize(size);
00494 
00495   m\_temp.resize(cols);
00496 
00497   m\_colsTranspositions.resize(m\_qr.cols());
00498   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} number\_of\_transpositions = 0;
00499 
00500   m\_colNormsUpdated.resize(cols);
00501   m\_colNormsDirect.resize(cols);
00502   \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < cols; ++k) \{
00503     \textcolor{comment}{// colNormsDirect(k) caches the most recent directly computed norm of}
00504     \textcolor{comment}{// column k.}
00505     m\_colNormsDirect.coeffRef(k) = m\_qr.col(k).norm();
00506     m\_colNormsUpdated.coeffRef(k) = m\_colNormsDirect.coeffRef(k);
00507   \}
00508 
00509   RealScalar threshold\_helper =  numext::abs2<RealScalar>(m\_colNormsUpdated.maxCoeff() * 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<RealScalar>::epsilon}()) / RealScalar(rows);
00510   RealScalar norm\_downdate\_threshold = numext::sqrt(
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<RealScalar>::epsilon}());
00511 
00512   m\_nonzero\_pivots = size; \textcolor{comment}{// the generic case is that in which all pivots are nonzero (invertible case)}
00513   m\_maxpivot = RealScalar(0);
00514 
00515   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k = 0; k < size; ++k)
00516   \{
00517     \textcolor{comment}{// first, we look up in our table m\_colNormsUpdated which column has the biggest norm}
00518     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} biggest\_col\_index;
00519     RealScalar biggest\_col\_sq\_norm = numext::abs2(m\_colNormsUpdated.tail(cols-k).maxCoeff(&
      biggest\_col\_index));
00520     biggest\_col\_index += k;
00521 
00522     \textcolor{comment}{// Track the number of meaningful pivots but do not stop the decomposition to make}
00523     \textcolor{comment}{// sure that the initial matrix is properly reproduced. See bug 941.}
00524     \textcolor{keywordflow}{if}(m\_nonzero\_pivots==size && biggest\_col\_sq\_norm < threshold\_helper * RealScalar(rows-k))
00525       m\_nonzero\_pivots = k;
00526 
00527     \textcolor{comment}{// apply the transposition to the columns}
00528     m\_colsTranspositions.coeffRef(k) = biggest\_col\_index;
00529     \textcolor{keywordflow}{if}(k != biggest\_col\_index) \{
00530       m\_qr.col(k).swap(m\_qr.col(biggest\_col\_index));
00531       \hyperlink{endian_8c_a3ca5ecd34b04d6a243c054ac3a57f68d}{std::swap}(m\_colNormsUpdated.coeffRef(k), m\_colNormsUpdated.coeffRef(biggest\_col\_index));
00532       \hyperlink{endian_8c_a3ca5ecd34b04d6a243c054ac3a57f68d}{std::swap}(m\_colNormsDirect.coeffRef(k), m\_colNormsDirect.coeffRef(biggest\_col\_index));
00533       ++number\_of\_transpositions;
00534     \}
00535 
00536     \textcolor{comment}{// generate the householder vector, store it below the diagonal}
00537     RealScalar beta;
00538     m\_qr.col(k).tail(rows-k).makeHouseholderInPlace(m\_hCoeffs.coeffRef(k), beta);
00539 
00540     \textcolor{comment}{// apply the householder transformation to the diagonal coefficient}
00541     m\_qr.coeffRef(k,k) = beta;
00542 
00543     \textcolor{comment}{// remember the maximum absolute value of diagonal coefficients}
00544     \textcolor{keywordflow}{if}(abs(beta) > m\_maxpivot) m\_maxpivot = abs(beta);
00545 
00546     \textcolor{comment}{// apply the householder transformation}
00547     m\_qr.bottomRightCorner(rows-k, cols-k-1)
00548         .applyHouseholderOnTheLeft(m\_qr.col(k).tail(rows-k-1), m\_hCoeffs.coeffRef(k), &m\_temp.coeffRef(k+1)
      );
00549 
00550     \textcolor{comment}{// update our table of norms of the columns}
00551     \textcolor{keywordflow}{for} (\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} j = k + 1; j < cols; ++j) \{
00552       \textcolor{comment}{// The following implements the stable norm downgrade step discussed in}
00553       \textcolor{comment}{// http://www.netlib.org/lapack/lawnspdf/lawn176.pdf}
00554       \textcolor{comment}{// and used in LAPACK routines xGEQPF and xGEQP3.}
00555       \textcolor{comment}{// See lines 278-297 in http://www.netlib.org/lapack/explore-html/dc/df4/sgeqpf\_8f\_source.html}
00556       \textcolor{keywordflow}{if} (m\_colNormsUpdated.coeffRef(j) != RealScalar(0)) \{
00557         RealScalar temp = abs(m\_qr.coeffRef(k, j)) / m\_colNormsUpdated.coeffRef(j);
00558         temp = (RealScalar(1) + temp) * (RealScalar(1) - temp);
00559         temp = temp <  RealScalar(0) ? RealScalar(0) : temp;
00560         RealScalar temp2 = temp * numext::abs2<RealScalar>(m\_colNormsUpdated.coeffRef(j) /
00561                                                            m\_colNormsDirect.coeffRef(j));
00562         \textcolor{keywordflow}{if} (temp2 <= norm\_downdate\_threshold) \{
00563           \textcolor{comment}{// The updated norm has become too inaccurate so re-compute the column}
00564           \textcolor{comment}{// norm directly.}
00565           m\_colNormsDirect.coeffRef(j) = m\_qr.col(j).tail(rows - k - 1).norm();
00566           m\_colNormsUpdated.coeffRef(j) = m\_colNormsDirect.coeffRef(j);
00567         \} \textcolor{keywordflow}{else} \{
00568           m\_colNormsUpdated.coeffRef(j) *= numext::sqrt(temp);
00569         \}
00570       \}
00571     \}
00572   \}
00573 
00574   m\_colsPermutation.setIdentity(PermIndexType(cols));
00575   \textcolor{keywordflow}{for}(PermIndexType k = 0; k < size\textcolor{comment}{/*m\_nonzero\_pivots*/}; ++k)
00576     m\_colsPermutation.applyTranspositionOnTheRight(k, PermIndexType(m\_colsTranspositions.coeff(k)));
00577 
00578   m\_det\_pq = (number\_of\_transpositions%2) ? -1 : 1;
00579   m\_isInitialized = \textcolor{keyword}{true};
00580 \}
00581 
00582 \textcolor{preprocessor}{#ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00583 \textcolor{keyword}{template}<\textcolor{keyword}{typename} \_MatrixType>
00584 \textcolor{keyword}{template}<\textcolor{keyword}{typename} RhsType, \textcolor{keyword}{typename} DstType>
00585 \textcolor{keywordtype}{void} \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<\_MatrixType>::\_solve\_impl}(\textcolor{keyword}{const} 
      RhsType &rhs, DstType &dst)\textcolor{keyword}{ const}
00586 \textcolor{keyword}{}\{
00587   eigen\_assert(rhs.rows() == rows());
00588 
00589   \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nonzero\_pivots = nonzeroPivots();
00590 
00591   \textcolor{keywordflow}{if}(nonzero\_pivots == 0)
00592   \{
00593     dst.setZero();
00594     \textcolor{keywordflow}{return};
00595   \}
00596 
00597   \textcolor{keyword}{typename} RhsType::PlainObject c(rhs);
00598 
00599   \textcolor{comment}{// Note that the matrix Q = H\_0^* H\_1^*... so its inverse is Q^* = (H\_0 H\_1 ...)^T}
00600   c.applyOnTheLeft(\hyperlink{group___householder___module_ga4bd4b85120e014cf1125a054b02d4d92}{householderSequence}(m\_qr, m\_hCoeffs)
00601                     .setLength(nonzero\_pivots)
00602                     .transpose()
00603     );
00604 
00605   m\_qr.topLeftCorner(nonzero\_pivots, nonzero\_pivots)
00606       .template triangularView<Upper>()
00607       .solveInPlace(c.topRows(nonzero\_pivots));
00608 
00609   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = 0; i < nonzero\_pivots; ++i) dst.row(m\_colsPermutation.indices().coeff(i)) = c.row(i);
00610   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i = nonzero\_pivots; i < cols(); ++i) dst.row(m\_colsPermutation.indices().coeff(i)).setZero
      ();
00611 \}
00612 \textcolor{preprocessor}{#endif}
00613 
00614 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00615 
00616 \textcolor{keyword}{template}<\textcolor{keyword}{typename} DstXprType, \textcolor{keyword}{typename} MatrixType>
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00617}\hyperlink{struct_eigen_1_1internal_1_1_assignment_3_01_dst_xpr_type_00_01_inverse_3_01_col_piv_householdera738c212c6cb5ba27ad8c50c6864d6b5}{00617} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_assignment}{Assignment}<DstXprType, \hyperlink{class_eigen_1_1_inverse}{Inverse}<\hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR}<MatrixType> >
      , \hyperlink{namespaceinternal}{internal}::\hyperlink{struct_eigen_1_1internal_1_1assign__op}{assign\_op}<typename DstXprType::Scalar,typename ColPivHouseholderQR<MatrixType>:
      :Scalar>, \hyperlink{struct_eigen_1_1internal_1_1_dense2_dense}{Dense2Dense}>
00618 \{
00619   \textcolor{keyword}{typedef} \hyperlink{group___q_r___module}{ColPivHouseholderQR<MatrixType>} \hyperlink{group___q_r___module}{QrType};
00620   \textcolor{keyword}{typedef} \hyperlink{class_eigen_1_1_inverse}{Inverse<QrType>} \hyperlink{class_eigen_1_1_inverse}{SrcXprType};
00621   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(DstXprType &dst, \textcolor{keyword}{const} SrcXprType &src, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1assign__op}{internal::assign\_op<typename DstXprType::Scalar,typename QrType::Scalar>}
       &)
00622   \{
00623     dst = src.nestedExpression().solve(MatrixType::Identity(src.rows(), src.cols()));
00624   \}
00625 \};
00626 
00627 \} \textcolor{comment}{// end namespace internal}
00628 
00632 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00633 \textcolor{keyword}{typename} \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<MatrixType>::HouseholderSequenceType}
       \hyperlink{group___q_r___module_a28ab9d8916ca609c5469c4c192fbfa28}{ColPivHouseholderQR<MatrixType>}
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00634}\hyperlink{group___q_r___module_a28ab9d8916ca609c5469c4c192fbfa28}{00634} \hyperlink{group___q_r___module_a28ab9d8916ca609c5469c4c192fbfa28}{  ::householderQ}()\textcolor{keyword}{ const}
00635 \textcolor{keyword}{}\{
00636   eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"ColPivHouseholderQR is not initialized."});
00637   \textcolor{keywordflow}{return} \hyperlink{group___householder___module_class_eigen_1_1_householder_sequence}{HouseholderSequenceType}(m\_qr, m\_hCoeffs.conjugate());
00638 \}
00639 
00644 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00645 \textcolor{keyword}{const} \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<typename MatrixBase<Derived>::PlainObject}
      >
\Hypertarget{eigen_2_eigen_2src_2_q_r_2_col_piv_householder_q_r_8h_source_l00646}\hyperlink{group___core___module_adee8c19c833245bbb00a591dce68e8a4}{00646} \hyperlink{group___core___module_adee8c19c833245bbb00a591dce68e8a4}{MatrixBase<Derived>::colPivHouseholderQr}()\textcolor{keyword}{ const}
00647 \textcolor{keyword}{}\{
00648   \textcolor{keywordflow}{return} \hyperlink{group___q_r___module_class_eigen_1_1_col_piv_householder_q_r}{ColPivHouseholderQR<PlainObject>}(eval());
00649 \}
00650 
00651 \} \textcolor{comment}{// end namespace Eigen}
00652 
00653 \textcolor{preprocessor}{#endif // EIGEN\_COLPIVOTINGHOUSEHOLDERQR\_H}
\end{DoxyCode}
