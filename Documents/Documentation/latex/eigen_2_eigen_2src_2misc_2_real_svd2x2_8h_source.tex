\hypertarget{eigen_2_eigen_2src_2misc_2_real_svd2x2_8h_source}{}\section{eigen/\+Eigen/src/misc/\+Real\+Svd2x2.h}
\label{eigen_2_eigen_2src_2misc_2_real_svd2x2_8h_source}\index{Real\+Svd2x2.\+h@{Real\+Svd2x2.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2009-2010 Benoit Jacob <jacob.benoit.1@gmail.com>}
00005 \textcolor{comment}{// Copyright (C) 2013-2016 Gael Guennebaud <gael.guennebaud@inria.fr>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_REALSVD2X2\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_REALSVD2X2\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00015 
00016 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00017 
00018 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keyword}{typename} RealScalar, \textcolor{keyword}{typename} Index>
00019 \textcolor{keywordtype}{void} real\_2x2\_jacobi\_svd(\textcolor{keyword}{const} MatrixType& matrix, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} p, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} q,
00020                          JacobiRotation<RealScalar> *j\_left,
00021                          JacobiRotation<RealScalar> *j\_right)
00022 \{
00023   \textcolor{keyword}{using} std::sqrt;
00024   \textcolor{keyword}{using} std::abs;
00025   Matrix<RealScalar,2,2> m;
00026   m << numext::real(matrix.coeff(p,p)), numext::real(matrix.coeff(p,q)),
00027        numext::real(matrix.coeff(q,p)), numext::real(matrix.coeff(q,q));
00028   JacobiRotation<RealScalar> rot1;
00029   RealScalar t = m.coeff(0,0) + m.coeff(1,1);
00030   RealScalar d = m.coeff(1,0) - m.coeff(0,1);
00031 
00032   \textcolor{keywordflow}{if}(abs(d) < (std::numeric\_limits<RealScalar>::min)())
00033   \{
00034     rot1.s() = RealScalar(0);
00035     rot1.c() = RealScalar(1);
00036   \}
00037   \textcolor{keywordflow}{else}
00038   \{
00039     \textcolor{comment}{// If d!=0, then t/d cannot overflow because the magnitude of the}
00040     \textcolor{comment}{// entries forming d are not too small compared to the ones forming t.}
00041     RealScalar u = t / d;
00042     RealScalar tmp = sqrt(RealScalar(1) + numext::abs2(u));
00043     rot1.s() = RealScalar(1) / tmp;
00044     rot1.c() = u / tmp;
00045   \}
00046   m.applyOnTheLeft(0,1,rot1);
00047   j\_right->makeJacobi(m,0,1);
00048   *j\_left = rot1 * j\_right->transpose();
00049 \}
00050 
00051 \} \textcolor{comment}{// end namespace internal}
00052 
00053 \} \textcolor{comment}{// end namespace Eigen}
00054 
00055 \textcolor{preprocessor}{#endif // EIGEN\_REALSVD2X2\_H}
\end{DoxyCode}
