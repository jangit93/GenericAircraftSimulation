\hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___utils_8h_source}{}\section{eigen/\+Eigen/src/\+Sparse\+L\+U/\+Sparse\+L\+U\+\_\+\+Utils.h}
\label{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___utils_8h_source}\index{Sparse\+L\+U\+\_\+\+Utils.\+h@{Sparse\+L\+U\+\_\+\+Utils.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2012 Désiré Nuentsa-Wakam <desire.nuentsa\_wakam@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_SPARSELU\_UTILS\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_SPARSELU\_UTILS\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00020 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} StorageIndex>
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___utils_8h_source_l00021}\hyperlink{group___sparse_l_u___module_acbede3f259186d48ad42ca093f80b64b}{00021} \textcolor{keywordtype}{void} \hyperlink{group___sparse_l_u___module_acbede3f259186d48ad42ca093f80b64b}{SparseLUImpl<Scalar,StorageIndex>::countnz}(\textcolor{keyword}{const} 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}& nnzL, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}& nnzU, \hyperlink{struct_eigen_1_1internal_1_1_l_u___global_l_u__t}{GlobalLU\_t}& glu)
00022 \{
00023  nnzL = 0; 
00024  nnzU = (glu.xusub)(n); 
00025  \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nsuper = (glu.supno)(n); 
00026  \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} jlen; 
00027  \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} i, j, fsupc;
00028  \textcolor{keywordflow}{if} (n <= 0 ) \textcolor{keywordflow}{return}; 
00029  \textcolor{comment}{// For each supernode}
00030  \textcolor{keywordflow}{for} (i = 0; i <= nsuper; i++)
00031  \{
00032    fsupc = glu.xsup(i); 
00033    jlen = glu.xlsub(fsupc+1) - glu.xlsub(fsupc); 
00034    
00035    \textcolor{keywordflow}{for} (j = fsupc; j < glu.xsup(i+1); j++)
00036    \{
00037      nnzL += jlen; 
00038      nnzU += j - fsupc + 1; 
00039      jlen--; 
00040    \}
00041  \}
00042 \}
00043 
00051 \textcolor{keyword}{template} <\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} StorageIndex>
\Hypertarget{eigen_2_eigen_2src_2_sparse_l_u_2_sparse_l_u___utils_8h_source_l00052}\hyperlink{group___sparse_l_u___module_ae1d1ed091956ff4e5734b4e3f79f866e}{00052} \textcolor{keywordtype}{void} \hyperlink{group___sparse_l_u___module_ae1d1ed091956ff4e5734b4e3f79f866e}{SparseLUImpl<Scalar,StorageIndex>::fixupL}(\textcolor{keyword}{const} 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} n, \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix}{IndexVector}& perm\_r, \hyperlink{struct_eigen_1_1internal_1_1_l_u___global_l_u__t}{GlobalLU\_t}& glu)
00053 \{
00054   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} fsupc, i, j, k, jstart; 
00055   
00056   StorageIndex nextl = 0; 
00057   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} nsuper = (glu.supno)(n); 
00058   
00059   \textcolor{comment}{// For each supernode }
00060   \textcolor{keywordflow}{for} (i = 0; i <= nsuper; i++)
00061   \{
00062     fsupc = glu.xsup(i); 
00063     jstart = glu.xlsub(fsupc); 
00064     glu.xlsub(fsupc) = nextl; 
00065     \textcolor{keywordflow}{for} (j = jstart; j < glu.xlsub(fsupc + 1); j++)
00066     \{
00067       glu.lsub(nextl) = perm\_r(glu.lsub(j)); \textcolor{comment}{// Now indexed into P*A}
00068       nextl++;
00069     \}
00070     \textcolor{keywordflow}{for} (k = fsupc+1; k < glu.xsup(i+1); k++)
00071       glu.xlsub(k) = nextl; \textcolor{comment}{// other columns in supernode i}
00072   \}
00073   
00074   glu.xlsub(n) = nextl; 
00075 \}
00076 
00077 \} \textcolor{comment}{// end namespace internal}
00078 
00079 \} \textcolor{comment}{// end namespace Eigen}
00080 \textcolor{preprocessor}{#endif // EIGEN\_SPARSELU\_UTILS\_H}
\end{DoxyCode}
