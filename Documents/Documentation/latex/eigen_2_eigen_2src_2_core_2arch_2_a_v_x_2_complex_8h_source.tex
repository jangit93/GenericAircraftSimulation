\hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source}{}\section{eigen/\+Eigen/src/\+Core/arch/\+A\+V\+X/\+Complex.h}
\label{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source}\index{Complex.\+h@{Complex.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner (benoit.steiner.goog@gmail.com)}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_COMPLEX\_AVX\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_COMPLEX\_AVX\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00017 \textcolor{comment}{//---------- float ----------}
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00018}\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{00018} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}
00019 \{
00020   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}() \{\}
00021   EIGEN\_STRONG\_INLINE \textcolor{keyword}{explicit} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\textcolor{keyword}{const} \_\_m256& a) : v(a) \{\}
00022   \_\_m256  v;
00023 \};
00024 
00025 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1packet__traits}{packet\_traits}<std::\hyperlink{structcomplex}{complex}<float> >  : 
      \hyperlink{struct_eigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}
00026 \{
00027   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} type;
00028   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf} \hyperlink{struct_eigen_1_1half}{half};
00029   \textcolor{keyword}{enum} \{
00030     Vectorizable = 1,
00031     AlignedOnScalar = 1,
00032     size = 4,
00033     HasHalfPacket = 1,
00034 
00035     HasAdd    = 1,
00036     HasSub    = 1,
00037     HasMul    = 1,
00038     HasDiv    = 1,
00039     HasNegate = 1,
00040     HasAbs    = 0,
00041     HasAbs2   = 0,
00042     HasMin    = 0,
00043     HasMax    = 0,
00044     HasSetLinear = 0
00045   \};
00046 \};
00047 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00048}\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_3_01_packet4cf_01_4}{00048} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}<\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}> \{ \textcolor{keyword}{typedef} std::complex<float> type; \textcolor{keyword}{
      enum} \{size=4, alignment=\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a7797d247b86f6e9837cc338beb6060de}{Aligned32}\}; \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf} \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{half}; \};
00049 
00050 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} padd<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_add\_ps(a.v,b.v)); \}
00051 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} psub<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_sub\_ps(a.v,b.v)); \}
00052 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pnegate(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a)
00053 \{
00054   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(pnegate(a.v));
00055 \}
00056 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pconj(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a)
00057 \{
00058   \textcolor{keyword}{const} \_\_m256 mask = \_mm256\_castsi256\_ps(\_mm256\_setr\_epi32(0x00000000,0x80000000,0x00000000,0x80000000,0
      x00000000,0x80000000,0x00000000,0x80000000));
00059   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_xor\_ps(a.v,mask));
00060 \}
00061 
00062 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b)
00063 \{
00064   \_\_m256 tmp1 = \_mm256\_mul\_ps(\_mm256\_moveldup\_ps(a.v), b.v);
00065   \_\_m256 tmp2 = \_mm256\_mul\_ps(\_mm256\_movehdup\_ps(a.v), \_mm256\_permute\_ps(b.v, \_MM\_SHUFFLE(2,3,0,1)));
00066   \_\_m256 result = \_mm256\_addsub\_ps(tmp1, tmp2);
00067   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(result);
00068 \}
00069 
00070 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pand   <Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_and\_ps(a.v,b.v)); \}
00071 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} por    <Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_or\_ps(a.v,b.v)); \}
00072 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pxor   <Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_xor\_ps(a.v,b.v)); \}
00073 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pandnot<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_andnot\_ps(a.v,b.v));
       \}
00074 
00075 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pload <Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from) \{ 
      EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(pload<Packet8f>(&numext::real\_ref(*from))); \}
00076 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} ploadu<Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from) \{ 
      EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(ploadu<Packet8f>(&numext::real\_ref(*from))); \}
00077 
00078 
00079 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pset1<Packet4cf>(\textcolor{keyword}{const} std::complex<float>& from)
00080 \{
00081   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_castpd\_ps(\_mm256\_broadcast\_sd((\textcolor{keyword}{const} \textcolor{keywordtype}{double}*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)&from)));
00082 \}
00083 
00084 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} ploaddup<Packet4cf>(\textcolor{keyword}{const} std::complex<float>* from)
00085 \{
00086   \textcolor{comment}{// FIXME The following might be optimized using \_mm256\_movedup\_pd}
00087   \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf} a = ploaddup<Packet2cf>(from);
00088   \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf} b = ploaddup<Packet2cf>(from+1);
00089   \textcolor{keywordflow}{return}  \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_insertf128\_ps(\_mm256\_castps128\_ps256(a.v), b.v, 1));
00090 \}
00091 
00092 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore <std::complex<float> >(std::complex<float>* to, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& from) \{ EIGEN\_DEBUG\_ALIGNED\_STORE pstore(&numext::real\_ref(*to), from.v); \}
00093 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<std::complex<float> >(std::complex<float>* to, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& from) \{ EIGEN\_DEBUG\_UNALIGNED\_STORE pstoreu(&numext::real\_ref(*to), from.v); \}
00094 
00095 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pgather<std::complex<float>, 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}>(\textcolor{keyword}{const} std::complex<float>* from, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride)
00096 \{
00097   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_set\_ps(std::imag(from[3*stride]), std::real(from[3*stride]),
00098                                  std::imag(from[2*stride]), std::real(from[2*stride]),
00099                                  std::imag(from[1*stride]), std::real(from[1*stride]),
00100                                  std::imag(from[0*stride]), std::real(from[0*stride])));
00101 \}
00102 
00103 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<std::complex<float>, \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}>(
      std::complex<float>* to, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& from, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride)
00104 \{
00105   \_\_m128 low = \_mm256\_extractf128\_ps(from.v, 0);
00106   to[stride*0] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 0)),
00107                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 1)));
00108   to[stride*1] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 2)),
00109                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(low, low, 3)));
00110 
00111   \_\_m128 high = \_mm256\_extractf128\_ps(from.v, 1);
00112   to[stride*2] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 0)),
00113                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 1)));
00114   to[stride*3] = std::complex<float>(\_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 2)),
00115                                      \_mm\_cvtss\_f32(\_mm\_shuffle\_ps(high, high, 3)));
00116 
00117 \}
00118 
00119 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float>  pfirst<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a)
00120 \{
00121   \textcolor{keywordflow}{return} pfirst(\hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf}(\_mm256\_castps256\_ps128(a.v)));
00122 \}
00123 
00124 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} preverse(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a) \{
00125   \_\_m128 low  = \_mm256\_extractf128\_ps(a.v, 0);
00126   \_\_m128 high = \_mm256\_extractf128\_ps(a.v, 1);
00127   \_\_m128d lowd  = \_mm\_castps\_pd(low);
00128   \_\_m128d highd = \_mm\_castps\_pd(high);
00129   low  = \_mm\_castpd\_ps(\_mm\_shuffle\_pd(lowd,lowd,0x1));
00130   high = \_mm\_castpd\_ps(\_mm\_shuffle\_pd(highd,highd,0x1));
00131   \_\_m256 result = \_mm256\_setzero\_ps();
00132   result = \_mm256\_insertf128\_ps(result, low, 1);
00133   result = \_mm256\_insertf128\_ps(result, high, 0);
00134   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(result);
00135 \}
00136 
00137 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float> predux<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a)
00138 \{
00139   \textcolor{keywordflow}{return} predux(padd(\hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf}(\_mm256\_extractf128\_ps(a.v,0)),
00140                      \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf}(\_mm256\_extractf128\_ps(a.v,1))));
00141 \}
00142 
00143 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} preduxp<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}* vecs)
00144 \{
00145   Packet8f t0 = \_mm256\_shuffle\_ps(vecs[0].v, vecs[0].v, \_MM\_SHUFFLE(3, 1, 2 ,0));
00146   Packet8f t1 = \_mm256\_shuffle\_ps(vecs[1].v, vecs[1].v, \_MM\_SHUFFLE(3, 1, 2 ,0));
00147   t0 = \_mm256\_hadd\_ps(t0,t1);
00148   Packet8f t2 = \_mm256\_shuffle\_ps(vecs[2].v, vecs[2].v, \_MM\_SHUFFLE(3, 1, 2 ,0));
00149   Packet8f t3 = \_mm256\_shuffle\_ps(vecs[3].v, vecs[3].v, \_MM\_SHUFFLE(3, 1, 2 ,0));
00150   t2 = \_mm256\_hadd\_ps(t2,t3);
00151   
00152   t1 = \_mm256\_permute2f128\_ps(t0,t2, 0 + (2<<4));
00153   t3 = \_mm256\_permute2f128\_ps(t0,t2, 1 + (3<<4));
00154 
00155   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_add\_ps(t1,t3));
00156 \}
00157 
00158 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<float> predux\_mul<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a)
00159 \{
00160   \textcolor{keywordflow}{return} predux\_mul(pmul(\hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf}(\_mm256\_extractf128\_ps(a.v, 0)),
00161                          \hyperlink{struct_eigen_1_1internal_1_1_packet2cf}{Packet2cf}(\_mm256\_extractf128\_ps(a.v, 1))));
00162 \}
00163 
00164 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} Offset>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00165}\hyperlink{struct_eigen_1_1internal_1_1palign__impl_3_01_offset_00_01_packet4cf_01_4}{00165} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl}<Offset,\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}>
00166 \{
00167   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} run(\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& first, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& second)
00168   \{
00169     \textcolor{keywordflow}{if} (Offset==0) \textcolor{keywordflow}{return};
00170     \hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl<Offset*2,Packet8f>::run}(first.v, second.v);
00171   \}
00172 \};
00173 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00174}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet4cf_00_01_packet4cf_00_01false_00_01true_01_4}{00174} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, false,true>
00175 \{
00176   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& c)\textcolor{keyword}{ const}
00177 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00178 
00179   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b)\textcolor{keyword}{ const}
00180 \textcolor{keyword}{  }\{
00181     \textcolor{keywordflow}{return} internal::pmul(a, pconj(b));
00182   \}
00183 \};
00184 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00185}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet4cf_00_01_packet4cf_00_01true_00_01false_01_4}{00185} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, true,false>
00186 \{
00187   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& c)\textcolor{keyword}{ const}
00188 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00189 
00190   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b)\textcolor{keyword}{ const}
00191 \textcolor{keyword}{  }\{
00192     \textcolor{keywordflow}{return} internal::pmul(pconj(a), b);
00193   \}
00194 \};
00195 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00196}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet4cf_00_01_packet4cf_00_01true_00_01true_01_4}{00196} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, true,true>
00197 \{
00198   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& c)\textcolor{keyword}{ const}
00199 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00200 
00201   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b)\textcolor{keyword}{ const}
00202 \textcolor{keyword}{  }\{
00203     \textcolor{keywordflow}{return} pconj(internal::pmul(a, b));
00204   \}
00205 \};
00206 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00207}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet8f_00_01_packet4cf_00_01false_00_01false_01_4}{00207} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<Packet8f, \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, false,false>
00208 \{
00209   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmadd(\textcolor{keyword}{const} Packet8f& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& c)\textcolor{keyword}{ const}
00210 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(c, pmul(x,y)); \}
00211 
00212   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul(\textcolor{keyword}{const} Packet8f& x, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& y)\textcolor{keyword}{ const}
00213 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(Eigen::internal::pmul(x, y.v)); \}
00214 \};
00215 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00216}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet4cf_00_01_packet8f_00_01false_00_01false_01_4}{00216} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}, Packet8f, false,false>
00217 \{
00218   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x, \textcolor{keyword}{const} Packet8f& y, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& c)\textcolor{keyword}{ const}
00219 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(c, pmul(x,y)); \}
00220 
00221   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x, \textcolor{keyword}{const} Packet8f& y)\textcolor{keyword}{ const}
00222 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(Eigen::internal::pmul(x.v, y)); \}
00223 \};
00224 
00225 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pdiv<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& b)
00226 \{
00227   \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} num = pmul(a, pconj(b));
00228   \_\_m256 tmp = \_mm256\_mul\_ps(b.v, b.v);
00229   \_\_m256 tmp2    = \_mm256\_shuffle\_ps(tmp,tmp,0xB1);
00230   \_\_m256 denom = \_mm256\_add\_ps(tmp, tmp2);
00231   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_div\_ps(num.v, denom));
00232 \}
00233 
00234 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pcplxflip<Packet4cf>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& x)
00235 \{
00236   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_shuffle\_ps(x.v, x.v, \_MM\_SHUFFLE(2, 3, 0 ,1)));
00237 \}
00238 
00239 \textcolor{comment}{//---------- double ----------}
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00240}\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{00240} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}
00241 \{
00242   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}() \{\}
00243   EIGEN\_STRONG\_INLINE \textcolor{keyword}{explicit} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\textcolor{keyword}{const} \_\_m256d& a) : v(a) \{\}
00244   \_\_m256d  v;
00245 \};
00246 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00247}\hyperlink{struct_eigen_1_1internal_1_1packet__traits_3_01std_1_1complex_3_01double_01_4_01_4}{00247} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1packet__traits}{packet\_traits}<std::\hyperlink{structcomplex}{complex}<double> >  : 
      \hyperlink{struct_eigen_1_1internal_1_1default__packet__traits}{default\_packet\_traits}
00248 \{
00249   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{type};
00250   \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd} \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{half};
00251   \textcolor{keyword}{enum} \{
00252     Vectorizable = 1,
00253     AlignedOnScalar = 0,
00254     size = 2,
00255     HasHalfPacket = 1,
00256 
00257     HasAdd    = 1,
00258     HasSub    = 1,
00259     HasMul    = 1,
00260     HasDiv    = 1,
00261     HasNegate = 1,
00262     HasAbs    = 0,
00263     HasAbs2   = 0,
00264     HasMin    = 0,
00265     HasMax    = 0,
00266     HasSetLinear = 0
00267   \};
00268 \};
00269 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00270}\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits_3_01_packet2cd_01_4}{00270} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1unpacket__traits}{unpacket\_traits}<\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}> \{ \textcolor{keyword}{typedef} std::complex<double> type; \textcolor{keyword}{
      enum} \{size=2, alignment=\hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1a7797d247b86f6e9837cc338beb6060de}{Aligned32}\}; \textcolor{keyword}{typedef} \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd} \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{half}; \};
00271 
00272 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} padd<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_add\_pd(a.v,b.v)); \}
00273 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} psub<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_sub\_pd(a.v,b.v)); \}
00274 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pnegate(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a) \{ \textcolor{keywordflow}{return} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(pnegate(a.v)); \}
00275 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pconj(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a)
00276 \{
00277   \textcolor{keyword}{const} \_\_m256d mask = \_mm256\_castsi256\_pd(\_mm256\_set\_epi32(0x80000000,0x0,0x0,0x0,0x80000000,0x0,0x0,0x0))
      ;
00278   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_xor\_pd(a.v,mask));
00279 \}
00280 
00281 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b)
00282 \{
00283   \_\_m256d tmp1 = \_mm256\_shuffle\_pd(a.v,a.v,0x0);
00284   \_\_m256d even = \_mm256\_mul\_pd(tmp1, b.v);
00285   \_\_m256d tmp2 = \_mm256\_shuffle\_pd(a.v,a.v,0xF);
00286   \_\_m256d tmp3 = \_mm256\_shuffle\_pd(b.v,b.v,0x5);
00287   \_\_m256d odd  = \_mm256\_mul\_pd(tmp2, tmp3);
00288   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_addsub\_pd(even, odd));
00289 \}
00290 
00291 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pand   <Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_and\_pd(a.v,b.v)); \}
00292 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} por    <Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_or\_pd(a.v,b.v)); \}
00293 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pxor   <Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_xor\_pd(a.v,b.v)); \}
00294 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pandnot<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b) \{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_andnot\_pd(a.v,b.v));
       \}
00295 
00296 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pload <Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from)
00297 \{ EIGEN\_DEBUG\_ALIGNED\_LOAD \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(pload<Packet4d>((\textcolor{keyword}{const} \textcolor{keywordtype}{double}*)from)); \}
00298 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} ploadu<Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from)
00299 \{ EIGEN\_DEBUG\_UNALIGNED\_LOAD \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(ploadu<Packet4d>((\textcolor{keyword}{const} \textcolor{keywordtype}{double}*)from)); \}
00300 
00301 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pset1<Packet2cd>(\textcolor{keyword}{const} std::complex<double>& from)
00302 \{
00303   \textcolor{comment}{// in case casting to a \_\_m128d* is really not safe, then we can still fallback to this version: (much
       slower though)}
00304 \textcolor{comment}{//   return Packet2cd(\_mm256\_loadu2\_m128d((const double*)&from,(const double*)&from));}
00305     \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_broadcast\_pd((\textcolor{keyword}{const} \_\_m128d*)(\textcolor{keyword}{const} \textcolor{keywordtype}{void}*)&from));
00306 \}
00307 
00308 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} ploaddup<Packet2cd>(\textcolor{keyword}{const} std::complex<double>* from) \{ \textcolor{keywordflow}{
      return} pset1<Packet2cd>(*from); \}
00309 
00310 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore <std::complex<double> >(std::complex<double> *   to, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& from) \{ EIGEN\_DEBUG\_ALIGNED\_STORE pstore((\textcolor{keywordtype}{double}*)to, from.v); \}
00311 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<std::complex<double> >(std::complex<double> *   to, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& from) \{ EIGEN\_DEBUG\_UNALIGNED\_STORE pstoreu((\textcolor{keywordtype}{double}*)to, from.v); \}
00312 
00313 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pgather<std::complex<double>, 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}>(\textcolor{keyword}{const} std::complex<double>* from, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride)
00314 \{
00315   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_set\_pd(std::imag(from[1*stride]), std::real(from[1*stride]),
00316                  std::imag(from[0*stride]), std::real(from[0*stride])));
00317 \}
00318 
00319 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<std::complex<double>, 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}>(std::complex<double>* to, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& from, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride)
00320 \{
00321   \_\_m128d low = \_mm256\_extractf128\_pd(from.v, 0);
00322   to[stride*0] = std::complex<double>(\_mm\_cvtsd\_f64(low), \_mm\_cvtsd\_f64(\_mm\_shuffle\_pd(low, low, 1)));
00323   \_\_m128d high = \_mm256\_extractf128\_pd(from.v, 1);
00324   to[stride*1] = std::complex<double>(\_mm\_cvtsd\_f64(high), \_mm\_cvtsd\_f64(\_mm\_shuffle\_pd(high, high, 1)));
00325 \}
00326 
00327 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> pfirst<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a)
00328 \{
00329   \_\_m128d low = \_mm256\_extractf128\_pd(a.v, 0);
00330   EIGEN\_ALIGN16 \textcolor{keywordtype}{double} res[2];
00331   \_mm\_store\_pd(res, low);
00332   \textcolor{keywordflow}{return} std::complex<double>(res[0],res[1]);
00333 \}
00334 
00335 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} preverse(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a) \{
00336   \_\_m256d result = \_mm256\_permute2f128\_pd(a.v, a.v, 1);
00337   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(result);
00338 \}
00339 
00340 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> predux<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a)
00341 \{
00342   \textcolor{keywordflow}{return} predux(padd(\hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd}(\_mm256\_extractf128\_pd(a.v,0)),
00343                      \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd}(\_mm256\_extractf128\_pd(a.v,1))));
00344 \}
00345 
00346 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} preduxp<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}* vecs)
00347 \{
00348   Packet4d t0 = \_mm256\_permute2f128\_pd(vecs[0].v,vecs[1].v, 0 + (2<<4));
00349   Packet4d t1 = \_mm256\_permute2f128\_pd(vecs[0].v,vecs[1].v, 1 + (3<<4));
00350 
00351   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_add\_pd(t0,t1));
00352 \}
00353 
00354 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE std::complex<double> predux\_mul<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a)
00355 \{
00356   \textcolor{keywordflow}{return} predux(pmul(\hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd}(\_mm256\_extractf128\_pd(a.v,0)),
00357                      \hyperlink{struct_eigen_1_1internal_1_1_packet1cd}{Packet1cd}(\_mm256\_extractf128\_pd(a.v,1))));
00358 \}
00359 
00360 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} Offset>
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00361}\hyperlink{struct_eigen_1_1internal_1_1palign__impl_3_01_offset_00_01_packet2cd_01_4}{00361} \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl}<Offset,\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}>
00362 \{
00363   \textcolor{keyword}{static} EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} run(\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& first, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& second)
00364   \{
00365     \textcolor{keywordflow}{if} (Offset==0) \textcolor{keywordflow}{return};
00366     \hyperlink{struct_eigen_1_1internal_1_1palign__impl}{palign\_impl<Offset*2,Packet4d>::run}(first.v, second.v);
00367   \}
00368 \};
00369 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00370}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet2cd_00_01_packet2cd_00_01false_00_01true_01_4}{00370} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, false,true>
00371 \{
00372   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& c)\textcolor{keyword}{ const}
00373 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00374 
00375   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b)\textcolor{keyword}{ const}
00376 \textcolor{keyword}{  }\{
00377     \textcolor{keywordflow}{return} internal::pmul(a, pconj(b));
00378   \}
00379 \};
00380 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00381}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet2cd_00_01_packet2cd_00_01true_00_01false_01_4}{00381} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, true,false>
00382 \{
00383   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& c)\textcolor{keyword}{ const}
00384 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00385 
00386   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b)\textcolor{keyword}{ const}
00387 \textcolor{keyword}{  }\{
00388     \textcolor{keywordflow}{return} internal::pmul(pconj(a), b);
00389   \}
00390 \};
00391 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00392}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet2cd_00_01_packet2cd_00_01true_00_01true_01_4}{00392} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, true,true>
00393 \{
00394   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& c)\textcolor{keyword}{ const}
00395 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(pmul(x,y),c); \}
00396 
00397   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b)\textcolor{keyword}{ const}
00398 \textcolor{keyword}{  }\{
00399     \textcolor{keywordflow}{return} pconj(internal::pmul(a, b));
00400   \}
00401 \};
00402 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00403}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet4d_00_01_packet2cd_00_01false_00_01false_01_4}{00403} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<Packet4d, \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, false,false>
00404 \{
00405   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmadd(\textcolor{keyword}{const} Packet4d& x, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& y, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& c)\textcolor{keyword}{ const}
00406 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(c, pmul(x,y)); \}
00407 
00408   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul(\textcolor{keyword}{const} Packet4d& x, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& y)\textcolor{keyword}{ const}
00409 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(Eigen::internal::pmul(x, y.v)); \}
00410 \};
00411 
\Hypertarget{eigen_2_eigen_2src_2_core_2arch_2_a_v_x_2_complex_8h_source_l00412}\hyperlink{struct_eigen_1_1internal_1_1conj__helper_3_01_packet2cd_00_01_packet4d_00_01false_00_01false_01_4}{00412} \textcolor{keyword}{template}<> \textcolor{keyword}{struct }\hyperlink{struct_eigen_1_1internal_1_1conj__helper}{conj\_helper}<\hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}, Packet4d, false,false>
00413 \{
00414   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmadd(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x, \textcolor{keyword}{const} Packet4d& y, \textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& c)\textcolor{keyword}{ const}
00415 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} padd(c, pmul(x,y)); \}
00416 
00417   EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pmul(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x, \textcolor{keyword}{const} Packet4d& y)\textcolor{keyword}{ const}
00418 \textcolor{keyword}{  }\{ \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(Eigen::internal::pmul(x.v, y)); \}
00419 \};
00420 
00421 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pdiv<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, \textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& b)
00422 \{
00423   \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} num = pmul(a, pconj(b));
00424   \_\_m256d tmp = \_mm256\_mul\_pd(b.v, b.v);
00425   \_\_m256d denom = \_mm256\_hadd\_pd(tmp, tmp);
00426   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_div\_pd(num.v, denom));
00427 \}
00428 
00429 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pcplxflip<Packet2cd>(\textcolor{keyword}{const} 
      \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& x)
00430 \{
00431   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_shuffle\_pd(x.v, x.v, 0x5));
00432 \}
00433 
00434 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}
00435 ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet4cf,4>}& kernel) \{
00436   \_\_m256d P0 = \_mm256\_castps\_pd(kernel.packet[0].v);
00437   \_\_m256d P1 = \_mm256\_castps\_pd(kernel.packet[1].v);
00438   \_\_m256d P2 = \_mm256\_castps\_pd(kernel.packet[2].v);
00439   \_\_m256d P3 = \_mm256\_castps\_pd(kernel.packet[3].v);
00440 
00441   \_\_m256d T0 = \_mm256\_shuffle\_pd(P0, P1, 15);
00442   \_\_m256d T1 = \_mm256\_shuffle\_pd(P0, P1, 0);
00443   \_\_m256d T2 = \_mm256\_shuffle\_pd(P2, P3, 15);
00444   \_\_m256d T3 = \_mm256\_shuffle\_pd(P2, P3, 0);
00445 
00446   kernel.packet[1].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T0, T2, 32));
00447   kernel.packet[3].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T0, T2, 49));
00448   kernel.packet[0].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T1, T3, 32));
00449   kernel.packet[2].v = \_mm256\_castpd\_ps(\_mm256\_permute2f128\_pd(T1, T3, 49));
00450 \}
00451 
00452 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}
00453 ptranspose(\hyperlink{struct_eigen_1_1internal_1_1_packet_block}{PacketBlock<Packet2cd,2>}& kernel) \{
00454   \_\_m256d tmp = \_mm256\_permute2f128\_pd(kernel.packet[0].v, kernel.packet[1].v, 0+(2<<4));
00455   kernel.packet[1].v = \_mm256\_permute2f128\_pd(kernel.packet[0].v, kernel.packet[1].v, 1+(3<<4));
00456  kernel.packet[0].v = tmp;
00457 \}
00458 
00459 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pinsertfirst(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, 
      std::complex<float> b)
00460 \{
00461   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_blend\_ps(a.v,pset1<Packet4cf>(b).v,1|2));
00462 \}
00463 
00464 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pinsertfirst(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, 
      std::complex<double> b)
00465 \{
00466   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_blend\_pd(a.v,pset1<Packet2cd>(b).v,1|2));
00467 \}
00468 
00469 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf} pinsertlast(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}& a, 
      std::complex<float> b)
00470 \{
00471   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet4cf}{Packet4cf}(\_mm256\_blend\_ps(a.v,pset1<Packet4cf>(b).v,(1<<7)|(1<<6)));
00472 \}
00473 
00474 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd} pinsertlast(\textcolor{keyword}{const} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}& a, 
      std::complex<double> b)
00475 \{
00476   \textcolor{keywordflow}{return} \hyperlink{struct_eigen_1_1internal_1_1_packet2cd}{Packet2cd}(\_mm256\_blend\_pd(a.v,pset1<Packet2cd>(b).v,(1<<3)|(1<<2)));
00477 \}
00478 
00479 \} \textcolor{comment}{// end namespace internal}
00480 
00481 \} \textcolor{comment}{// end namespace Eigen}
00482 
00483 \textcolor{preprocessor}{#endif // EIGEN\_COMPLEX\_AVX\_H}
\end{DoxyCode}
