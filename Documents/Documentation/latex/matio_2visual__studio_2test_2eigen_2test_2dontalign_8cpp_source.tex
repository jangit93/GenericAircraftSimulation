\hypertarget{matio_2visual__studio_2test_2eigen_2test_2dontalign_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/test/dontalign.cpp}
\label{matio_2visual__studio_2test_2eigen_2test_2dontalign_8cpp_source}\index{dontalign.\+cpp@{dontalign.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2011 Benoit Jacob <jacob.benoit.1@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#if defined EIGEN\_TEST\_PART\_1 || defined EIGEN\_TEST\_PART\_2 || defined EIGEN\_TEST\_PART\_3 || defined
       EIGEN\_TEST\_PART\_4}
00011 \textcolor{preprocessor}{#define EIGEN\_DONT\_ALIGN}
00012 \textcolor{preprocessor}{#elif defined EIGEN\_TEST\_PART\_5 || defined EIGEN\_TEST\_PART\_6 || defined EIGEN\_TEST\_PART\_7 || defined
       EIGEN\_TEST\_PART\_8}
00013 \textcolor{preprocessor}{#define EIGEN\_DONT\_ALIGN\_STATICALLY}
00014 \textcolor{preprocessor}{#endif}
00015 
00016 \textcolor{preprocessor}{#include "main.h"}
00017 \textcolor{preprocessor}{#include <Eigen/Dense>}
00018 
00019 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType>
00020 \textcolor{keywordtype}{void} dontalign(\textcolor{keyword}{const} MatrixType& m)
00021 \{
00022   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Index \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index};
00023   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::Scalar Scalar;
00024   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar, MatrixType::RowsAtCompileTime, 1>} 
      \hyperlink{struct_vector_type}{VectorType};
00025   \textcolor{keyword}{typedef} 
      \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar, MatrixType::RowsAtCompileTime, MatrixType::RowsAtCompileTime>}
       SquareMatrixType;
00026 
00027   Index rows = m.rows();
00028   Index cols = m.cols();
00029 
00030   MatrixType a = MatrixType::Random(rows,cols);
00031   SquareMatrixType square = SquareMatrixType::Random(rows,rows);
00032   VectorType v = VectorType::Random(rows);
00033 
00034   VERIFY\_IS\_APPROX(v, square * square.colPivHouseholderQr().solve(v));
00035   square = square.inverse().eval();
00036   a = square * a;
00037   square = square*square;
00038   v = square * v;
00039   v = a.adjoint() * v;
00040   VERIFY(square.determinant() != Scalar(0));
00041 
00042   \textcolor{comment}{// bug 219: MapAligned() was giving an assert with EIGEN\_DONT\_ALIGN, because Map Flags were miscomputed}
00043   Scalar* \hyperlink{class_eigen_1_1array}{array} = internal::aligned\_new<Scalar>(rows);
00044   v = VectorType::MapAligned(array, rows);
00045   internal::aligned\_delete(array, rows);
00046 \}
00047 
00048 \textcolor{keywordtype}{void} test\_dontalign()
00049 \{
00050 \textcolor{preprocessor}{#if defined EIGEN\_TEST\_PART\_1 || defined EIGEN\_TEST\_PART\_5}
00051   dontalign(Matrix3d());
00052   dontalign(Matrix4f());
00053 \textcolor{preprocessor}{#elif defined EIGEN\_TEST\_PART\_2 || defined EIGEN\_TEST\_PART\_6}
00054   dontalign(Matrix3cd());
00055   dontalign(Matrix4cf());
00056 \textcolor{preprocessor}{#elif defined EIGEN\_TEST\_PART\_3 || defined EIGEN\_TEST\_PART\_7}
00057   dontalign(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<float, 32, 32>}());
00058   dontalign(\hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix}<std::complex<float>, 32, 32>());
00059 \textcolor{preprocessor}{#elif defined EIGEN\_TEST\_PART\_4 || defined EIGEN\_TEST\_PART\_8}
00060   dontalign(MatrixXd(32, 32));
00061   dontalign(MatrixXcf(32, 32));
00062 \textcolor{preprocessor}{#endif}
00063 \}
\end{DoxyCode}
