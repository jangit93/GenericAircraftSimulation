\hypertarget{eigen_2test_2incomplete__cholesky_8cpp_source}{}\section{eigen/test/incomplete\+\_\+cholesky.cpp}
\label{eigen_2test_2incomplete__cholesky_8cpp_source}\index{incomplete\+\_\+cholesky.\+cpp@{incomplete\+\_\+cholesky.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2015-2016 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 \textcolor{comment}{// #define EIGEN\_DONT\_VECTORIZE}
00010 \textcolor{comment}{// #define EIGEN\_MAX\_ALIGN\_BYTES 0}
00011 \textcolor{preprocessor}{#include "sparse\_solver.h"}
00012 \textcolor{preprocessor}{#include <Eigen/IterativeLinearSolvers>}
00013 \textcolor{preprocessor}{#include <unsupported/Eigen/IterativeSolvers>}
00014 
00015 \textcolor{keyword}{template}<\textcolor{keyword}{typename} T, \textcolor{keyword}{typename} I> \textcolor{keywordtype}{void} test\_incomplete\_cholesky\_T()
00016 \{
00017   \textcolor{keyword}{typedef} \hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_matrix}{SparseMatrix<T,0,I>} SparseMatrixType;
00018   
      \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{ConjugateGradient<SparseMatrixType, Lower, IncompleteCholesky<T, Lower, AMDOrdering<I>}
       > >        cg\_illt\_lower\_amd;
00019   
      \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{ConjugateGradient<SparseMatrixType, Lower, IncompleteCholesky<T, Lower, NaturalOrdering<I>}
       > >    cg\_illt\_lower\_nat;
00020   
      \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{ConjugateGradient<SparseMatrixType, Upper, IncompleteCholesky<T, Upper, AMDOrdering<I>}
       > >        cg\_illt\_upper\_amd;
00021   
      \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{ConjugateGradient<SparseMatrixType, Upper, IncompleteCholesky<T, Upper, NaturalOrdering<I>}
       > >    cg\_illt\_upper\_nat;
00022   
      \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{ConjugateGradient<SparseMatrixType, Upper|Lower, IncompleteCholesky<T, Lower, AMDOrdering<I>}
       > >  cg\_illt\_uplo\_amd;
00023   
00024 
00025   CALL\_SUBTEST( check\_sparse\_spd\_solving(cg\_illt\_lower\_amd) );
00026   CALL\_SUBTEST( check\_sparse\_spd\_solving(cg\_illt\_lower\_nat) );
00027   CALL\_SUBTEST( check\_sparse\_spd\_solving(cg\_illt\_upper\_amd) );
00028   CALL\_SUBTEST( check\_sparse\_spd\_solving(cg\_illt\_upper\_nat) );
00029   CALL\_SUBTEST( check\_sparse\_spd\_solving(cg\_illt\_uplo\_amd) );
00030 \}
00031 
00032 \textcolor{keywordtype}{void} test\_incomplete\_cholesky()
00033 \{
00034   CALL\_SUBTEST\_1(( test\_incomplete\_cholesky\_T<double,int>() ));
00035   CALL\_SUBTEST\_2(( test\_incomplete\_cholesky\_T<std::complex<double>, \textcolor{keywordtype}{int}>() ));
00036   CALL\_SUBTEST\_3(( test\_incomplete\_cholesky\_T<double,long int>() ));
00037 
00038 \textcolor{preprocessor}{#ifdef EIGEN\_TEST\_PART\_1}
00039     \textcolor{comment}{// regression for bug 1150}
00040   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} N = 1; N<20; ++N)
00041   \{
00042     Eigen::MatrixXd b( N, N );
00043     b.setOnes();
00044 
00045     \hyperlink{group___sparse_core___module}{Eigen::SparseMatrix<double>} m( N, N );
00046     m.reserve(Eigen::VectorXi::Constant(N,4));
00047     \textcolor{keywordflow}{for}( \textcolor{keywordtype}{int} i = 0; i < N; ++i )
00048     \{
00049         m.insert( i, i ) = 1;
00050         m.coeffRef( i, i / 2 ) = 2;
00051         m.coeffRef( i, i / 3 ) = 2;
00052         m.coeffRef( i, i / 4 ) = 2;
00053     \}
00054 
00055     \hyperlink{group___sparse_core___module}{Eigen::SparseMatrix<double>} \hyperlink{group___core___module_class_eigen_1_1_matrix}{A};
00056     A = m * m.transpose();
00057 
00058     \hyperlink{group___iterative_linear_solvers___module_class_eigen_1_1_conjugate_gradient}{Eigen::ConjugateGradient<Eigen::SparseMatrix<double>}
      ,
00059         \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Eigen::Lower} | \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Eigen::Upper},
00060         \hyperlink{class_eigen_1_1_incomplete_cholesky}{Eigen::IncompleteCholesky<double>} > solver( A );
00061     VERIFY(solver.preconditioner().info() == \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Eigen::Success});
00062     VERIFY(solver.info() == \hyperlink{group__enums_gga85fad7b87587764e5cf6b513a9e0ee5ea52581b035f4b59c203b8ff999ef5fcea}{Eigen::Success});
00063   \}
00064 \textcolor{preprocessor}{#endif}
00065 \}
\end{DoxyCode}
