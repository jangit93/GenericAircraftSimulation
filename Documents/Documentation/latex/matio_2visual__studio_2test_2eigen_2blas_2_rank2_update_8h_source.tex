\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2_rank2_update_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/\+Rank2\+Update.h}
\label{matio_2visual__studio_2test_2eigen_2blas_2_rank2_update_8h_source}\index{Rank2\+Update.\+h@{Rank2\+Update.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2012 Chen-Pang He <jdh8@ms63.hinet.net>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_RANK2UPDATE\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_RANK2UPDATE\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00014 
00015 \textcolor{comment}{/* Optimized selfadjoint matrix += alpha * uv' + conj(alpha)*vu'}
00016 \textcolor{comment}{ * This is the low-level version of SelfadjointRank2Update.h}
00017 \textcolor{comment}{ */}
00018 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} UpLo>
00019 \textcolor{keyword}{struct }rank2\_update\_selector
00020 \{
00021   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, Scalar* mat, Index stride, \textcolor{keyword}{const} Scalar* u, \textcolor{keyword}{const} Scalar* v, Scalar alpha)
00022   \{
00023     \textcolor{keyword}{typedef} Map<const Matrix<Scalar,Dynamic,1> > OtherMap;
00024     \textcolor{keywordflow}{for} (Index i=0; i<size; ++i)
00025     \{
00026       Map<Matrix<Scalar,Dynamic,1> >(mat+stride*i+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? i : 0), UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1)) +=
00027       numext::conj(alpha) * numext::conj(u[i]) * OtherMap(v+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? i : 0), UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1))
00028                 + alpha * numext::conj(v[i]) * OtherMap(u+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? i : 0), UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1));
00029     \}
00030   \}
00031 \};
00032 
00033 \textcolor{comment}{/* Optimized selfadjoint matrix += alpha * uv' + conj(alpha)*vu'}
00034 \textcolor{comment}{ * The matrix is in packed form.}
00035 \textcolor{comment}{ */}
00036 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar, \textcolor{keyword}{typename} Index, \textcolor{keywordtype}{int} UpLo>
00037 \textcolor{keyword}{struct }packed\_rank2\_update\_selector
00038 \{
00039   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(Index size, Scalar* mat, \textcolor{keyword}{const} Scalar* u, \textcolor{keyword}{const} Scalar* v, Scalar alpha)
00040   \{
00041     \textcolor{keyword}{typedef} Map<const Matrix<Scalar,Dynamic,1> > OtherMap;
00042     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} offset = 0;
00043     \textcolor{keywordflow}{for} (Index i=0; i<size; ++i)
00044     \{
00045       Map<Matrix<Scalar,Dynamic,1> >(mat+offset, UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1)) +=
00046       numext::conj(alpha) * numext::conj(u[i]) * OtherMap(v+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? i : 0), UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1))
00047                 + alpha * numext::conj(v[i]) * OtherMap(u+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? i : 0), UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1));
00048       \textcolor{comment}{//FIXME This should be handled outside.}
00049       mat[offset+(UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? 0 : i)] = numext::real(mat[offset+(UpLo==
      \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? 0 : i)]);
00050       offset += UpLo==\hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower} ? size-i : (i+1);
00051     \}
00052   \}
00053 \};
00054 
00055 \} \textcolor{comment}{// end namespace internal}
00056 
00057 \textcolor{preprocessor}{#endif // EIGEN\_RANK2UPDATE\_H}
\end{DoxyCode}
