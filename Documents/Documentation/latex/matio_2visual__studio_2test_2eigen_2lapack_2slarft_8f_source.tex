\hypertarget{matio_2visual__studio_2test_2eigen_2lapack_2slarft_8f_source}{}\section{matio/visual\+\_\+studio/test/eigen/lapack/slarft.f}
\label{matio_2visual__studio_2test_2eigen_2lapack_2slarft_8f_source}\index{slarft.\+f@{slarft.\+f}}

\begin{DoxyCode}
00001 \textcolor{comment}{*> \(\backslash\)brief \(\backslash\)b SLARFT}
00002 \textcolor{comment}{*}
00003 \textcolor{comment}{*  =========== DOCUMENTATION ===========}
00004 \textcolor{comment}{*}
00005 \textcolor{comment}{* Online html documentation available at }
00006 \textcolor{comment}{*            http://www.netlib.org/lapack/explore-html/ }
00007 \textcolor{comment}{*}
00008 \textcolor{comment}{*> \(\backslash\)htmlonly}
00009 \textcolor{comment}{*> Download SLARFT + dependencies }
00010 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.tgz?format=tgz&filename=/lapack/lapack\_routine/slarft.f"> }
00011 \textcolor{comment}{*> [TGZ]</a> }
00012 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.zip?format=zip&filename=/lapack/lapack\_routine/slarft.f"> }
00013 \textcolor{comment}{*> [ZIP]</a> }
00014 \textcolor{comment}{*> <a
       href="http://www.netlib.org/cgi-bin/netlibfiles.txt?format=txt&filename=/lapack/lapack\_routine/slarft.f"> }
00015 \textcolor{comment}{*> [TXT]</a>}
00016 \textcolor{comment}{*> \(\backslash\)endhtmlonly }
00017 \textcolor{comment}{*}
00018 \textcolor{comment}{*  Definition:}
00019 \textcolor{comment}{*  ===========}
00020 \textcolor{comment}{*}
00021 \textcolor{comment}{*       SUBROUTINE SLARFT( DIRECT, STOREV, N, K, V, LDV, TAU, T, LDT )}
00022 \textcolor{comment}{* }
00023 \textcolor{comment}{*       .. Scalar Arguments ..}
00024 \textcolor{comment}{*       CHARACTER          DIRECT, STOREV}
00025 \textcolor{comment}{*       INTEGER            K, LDT, LDV, N}
00026 \textcolor{comment}{*       ..}
00027 \textcolor{comment}{*       .. Array Arguments ..}
00028 \textcolor{comment}{*       REAL               T( LDT, * ), TAU( * ), V( LDV, * )}
00029 \textcolor{comment}{*       ..}
00030 \textcolor{comment}{*  }
00031 \textcolor{comment}{*}
00032 \textcolor{comment}{*> \(\backslash\)par Purpose:}
00033 \textcolor{comment}{*  =============}
00034 \textcolor{comment}{*>}
00035 \textcolor{comment}{*> \(\backslash\)verbatim}
00036 \textcolor{comment}{*>}
00037 \textcolor{comment}{*> SLARFT forms the triangular factor T of a real block reflector H}
00038 \textcolor{comment}{*> of order n, which is defined as a product of k elementary reflectors.}
00039 \textcolor{comment}{*>}
00040 \textcolor{comment}{*> If DIRECT = 'F', H = H(1) H(2) . . . H(k) and T is upper triangular;}
00041 \textcolor{comment}{*>}
00042 \textcolor{comment}{*> If DIRECT = 'B', H = H(k) . . . H(2) H(1) and T is lower triangular.}
00043 \textcolor{comment}{*>}
00044 \textcolor{comment}{*> If STOREV = 'C', the vector which defines the elementary reflector}
00045 \textcolor{comment}{*> H(i) is stored in the i-th column of the array V, and}
00046 \textcolor{comment}{*>}
00047 \textcolor{comment}{*>    H  =  I - V * T * V**T}
00048 \textcolor{comment}{*>}
00049 \textcolor{comment}{*> If STOREV = 'R', the vector which defines the elementary reflector}
00050 \textcolor{comment}{*> H(i) is stored in the i-th row of the array V, and}
00051 \textcolor{comment}{*>}
00052 \textcolor{comment}{*>    H  =  I - V**T * T * V}
00053 \textcolor{comment}{*> \(\backslash\)endverbatim}
00054 \textcolor{comment}{*}
00055 \textcolor{comment}{*  Arguments:}
00056 \textcolor{comment}{*  ==========}
00057 \textcolor{comment}{*}
00058 \textcolor{comment}{*> \(\backslash\)param[in] DIRECT}
00059 \textcolor{comment}{*> \(\backslash\)verbatim}
00060 \textcolor{comment}{*>          DIRECT is CHARACTER*1}
00061 \textcolor{comment}{*>          Specifies the order in which the elementary reflectors are}
00062 \textcolor{comment}{*>          multiplied to form the block reflector:}
00063 \textcolor{comment}{*>          = 'F': H = H(1) H(2) . . . H(k) (Forward)}
00064 \textcolor{comment}{*>          = 'B': H = H(k) . . . H(2) H(1) (Backward)}
00065 \textcolor{comment}{*> \(\backslash\)endverbatim}
00066 \textcolor{comment}{*>}
00067 \textcolor{comment}{*> \(\backslash\)param[in] STOREV}
00068 \textcolor{comment}{*> \(\backslash\)verbatim}
00069 \textcolor{comment}{*>          STOREV is CHARACTER*1}
00070 \textcolor{comment}{*>          Specifies how the vectors which define the elementary}
00071 \textcolor{comment}{*>          reflectors are stored (see also Further Details):}
00072 \textcolor{comment}{*>          = 'C': columnwise}
00073 \textcolor{comment}{*>          = 'R': rowwise}
00074 \textcolor{comment}{*> \(\backslash\)endverbatim}
00075 \textcolor{comment}{*>}
00076 \textcolor{comment}{*> \(\backslash\)param[in] N}
00077 \textcolor{comment}{*> \(\backslash\)verbatim}
00078 \textcolor{comment}{*>          N is INTEGER}
00079 \textcolor{comment}{*>          The order of the block reflector H. N >= 0.}
00080 \textcolor{comment}{*> \(\backslash\)endverbatim}
00081 \textcolor{comment}{*>}
00082 \textcolor{comment}{*> \(\backslash\)param[in] K}
00083 \textcolor{comment}{*> \(\backslash\)verbatim}
00084 \textcolor{comment}{*>          K is INTEGER}
00085 \textcolor{comment}{*>          The order of the triangular factor T (= the number of}
00086 \textcolor{comment}{*>          elementary reflectors). K >= 1.}
00087 \textcolor{comment}{*> \(\backslash\)endverbatim}
00088 \textcolor{comment}{*>}
00089 \textcolor{comment}{*> \(\backslash\)param[in] V}
00090 \textcolor{comment}{*> \(\backslash\)verbatim}
00091 \textcolor{comment}{*>          V is REAL array, dimension}
00092 \textcolor{comment}{*>                               (LDV,K) if STOREV = 'C'}
00093 \textcolor{comment}{*>                               (LDV,N) if STOREV = 'R'}
00094 \textcolor{comment}{*>          The matrix V. See further details.}
00095 \textcolor{comment}{*> \(\backslash\)endverbatim}
00096 \textcolor{comment}{*>}
00097 \textcolor{comment}{*> \(\backslash\)param[in] LDV}
00098 \textcolor{comment}{*> \(\backslash\)verbatim}
00099 \textcolor{comment}{*>          LDV is INTEGER}
00100 \textcolor{comment}{*>          The leading dimension of the array V.}
00101 \textcolor{comment}{*>          If STOREV = 'C', LDV >= max(1,N); if STOREV = 'R', LDV >= K.}
00102 \textcolor{comment}{*> \(\backslash\)endverbatim}
00103 \textcolor{comment}{*>}
00104 \textcolor{comment}{*> \(\backslash\)param[in] TAU}
00105 \textcolor{comment}{*> \(\backslash\)verbatim}
00106 \textcolor{comment}{*>          TAU is REAL array, dimension (K)}
00107 \textcolor{comment}{*>          TAU(i) must contain the scalar factor of the elementary}
00108 \textcolor{comment}{*>          reflector H(i).}
00109 \textcolor{comment}{*> \(\backslash\)endverbatim}
00110 \textcolor{comment}{*>}
00111 \textcolor{comment}{*> \(\backslash\)param[out] T}
00112 \textcolor{comment}{*> \(\backslash\)verbatim}
00113 \textcolor{comment}{*>          T is REAL array, dimension (LDT,K)}
00114 \textcolor{comment}{*>          The k by k triangular factor T of the block reflector.}
00115 \textcolor{comment}{*>          If DIRECT = 'F', T is upper triangular; if DIRECT = 'B', T is}
00116 \textcolor{comment}{*>          lower triangular. The rest of the array is not used.}
00117 \textcolor{comment}{*> \(\backslash\)endverbatim}
00118 \textcolor{comment}{*>}
00119 \textcolor{comment}{*> \(\backslash\)param[in] LDT}
00120 \textcolor{comment}{*> \(\backslash\)verbatim}
00121 \textcolor{comment}{*>          LDT is INTEGER}
00122 \textcolor{comment}{*>          The leading dimension of the array T. LDT >= K.}
00123 \textcolor{comment}{*> \(\backslash\)endverbatim}
00124 \textcolor{comment}{*}
00125 \textcolor{comment}{*  Authors:}
00126 \textcolor{comment}{*  ========}
00127 \textcolor{comment}{*}
00128 \textcolor{comment}{*> \(\backslash\)author Univ. of Tennessee }
00129 \textcolor{comment}{*> \(\backslash\)author Univ. of California Berkeley }
00130 \textcolor{comment}{*> \(\backslash\)author Univ. of Colorado Denver }
00131 \textcolor{comment}{*> \(\backslash\)author NAG Ltd. }
00132 \textcolor{comment}{*}
00133 \textcolor{comment}{*> \(\backslash\)date April 2012}
00134 \textcolor{comment}{*}
00135 \textcolor{comment}{*> \(\backslash\)ingroup realOTHERauxiliary}
00136 \textcolor{comment}{*}
00137 \textcolor{comment}{*> \(\backslash\)par Further Details:}
00138 \textcolor{comment}{*  =====================}
00139 \textcolor{comment}{*>}
00140 \textcolor{comment}{*> \(\backslash\)verbatim}
00141 \textcolor{comment}{*>}
00142 \textcolor{comment}{*>  The shape of the matrix V and the storage of the vectors which define}
00143 \textcolor{comment}{*>  the H(i) is best illustrated by the following example with n = 5 and}
00144 \textcolor{comment}{*>  k = 3. The elements equal to 1 are not stored.}
00145 \textcolor{comment}{*>}
00146 \textcolor{comment}{*>  DIRECT = 'F' and STOREV = 'C':         DIRECT = 'F' and STOREV = 'R':}
00147 \textcolor{comment}{*>}
00148 \textcolor{comment}{*>               V = (  1       )                 V = (  1 v1 v1 v1 v1 )}
00149 \textcolor{comment}{*>                   ( v1  1    )                     (     1 v2 v2 v2 )}
00150 \textcolor{comment}{*>                   ( v1 v2  1 )                     (        1 v3 v3 )}
00151 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00152 \textcolor{comment}{*>                   ( v1 v2 v3 )}
00153 \textcolor{comment}{*>}
00154 \textcolor{comment}{*>  DIRECT = 'B' and STOREV = 'C':         DIRECT = 'B' and STOREV = 'R':}
00155 \textcolor{comment}{*>}
00156 \textcolor{comment}{*>               V = ( v1 v2 v3 )                 V = ( v1 v1  1       )}
00157 \textcolor{comment}{*>                   ( v1 v2 v3 )                     ( v2 v2 v2  1    )}
00158 \textcolor{comment}{*>                   (  1 v2 v3 )                     ( v3 v3 v3 v3  1 )}
00159 \textcolor{comment}{*>                   (     1 v3 )}
00160 \textcolor{comment}{*>                   (        1 )}
00161 \textcolor{comment}{*> \(\backslash\)endverbatim}
00162 \textcolor{comment}{*>}
00163 \textcolor{comment}{*  =====================================================================}
00164 \textcolor{keyword}{      SUBROUTINE }slarft( DIRECT, STOREV, N, K, V, LDV, TAU, T, LDT )
00165 \textcolor{comment}{*}
00166 \textcolor{comment}{*  -- LAPACK auxiliary routine (version 3.4.1) --}
00167 \textcolor{comment}{*  -- LAPACK is a software package provided by Univ. of Tennessee,    --}
00168 \textcolor{comment}{*  -- Univ. of California Berkeley, Univ. of Colorado Denver and NAG Ltd..--}
00169 \textcolor{comment}{*     April 2012}
00170 \textcolor{comment}{*}
00171 \textcolor{comment}{*     .. Scalar Arguments ..}
00172       \textcolor{keywordtype}{CHARACTER}          direct, storev
00173       \textcolor{keywordtype}{INTEGER}            k, ldt, ldv, n
00174 \textcolor{comment}{*     ..}
00175 \textcolor{comment}{*     .. Array Arguments ..}
00176       \textcolor{keywordtype}{REAL}               t( ldt, * ), tau( * ), v( ldv, * )
00177 \textcolor{comment}{*     ..}
00178 \textcolor{comment}{*}
00179 \textcolor{comment}{*  =====================================================================}
00180 \textcolor{comment}{*}
00181 \textcolor{comment}{*     .. Parameters ..}
00182       \textcolor{keywordtype}{REAL}               one, zero
00183       parameter( one = 1.0e+0, zero = 0.0e+0 )
00184 \textcolor{comment}{*     ..}
00185 \textcolor{comment}{*     .. Local Scalars ..}
00186       \textcolor{keywordtype}{INTEGER}            i, j, prevlastv, lastv
00187 \textcolor{comment}{*     ..}
00188 \textcolor{comment}{*     .. External Subroutines ..}
00189       \textcolor{keywordtype}{EXTERNAL}           sgemv, strmv
00190 \textcolor{comment}{*     ..}
00191 \textcolor{comment}{*     .. External Functions ..}
00192       \textcolor{keywordtype}{LOGICAL}            lsame
00193       \textcolor{keywordtype}{EXTERNAL}           lsame
00194 \textcolor{comment}{*     ..}
00195 \textcolor{comment}{*     .. Executable Statements ..}
00196 \textcolor{comment}{*}
00197 \textcolor{comment}{*     Quick return if possible}
00198 \textcolor{comment}{*}
00199       \textcolor{keywordflow}{IF}( n.EQ.0 )
00200      $   \textcolor{keywordflow}{RETURN}
00201 \textcolor{comment}{*}
00202       \textcolor{keywordflow}{IF}( lsame( direct, \textcolor{stringliteral}{'F'} ) ) \textcolor{keywordflow}{THEN}
00203          prevlastv = n
00204          \textcolor{keywordflow}{DO} i = 1, k
00205             prevlastv = max( i, prevlastv )
00206             \textcolor{keywordflow}{IF}( tau( i ).EQ.zero ) \textcolor{keywordflow}{THEN}
00207 \textcolor{comment}{*}
00208 \textcolor{comment}{*              H(i)  =  I}
00209 \textcolor{comment}{*}
00210                \textcolor{keywordflow}{DO} j = 1, i
00211                   t( j, i ) = zero
00212 \textcolor{keywordflow}{               END DO}
00213             \textcolor{keywordflow}{ELSE}
00214 \textcolor{comment}{*}
00215 \textcolor{comment}{*              general case}
00216 \textcolor{comment}{*}
00217                \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00218 \textcolor{comment}{*                 Skip any trailing zeros.}
00219                   \textcolor{keywordflow}{DO} lastv = n, i+1, -1
00220                      \textcolor{keywordflow}{IF}( v( lastv, i ).NE.zero ) \textcolor{keywordflow}{EXIT}
00221 \textcolor{keywordflow}{                  END DO}
00222                   \textcolor{keywordflow}{DO} j = 1, i-1
00223                      t( j, i ) = -tau( i ) * v( i , j )
00224 \textcolor{keywordflow}{                  END DO}   
00225                   j = min( lastv, prevlastv )
00226 \textcolor{comment}{*}
00227 \textcolor{comment}{*                 T(1:i-1,i) := - tau(i) * V(i:j,1:i-1)**T * V(i:j,i)}
00228 \textcolor{comment}{*}
00229                   \textcolor{keyword}{CALL }sgemv( \textcolor{stringliteral}{'Transpose'}, j-i, i-1, -tau( i ),
00230      $                        v( i+1, 1 ), ldv, v( i+1, i ), 1, one,
00231      $                        t( 1, i ), 1 )
00232                \textcolor{keywordflow}{ELSE}
00233 \textcolor{comment}{*                 Skip any trailing zeros.}
00234                   \textcolor{keywordflow}{DO} lastv = n, i+1, -1
00235                      \textcolor{keywordflow}{IF}( v( i, lastv ).NE.zero ) \textcolor{keywordflow}{EXIT}
00236 \textcolor{keywordflow}{                  END DO}
00237                   \textcolor{keywordflow}{DO} j = 1, i-1
00238                      t( j, i ) = -tau( i ) * v( j , i )
00239 \textcolor{keywordflow}{                  END DO}   
00240                   j = min( lastv, prevlastv )
00241 \textcolor{comment}{*}
00242 \textcolor{comment}{*                 T(1:i-1,i) := - tau(i) * V(1:i-1,i:j) * V(i,i:j)**T}
00243 \textcolor{comment}{*}
00244                   \textcolor{keyword}{CALL }sgemv( \textcolor{stringliteral}{'No transpose'}, i-1, j-i, -tau( i ),
00245      $                        v( 1, i+1 ), ldv, v( i, i+1 ), ldv, 
00246      $                        one, t( 1, i ), 1 )
00247 \textcolor{keywordflow}{               END IF}
00248 \textcolor{comment}{*}
00249 \textcolor{comment}{*              T(1:i-1,i) := T(1:i-1,1:i-1) * T(1:i-1,i)}
00250 \textcolor{comment}{*}
00251                \textcolor{keyword}{CALL }strmv( \textcolor{stringliteral}{'Upper'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Non-unit'}, i-1, t,
00252      $                     ldt, t( 1, i ), 1 )
00253                t( i, i ) = tau( i )
00254                \textcolor{keywordflow}{IF}( i.GT.1 ) \textcolor{keywordflow}{THEN}
00255                   prevlastv = max( prevlastv, lastv )
00256                \textcolor{keywordflow}{ELSE}
00257                   prevlastv = lastv
00258 \textcolor{keywordflow}{               END IF}
00259 \textcolor{keywordflow}{            END IF}
00260 \textcolor{keywordflow}{         END DO}
00261       \textcolor{keywordflow}{ELSE}
00262          prevlastv = 1
00263          \textcolor{keywordflow}{DO} i = k, 1, -1
00264             \textcolor{keywordflow}{IF}( tau( i ).EQ.zero ) \textcolor{keywordflow}{THEN}
00265 \textcolor{comment}{*}
00266 \textcolor{comment}{*              H(i)  =  I}
00267 \textcolor{comment}{*}
00268                \textcolor{keywordflow}{DO} j = i, k
00269                   t( j, i ) = zero
00270 \textcolor{keywordflow}{               END DO}
00271             \textcolor{keywordflow}{ELSE}
00272 \textcolor{comment}{*}
00273 \textcolor{comment}{*              general case}
00274 \textcolor{comment}{*}
00275                \textcolor{keywordflow}{IF}( i.LT.k ) \textcolor{keywordflow}{THEN}
00276                   \textcolor{keywordflow}{IF}( lsame( storev, \textcolor{stringliteral}{'C'} ) ) \textcolor{keywordflow}{THEN}
00277 \textcolor{comment}{*                    Skip any leading zeros.}
00278                      \textcolor{keywordflow}{DO} lastv = 1, i-1
00279                         \textcolor{keywordflow}{IF}( v( lastv, i ).NE.zero ) \textcolor{keywordflow}{EXIT}
00280 \textcolor{keywordflow}{                     END DO}
00281                      \textcolor{keywordflow}{DO} j = i+1, k
00282                         t( j, i ) = -tau( i ) * v( n-k+i , j )
00283 \textcolor{keywordflow}{                     END DO}   
00284                      j = max( lastv, prevlastv )
00285 \textcolor{comment}{*}
00286 \textcolor{comment}{*                    T(i+1:k,i) = -tau(i) * V(j:n-k+i,i+1:k)**T * V(j:n-k+i,i)}
00287 \textcolor{comment}{*}
00288                      \textcolor{keyword}{CALL }sgemv( \textcolor{stringliteral}{'Transpose'}, n-k+i-j, k-i, -tau( i ),
00289      $                           v( j, i+1 ), ldv, v( j, i ), 1, one,
00290      $                           t( i+1, i ), 1 )
00291                   \textcolor{keywordflow}{ELSE}
00292 \textcolor{comment}{*                    Skip any leading zeros.}
00293                      \textcolor{keywordflow}{DO} lastv = 1, i-1
00294                         \textcolor{keywordflow}{IF}( v( i, lastv ).NE.zero ) \textcolor{keywordflow}{EXIT}
00295 \textcolor{keywordflow}{                     END DO}
00296                      \textcolor{keywordflow}{DO} j = i+1, k
00297                         t( j, i ) = -tau( i ) * v( j, n-k+i )
00298 \textcolor{keywordflow}{                     END DO}   
00299                      j = max( lastv, prevlastv )
00300 \textcolor{comment}{*}
00301 \textcolor{comment}{*                    T(i+1:k,i) = -tau(i) * V(i+1:k,j:n-k+i) * V(i,j:n-k+i)**T}
00302 \textcolor{comment}{*}
00303                      \textcolor{keyword}{CALL }sgemv( \textcolor{stringliteral}{'No transpose'}, k-i, n-k+i-j,
00304      $                    -tau( i ), v( i+1, j ), ldv, v( i, j ), ldv,
00305      $                    one, t( i+1, i ), 1 )
00306 \textcolor{keywordflow}{                  END IF}
00307 \textcolor{comment}{*}
00308 \textcolor{comment}{*                 T(i+1:k,i) := T(i+1:k,i+1:k) * T(i+1:k,i)}
00309 \textcolor{comment}{*}
00310                   \textcolor{keyword}{CALL }strmv( \textcolor{stringliteral}{'Lower'}, \textcolor{stringliteral}{'No transpose'}, \textcolor{stringliteral}{'Non-unit'}, k-i,
00311      $                        t( i+1, i+1 ), ldt, t( i+1, i ), 1 )
00312                   \textcolor{keywordflow}{IF}( i.GT.1 ) \textcolor{keywordflow}{THEN}
00313                      prevlastv = min( prevlastv, lastv )
00314                   \textcolor{keywordflow}{ELSE}
00315                      prevlastv = lastv
00316 \textcolor{keywordflow}{                  END IF}
00317 \textcolor{keywordflow}{               END IF}
00318                t( i, i ) = tau( i )
00319 \textcolor{keywordflow}{            END IF}
00320 \textcolor{keywordflow}{         END DO}
00321 \textcolor{keywordflow}{      END IF}
00322       \textcolor{keywordflow}{RETURN}
00323 \textcolor{comment}{*}
00324 \textcolor{comment}{*     End of SLARFT}
00325 \textcolor{comment}{*}
00326 \textcolor{keyword}{      END}
\end{DoxyCode}
