\hypertarget{mat_8c_source}{}\section{mat.\+c}
\label{mat_8c_source}\index{mat.\+c@{mat.\+c}}

\begin{DoxyCode}
00001 
00005 \textcolor{comment}{/*}
00006 \textcolor{comment}{ * Copyright (c) 2005-2018, Christopher C. Hulbert}
00007 \textcolor{comment}{ * All rights reserved.}
00008 \textcolor{comment}{ *}
00009 \textcolor{comment}{ * Redistribution and use in source and binary forms, with or without}
00010 \textcolor{comment}{ * modification, are permitted provided that the following conditions are met:}
00011 \textcolor{comment}{ *}
00012 \textcolor{comment}{ * 1. Redistributions of source code must retain the above copyright notice, this}
00013 \textcolor{comment}{ *    list of conditions and the following disclaimer.}
00014 \textcolor{comment}{ *}
00015 \textcolor{comment}{ * 2. Redistributions in binary form must reproduce the above copyright notice,}
00016 \textcolor{comment}{ *    this list of conditions and the following disclaimer in the documentation}
00017 \textcolor{comment}{ *    and/or other materials provided with the distribution.}
00018 \textcolor{comment}{ *}
00019 \textcolor{comment}{ * THIS SOFTWARE IS PROVIDED BY THE COPYRIGHT HOLDERS AND CONTRIBUTORS "AS IS"}
00020 \textcolor{comment}{ * AND ANY EXPRESS OR IMPLIED WARRANTIES, INCLUDING, BUT NOT LIMITED TO, THE}
00021 \textcolor{comment}{ * IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE ARE}
00022 \textcolor{comment}{ * DISCLAIMED. IN NO EVENT SHALL THE COPYRIGHT HOLDER OR CONTRIBUTORS BE LIABLE}
00023 \textcolor{comment}{ * FOR ANY DIRECT, INDIRECT, INCIDENTAL, SPECIAL, EXEMPLARY, OR CONSEQUENTIAL}
00024 \textcolor{comment}{ * DAMAGES (INCLUDING, BUT NOT LIMITED TO, PROCUREMENT OF SUBSTITUTE GOODS OR}
00025 \textcolor{comment}{ * SERVICES; LOSS OF USE, DATA, OR PROFITS; OR BUSINESS INTERRUPTION) HOWEVER}
00026 \textcolor{comment}{ * CAUSED AND ON ANY THEORY OF LIABILITY, WHETHER IN CONTRACT, STRICT LIABILITY,}
00027 \textcolor{comment}{ * OR TORT (INCLUDING NEGLIGENCE OR OTHERWISE) ARISING IN ANY WAY OUT OF THE USE}
00028 \textcolor{comment}{ * OF THIS SOFTWARE, EVEN IF ADVISED OF THE POSSIBILITY OF SUCH DAMAGE.}
00029 \textcolor{comment}{ */}
00030 
00031 \textcolor{comment}{/* FIXME: Implement Unicode support */}
00032 \textcolor{preprocessor}{#include <stdlib.h>}
00033 \textcolor{preprocessor}{#include <string.h>}
00034 \textcolor{preprocessor}{#include <stdio.h>}
00035 \textcolor{preprocessor}{#include <math.h>}
00036 \textcolor{preprocessor}{#include <time.h>}
00037 \textcolor{preprocessor}{#if HAVE\_INTTYPES\_H}
00038 \textcolor{preprocessor}{#   define \_\_STDC\_FORMAT\_MACROS}
00039 \textcolor{preprocessor}{#   include <inttypes.h>}
00040 \textcolor{preprocessor}{#endif}
00041 \textcolor{preprocessor}{#if defined(\_WIN64) || defined(\_WIN32)}
00042 \textcolor{preprocessor}{#   include <io.h>}
00043 \textcolor{preprocessor}{#   define mktemp \_mktemp}
00044 \textcolor{preprocessor}{#endif}
00045 \textcolor{preprocessor}{#if defined(\_MSC\_VER) || defined(\_\_MINGW32\_\_)}
00046 \textcolor{preprocessor}{#   define SIZE\_T\_FMTSTR "Iu"}
00047 \textcolor{preprocessor}{#   define strdup \_strdup}
00048 \textcolor{preprocessor}{#else}
00049 \textcolor{preprocessor}{#   define SIZE\_T\_FMTSTR "zu"}
00050 \textcolor{preprocessor}{#endif}
00051 \textcolor{preprocessor}{#include "matio\_private.h"}
00052 \textcolor{preprocessor}{#include "mat5.h"}
00053 \textcolor{preprocessor}{#include "mat4.h"}
00054 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00055 \textcolor{preprocessor}{#   include "mat73.h"}
00056 \textcolor{preprocessor}{#endif}
00057 
00058 \textcolor{comment}{/*}
00059 \textcolor{comment}{ *===================================================================}
00060 \textcolor{comment}{ *                 Private Functions}
00061 \textcolor{comment}{ *===================================================================}
00062 \textcolor{comment}{ */}
00063 
00064 \textcolor{keyword}{static} \textcolor{keywordtype}{void}
00065 ReadData(\hyperlink{struct__mat__t}{mat\_t} *mat, \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar)
00066 \{
00067     \textcolor{keywordflow}{if} ( mat == NULL || matvar == NULL || mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} == NULL )
00068         \textcolor{keywordflow}{return};
00069     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5} )
00070         \hyperlink{mat5_8c_abd8669832a02e759fe190bf2724f60ae}{Read5}(mat,matvar);
00071 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00072     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} )
00073         Mat\_VarRead73(mat,matvar);
00074 \textcolor{preprocessor}{#endif}
00075     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4} )
00076         \hyperlink{mat4_8c_a48f37c81ddb08c15bd949ccd31a8aee9}{Read4}(mat,matvar);
00077     \textcolor{keywordflow}{return};
00078 \}
00079 
00080 \textcolor{keyword}{static} \textcolor{keywordtype}{void}
00081 Mat\_PrintNumber(\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gacf7b3b879282b7ab3a51190e49bf3453}{matio\_types} type, \textcolor{keywordtype}{void} *data)
00082 \{
00083     \textcolor{keywordflow}{switch} ( type ) \{
00084         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a31e721ecf7e188196f83c32838288797}{MAT\_T\_DOUBLE}:
00085             printf(\textcolor{stringliteral}{"%g"},*(\textcolor{keywordtype}{double}*)data);
00086             \textcolor{keywordflow}{break};
00087         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a3a3657d40e9212c923d9b9d03531b64c}{MAT\_T\_SINGLE}:
00088             printf(\textcolor{stringliteral}{"%g"},*(\textcolor{keywordtype}{float}*)data);
00089             \textcolor{keywordflow}{break};
00090 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_INT64\_T}
00091         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9e825b5d18b8f946eaf2b4b57e51c145}{MAT\_T\_INT64}:
00092 \textcolor{preprocessor}{#if HAVE\_INTTYPES\_H}
00093             printf(\textcolor{stringliteral}{"%"} PRIi64,*(mat\_int64\_t*)data);
00094 \textcolor{preprocessor}{#elif defined(\_MSC\_VER) && \_MSC\_VER >= 1200}
00095             printf(\textcolor{stringliteral}{"%I64i"},*(mat\_int64\_t*)data);
00096 \textcolor{preprocessor}{#elif defined(HAVE\_LONG\_LONG\_INT)}
00097             printf(\textcolor{stringliteral}{"%lld"},(\textcolor{keywordtype}{long} \textcolor{keywordtype}{long})(*(mat\_int64\_t*)data));
00098 \textcolor{preprocessor}{#else}
00099             printf(\textcolor{stringliteral}{"%ld"},(\textcolor{keywordtype}{long})(*(mat\_int64\_t*)data));
00100 \textcolor{preprocessor}{#endif}
00101             \textcolor{keywordflow}{break};
00102 \textcolor{preprocessor}{#endif}
00103 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_UINT64\_T}
00104         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a45547932c46be27118abe08302d7e29f}{MAT\_T\_UINT64}:
00105 \textcolor{preprocessor}{#if HAVE\_INTTYPES\_H}
00106             printf(\textcolor{stringliteral}{"%"} PRIu64,*(mat\_uint64\_t*)data);
00107 \textcolor{preprocessor}{#elif defined(\_MSC\_VER) && \_MSC\_VER >= 1200}
00108             printf(\textcolor{stringliteral}{"%I64u"},*(mat\_uint64\_t*)data);
00109 \textcolor{preprocessor}{#elif defined(HAVE\_UNSIGNED\_LONG\_LONG\_INT)}
00110             printf(\textcolor{stringliteral}{"%llu"},(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long} \textcolor{keywordtype}{long})(*(mat\_uint64\_t*)data));
00111 \textcolor{preprocessor}{#else}
00112             printf(\textcolor{stringliteral}{"%lu"},(\textcolor{keywordtype}{unsigned} \textcolor{keywordtype}{long})(*(mat\_uint64\_t*)data));
00113 \textcolor{preprocessor}{#endif}
00114             \textcolor{keywordflow}{break};
00115 \textcolor{preprocessor}{#endif}
00116         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a83e06a68320726c6572bfbb9f3addb1d}{MAT\_T\_INT32}:
00117             printf(\textcolor{stringliteral}{"%d"},*(mat\_int32\_t*)data);
00118             \textcolor{keywordflow}{break};
00119         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453aa397e285a23fe240368b752897652c6a}{MAT\_T\_UINT32}:
00120             printf(\textcolor{stringliteral}{"%u"},*(mat\_uint32\_t*)data);
00121             \textcolor{keywordflow}{break};
00122         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a8c5b2e381946e95ea8d81ac216743302}{MAT\_T\_INT16}:
00123             printf(\textcolor{stringliteral}{"%hd"},*(mat\_int16\_t*)data);
00124             \textcolor{keywordflow}{break};
00125         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a05bc7af7680aa68be95126ae0a4c2e31}{MAT\_T\_UINT16}:
00126             printf(\textcolor{stringliteral}{"%hu"},*(mat\_uint16\_t*)data);
00127             \textcolor{keywordflow}{break};
00128         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9807f5033ed4f9b548953742d9fd1658}{MAT\_T\_INT8}:
00129             printf(\textcolor{stringliteral}{"%hhd"},*(mat\_int8\_t*)data);
00130             \textcolor{keywordflow}{break};
00131         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a01c1bd7db68f90552862eb5d311be408}{MAT\_T\_UINT8}:
00132             printf(\textcolor{stringliteral}{"%hhu"},*(mat\_uint8\_t*)data);
00133             \textcolor{keywordflow}{break};
00134         \textcolor{keywordflow}{default}:
00135             \textcolor{keywordflow}{break};
00136     \}
00137 \}
00138 
00139 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *
00140 ComplexMalloc(\textcolor{keywordtype}{size\_t} nbytes)
00141 \{
00142     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = malloc(\textcolor{keyword}{sizeof}(*complex\_data));
00143     \textcolor{keywordflow}{if} ( NULL != complex\_data ) \{
00144         complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(nbytes);
00145         \textcolor{keywordflow}{if} ( NULL != complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} ) \{
00146             complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(nbytes);
00147             \textcolor{keywordflow}{if} ( NULL == complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} ) \{
00148                 free(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re});
00149                 free(complex\_data);
00150                 complex\_data = NULL;
00151             \}
00152         \}
00153         \textcolor{keywordflow}{else} \{
00154             free(complex\_data);
00155             complex\_data = NULL;
00156         \}
00157     \}
00158 
00159     \textcolor{keywordflow}{return} complex\_data;
00160 \}
00161 
00162 \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gacf7b3b879282b7ab3a51190e49bf3453}{matio\_types}
00163 ClassType2DataType(\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad4d60ae7b709fc81bfd744fb4c857c40}{matio\_classes} class\_type)
00164 \{
00165     \textcolor{keywordflow}{switch} ( class\_type ) \{
00166         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
00167             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a31e721ecf7e188196f83c32838288797}{MAT\_T\_DOUBLE};
00168         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
00169             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a3a3657d40e9212c923d9b9d03531b64c}{MAT\_T\_SINGLE};
00170 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_INT64\_T}
00171         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
00172             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9e825b5d18b8f946eaf2b4b57e51c145}{MAT\_T\_INT64};
00173 \textcolor{preprocessor}{#endif}
00174 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_UINT64\_T}
00175         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
00176             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a45547932c46be27118abe08302d7e29f}{MAT\_T\_UINT64};
00177 \textcolor{preprocessor}{#endif}
00178         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
00179             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a83e06a68320726c6572bfbb9f3addb1d}{MAT\_T\_INT32};
00180         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
00181             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453aa397e285a23fe240368b752897652c6a}{MAT\_T\_UINT32};
00182         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
00183             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a8c5b2e381946e95ea8d81ac216743302}{MAT\_T\_INT16};
00184         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
00185             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a05bc7af7680aa68be95126ae0a4c2e31}{MAT\_T\_UINT16};
00186         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
00187             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9807f5033ed4f9b548953742d9fd1658}{MAT\_T\_INT8};
00188         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aacdec5834df0861130b393697646119c}{MAT\_C\_CHAR}:
00189             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a01c1bd7db68f90552862eb5d311be408}{MAT\_T\_UINT8};
00190         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
00191             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a01c1bd7db68f90552862eb5d311be408}{MAT\_T\_UINT8};
00192         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL}:
00193             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a07599cf2cca6d2b2d059378563318ba5}{MAT\_T\_CELL};
00194         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40acb467c7749c80902b798134c729bb521}{MAT\_C\_STRUCT}:
00195             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a4f4d5a6e1d42c6aa81ffb810e5da5c85}{MAT\_T\_STRUCT};
00196         \textcolor{keywordflow}{default}:
00197             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a2a7318fe8bf9464935e7ed8902618293}{MAT\_T\_UNKNOWN};
00198     \}
00199 \}
00200 
00201 \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad4d60ae7b709fc81bfd744fb4c857c40}{matio\_classes}
00202 DataType2ClassType(\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gacf7b3b879282b7ab3a51190e49bf3453}{matio\_types} type)
00203 \{
00204     \textcolor{keywordflow}{switch} ( type ) \{
00205         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a31e721ecf7e188196f83c32838288797}{MAT\_T\_DOUBLE}:
00206             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE};
00207         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a3a3657d40e9212c923d9b9d03531b64c}{MAT\_T\_SINGLE}:
00208             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE};
00209 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_INT64\_T}
00210         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9e825b5d18b8f946eaf2b4b57e51c145}{MAT\_T\_INT64}:
00211             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64};
00212 \textcolor{preprocessor}{#endif}
00213 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_UINT64\_T}
00214         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a45547932c46be27118abe08302d7e29f}{MAT\_T\_UINT64}:
00215             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64};
00216 \textcolor{preprocessor}{#endif}
00217         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a83e06a68320726c6572bfbb9f3addb1d}{MAT\_T\_INT32}:
00218             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32};
00219         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453aa397e285a23fe240368b752897652c6a}{MAT\_T\_UINT32}:
00220             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32};
00221         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a8c5b2e381946e95ea8d81ac216743302}{MAT\_T\_INT16}:
00222             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16};
00223         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a05bc7af7680aa68be95126ae0a4c2e31}{MAT\_T\_UINT16}:
00224             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16};
00225         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9807f5033ed4f9b548953742d9fd1658}{MAT\_T\_INT8}:
00226             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8};
00227         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a01c1bd7db68f90552862eb5d311be408}{MAT\_T\_UINT8}:
00228             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8};
00229         \textcolor{keywordflow}{default}:
00230             \textcolor{keywordflow}{return} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5c76eef0ca0373d25abe49053be6fa9a}{MAT\_C\_EMPTY};
00231     \}
00232 \}
00233 
00234 \textcolor{comment}{/*}
00235 \textcolor{comment}{ *===================================================================}
00236 \textcolor{comment}{ *                 Public Functions}
00237 \textcolor{comment}{ *===================================================================}
00238 \textcolor{comment}{ */}
00239 
00247 \textcolor{keywordtype}{void}
\Hypertarget{mat_8c_source_l00248}\hyperlink{mat_8c_a2069c4f0d1106778b56216ff4f95f94b}{00248} \hyperlink{mat_8c_a2069c4f0d1106778b56216ff4f95f94b}{Mat\_GetLibraryVersion}(\textcolor{keywordtype}{int} *major,\textcolor{keywordtype}{int} *minor,\textcolor{keywordtype}{int} *release)
00249 \{
00250     \textcolor{keywordflow}{if} ( NULL != major )
00251         *major = MATIO\_MAJOR\_VERSION;
00252     \textcolor{keywordflow}{if} ( NULL != minor )
00253         *minor = MATIO\_MINOR\_VERSION;
00254     \textcolor{keywordflow}{if} ( NULL != release )
00255         *release = MATIO\_RELEASE\_LEVEL;
00256 \}
00257 
00273 \hyperlink{struct__mat__t}{mat\_t} *
\Hypertarget{mat_8c_source_l00274}\hyperlink{group___m_a_t_ga22d404f203af7869c841400e7ad247cf}{00274} \hyperlink{group___m_a_t_ga22d404f203af7869c841400e7ad247cf}{Mat\_CreateVer}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *matname,\textcolor{keyword}{const} \textcolor{keywordtype}{char} *hdr\_str,\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft} mat\_file\_ver)
00275 \{
00276     \hyperlink{struct__mat__t}{mat\_t} *mat;
00277 
00278     \textcolor{keywordflow}{switch} ( mat\_file\_ver ) \{
00279         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4}:
00280             mat = \hyperlink{mat4_8c_aa819b0bf76cab52a202742dd4102c18d}{Mat\_Create4}(matname);
00281             \textcolor{keywordflow}{break};
00282         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5}:
00283             mat = \hyperlink{mat5_8c_aacff52cdf3427b35a54c111fa3d7bb21}{Mat\_Create5}(matname,hdr\_str);
00284             \textcolor{keywordflow}{break};
00285         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73}:
00286 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00287             mat = Mat\_Create73(matname,hdr\_str);
00288 \textcolor{preprocessor}{#else}
00289             mat = NULL;
00290 \textcolor{preprocessor}{#endif}
00291             \textcolor{keywordflow}{break};
00292         \textcolor{keywordflow}{default}:
00293             mat = NULL;
00294             \textcolor{keywordflow}{break};
00295     \}
00296 
00297     \textcolor{keywordflow}{return} mat;
00298 \}
00299 
00309 \hyperlink{struct__mat__t}{mat\_t} *
\Hypertarget{mat_8c_source_l00310}\hyperlink{group___m_a_t_gafbfedb5636a99f0ef867520c47f77d18}{00310} \hyperlink{group___m_a_t_gafbfedb5636a99f0ef867520c47f77d18}{Mat\_Open}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *matname,\textcolor{keywordtype}{int} mode)
00311 \{
00312     FILE *fp = NULL;
00313     mat\_int16\_t tmp, tmp2;
00314     \hyperlink{struct__mat__t}{mat\_t} *mat = NULL;
00315     \textcolor{keywordtype}{size\_t} bytesread = 0;
00316 
00317     \textcolor{keywordflow}{if} ( (mode & 0x01) == \hyperlink{group___m_a_t_ggaa9dcbc70f538af79bd557593ff6b5cdba8dd1457651b27ba9bea6cfba158c037c}{MAT\_ACC\_RDONLY} ) \{
00318         fp = fopen( matname, \textcolor{stringliteral}{"rb"} );
00319         \textcolor{keywordflow}{if} ( !fp )
00320             \textcolor{keywordflow}{return} NULL;
00321     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (mode & 0x01) == \hyperlink{group___m_a_t_ggaa9dcbc70f538af79bd557593ff6b5cdba0f65f27ea42fde32d62b702b82329c1f}{MAT\_ACC\_RDWR} ) \{
00322         fp = fopen( matname, \textcolor{stringliteral}{"r+b"} );
00323         \textcolor{keywordflow}{if} ( !fp ) \{
00324             mat = \hyperlink{group___m_a_t_ga22d404f203af7869c841400e7ad247cf}{Mat\_CreateVer}(matname,NULL,(\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft})(mode&0xfffffffe));
00325             \textcolor{keywordflow}{return} mat;
00326         \}
00327     \} \textcolor{keywordflow}{else} \{
00328         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Invalid file open mode"});
00329         \textcolor{keywordflow}{return} NULL;
00330     \}
00331 
00332     mat = (\hyperlink{struct__mat__t}{mat\_t}*)malloc(\textcolor{keyword}{sizeof}(*mat));
00333     \textcolor{keywordflow}{if} ( NULL == mat ) \{
00334         fclose(fp);
00335         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the MAT file"});
00336         \textcolor{keywordflow}{return} NULL;
00337     \}
00338 
00339     mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = fp;
00340     mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header}        = (\textcolor{keywordtype}{char}*)calloc(128,\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}));
00341     \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header} ) \{
00342         free(mat);
00343         fclose(fp);
00344         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the MAT file header"});
00345         \textcolor{keywordflow}{return} NULL;
00346     \}
00347     mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset} = (\textcolor{keywordtype}{char}*)calloc(8,\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}));
00348     \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset} ) \{
00349         free(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header});
00350         free(mat);
00351         fclose(fp);
00352         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the MAT file subsys offset"});
00353         \textcolor{keywordflow}{return} NULL;
00354     \}
00355     mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename}      = NULL;
00356     mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version}       = 0;
00357     mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap}      = 0;
00358     mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}  = 0;
00359 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00360     mat->refs\_id       = -1;
00361 \textcolor{preprocessor}{#endif}
00362     mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}           = NULL;
00363 
00364     bytesread += fread(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header},1,116,fp);
00365     mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header}[116] = \textcolor{charliteral}{'\(\backslash\)0'};
00366     bytesread += fread(mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset},1,8,fp);
00367     bytesread += 2*fread(&tmp2,2,1,fp);
00368     bytesread += fread(&tmp,1,2,fp);
00369 
00370     \textcolor{keywordflow}{if} ( 128 == bytesread ) \{
00371         \textcolor{comment}{/* v5 and v7.3 files have at least 128 byte header */}
00372         mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap} = -1;
00373         \textcolor{keywordflow}{if} ( tmp == 0x4d49 )
00374             mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap} = 0;
00375         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( tmp == 0x494d ) \{
00376             mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap} = 1;
00377             \hyperlink{endian_8c_a741eb8019dbc3e8addfc0e75adb0dd90}{Mat\_int16Swap}(&tmp2);
00378         \}
00379 
00380         mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} = (int)tmp2;
00381         \textcolor{keywordflow}{if} ( (mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == 0x0100 || mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == 0x0200) &&
00382              -1 != mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap} ) \{
00383             mat->\hyperlink{struct__mat__t_a0f87794a6113bd568fe591953e20ddf3}{bof} = ftell((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
00384             \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a0f87794a6113bd568fe591953e20ddf3}{bof} == -1L ) \{
00385                 free(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header});
00386                 free(mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset});
00387                 free(mat);
00388                 fclose(fp);
00389                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't determine file position"});
00390                 \textcolor{keywordflow}{return} NULL;
00391             \}
00392             mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = 0;
00393         \} \textcolor{keywordflow}{else} \{
00394             mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} = 0;
00395         \}
00396     \}
00397 
00398     \textcolor{keywordflow}{if} ( 0 == mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
00399         \textcolor{comment}{/* Maybe a V4 MAT file */}
00400         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *var;
00401 
00402         free(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header});
00403         free(mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset});
00404 
00405         mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header}        = NULL;
00406         mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset} = NULL;
00407         mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}            = fp;
00408         mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version}       = \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4};
00409         mat->\hyperlink{struct__mat__t_a99d207977af5e04941ace56d71817a40}{byteswap}      = 0;
00410         mat->\hyperlink{struct__mat__t_aa43288b63b8edb7cadf0b79e2d1df2ee}{mode}          = mode;
00411         mat->\hyperlink{struct__mat__t_a0f87794a6113bd568fe591953e20ddf3}{bof}           = 0;
00412         mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index}    = 0;
00413 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00414         mat->refs\_id       = -1;
00415 \textcolor{preprocessor}{#endif}
00416 
00417         \hyperlink{group___m_a_t_ga4d6e3892d2e216c507a744ba0e070d0b}{Mat\_Rewind}(mat);
00418         var = \hyperlink{mat4_8c_a494a64be8f002874f2048687561f65d3}{Mat\_VarReadNextInfo4}(mat);
00419         \textcolor{keywordflow}{if} ( NULL == var &&
00420              bytesread != 0 ) \{ \textcolor{comment}{/* Accept 0 bytes files as a valid V4 file */}
00421             \textcolor{comment}{/* Does not seem to be a valid V4 file */}
00422             \hyperlink{group___m_a_t_ga101c92ff7bde4a2d4615661beba09262}{Mat\_Close}(mat);
00423             mat = NULL;
00424             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"\(\backslash\)"%s\(\backslash\)" does not seem to be a valid MAT file"},matname);
00425         \} \textcolor{keywordflow}{else} \{
00426             \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(var);
00427             \hyperlink{group___m_a_t_ga4d6e3892d2e216c507a744ba0e070d0b}{Mat\_Rewind}(mat);
00428         \}
00429     \}
00430 
00431     \textcolor{keywordflow}{if} ( NULL == mat )
00432         \textcolor{keywordflow}{return} mat;
00433 
00434     mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename} = \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"},matname);
00435     mat->\hyperlink{struct__mat__t_aa43288b63b8edb7cadf0b79e2d1df2ee}{mode} = mode;
00436 
00437     \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == 0x0200 ) \{
00438         fclose((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
00439 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00440         mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = malloc(\textcolor{keyword}{sizeof}(hid\_t));
00441 
00442         \textcolor{keywordflow}{if} ( (mode & 0x01) == \hyperlink{group___m_a_t_ggaa9dcbc70f538af79bd557593ff6b5cdba8dd1457651b27ba9bea6cfba158c037c}{MAT\_ACC\_RDONLY} )
00443             *(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}=H5Fopen(mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename},H5F\_ACC\_RDONLY,H5P\_DEFAULT);
00444         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (mode & 0x01) == \hyperlink{group___m_a_t_ggaa9dcbc70f538af79bd557593ff6b5cdba0f65f27ea42fde32d62b702b82329c1f}{MAT\_ACC\_RDWR} )
00445             *(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}=H5Fopen(mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename},H5F\_ACC\_RDWR,H5P\_DEFAULT);
00446 
00447         \textcolor{keywordflow}{if} ( -1 < *(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} ) \{
00448             \hyperlink{struct_h5_g__info__t}{H5G\_info\_t} group\_info = \{0\};
00449             H5Gget\_info(*(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}, &group\_info);
00450             mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} = (size\_t)group\_info.nlinks;
00451             mat->refs\_id      = -1;
00452         \}
00453 \textcolor{preprocessor}{#else}
00454         mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = NULL;
00455         \hyperlink{group___m_a_t_ga101c92ff7bde4a2d4615661beba09262}{Mat\_Close}(mat);
00456         mat = NULL;
00457         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"No HDF5 support which is required to read the v7.3 "}
00458                      \textcolor{stringliteral}{"MAT file \(\backslash\)"%s\(\backslash\)""},matname);
00459 \textcolor{preprocessor}{#endif}
00460     \}
00461 
00462     \textcolor{keywordflow}{return} mat;
00463 \}
00464 
00472 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l00473}\hyperlink{group___m_a_t_ga101c92ff7bde4a2d4615661beba09262}{00473} \hyperlink{group___m_a_t_ga101c92ff7bde4a2d4615661beba09262}{Mat\_Close}( \hyperlink{struct__mat__t}{mat\_t} *mat )
00474 \{
00475     \textcolor{keywordtype}{int} err = 0;
00476 
00477     \textcolor{keywordflow}{if} ( NULL != mat ) \{
00478 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00479         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == 0x0200 ) \{
00480             \textcolor{keywordflow}{if} ( mat->refs\_id > -1 )
00481                 H5Gclose(mat->refs\_id);
00482             \textcolor{keywordflow}{if} ( 0 > H5Fclose(*(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) )
00483                 err = 1;
00484             free(mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
00485             mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = NULL;
00486         \}
00487 \textcolor{preprocessor}{#endif}
00488         \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} )
00489             fclose((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
00490         \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header} )
00491             free(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header});
00492         \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset} )
00493             free(mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset});
00494         \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename} )
00495             free(mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename});
00496         \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
00497             \textcolor{keywordtype}{size\_t} i;
00498             \textcolor{keywordflow}{for} ( i = 0; i < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}; i++ ) \{
00499                 \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i] )
00500                     free(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i]);
00501             \}
00502             free(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir});
00503         \}
00504         free(mat);
00505     \}
00506 
00507     \textcolor{keywordflow}{return} err;
00508 \}
00509 
00517 \textcolor{keyword}{const} \textcolor{keywordtype}{char} *
\Hypertarget{mat_8c_source_l00518}\hyperlink{group___m_a_t_ga671ff3c0247037c343b5df121ac0b824}{00518} \hyperlink{group___m_a_t_ga671ff3c0247037c343b5df121ac0b824}{Mat\_GetFilename}(\hyperlink{struct__mat__t}{mat\_t} *mat)
00519 \{
00520     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *filename = NULL;
00521     \textcolor{keywordflow}{if} ( NULL != mat )
00522         filename = mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename};
00523     \textcolor{keywordflow}{return} filename;
00524 \}
00525 
00533 \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft}
\Hypertarget{mat_8c_source_l00534}\hyperlink{group___m_a_t_gabef04e2a55e78b0f7d9b2ddc5f42d03c}{00534} \hyperlink{group___m_a_t_gabef04e2a55e78b0f7d9b2ddc5f42d03c}{Mat\_GetVersion}(\hyperlink{struct__mat__t}{mat\_t} *mat)
00535 \{
00536     \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft} file\_type = \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a29ebbcb4c6854eb5524a94d0f153a547}{MAT\_FT\_UNDEFINED};
00537     \textcolor{keywordflow}{if} ( NULL != mat )
00538         file\_type = (\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft})mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version};
00539     \textcolor{keywordflow}{return} file\_type;
00540 \}
00541 
00550 \textcolor{keywordtype}{char} **
\Hypertarget{mat_8c_source_l00551}\hyperlink{group___m_a_t_ga7c0d94860d782366ab93d9b6b068eaea}{00551} \hyperlink{group___m_a_t_ga7c0d94860d782366ab93d9b6b068eaea}{Mat\_GetDir}(\hyperlink{struct__mat__t}{mat\_t} *mat, \textcolor{keywordtype}{size\_t} *n)
00552 \{
00553     \textcolor{keywordtype}{char} ** dir = NULL;
00554 
00555     \textcolor{keywordflow}{if} ( NULL == n )
00556         \textcolor{keywordflow}{return} dir;
00557 
00558     \textcolor{keywordflow}{if} ( NULL == mat ) \{
00559         *n = 0;
00560         \textcolor{keywordflow}{return} dir;
00561     \}
00562 
00563     \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
00564         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar = NULL;
00565 
00566         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
00567             \textcolor{keywordtype}{size\_t} i = 0;
00568             \textcolor{keywordtype}{size\_t} fpos = mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index};
00569             \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} == 0 ) \{
00570                 *n = 0;
00571                 \textcolor{keywordflow}{return} dir;
00572             \}
00573             mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = calloc(mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*));
00574             \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
00575                 *n = 0;
00576                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the directory"});
00577                 \textcolor{keywordflow}{return} dir;
00578             \}
00579             mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = 0;
00580             \textcolor{keywordflow}{while} ( mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} ) \{
00581                 matvar = \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}(mat);
00582                 \textcolor{keywordflow}{if} ( NULL != matvar ) \{
00583                     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} ) \{
00584                         mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i++] = \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"},
00585                             matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
00586                     \}
00587                     \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
00588                 \} \textcolor{keywordflow}{else} \{
00589                     \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"An error occurred in reading the MAT file"});
00590                     \textcolor{keywordflow}{break};
00591                 \}
00592             \}
00593             mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = fpos;
00594             *n = i;
00595         \} \textcolor{keywordflow}{else} \{
00596             \textcolor{keywordtype}{long} fpos = ftell((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
00597             \textcolor{keywordflow}{if} ( fpos == -1L ) \{
00598                 *n = 0;
00599                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't determine file position"});
00600                 \textcolor{keywordflow}{return} dir;
00601             \}
00602             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},mat->\hyperlink{struct__mat__t_a0f87794a6113bd568fe591953e20ddf3}{bof},SEEK\_SET);
00603             mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} = 0;
00604             \textcolor{keywordflow}{do} \{
00605                 matvar = \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}(mat);
00606                 \textcolor{keywordflow}{if} ( NULL != matvar ) \{
00607                     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} ) \{
00608                         \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
00609                             dir = malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*));
00610                         \} \textcolor{keywordflow}{else} \{
00611                             dir = realloc(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir},
00612                                 (mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} + 1)*(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*)));
00613                         \}
00614                         \textcolor{keywordflow}{if} ( NULL != dir ) \{
00615                             mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = dir;
00616                             mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}++] =
00617                                 \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"}, matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
00618                         \} \textcolor{keywordflow}{else} \{
00619                             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the directory"});
00620                             \textcolor{keywordflow}{break};
00621                         \}
00622                     \}
00623                     \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
00624                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !feof((FILE *)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) ) \{
00625                     \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"An error occurred in reading the MAT file"});
00626                     \textcolor{keywordflow}{break};
00627                 \}
00628             \} \textcolor{keywordflow}{while} ( !feof((FILE *)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) );
00629             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},fpos,SEEK\_SET);
00630             *n = mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets};
00631         \}
00632     \}
00633     dir = mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir};
00634     \textcolor{keywordflow}{return} dir;
00635 \}
00636 
00644 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l00645}\hyperlink{group___m_a_t_ga4d6e3892d2e216c507a744ba0e070d0b}{00645} \hyperlink{group___m_a_t_ga4d6e3892d2e216c507a744ba0e070d0b}{Mat\_Rewind}( \hyperlink{struct__mat__t}{mat\_t} *mat )
00646 \{
00647     \textcolor{keywordtype}{int} err = 0;
00648 
00649     \textcolor{keywordflow}{switch} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
00650         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5}:
00651             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},128L,SEEK\_SET);
00652             \textcolor{keywordflow}{break};
00653         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73}:
00654             mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = 0;
00655             \textcolor{keywordflow}{break};
00656         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4}:
00657             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},0L,SEEK\_SET);
00658             \textcolor{keywordflow}{break};
00659         \textcolor{keywordflow}{default}:
00660             err = -1;
00661             \textcolor{keywordflow}{break};
00662     \}
00663 
00664     \textcolor{keywordflow}{return} err;
00665 \}
00666 
00674 \textcolor{keywordtype}{size\_t}
\Hypertarget{mat_8c_source_l00675}\hyperlink{group___m_a_t_ga2bf682f015b22fa796a8885e997661e7}{00675} \hyperlink{group___m_a_t_ga2bf682f015b22fa796a8885e997661e7}{Mat\_SizeOfClass}(\textcolor{keywordtype}{int} class\_type)
00676 \{
00677     \textcolor{keywordflow}{switch} ( class\_type ) \{
00678         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
00679             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(double);
00680         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
00681             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(float);
00682 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_INT64\_T}
00683         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
00684             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_int64\_t);
00685 \textcolor{preprocessor}{#endif}
00686 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_UINT64\_T}
00687         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
00688             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_uint64\_t);
00689 \textcolor{preprocessor}{#endif}
00690         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
00691             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_int32\_t);
00692         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
00693             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_uint32\_t);
00694         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
00695             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_int16\_t);
00696         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
00697             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_uint16\_t);
00698         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
00699             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_int8\_t);
00700         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
00701             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_uint8\_t);
00702         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aacdec5834df0861130b393697646119c}{MAT\_C\_CHAR}:
00703             \textcolor{keywordflow}{return} \textcolor{keyword}{sizeof}(mat\_int16\_t);
00704         \textcolor{keywordflow}{default}:
00705             \textcolor{keywordflow}{return} 0;
00706     \}
00707 \}
00708 
00709 \textcolor{comment}{/*}
00710 \textcolor{comment}{ *===================================================================}
00711 \textcolor{comment}{ *    MAT Variable Functions}
00712 \textcolor{comment}{ *===================================================================}
00713 \textcolor{comment}{ */}
00714 
00720 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l00721}\hyperlink{group___m_a_t_gae7c9c3699f6e9c31a9c490300013098c}{00721} \hyperlink{group___m_a_t_gae7c9c3699f6e9c31a9c490300013098c}{Mat\_VarCalloc}(\textcolor{keywordtype}{void})
00722 \{
00723     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar;
00724 
00725     matvar = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}*)malloc(\textcolor{keyword}{sizeof}(*matvar));
00726 
00727     \textcolor{keywordflow}{if} ( NULL != matvar ) \{
00728         matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes}       = 0;
00729         matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}         = 0;
00730         matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}    = \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a2a7318fe8bf9464935e7ed8902618293}{MAT\_T\_UNKNOWN};
00731         matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size}    = 0;
00732         matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type}   = \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5c76eef0ca0373d25abe49053be6fa9a}{MAT\_C\_EMPTY};
00733         matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex}    = 0;
00734         matvar->\hyperlink{group___m_a_t_af26c71c4c0ddb14931d15910dddac1bc}{isGlobal}     = 0;
00735         matvar->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical}    = 0;
00736         matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}         = NULL;
00737         matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name}         = NULL;
00738         matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data}         = NULL;
00739         matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} = 0;
00740         matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression}  = \hyperlink{group___m_a_t_gga768c318af97bd2567758ecb001ceb7f4a2280b97631ff5dd24dec55261dc587b6}{MAT\_COMPRESSION\_NONE};
00741         matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}     = (\textcolor{keyword}{struct }\hyperlink{structmatvar__internal}{matvar\_internal}*)malloc(\textcolor{keyword}{sizeof}(*matvar->
      \hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}));
00742         \textcolor{keywordflow}{if} ( NULL == matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} ) \{
00743             free(matvar);
00744             matvar = NULL;
00745         \} \textcolor{keywordflow}{else} \{
00746 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
00747             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name  = NULL;
00748             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref   =  0;
00749             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id         = -1;
00750 \textcolor{preprocessor}{#endif}
00751             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_afd3bfaab126a160bd6855563e1ea0a7e}{datapos}    = 0;
00752             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields} = 0;
00753             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames} = NULL;
00754 \textcolor{preprocessor}{#if defined(HAVE\_ZLIB)}
00755             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z          = NULL;
00756             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data       = NULL;
00757 \textcolor{preprocessor}{#endif}
00758         \}
00759     \}
00760 
00761     \textcolor{keywordflow}{return} matvar;
00762 \}
00763 
00820 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l00821}\hyperlink{group___m_a_t_ga1c54a84bb4d810c6fccdb8869489eac4}{00821} \hyperlink{group___m_a_t_ga1c54a84bb4d810c6fccdb8869489eac4}{Mat\_VarCreate}(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *name,\textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad4d60ae7b709fc81bfd744fb4c857c40}{matio\_classes} class\_type,
00822     \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gacf7b3b879282b7ab3a51190e49bf3453}{matio\_types} data\_type,\textcolor{keywordtype}{int} rank,\textcolor{keywordtype}{size\_t} *dims,\textcolor{keywordtype}{void} *data,\textcolor{keywordtype}{int} opt)
00823 \{
00824     \textcolor{keywordtype}{size\_t} i, nmemb = 1, data\_size;
00825     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar = NULL;
00826 
00827     \textcolor{keywordflow}{if} ( dims == NULL )
00828         \textcolor{keywordflow}{return} NULL;
00829 
00830     matvar = \hyperlink{group___m_a_t_gae7c9c3699f6e9c31a9c490300013098c}{Mat\_VarCalloc}();
00831     \textcolor{keywordflow}{if} ( NULL == matvar )
00832         \textcolor{keywordflow}{return} NULL;
00833 
00834     matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression} = \hyperlink{group___m_a_t_gga768c318af97bd2567758ecb001ceb7f4a2280b97631ff5dd24dec55261dc587b6}{MAT\_COMPRESSION\_NONE};
00835     matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex}   = opt & \hyperlink{group___m_a_t_ggab9d6ef9e3ddca78a317b173f01d53fbbacd7b091a11184aad7fc6078c04470780}{MAT\_F\_COMPLEX};
00836     matvar->\hyperlink{group___m_a_t_af26c71c4c0ddb14931d15910dddac1bc}{isGlobal}    = opt & \hyperlink{group___m_a_t_ggab9d6ef9e3ddca78a317b173f01d53fbba49084e0c796aa7963e53f7539525d40d}{MAT\_F\_GLOBAL};
00837     matvar->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical}   = opt & \hyperlink{group___m_a_t_ggab9d6ef9e3ddca78a317b173f01d53fbba57eb5c6e200bcbc0f1b7982f29a169c2}{MAT\_F\_LOGICAL};
00838     \textcolor{keywordflow}{if} ( name )
00839         matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} = \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"},name);
00840     matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} = rank;
00841     matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} = (\textcolor{keywordtype}{size\_t}*)malloc(matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}*\textcolor{keyword}{sizeof}(*matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}));
00842     \textcolor{keywordflow}{for} ( i = 0; i < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; i++ ) \{
00843         matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i] = dims[i];
00844         nmemb *= dims[i];
00845     \}
00846     matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} = class\_type;
00847     matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}  = data\_type;
00848     \textcolor{keywordflow}{switch} ( data\_type ) \{
00849         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9807f5033ed4f9b548953742d9fd1658}{MAT\_T\_INT8}:
00850             data\_size = 1;
00851             \textcolor{keywordflow}{break};
00852         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a01c1bd7db68f90552862eb5d311be408}{MAT\_T\_UINT8}:
00853             data\_size = 1;
00854             \textcolor{keywordflow}{break};
00855         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a8c5b2e381946e95ea8d81ac216743302}{MAT\_T\_INT16}:
00856             data\_size = 2;
00857             \textcolor{keywordflow}{break};
00858         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a05bc7af7680aa68be95126ae0a4c2e31}{MAT\_T\_UINT16}:
00859             data\_size = 2;
00860             \textcolor{keywordflow}{break};
00861         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a9e825b5d18b8f946eaf2b4b57e51c145}{MAT\_T\_INT64}:
00862             data\_size = 8;
00863             \textcolor{keywordflow}{break};
00864         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a45547932c46be27118abe08302d7e29f}{MAT\_T\_UINT64}:
00865             data\_size = 8;
00866             \textcolor{keywordflow}{break};
00867         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a83e06a68320726c6572bfbb9f3addb1d}{MAT\_T\_INT32}:
00868             data\_size = 4;
00869             \textcolor{keywordflow}{break};
00870         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453aa397e285a23fe240368b752897652c6a}{MAT\_T\_UINT32}:
00871             data\_size = 4;
00872             \textcolor{keywordflow}{break};
00873         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a3a3657d40e9212c923d9b9d03531b64c}{MAT\_T\_SINGLE}:
00874             data\_size = \textcolor{keyword}{sizeof}(float);
00875             \textcolor{keywordflow}{break};
00876         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a31e721ecf7e188196f83c32838288797}{MAT\_T\_DOUBLE}:
00877             data\_size = \textcolor{keyword}{sizeof}(double);
00878             \textcolor{keywordflow}{break};
00879         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453ac34ad81f5cbd3b7d0d95e57e5be0149b}{MAT\_T\_UTF8}:
00880             data\_size = 1;
00881             \textcolor{keywordflow}{break};
00882         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a87ffc0412143c326a1fcc759d5d81bdc}{MAT\_T\_UTF16}:
00883             data\_size = 2;
00884             \textcolor{keywordflow}{break};
00885         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a11e43c0e0be79b1983090e02ae583109}{MAT\_T\_UTF32}:
00886             data\_size = 4;
00887             \textcolor{keywordflow}{break};
00888         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a07599cf2cca6d2b2d059378563318ba5}{MAT\_T\_CELL}:
00889             data\_size = \textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **);
00890             \textcolor{keywordflow}{break};
00891         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a4f4d5a6e1d42c6aa81ffb810e5da5c85}{MAT\_T\_STRUCT}:
00892         \{
00893             data\_size = \textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **);
00894             \textcolor{keywordflow}{if} ( data != NULL ) \{
00895                 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **fields = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}**)data;
00896                 \textcolor{keywordtype}{size\_t} nfields = 0;
00897                 \textcolor{keywordflow}{while} ( fields[nfields] != NULL )
00898                     nfields++;
00899                 \textcolor{keywordflow}{if} ( nmemb )
00900                     nfields = nfields / nmemb;
00901                 matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields} = nfields;
00902                 \textcolor{keywordflow}{if} ( nfields ) \{
00903                     matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames} =
00904                         (\textcolor{keywordtype}{char}**)calloc(nfields,\textcolor{keyword}{sizeof}(*matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->
      \hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}));
00905                     \textcolor{keywordflow}{for} ( i = 0; i < nfields; i++ )
00906                         matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i] = strdup(fields[i]->name);
00907                     nmemb *= nfields;
00908                 \}
00909             \}
00910             \textcolor{keywordflow}{break};
00911         \}
00912         \textcolor{keywordflow}{default}:
00913             \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
00914             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Unrecognized data\_type"});
00915             \textcolor{keywordflow}{return} NULL;
00916     \}
00917     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE} ) \{
00918         matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size} = \textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_gad1332d0eb4faa5a99377919f84b77baf}{mat\_sparse\_t});
00919         matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes}    = matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
00920     \} \textcolor{keywordflow}{else} \{
00921         matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size} = data\_size;
00922         matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} = nmemb*matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
00923     \}
00924     \textcolor{keywordflow}{if} ( data == NULL ) \{
00925         \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL} == matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} && nmemb > 0 )
00926             matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = calloc(nmemb,\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}*));
00927         \textcolor{keywordflow}{else}
00928             matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = NULL;
00929     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( opt & \hyperlink{group___m_a_t_ggab9d6ef9e3ddca78a317b173f01d53fbba762244499f52eb35e7b53fb79a1f2889}{MAT\_F\_DONT\_COPY\_DATA} ) \{
00930         matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data}         = data;
00931         matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} = 1;
00932     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE} == matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
00933         \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *sparse\_data, *sparse\_data\_in;
00934 
00935         sparse\_data\_in = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)data;
00936         sparse\_data    = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}));
00937         \textcolor{keywordflow}{if} ( NULL != sparse\_data ) \{
00938             sparse\_data->\hyperlink{group___m_a_t_ad79471861cb948e32671be6d4089173a}{nzmax} = sparse\_data\_in->\hyperlink{group___m_a_t_ad79471861cb948e32671be6d4089173a}{nzmax};
00939             sparse\_data->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir}   = sparse\_data\_in->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir};
00940             sparse\_data->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc}   = sparse\_data\_in->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc};
00941             sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata} = sparse\_data\_in->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata};
00942             sparse\_data->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} = (\textcolor{keywordtype}{int}*)malloc(sparse\_data->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir}*\textcolor{keyword}{sizeof}(*sparse\_data->
      \hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}));
00943             \textcolor{keywordflow}{if} ( NULL != sparse\_data->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} )
00944                 memcpy(sparse\_data->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir},sparse\_data\_in->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir},
00945                        sparse\_data->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir}*\textcolor{keyword}{sizeof}(*sparse\_data->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}));
00946             sparse\_data->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} = (\textcolor{keywordtype}{int}*)malloc(sparse\_data->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc}*\textcolor{keyword}{sizeof}(*sparse\_data->
      \hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}));
00947             \textcolor{keywordflow}{if} ( NULL != sparse\_data->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} )
00948                 memcpy(sparse\_data->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc},sparse\_data\_in->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc},
00949                        sparse\_data->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc}*\textcolor{keyword}{sizeof}(*sparse\_data->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}));
00950             \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
00951                 sparse\_data->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
00952                 \textcolor{keywordflow}{if} ( NULL != sparse\_data->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} ) \{
00953                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data,*complex\_data\_in;
00954                     complex\_data     = (\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)sparse\_data->
      \hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
00955                     complex\_data\_in  = (\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)sparse\_data\_in->
      \hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
00956                     complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00957                     complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00958                     \textcolor{keywordflow}{if} ( NULL != complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
00959                         memcpy(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},complex\_data\_in->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},
00960                                sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00961                     \textcolor{keywordflow}{if} ( NULL != complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
00962                         memcpy(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},complex\_data\_in->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},
00963                                sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00964                 \}
00965             \} \textcolor{keywordflow}{else} \{
00966                 sparse\_data->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00967                 \textcolor{keywordflow}{if} ( NULL != sparse\_data->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} )
00968                     memcpy(sparse\_data->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data},sparse\_data\_in->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data},
00969                            sparse\_data->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*data\_size);
00970             \}
00971         \}
00972         matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = sparse\_data;
00973     \} \textcolor{keywordflow}{else} \{
00974         \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
00975             matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data}   = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
00976             \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} && matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} > 0 ) \{
00977                 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data    = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
00978                 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data\_in = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)data;
00979 
00980                 complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00981                 complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00982                 \textcolor{keywordflow}{if} ( NULL != complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
00983                     memcpy(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},complex\_data\_in->Re,matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00984                 \textcolor{keywordflow}{if} ( NULL != complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
00985                     memcpy(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},complex\_data\_in->Im,matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00986             \}
00987         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} > 0 ) \{
00988             matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data}   = malloc(matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00989             \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} )
00990                 memcpy(matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data},data,matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
00991         \}
00992         matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} = 0;
00993     \}
00994 
00995     \textcolor{keywordflow}{return} matvar;
00996 \}
00997 
01004 \textcolor{keyword}{static} \textcolor{keywordtype}{int}
01005 mat\_copy(\textcolor{keyword}{const} \textcolor{keywordtype}{char}* src, \textcolor{keyword}{const} \textcolor{keywordtype}{char}* dst)
01006 \{
01007     \textcolor{keywordtype}{size\_t} len;
01008     \textcolor{keywordtype}{char} buf[BUFSIZ] = \{\textcolor{charliteral}{'\(\backslash\)0'}\};
01009     FILE* in;
01010     FILE* out;
01011 
01012     in = fopen(src, \textcolor{stringliteral}{"rb"});
01013     \textcolor{keywordflow}{if} ( in == NULL ) \{
01014         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot open file \(\backslash\)"%s\(\backslash\)" for reading."}, src);
01015         \textcolor{keywordflow}{return} -1;
01016     \}
01017 
01018     out = fopen(dst, \textcolor{stringliteral}{"wb"});
01019     \textcolor{keywordflow}{if} ( out == NULL ) \{
01020         fclose(in);
01021         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot open file \(\backslash\)"%s\(\backslash\)" for writing."}, dst);
01022         \textcolor{keywordflow}{return} -1;
01023     \}
01024 
01025     \textcolor{keywordflow}{while} ( (len = fread(buf, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}), BUFSIZ, in)) > 0 ) \{
01026         \textcolor{keywordflow}{if} ( len != fwrite(buf, \textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}), len, out) ) \{
01027             fclose(in);
01028             fclose(out);
01029             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Error writing to file \(\backslash\)"%s\(\backslash\)"."}, dst);
01030             \textcolor{keywordflow}{return} -1;
01031         \}
01032     \}
01033     fclose(in);
01034     fclose(out);
01035     \textcolor{keywordflow}{return} 0;
01036 \}
01037 
01045 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l01046}\hyperlink{group___m_a_t_gabf139e48d48177e5069338fa2919c60a}{01046} \hyperlink{group___m_a_t_gabf139e48d48177e5069338fa2919c60a}{Mat\_VarDelete}(\hyperlink{struct__mat__t}{mat\_t} *mat, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name)
01047 \{
01048     \textcolor{keywordtype}{int}   err = 1;
01049     \textcolor{keywordtype}{char} *tmp\_name;
01050     \textcolor{keywordtype}{char} temp[7] = \textcolor{stringliteral}{"XXXXXX"};
01051 
01052     \textcolor{keywordflow}{if} ( NULL == mat || NULL == name )
01053         \textcolor{keywordflow}{return} err;
01054 
01055     \textcolor{keywordflow}{if} ( (tmp\_name = mktemp(temp)) != NULL ) \{
01056         \textcolor{keyword}{enum} \hyperlink{group___m_a_t_gad03442b8378999189d510e3745c702b7}{mat\_ft} mat\_file\_ver;
01057         \hyperlink{struct__mat__t}{mat\_t} *tmp;
01058 
01059         \textcolor{keywordflow}{switch} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
01060             \textcolor{keywordflow}{case} 0x0100:
01061                 mat\_file\_ver = \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5};
01062                 \textcolor{keywordflow}{break};
01063             \textcolor{keywordflow}{case} 0x0200:
01064                 mat\_file\_ver = \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73};
01065                 \textcolor{keywordflow}{break};
01066             \textcolor{keywordflow}{case} 0x0010:
01067                 mat\_file\_ver = \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4};
01068                 \textcolor{keywordflow}{break};
01069             \textcolor{keywordflow}{default}:
01070                 mat\_file\_ver = MAT\_FT\_DEFAULT;
01071                 \textcolor{keywordflow}{break};
01072         \}
01073 
01074         tmp = \hyperlink{group___m_a_t_ga22d404f203af7869c841400e7ad247cf}{Mat\_CreateVer}(tmp\_name,mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header},mat\_file\_ver);
01075         \textcolor{keywordflow}{if} ( tmp != NULL ) \{
01076             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar;
01077             \textcolor{keywordtype}{char} **dir;
01078             \textcolor{keywordtype}{size\_t} n;
01079 
01080             \hyperlink{group___m_a_t_ga4d6e3892d2e216c507a744ba0e070d0b}{Mat\_Rewind}(mat);
01081             \textcolor{keywordflow}{while} ( NULL != (matvar = \hyperlink{group___m_a_t_ga7c321d6aafd93916ba6c5655ad78e9ca}{Mat\_VarReadNext}(mat)) ) \{
01082                 \textcolor{keywordflow}{if} ( 0 != strcmp(matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name},name) )
01083                     \hyperlink{group___m_a_t_ga4bd3eba12df415d8226e27c457fbbb0b}{Mat\_VarWrite}(tmp,matvar,matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression});
01084                 \textcolor{keywordflow}{else}
01085                     err = 0;
01086                 \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
01087             \}
01088             dir = tmp->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}; \textcolor{comment}{/* Keep directory for later assignment */}
01089             tmp->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = NULL;
01090             n = tmp->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets};
01091             \hyperlink{group___m_a_t_ga101c92ff7bde4a2d4615661beba09262}{Mat\_Close}(tmp);
01092 
01093             \textcolor{keywordflow}{if} ( 0 == err ) \{
01094                 \textcolor{keywordtype}{char} *new\_name = \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"},mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename});
01095 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
01096                 \textcolor{keywordflow}{if} ( mat\_file\_ver == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
01097                     \textcolor{keywordflow}{if} ( mat->refs\_id > -1 )
01098                         H5Gclose(mat->refs\_id);
01099                     H5Fclose(*(hid\_t*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
01100                     free(mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
01101                     mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = NULL;
01102                 \}
01103 \textcolor{preprocessor}{#endif}
01104                 \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} != NULL ) \{
01105                     fclose((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
01106                     mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} = NULL;
01107                 \}
01108 
01109                 \textcolor{keywordflow}{if} ( (err = mat\_copy(tmp\_name,new\_name)) == -1 ) \{
01110                     \textcolor{keywordflow}{if} ( NULL != dir ) \{
01111                         \textcolor{keywordtype}{size\_t} i;
01112                         \textcolor{keywordflow}{for} ( i = 0; i < n; i++ ) \{
01113                             \textcolor{keywordflow}{if} ( dir[i] )
01114                                 free(dir[i]);
01115                         \}
01116                         free(dir);
01117                     \}
01118                     \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot copy file from \(\backslash\)"%s\(\backslash\)" to \(\backslash\)"%s\(\backslash\)"."},
01119                         tmp\_name, new\_name);
01120                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (err = \textcolor{keyword}{remove}(tmp\_name)) == -1 ) \{
01121                     \textcolor{keywordflow}{if} ( NULL != dir ) \{
01122                         \textcolor{keywordtype}{size\_t} i;
01123                         \textcolor{keywordflow}{for} ( i = 0; i < n; i++ ) \{
01124                             \textcolor{keywordflow}{if} ( dir[i] )
01125                                 free(dir[i]);
01126                         \}
01127                         free(dir);
01128                     \}
01129                     \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot remove file \(\backslash\)"%s\(\backslash\)"."},tmp\_name);
01130                 \} \textcolor{keywordflow}{else} \{
01131                     tmp = \hyperlink{group___m_a_t_gafbfedb5636a99f0ef867520c47f77d18}{Mat\_Open}(new\_name,mat->\hyperlink{struct__mat__t_aa43288b63b8edb7cadf0b79e2d1df2ee}{mode});
01132                     \textcolor{keywordflow}{if} ( NULL != tmp ) \{
01133                         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header} )
01134                             free(mat->\hyperlink{struct__mat__t_a5ed5d0e4e3c4d76b626a8a1772d579c4}{header});
01135                         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset} )
01136                             free(mat->\hyperlink{struct__mat__t_a19317c01209959d755d69311960d3eec}{subsys\_offset});
01137                         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename} )
01138                             free(mat->\hyperlink{struct__mat__t_a340b191598135edd03b6dec847f0b1b1}{filename});
01139                         \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
01140                             \textcolor{keywordtype}{size\_t} i;
01141                             \textcolor{keywordflow}{for} ( i = 0; i < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}; i++ ) \{
01142                                 \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i] )
01143                                     free(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i]);
01144                             \}
01145                             free(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir});
01146                         \}
01147                         memcpy(mat,tmp,\textcolor{keyword}{sizeof}(\hyperlink{struct__mat__t}{mat\_t}));
01148                         free(tmp);
01149                         mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} = n;
01150                         mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = dir;
01151                     \} \textcolor{keywordflow}{else} \{
01152                         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot open file \(\backslash\)"%s\(\backslash\)"."},new\_name);
01153                     \}
01154                 \}
01155                 free(new\_name);
01156             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (err = \textcolor{keyword}{remove}(tmp\_name)) == -1 ) \{
01157                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot remove file \(\backslash\)"%s\(\backslash\)"."},tmp\_name);
01158             \}
01159         \}
01160     \} \textcolor{keywordflow}{else} \{
01161         \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Cannot create a unique file name."});
01162     \}
01163 
01164     \textcolor{keywordflow}{return} err;
01165 \}
01166 
01179 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l01180}\hyperlink{group___m_a_t_ga7ef80c5d99d7918b2b09db3bea106ecc}{01180} \hyperlink{group___m_a_t_ga7ef80c5d99d7918b2b09db3bea106ecc}{Mat\_VarDuplicate}(\textcolor{keyword}{const} \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *in, \textcolor{keywordtype}{int} opt)
01181 \{
01182     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *out;
01183     \textcolor{keywordtype}{int} i;
01184 
01185     out = \hyperlink{group___m_a_t_gae7c9c3699f6e9c31a9c490300013098c}{Mat\_VarCalloc}();
01186     \textcolor{keywordflow}{if} ( out == NULL )
01187         \textcolor{keywordflow}{return} NULL;
01188 
01189     out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes}       = in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes};
01190     out->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}         = in->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank};
01191     out->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}    = in->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type};
01192     out->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size}    = in->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
01193     out->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type}   = in->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type};
01194     out->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex}    = in->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex};
01195     out->\hyperlink{group___m_a_t_af26c71c4c0ddb14931d15910dddac1bc}{isGlobal}     = in->\hyperlink{group___m_a_t_af26c71c4c0ddb14931d15910dddac1bc}{isGlobal};
01196     out->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical}    = in->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical};
01197     out->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} = in->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve};
01198     out->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression}  = in->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression};
01199 
01200     \textcolor{keywordflow}{if} ( in->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} != NULL && (NULL != (out->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} = (\textcolor{keywordtype}{char}*)malloc(strlen(in->
      \hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name})+1))) )
01201         memcpy(out->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name},in->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name},strlen(in->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name})+1);
01202 
01203     out->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} = (\textcolor{keywordtype}{size\_t}*)malloc(in->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}*\textcolor{keyword}{sizeof}(*out->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}));
01204     \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} != NULL )
01205         memcpy(out->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims},in->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims},in->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}*\textcolor{keyword}{sizeof}(*out->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}));
01206 
01207     \textcolor{keywordflow}{if} ( NULL != in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} ) \{
01208 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
01209         \textcolor{keywordflow}{if} ( NULL != in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name )
01210             out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name = strdup(in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name);
01211 
01212         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref = in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref;
01213         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id       = in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id;
01214 \textcolor{preprocessor}{#endif}
01215         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_afd3bfaab126a160bd6855563e1ea0a7e}{datapos}  = in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_afd3bfaab126a160bd6855563e1ea0a7e}{datapos};
01216 \textcolor{preprocessor}{#if defined(HAVE\_ZLIB)}
01217         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z        = NULL;
01218         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data     = NULL;
01219 \textcolor{preprocessor}{#endif}
01220         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields} = in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->
      \hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields};
01221         \textcolor{keywordflow}{if} ( NULL != in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames} && in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->
      \hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields} > 0 ) \{
01222             out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames} = (\textcolor{keywordtype}{char}**)calloc(in->
      \hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields},
01223                                                \textcolor{keyword}{sizeof}(*in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->
      \hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}));
01224             \textcolor{keywordflow}{for} ( i = 0; i < in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields}; i++ ) \{
01225                 \textcolor{keywordflow}{if} ( NULL != in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i] )
01226                     out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i] =
01227                         strdup(in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i]);
01228             \}
01229         \}
01230 
01231 \textcolor{preprocessor}{#if defined(HAVE\_ZLIB)}
01232         \textcolor{keywordflow}{if} ( (in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z != NULL) && (NULL != (out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z = (z\_streamp)malloc(\textcolor{keyword}{
      sizeof}(\hyperlink{structz__stream__s}{z\_stream})))) )
01233             inflateCopy(out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z,in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z);
01234         \textcolor{keywordflow}{if} ( in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data != NULL ) \{
01235             \textcolor{keywordflow}{if} ( in->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE} ) \{
01236                 out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}));
01237                 \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data != NULL ) \{
01238                     \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *out\_sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)out->
      \hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01239                     \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *in\_sparse  = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)in->
      \hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01240                     out\_sparse->\hyperlink{group___m_a_t_ad79471861cb948e32671be6d4089173a}{nzmax} = in\_sparse->nzmax;
01241                     out\_sparse->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir} = in\_sparse->nir;
01242                     out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} = (\textcolor{keywordtype}{int}*)malloc(in\_sparse->nir*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01243                     \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} != NULL )
01244                         memcpy(out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}, in\_sparse->ir, in\_sparse->nir*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01245                     out\_sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc} = in\_sparse->njc;
01246                     out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} = (\textcolor{keywordtype}{int}*)malloc(in\_sparse->njc*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01247                     \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} != NULL )
01248                         memcpy(out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}, in\_sparse->jc, in\_sparse->njc*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01249                     out\_sparse->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata} = in\_sparse->ndata;
01250                     \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} && NULL != in\_sparse->data ) \{
01251                         out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
01252                         \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} != NULL ) \{
01253                             \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *out\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01254                             \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *in\_data  = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)in\_sparse->data;
01255                             out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(
01256                                 in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01257                             \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
01258                                 memcpy(out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},in\_data->Re,
01259                                     in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01260                             out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(
01261                                 in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01262                             \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
01263                                 memcpy(out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},in\_data->Im,
01264                                     in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01265                         \}
01266                     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( in\_sparse->data != NULL ) \{
01267                         out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(in\_sparse->ndata*
      \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01268                         \textcolor{keywordflow}{if} ( NULL != out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} )
01269                             memcpy(out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data}, in\_sparse->data,
01270                                 in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01271                     \}
01272                 \}
01273             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01274                 out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
01275                 \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data != NULL ) \{
01276                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *out\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01277                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *in\_data  = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01278                     out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01279                     \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
01280                         memcpy(out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},in\_data->Re,out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01281                     out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01282                     \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
01283                         memcpy(out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},in\_data->Im,out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01284                 \}
01285             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( NULL != (out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data = malloc(in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes})) ) \{
01286                 memcpy(out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data, in->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data, in->
      \hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01287             \}
01288         \}
01289 \textcolor{preprocessor}{#endif}
01290     \} \textcolor{keywordflow}{else} \{
01291         free(out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal});
01292         out->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} = NULL;
01293     \}
01294 
01295     \textcolor{keywordflow}{if} ( !opt ) \{
01296         out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01297     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL) && (in->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == 
      \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40acb467c7749c80902b798134c729bb521}{MAT\_C\_STRUCT}) ) \{
01298         out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = malloc(in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01299         \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL && in->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size} > 0 ) \{
01300             \textcolor{keywordtype}{int} nfields = in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} / in->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
01301             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **infields  = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01302             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **outfields = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01303             \textcolor{keywordflow}{for} ( i = 0; i < nfields; i++ ) \{
01304                 outfields[i] = \hyperlink{group___m_a_t_ga7ef80c5d99d7918b2b09db3bea106ecc}{Mat\_VarDuplicate}(infields[i],opt);
01305             \}
01306         \}
01307     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL) && (in->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == 
      \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL}) ) \{
01308         out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = malloc(in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01309         \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL && in->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size} > 0 ) \{
01310             \textcolor{keywordtype}{int} ncells = in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} / in->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
01311             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **incells  = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01312             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **outcells = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01313             \textcolor{keywordflow}{for} ( i = 0; i < ncells; i++ ) \{
01314                 outcells[i] = \hyperlink{group___m_a_t_ga7ef80c5d99d7918b2b09db3bea106ecc}{Mat\_VarDuplicate}(incells[i],opt);
01315             \}
01316         \}
01317     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL) && (in->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == 
      \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE}) ) \{
01318         out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}));
01319         \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL ) \{
01320             \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *out\_sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)out->
      \hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01321             \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *in\_sparse  = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)in->
      \hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01322             out\_sparse->\hyperlink{group___m_a_t_ad79471861cb948e32671be6d4089173a}{nzmax} = in\_sparse->nzmax;
01323             out\_sparse->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir} = in\_sparse->nir;
01324             out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} = (\textcolor{keywordtype}{int}*)malloc(in\_sparse->nir*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01325             \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} != NULL )
01326                 memcpy(out\_sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}, in\_sparse->ir, in\_sparse->nir*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01327             out\_sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc} = in\_sparse->njc;
01328             out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} = (\textcolor{keywordtype}{int}*)malloc(in\_sparse->njc*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01329             \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} != NULL )
01330                 memcpy(out\_sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}, in\_sparse->jc, in\_sparse->njc*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01331             out\_sparse->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata} = in\_sparse->ndata;
01332             \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} && NULL != in\_sparse->data ) \{
01333                 out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
01334                 \textcolor{keywordflow}{if} ( out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} != NULL ) \{
01335                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *out\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01336                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *in\_data  = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)in\_sparse->data;
01337                     out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01338                     \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
01339                         memcpy(out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},in\_data->Re,in\_sparse->ndata*
      \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01340                     out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01341                     \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
01342                         memcpy(out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},in\_data->Im,in\_sparse->ndata*
      \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01343                 \}
01344             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( in\_sparse->data != NULL ) \{
01345                 out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = malloc(in\_sparse->ndata*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01346                 \textcolor{keywordflow}{if} ( NULL != out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} )
01347                     memcpy(out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data}, in\_sparse->data, in\_sparse->ndata*
      \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(in->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}));
01348             \} \textcolor{keywordflow}{else} \{
01349                 out\_sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} = NULL;
01350             \}
01351         \}
01352     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL ) \{
01353         \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01354             out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = malloc(\textcolor{keyword}{sizeof}(\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}));
01355             \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL ) \{
01356                 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *out\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01357                 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *in\_data  = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01358                 out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} = malloc(out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01359                 \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re} )
01360                     memcpy(out\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re},in\_data->Re,out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01361                 out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} = malloc(out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01362                 \textcolor{keywordflow}{if} ( NULL != out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im} )
01363                     memcpy(out\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im},in\_data->Im,out->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01364             \}
01365         \} \textcolor{keywordflow}{else} \{
01366             out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} = malloc(in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01367             \textcolor{keywordflow}{if} ( out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} != NULL )
01368                 memcpy(out->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data},in->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data},in->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes});
01369         \}
01370     \}
01371 
01372     \textcolor{keywordflow}{return} out;
01373 \}
01374 
01382 \textcolor{keywordtype}{void}
\Hypertarget{mat_8c_source_l01383}\hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{01383} \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar)
01384 \{
01385     \textcolor{keywordtype}{size\_t} nmemb = 0, i;
01386     \textcolor{keywordflow}{if} ( NULL == matvar )
01387         \textcolor{keywordflow}{return};
01388     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} ) \{
01389         nmemb = 1;
01390         \textcolor{keywordflow}{for} ( i = 0; i < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; i++ )
01391             nmemb *= matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i];
01392         free(matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims});
01393     \}
01394     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} ) \{
01395         \textcolor{keywordflow}{switch} (matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
01396             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40acb467c7749c80902b798134c729bb521}{MAT\_C\_STRUCT}:
01397                 \textcolor{keywordflow}{if} ( !matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} ) \{
01398                     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **fields = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}**)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01399                     \textcolor{keywordtype}{int} nfields = matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields};
01400                     for ( i = 0; i < nmemb*nfields; i++ )
01401                         \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(fields[i]);
01402 
01403                     free(matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data});
01404                 \}
01405                 \textcolor{keywordflow}{break};
01406             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL}:
01407                 \textcolor{keywordflow}{if} ( !matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} ) \{
01408                     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **cells = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}**)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01409                     for ( i = 0; i < nmemb; i++ )
01410                         \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(cells[i]);
01411 
01412                     free(matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data});
01413                 \}
01414                 \textcolor{keywordflow}{break};
01415             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE}:
01416                 \textcolor{keywordflow}{if} ( !matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} ) \{
01417                     \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *sparse;
01418                     sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01419                     if ( sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} != NULL )
01420                         free(sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir});
01421                     \textcolor{keywordflow}{if} ( sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} != NULL )
01422                         free(sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc});
01423                     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} && NULL != sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} ) \{
01424                         \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01425                         free(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re});
01426                         free(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im});
01427                         free(complex\_data);
01428                     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} != NULL ) \{
01429                         free(sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data});
01430                     \}
01431                     free(sparse);
01432                 \}
01433                 \textcolor{keywordflow}{break};
01434             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
01435             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
01436             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
01437             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
01438             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
01439             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
01440             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
01441             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
01442             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
01443             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
01444             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aacdec5834df0861130b393697646119c}{MAT\_C\_CHAR}:
01445                 \textcolor{keywordflow}{if} ( !matvar->\hyperlink{group___m_a_t_aff20e87a00691c97340ab07656a13ee7}{mem\_conserve} ) \{
01446                     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01447                         \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01448                         free(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re});
01449                         free(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im});
01450                         free(complex\_data);
01451                     \} \textcolor{keywordflow}{else} \{
01452                         free(matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data});
01453                     \}
01454                 \}
01455                 \textcolor{keywordflow}{break};
01456             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5c76eef0ca0373d25abe49053be6fa9a}{MAT\_C\_EMPTY}:
01457             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40afe45104b68b044c83a2f99e349fa1ea6}{MAT\_C\_OBJECT}:
01458             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aaa9bf08312779cd1ab8e504a162ddcea}{MAT\_C\_FUNCTION}:
01459             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40ad83c684d250e463c1a3779647695c0c9}{MAT\_C\_OPAQUE}:
01460                 \textcolor{keywordflow}{break};
01461         \}
01462     \}
01463 
01464     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} ) \{
01465 \textcolor{preprocessor}{#if defined(HAVE\_ZLIB)}
01466         \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression} == \hyperlink{group___m_a_t_gga768c318af97bd2567758ecb001ceb7f4a5181d2f71eab0f12f05ba65d4f13fb53}{MAT\_COMPRESSION\_ZLIB} ) \{
01467             inflateEnd(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z);
01468             free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z);
01469             \textcolor{keywordflow}{if} ( (matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data != NULL) && (matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == 
      \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE}) ) \{
01470                 \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *sparse;
01471                 sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01472                 if ( sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir} != NULL )
01473                     free(sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir});
01474                 \textcolor{keywordflow}{if} ( sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc} != NULL )
01475                     free(sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc});
01476                 \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} && NULL != sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} ) \{
01477                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01478                     free(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re});
01479                     free(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im});
01480                     free(complex\_data);
01481                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data} != NULL ) \{
01482                     free(sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data});
01483                 \}
01484                 free(sparse);
01485             \}
01486             \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( (matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data != NULL) && matvar->
      \hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01487                 \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data =
01488                     (\hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data;
01489                 free(complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re});
01490                 free(complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im});
01491                 free(complex\_data);
01492             \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data ) \{
01493                 free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->data);
01494             \}
01495         \}
01496 \textcolor{preprocessor}{#endif}
01497 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
01498         \textcolor{keywordflow}{if} ( -1 < matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id ) \{
01499             \textcolor{keywordflow}{switch} ( H5Iget\_type(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id) ) \{
01500                 \textcolor{keywordflow}{case} H5I\_GROUP:
01501                     H5Gclose(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id);
01502                     matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id = -1;
01503                     \textcolor{keywordflow}{break};
01504                 \textcolor{keywordflow}{case} H5I\_DATASET:
01505                     H5Dclose(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id);
01506                     matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id = -1;
01507                     \textcolor{keywordflow}{break};
01508                 \textcolor{keywordflow}{default}:
01509                     \textcolor{keywordflow}{break};
01510             \}
01511         \}
01512         \textcolor{keywordflow}{if} ( 0 < matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref ) \{
01513             \textcolor{keywordflow}{switch} ( H5Iget\_type(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id) ) \{
01514                 \textcolor{keywordflow}{case} H5I\_GROUP:
01515                     H5Gclose(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id);
01516                     matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref = -1;
01517                     \textcolor{keywordflow}{break};
01518                 \textcolor{keywordflow}{case} H5I\_DATASET:
01519                     H5Dclose(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->id);
01520                     matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_ref = -1;
01521                     \textcolor{keywordflow}{break};
01522                 \textcolor{keywordflow}{default}:
01523                     \textcolor{keywordflow}{break};
01524             \}
01525         \}
01526         \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name ) \{
01527             free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name);
01528             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->hdf5\_name = NULL;
01529         \}
01530 \textcolor{preprocessor}{#endif}
01531         \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames} &&
01532              matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields} > 0 ) \{
01533             \textcolor{keywordtype}{size\_t} i;
01534             \textcolor{keywordflow}{for} ( i = 0; i < matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields}; i++ ) \{
01535                 \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i] )
01536                     free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i]);
01537             \}
01538             free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames});
01539         \}
01540         free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal});
01541         matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} = NULL;
01542     \}
01543     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} )
01544         free(matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
01545     free(matvar);
01546 \}
01547 
01564 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l01565}\hyperlink{group___m_a_t_ga9b8d09f631538b14ca29792e0334e349}{01565} \hyperlink{group___m_a_t_ga9b8d09f631538b14ca29792e0334e349}{Mat\_CalcSingleSubscript}(\textcolor{keywordtype}{int} rank,\textcolor{keywordtype}{int} *dims,\textcolor{keywordtype}{int} *subs)
01566 \{
01567     \textcolor{keywordtype}{int} index = 0, i, j, err = 0;
01568 
01569     \textcolor{keywordflow}{for} ( i = 0; i < rank; i++ ) \{
01570         \textcolor{keywordtype}{int} k = subs[i];
01571         \textcolor{keywordflow}{if} ( k > dims[i] ) \{
01572             err = 1;
01573             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Mat\_CalcSingleSubscript: index out of bounds"});
01574             \textcolor{keywordflow}{break};
01575         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( k < 1 ) \{
01576             err = 1;
01577             \textcolor{keywordflow}{break};
01578         \}
01579         k--;
01580         \textcolor{keywordflow}{for} ( j = i; j--; )
01581             k *= dims[j];
01582         index += k;
01583     \}
01584     \textcolor{keywordflow}{if} ( err )
01585         index = -1;
01586 
01587     \textcolor{keywordflow}{return} index;
01588 \}
01589 
01607 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l01608}\hyperlink{group___m_a_t_ga5f7923e9d61ad728c127439044c4ae0e}{01608} \hyperlink{group___m_a_t_ga5f7923e9d61ad728c127439044c4ae0e}{Mat\_CalcSingleSubscript2}(\textcolor{keywordtype}{int} rank,\textcolor{keywordtype}{size\_t} *dims,\textcolor{keywordtype}{size\_t} *subs,\textcolor{keywordtype}{size\_t} *index)
01609 \{
01610     \textcolor{keywordtype}{int} i, err = 0;
01611 
01612     \textcolor{keywordflow}{for} ( i = 0; i < rank; i++ ) \{
01613         \textcolor{keywordtype}{int} j;
01614         \textcolor{keywordtype}{size\_t} k = subs[i];
01615         \textcolor{keywordflow}{if} ( k > dims[i] ) \{
01616             err = 1;
01617             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Mat\_CalcSingleSubscript2: index out of bounds"});
01618             \textcolor{keywordflow}{break};
01619         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( k < 1 ) \{
01620             err = 1;
01621             \textcolor{keywordflow}{break};
01622         \}
01623         k--;
01624         \textcolor{keywordflow}{for} ( j = i; j--; )
01625             k *= dims[j];
01626         *index += k;
01627     \}
01628 
01629     \textcolor{keywordflow}{return} err;
01630 \}
01631 
01650 \textcolor{keywordtype}{int} *
\Hypertarget{mat_8c_source_l01651}\hyperlink{group___m_a_t_gabe2571a4b9b6cff3b31aa6f152deba61}{01651} \hyperlink{group___m_a_t_gabe2571a4b9b6cff3b31aa6f152deba61}{Mat\_CalcSubscripts}(\textcolor{keywordtype}{int} rank,\textcolor{keywordtype}{int} *dims,\textcolor{keywordtype}{int} index)
01652 \{
01653     \textcolor{keywordtype}{int} i, j, *subs;
01654     \textcolor{keywordtype}{double} l;
01655 
01656     subs = (\textcolor{keywordtype}{int}*)malloc(rank*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{int}));
01657     l = index;
01658     \textcolor{keywordflow}{for} ( i = rank; i--; ) \{
01659         \textcolor{keywordtype}{int} k = 1;
01660         \textcolor{keywordflow}{for} ( j = i; j--; )
01661             k *= dims[j];
01662         subs[i] = (int)floor(l / (\textcolor{keywordtype}{double})k);
01663         l -= subs[i]*k;
01664         subs[i]++;
01665     \}
01666 
01667     \textcolor{keywordflow}{return} subs;
01668 \}
01669 
01688 \textcolor{keywordtype}{size\_t} *
\Hypertarget{mat_8c_source_l01689}\hyperlink{group___m_a_t_ga5af1727403cfa3daa8567de39e1abe64}{01689} \hyperlink{group___m_a_t_ga5af1727403cfa3daa8567de39e1abe64}{Mat\_CalcSubscripts2}(\textcolor{keywordtype}{int} rank,\textcolor{keywordtype}{size\_t} *dims,\textcolor{keywordtype}{size\_t} index)
01690 \{
01691     \textcolor{keywordtype}{int} i;
01692     \textcolor{keywordtype}{size\_t} *subs;
01693     \textcolor{keywordtype}{double} l;
01694 
01695     subs = (\textcolor{keywordtype}{size\_t}*)malloc(rank*\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{size\_t}));
01696     l = (double)index;
01697     \textcolor{keywordflow}{for} ( i = rank; i--; ) \{
01698         \textcolor{keywordtype}{int} j;
01699         \textcolor{keywordtype}{size\_t} k = 1;
01700         \textcolor{keywordflow}{for} ( j = i; j--; )
01701             k *= dims[j];
01702         subs[i] = (size\_t)floor(l / (\textcolor{keywordtype}{double})k);
01703         l -= subs[i]*k;
01704         subs[i]++;
01705     \}
01706 
01707     \textcolor{keywordflow}{return} subs;
01708 \}
01709 
01716 \textcolor{keywordtype}{size\_t}
\Hypertarget{mat_8c_source_l01717}\hyperlink{group___m_a_t_gaeeb798fead2f765bddfb19016c7fdbcc}{01717} \hyperlink{group___m_a_t_gaeeb798fead2f765bddfb19016c7fdbcc}{Mat\_VarGetSize}(\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar)
01718 \{
01719     \textcolor{keywordtype}{int} i;
01720     \textcolor{keywordtype}{size\_t} bytes = 0, overhead = 0, ptr = 0;
01721 
01722 \textcolor{preprocessor}{#if defined(\_WIN64) || (defined(\_\_SIZEOF\_POINTER\_\_) && (\_\_SIZEOF\_POINTER\_\_ == 8)) ||
       (defined(SIZEOF\_VOID\_P) && (SIZEOF\_VOID\_P == 8))}
01723     \textcolor{comment}{/* 112 bytes cell/struct overhead for 64-bit system */}
01724     overhead = 112;
01725     ptr = 8;
01726 \textcolor{preprocessor}{#elif defined(\_WIN32) || (defined(\_\_SIZEOF\_POINTER\_\_) && (\_\_SIZEOF\_POINTER\_\_ == 4)) ||
       (defined(SIZEOF\_VOID\_P) && (SIZEOF\_VOID\_P == 4))}
01727     \textcolor{comment}{/* 60 bytes cell/struct overhead for 32-bit system */}
01728     overhead = 60;
01729     ptr = 4;
01730 \textcolor{preprocessor}{#endif}
01731 
01732     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40acb467c7749c80902b798134c729bb521}{MAT\_C\_STRUCT} ) \{
01733         \textcolor{keywordtype}{int} nfields = matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields};
01734         \textcolor{keywordtype}{int} nmemb = 1;
01735         \textcolor{keywordflow}{for} ( i = 0; i < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; i++ )
01736             nmemb *= matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i];
01737         if ( nmemb*nfields > 0 ) \{
01738             \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **fields = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}**)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01739             if ( NULL != fields ) \{
01740                 bytes = nmemb*nfields*overhead;
01741                 \textcolor{keywordflow}{for} ( i = 0; i < nmemb*nfields; i++ ) \{
01742                     \textcolor{keywordflow}{if} ( NULL != fields[i] ) \{
01743                         \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5c76eef0ca0373d25abe49053be6fa9a}{MAT\_C\_EMPTY} != fields[i]->class\_type )
01744                             bytes += \hyperlink{group___m_a_t_gaeeb798fead2f765bddfb19016c7fdbcc}{Mat\_VarGetSize}(fields[i]);
01745                         \textcolor{keywordflow}{else}
01746                             bytes += ptr - overhead;
01747                     \}
01748                 \}
01749             \}
01750         \}
01751         bytes += 64 \textcolor{comment}{/* max field name length */} *nfields;
01752     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL} ) \{
01753         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **cells = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t}**)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01754         if ( NULL != cells ) \{
01755             \textcolor{keywordtype}{int} ncells = matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} / matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
01756             bytes = ncells*overhead;
01757             \textcolor{keywordflow}{for} ( i = 0; i < ncells; i++ ) \{
01758                 \textcolor{keywordflow}{if} ( NULL != cells[i] ) \{
01759                     \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5c76eef0ca0373d25abe49053be6fa9a}{MAT\_C\_EMPTY} != cells[i]->class\_type )
01760                         bytes += \hyperlink{group___m_a_t_gaeeb798fead2f765bddfb19016c7fdbcc}{Mat\_VarGetSize}(cells[i]);
01761                     \textcolor{keywordflow}{else}
01762                         bytes += ptr - overhead;
01763                 \}
01764             \}
01765         \}
01766     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} == \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE} ) \{
01767         \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)matvar->
      \hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01768         if ( NULL != sparse ) \{
01769             bytes = sparse->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata}*\hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type});
01770             \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} )
01771                 bytes *= 2;
01772 \textcolor{preprocessor}{#if defined(\_WIN64) || (defined(\_\_SIZEOF\_POINTER\_\_) && (\_\_SIZEOF\_POINTER\_\_ == 8)) ||
       (defined(SIZEOF\_VOID\_P) && (SIZEOF\_VOID\_P == 8))}
01773             \textcolor{comment}{/* 8 byte integers for 64-bit system (as displayed in MATLAB (x64) whos) */}
01774             bytes += (sparse->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir} + sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc})*8;
01775 \textcolor{preprocessor}{#elif defined(\_WIN32) || (defined(\_\_SIZEOF\_POINTER\_\_) && (\_\_SIZEOF\_POINTER\_\_ == 4)) ||
       (defined(SIZEOF\_VOID\_P) && (SIZEOF\_VOID\_P == 4))}
01776             \textcolor{comment}{/* 4 byte integers for 32-bit system (as defined by mat\_sparse\_t) */}
01777             bytes += (sparse->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir} + sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc})*4;
01778 \textcolor{preprocessor}{#endif}
01779             \textcolor{keywordflow}{if} ( sparse->\hyperlink{group___m_a_t_a1beb8a8c58a808207cbea650563a9b63}{ndata} == 0 || sparse->\hyperlink{group___m_a_t_aa64636ad57cf87f7a28ff5018437a850}{nir} == 0 || sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc} == 0 )
01780                 bytes += matvar->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical} ? 1 : 8;
01781         \}
01782     \} \textcolor{keywordflow}{else} \{
01783         \textcolor{keywordtype}{int} nmemb = 1;
01784         \textcolor{keywordflow}{for} ( i = 0; i < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; i++ )
01785             nmemb *= matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i];
01786         bytes = nmemb*\hyperlink{group___m_a_t_ga2bf682f015b22fa796a8885e997661e7}{Mat\_SizeOfClass}(matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type});
01787         \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} )
01788             bytes *= 2;
01789     \}
01790 
01791     \textcolor{keywordflow}{return} bytes;
01792 \}
01793 
01801 \textcolor{keywordtype}{void}
\Hypertarget{mat_8c_source_l01802}\hyperlink{group___m_a_t_ga9100c145e338b84b55d5d0795d5d390a}{01802} \hyperlink{group___m_a_t_ga9100c145e338b84b55d5d0795d5d390a}{Mat\_VarPrint}( \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar, \textcolor{keywordtype}{int} printdata )
01803 \{
01804     \textcolor{keywordtype}{size\_t} nmemb = 0;
01805     \textcolor{keywordtype}{int} i, j;
01806     \textcolor{keyword}{const} \textcolor{keywordtype}{char} *class\_type\_desc[18] = \{\textcolor{stringliteral}{"Undefined"},\textcolor{stringliteral}{"Cell Array"},\textcolor{stringliteral}{"Structure"},
01807        \textcolor{stringliteral}{"Object"},\textcolor{stringliteral}{"Character Array"},\textcolor{stringliteral}{"Sparse Array"},\textcolor{stringliteral}{"Double Precision Array"},
01808        \textcolor{stringliteral}{"Single Precision Array"}, \textcolor{stringliteral}{"8-bit, signed integer array"},
01809        \textcolor{stringliteral}{"8-bit, unsigned integer array"},\textcolor{stringliteral}{"16-bit, signed integer array"},
01810        \textcolor{stringliteral}{"16-bit, unsigned integer array"},\textcolor{stringliteral}{"32-bit, signed integer array"},
01811        \textcolor{stringliteral}{"32-bit, unsigned integer array"},\textcolor{stringliteral}{"64-bit, signed integer array"},
01812        \textcolor{stringliteral}{"64-bit, unsigned integer array"},\textcolor{stringliteral}{"Function"},\textcolor{stringliteral}{"Opaque"}\};
01813 
01814     \textcolor{keywordflow}{if} ( matvar == NULL )
01815         \textcolor{keywordflow}{return};
01816     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} )
01817         printf(\textcolor{stringliteral}{"      Name: %s\(\backslash\)n"}, matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
01818     printf(\textcolor{stringliteral}{"      Rank: %d\(\backslash\)n"}, matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank});
01819     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} <= 0 )
01820         \textcolor{keywordflow}{return};
01821     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} ) \{
01822         printf(\textcolor{stringliteral}{"Dimensions: %"} SIZE\_T\_FMTSTR,matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0]);
01823         nmemb = matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0];
01824         \textcolor{keywordflow}{for} ( i = 1; i < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; i++ ) \{
01825             printf(\textcolor{stringliteral}{" x %"} SIZE\_T\_FMTSTR,matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i]);
01826             nmemb *= matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[i];
01827         \}
01828         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01829     \}
01830     printf(\textcolor{stringliteral}{"Class Type: %s"},class\_type\_desc[matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type}]);
01831     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} )
01832         printf(\textcolor{stringliteral}{" (complex)"});
01833     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a866c1539e68073a837833d74cd4a65be}{isLogical} )
01834         printf(\textcolor{stringliteral}{" (logical)"});
01835     printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01836     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type} ) \{
01837         \textcolor{keyword}{const} \textcolor{keywordtype}{char} *data\_type\_desc[23] = \{\textcolor{stringliteral}{"Unknown"},\textcolor{stringliteral}{"8-bit, signed integer"},
01838            \textcolor{stringliteral}{"8-bit, unsigned integer"},\textcolor{stringliteral}{"16-bit, signed integer"},
01839            \textcolor{stringliteral}{"16-bit, unsigned integer"},\textcolor{stringliteral}{"32-bit, signed integer"},
01840            \textcolor{stringliteral}{"32-bit, unsigned integer"},\textcolor{stringliteral}{"IEEE 754 single-precision"},\textcolor{stringliteral}{"RESERVED"},
01841            \textcolor{stringliteral}{"IEEE 754 double-precision"},\textcolor{stringliteral}{"RESERVED"},\textcolor{stringliteral}{"RESERVED"},
01842            \textcolor{stringliteral}{"64-bit, signed integer"},\textcolor{stringliteral}{"64-bit, unsigned integer"}, \textcolor{stringliteral}{"Matlab Array"},
01843            \textcolor{stringliteral}{"Compressed Data"},\textcolor{stringliteral}{"Unicode UTF-8 Encoded Character Data"},
01844            \textcolor{stringliteral}{"Unicode UTF-16 Encoded Character Data"},
01845            \textcolor{stringliteral}{"Unicode UTF-32 Encoded Character Data"},\textcolor{stringliteral}{""},\textcolor{stringliteral}{"String"},\textcolor{stringliteral}{"Cell Array"},
01846            \textcolor{stringliteral}{"Structure"}\};
01847         printf(\textcolor{stringliteral}{" Data Type: %s\(\backslash\)n"}, data\_type\_desc[matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type}]);
01848     \}
01849 
01850     \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40acb467c7749c80902b798134c729bb521}{MAT\_C\_STRUCT} == matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
01851         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **fields = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01852         \textcolor{keywordtype}{int} nfields = matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a93fc447484f455eddf9334f2e9e411c2}{num\_fields};
01853         if ( nmemb*nfields > 0 ) \{
01854             printf(\textcolor{stringliteral}{"Fields[%"} SIZE\_T\_FMTSTR \textcolor{stringliteral}{"] \{\(\backslash\)n"}, nfields*nmemb);
01855             \textcolor{keywordflow}{for} ( i = 0; i < nfields*nmemb; i++ ) \{
01856                 \textcolor{keywordflow}{if} ( NULL == fields[i] ) \{
01857                     printf(\textcolor{stringliteral}{"      Name: %s\(\backslash\)n      Rank: %d\(\backslash\)n"},
01858                            matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i%nfields],0);
01859                 \} \textcolor{keywordflow}{else} \{
01860                     \hyperlink{group___m_a_t_ga9100c145e338b84b55d5d0795d5d390a}{Mat\_VarPrint}(fields[i],printdata);
01861                 \}
01862             \}
01863             printf(\textcolor{stringliteral}{"\}\(\backslash\)n"});
01864         \} \textcolor{keywordflow}{else} \{
01865             printf(\textcolor{stringliteral}{"Fields[%d] \{\(\backslash\)n"}, nfields);
01866             \textcolor{keywordflow}{for} ( i = 0; i < nfields; i++ )
01867                 printf(\textcolor{stringliteral}{"      Name: %s\(\backslash\)n      Rank: %d\(\backslash\)n"},
01868                        matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_a7574d000bfc98ad4860ae6590b8d4985}{fieldnames}[i],0);
01869             printf(\textcolor{stringliteral}{"\}\(\backslash\)n"});
01870         \}
01871         \textcolor{keywordflow}{return};
01872     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data} == NULL || matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size} < 1 ) \{
01873         \textcolor{keywordflow}{if} ( printdata )
01874             printf(\textcolor{stringliteral}{"\{\(\backslash\)n\}\(\backslash\)n"});
01875         \textcolor{keywordflow}{return};
01876     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2f7abb47a1c51e248bd4e5e03cc81b08}{MAT\_C\_CELL} == matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
01877         \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **cells = (\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} **)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01878         \textcolor{keywordtype}{int} ncells = matvar->\hyperlink{group___m_a_t_abf1c844540503be2df9bb3db93cfe307}{nbytes} / matvar->\hyperlink{group___m_a_t_a9ad1c82e2b568da617e12dc73a26e1f9}{data\_size};
01879         printf(\textcolor{stringliteral}{"\{\(\backslash\)n"});
01880         \textcolor{keywordflow}{for} ( i = 0; i < ncells; i++ )
01881             \hyperlink{group___m_a_t_ga9100c145e338b84b55d5d0795d5d390a}{Mat\_VarPrint}(cells[i],printdata);
01882         printf(\textcolor{stringliteral}{"\}\(\backslash\)n"});
01883         \textcolor{keywordflow}{return};
01884     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !printdata ) \{
01885         \textcolor{keywordflow}{return};
01886     \}
01887 
01888     printf(\textcolor{stringliteral}{"\{\(\backslash\)n"});
01889 
01890     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} > 2 ) \{
01891         printf(\textcolor{stringliteral}{"I can't print more than 2 dimensions\(\backslash\)n"});
01892     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} == 1 && NULL != matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} && matvar->
      \hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0] > 15 ) \{
01893         printf(\textcolor{stringliteral}{"I won't print more than 15 elements in a vector\(\backslash\)n"});
01894     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} == 2 && NULL != matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims} ) \{
01895         \textcolor{keywordflow}{switch}( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
01896             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
01897             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
01898 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_INT64\_T}
01899             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
01900 \textcolor{preprocessor}{#endif}
01901 \textcolor{preprocessor}{#ifdef HAVE\_MAT\_UINT64\_T}
01902             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
01903 \textcolor{preprocessor}{#endif}
01904             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
01905             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
01906             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
01907             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
01908             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
01909             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
01910             \{
01911                 \textcolor{keywordtype}{size\_t} stride = \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type});
01912                 \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01913                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01914                     \textcolor{keywordtype}{char} *rp = (\textcolor{keywordtype}{char}*)complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re};
01915                     \textcolor{keywordtype}{char} *ip = (\textcolor{keywordtype}{char}*)complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im};
01916                     for ( i = 0; i < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0] && i < 15; i++ ) \{
01917                         \textcolor{keywordflow}{for} ( j = 0; j < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[1] && j < 15; j++ ) \{
01918                             \textcolor{keywordtype}{size\_t} idx = matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0]*j+i;
01919                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},rp+idx*stride);
01920                             printf(\textcolor{stringliteral}{" + "});
01921                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},ip+idx*stride);
01922                             printf(\textcolor{stringliteral}{"i "});
01923                         \}
01924                         \textcolor{keywordflow}{if} ( j < matvar->dims[1] )
01925                             printf(\textcolor{stringliteral}{"..."});
01926                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01927                     \}
01928                     \textcolor{keywordflow}{if} ( i < matvar->dims[0] )
01929                         printf(\textcolor{stringliteral}{".\(\backslash\)n.\(\backslash\)n.\(\backslash\)n"});
01930                \} \textcolor{keywordflow}{else} \{
01931                    \textcolor{keywordtype}{char} *data = (\textcolor{keywordtype}{char}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01932                    for ( i = 0; i < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0] && i < 15; i++ ) \{
01933                         \textcolor{keywordflow}{for} ( j = 0; j < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[1] && j < 15; j++ ) \{
01934                             \textcolor{keywordtype}{size\_t} idx = matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0]*j+i;
01935                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},
01936                                             data+idx*stride);
01937                             printf(\textcolor{stringliteral}{" "});
01938                         \}
01939                         \textcolor{keywordflow}{if} ( j < matvar->dims[1] )
01940                             printf(\textcolor{stringliteral}{"..."});
01941                         printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01942                     \}
01943                     \textcolor{keywordflow}{if} ( i < matvar->dims[0] )
01944                         printf(\textcolor{stringliteral}{".\(\backslash\)n.\(\backslash\)n.\(\backslash\)n"});
01945                 \}
01946                 \textcolor{keywordflow}{break};
01947             \}
01948             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aacdec5834df0861130b393697646119c}{MAT\_C\_CHAR}:
01949             \{
01950                 \textcolor{keywordtype}{char} *data = (\textcolor{keywordtype}{char}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01951                 for ( i = 0; i < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0]; i++ ) \{
01952                     \textcolor{keywordflow}{for} ( j = 0; j < matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[1]; j++ )
01953                         printf(\textcolor{stringliteral}{"%c"},data[j*matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0]+i]);
01954                     printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01955                 \}
01956                 \textcolor{keywordflow}{break};
01957             \}
01958             \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a0d5655b7e6178a2242cb3bb56ff4c8d2}{MAT\_C\_SPARSE}:
01959             \{
01960                 \hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t} *sparse;
01961                 \textcolor{keywordtype}{size\_t} stride = \hyperlink{group__mat__util_gab6774aabdc124c540c1e7686d0804940}{Mat\_SizeOf}(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type});
01962 \textcolor{preprocessor}{#if !defined(EXTENDED\_SPARSE)}
01963                 \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggacf7b3b879282b7ab3a51190e49bf3453a31e721ecf7e188196f83c32838288797}{MAT\_T\_DOUBLE} != matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type} )
01964                     \textcolor{keywordflow}{break};
01965 \textcolor{preprocessor}{#endif}
01966                 sparse = (\hyperlink{group___m_a_t_structmat__sparse__t}{mat\_sparse\_t}*)matvar->\hyperlink{group___m_a_t_a5672978efa230bbdecdf38ede781f7fa}{data};
01967                 if ( matvar->\hyperlink{group___m_a_t_aeb03b3a69f108dc05470b00443a43739}{isComplex} ) \{
01968                     \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t} *complex\_data = (
      \hyperlink{group___m_a_t_structmat__complex__split__t}{mat\_complex\_split\_t}*)sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01969                     \textcolor{keywordtype}{char} *re = (\textcolor{keywordtype}{char}*)complex\_data->\hyperlink{group___m_a_t_a484a93607508adac2bce53a0252e0325}{Re};
01970                     \textcolor{keywordtype}{char} *im = (\textcolor{keywordtype}{char}*)complex\_data->\hyperlink{group___m_a_t_a7182d10b0d3598415887376065440946}{Im};
01971                     for ( i = 0; i < sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc}-1; i++ ) \{
01972                         \textcolor{keywordflow}{for} ( j = sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}[i];
01973                               j < sparse->jc[i+1] && j < sparse->ndata; j++ ) \{
01974                             printf(\textcolor{stringliteral}{"    (%d,%d)  "},sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}[j]+1,i+1);
01975                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},re+j*stride);
01976                             printf(\textcolor{stringliteral}{" + "});
01977                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},im+j*stride);
01978                             printf(\textcolor{stringliteral}{"i\(\backslash\)n"});
01979                         \}
01980                     \}
01981                 \} \textcolor{keywordflow}{else} \{
01982                     \textcolor{keywordtype}{char} *data = (\textcolor{keywordtype}{char}*)sparse->\hyperlink{group___m_a_t_ae2c648cb9eac4ce47f26cddb44246152}{data};
01983                     for ( i = 0; i < sparse->\hyperlink{group___m_a_t_a482d8e4b40aa975f0c1daf146ebe08a4}{njc}-1; i++ ) \{
01984                         \textcolor{keywordflow}{for} ( j = sparse->\hyperlink{group___m_a_t_ad1e74cdc4f7eff1e47a670297c01da4b}{jc}[i];
01985                               j < sparse->jc[i+1] && j < sparse->ndata; j++ ) \{
01986                             printf(\textcolor{stringliteral}{"    (%d,%d)  "},sparse->\hyperlink{group___m_a_t_a8d4c863d704edddec5cbfa15b2d719c8}{ir}[j]+1,i+1);
01987                             Mat\_PrintNumber(matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},data+j*stride);
01988                             printf(\textcolor{stringliteral}{"\(\backslash\)n"});
01989                         \}
01990                     \}
01991                 \}
01992                 \textcolor{keywordflow}{break};
01993             \} \textcolor{comment}{/* case MAT\_C\_SPARSE: */}
01994             \textcolor{keywordflow}{default}:
01995                 \textcolor{keywordflow}{break};
01996         \} \textcolor{comment}{/* switch( matvar->class\_type ) */}
01997     \}
01998 
01999     printf(\textcolor{stringliteral}{"\}\(\backslash\)n"});
02000 
02001     \textcolor{keywordflow}{return};
02002 \}
02003 
02017 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02018}\hyperlink{group___m_a_t_ga1845000f4fc6252ec5ff11c4b9f0759f}{02018} \hyperlink{group___m_a_t_ga1845000f4fc6252ec5ff11c4b9f0759f}{Mat\_VarReadData}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar,\textcolor{keywordtype}{void} *data,
02019       \textcolor{keywordtype}{int} *start,\textcolor{keywordtype}{int} *stride,\textcolor{keywordtype}{int} *edge)
02020 \{
02021     \textcolor{keywordtype}{int} err = 0;
02022 
02023     \textcolor{keywordflow}{switch} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
02024         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
02025         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
02026         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
02027         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
02028         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
02029         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
02030         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
02031         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
02032         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
02033         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
02034             \textcolor{keywordflow}{break};
02035         \textcolor{keywordflow}{default}:
02036             \textcolor{keywordflow}{return} -1;
02037     \}
02038 
02039     \textcolor{keywordflow}{switch} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
02040         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5}:
02041             err = \hyperlink{mat5_8c_af8a259573b7b3a89555c5a9bc1860e19}{ReadData5}(mat,matvar,data,start,stride,edge);
02042             \textcolor{keywordflow}{break};
02043         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73}:
02044 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
02045             err = Mat\_VarReadData73(mat,matvar,data,start,stride,edge);
02046 \textcolor{preprocessor}{#else}
02047             err = 1;
02048 \textcolor{preprocessor}{#endif}
02049             \textcolor{keywordflow}{break};
02050         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4}:
02051             err = \hyperlink{mat4_8c_a6c3186af92bf92da475cd4142c325ba5}{ReadData4}(mat,matvar,data,start,stride,edge);
02052             \textcolor{keywordflow}{break};
02053         \textcolor{keywordflow}{default}:
02054             err = 2;
02055             \textcolor{keywordflow}{break};
02056     \}
02057 
02058     \textcolor{keywordflow}{return} err;
02059 \}
02060 
02069 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02070}\hyperlink{group___m_a_t_gaa8060d7c8e5da0aa9ee5f96e5f1eb30a}{02070} \hyperlink{group___m_a_t_gaa8060d7c8e5da0aa9ee5f96e5f1eb30a}{Mat\_VarReadDataAll}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar)
02071 \{
02072     \textcolor{keywordtype}{int} err = 0;
02073 
02074     \textcolor{keywordflow}{if} ( (mat == NULL) || (matvar == NULL) )
02075         err = 1;
02076     \textcolor{keywordflow}{else}
02077         ReadData(mat,matvar);
02078 
02079     \textcolor{keywordflow}{return} err;
02080 \}
02081 
02095 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02096}\hyperlink{group___m_a_t_gaad61c8449a2106afa697280ff0ee9dd8}{02096} \hyperlink{group___m_a_t_gaad61c8449a2106afa697280ff0ee9dd8}{Mat\_VarReadDataLinear}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar,\textcolor{keywordtype}{void} *data,\textcolor{keywordtype}{int} start,
02097     \textcolor{keywordtype}{int} stride,\textcolor{keywordtype}{int} edge)
02098 \{
02099     \textcolor{keywordtype}{int} err = 0;
02100 
02101     \textcolor{keywordflow}{switch} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
02102         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
02103         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
02104         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
02105         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
02106         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
02107         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
02108         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
02109         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
02110         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
02111         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
02112             \textcolor{keywordflow}{break};
02113         \textcolor{keywordflow}{default}:
02114             \textcolor{keywordflow}{return} -1;
02115     \}
02116 
02117     \textcolor{keywordflow}{switch} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
02118         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5}:
02119             err = \hyperlink{group___m_a_t_ga9c81a102772919ad4841c37e4907e712}{Mat\_VarReadDataLinear5}(mat,matvar,data,start,stride,edge);
02120             \textcolor{keywordflow}{break};
02121         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73}:
02122 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
02123             err = Mat\_VarReadDataLinear73(mat,matvar,data,start,stride,edge);
02124 \textcolor{preprocessor}{#else}
02125             err = 1;
02126 \textcolor{preprocessor}{#endif}
02127             \textcolor{keywordflow}{break};
02128         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4}:
02129             err = \hyperlink{group___m_a_t_gab9f3d6b362bfa1fa92ed2afb8281cff4}{Mat\_VarReadDataLinear4}(mat,matvar,data,start,stride,edge);
02130             \textcolor{keywordflow}{break};
02131         \textcolor{keywordflow}{default}:
02132             err = 2;
02133             \textcolor{keywordflow}{break};
02134     \}
02135 
02136     \textcolor{keywordflow}{return} err;
02137 \}
02138 
02149 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l02150}\hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{02150} \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}( \hyperlink{struct__mat__t}{mat\_t} *mat )
02151 \{
02152     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar;
02153     \textcolor{keywordflow}{if} ( mat == NULL )
02154         \textcolor{keywordflow}{return} NULL;
02155 
02156     \textcolor{keywordflow}{switch} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
02157         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5}:
02158             matvar = \hyperlink{mat5_8c_a5defc934cf088b13347e50ea7f276ea3}{Mat\_VarReadNextInfo5}(mat);
02159             \textcolor{keywordflow}{break};
02160         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73}:
02161 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
02162             matvar = Mat\_VarReadNextInfo73(mat);
02163 \textcolor{preprocessor}{#else}
02164             matvar = NULL;
02165 \textcolor{preprocessor}{#endif}
02166             \textcolor{keywordflow}{break};
02167         \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4}:
02168             matvar = \hyperlink{mat4_8c_a494a64be8f002874f2048687561f65d3}{Mat\_VarReadNextInfo4}(mat);
02169             \textcolor{keywordflow}{break};
02170         \textcolor{keywordflow}{default}:
02171             matvar = NULL;
02172             \textcolor{keywordflow}{break};
02173     \}
02174 
02175     \textcolor{keywordflow}{return} matvar;
02176 \}
02177 
02189 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l02190}\hyperlink{group___m_a_t_ga46da2e45ed96d3f1a6ec643757f2b086}{02190} \hyperlink{group___m_a_t_ga46da2e45ed96d3f1a6ec643757f2b086}{Mat\_VarReadInfo}( \hyperlink{struct__mat__t}{mat\_t} *mat, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name )
02191 \{
02192     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar = NULL;
02193 
02194     \textcolor{keywordflow}{if} ( (mat == NULL) || (name == NULL) )
02195         \textcolor{keywordflow}{return} NULL;
02196 
02197     \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
02198         \textcolor{keywordtype}{size\_t} fpos = mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index};
02199         mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = 0;
02200         \textcolor{keywordflow}{while} ( NULL == matvar && mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} ) \{
02201             matvar = \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}(mat);
02202             \textcolor{keywordflow}{if} ( matvar != NULL ) \{
02203                 \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} == NULL || 0 != strcmp(matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name},name) ) \{
02204                     \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
02205                     matvar = NULL;
02206                 \}
02207             \} \textcolor{keywordflow}{else} \{
02208                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"An error occurred in reading the MAT file"});
02209                 \textcolor{keywordflow}{break};
02210             \}
02211         \}
02212         mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = fpos;
02213     \} \textcolor{keywordflow}{else} \{
02214         \textcolor{keywordtype}{long} fpos = ftell((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
02215         \textcolor{keywordflow}{if} ( fpos != -1L ) \{
02216             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},mat->\hyperlink{struct__mat__t_a0f87794a6113bd568fe591953e20ddf3}{bof},SEEK\_SET);
02217             \textcolor{keywordflow}{do} \{
02218                 matvar = \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}(mat);
02219                 \textcolor{keywordflow}{if} ( matvar != NULL ) \{
02220                     \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} == NULL || 0 != strcmp(matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name},name) ) \{
02221                         \hyperlink{group___m_a_t_ga1d14716f7450530fd1c9d02413787f0e}{Mat\_VarFree}(matvar);
02222                         matvar = NULL;
02223                     \}
02224                 \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( !feof((FILE *)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) ) \{
02225                     \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"An error occurred in reading the MAT file"});
02226                     \textcolor{keywordflow}{break};
02227                 \}
02228             \} \textcolor{keywordflow}{while} ( NULL == matvar && !feof((FILE *)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) );
02229             (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},fpos,SEEK\_SET);
02230         \} \textcolor{keywordflow}{else} \{
02231             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't determine file position"});
02232         \}
02233     \}
02234 
02235     \textcolor{keywordflow}{return} matvar;
02236 \}
02237 
02247 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l02248}\hyperlink{group___m_a_t_ga3505f63029763eaa73d5a19f1115eb42}{02248} \hyperlink{group___m_a_t_ga3505f63029763eaa73d5a19f1115eb42}{Mat\_VarRead}( \hyperlink{struct__mat__t}{mat\_t} *mat, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *name )
02249 \{
02250     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar = NULL;
02251 
02252     \textcolor{keywordflow}{if} ( (mat == NULL) || (name == NULL) )
02253         \textcolor{keywordflow}{return} NULL;
02254 
02255     \textcolor{keywordflow}{if} ( \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} != mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} ) \{
02256         \textcolor{keywordtype}{long} fpos = ftell((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
02257         \textcolor{keywordflow}{if} ( fpos == -1L ) \{
02258             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't determine file position"});
02259             \textcolor{keywordflow}{return} NULL;
02260         \}
02261         matvar = \hyperlink{group___m_a_t_ga46da2e45ed96d3f1a6ec643757f2b086}{Mat\_VarReadInfo}(mat,name);
02262         \textcolor{keywordflow}{if} ( matvar )
02263             ReadData(mat,matvar);
02264         (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},fpos,SEEK\_SET);
02265     \} \textcolor{keywordflow}{else} \{
02266         \textcolor{keywordtype}{size\_t} fpos = mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index};
02267         mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = 0;
02268         matvar = \hyperlink{group___m_a_t_ga46da2e45ed96d3f1a6ec643757f2b086}{Mat\_VarReadInfo}(mat,name);
02269         \textcolor{keywordflow}{if} ( matvar )
02270             ReadData(mat,matvar);
02271         mat->\hyperlink{struct__mat__t_a0163a12f9735356723bb604992639d9e}{next\_index} = fpos;
02272     \}
02273 
02274     \textcolor{keywordflow}{return} matvar;
02275 \}
02276 
02285 \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *
\Hypertarget{mat_8c_source_l02286}\hyperlink{group___m_a_t_ga7c321d6aafd93916ba6c5655ad78e9ca}{02286} \hyperlink{group___m_a_t_ga7c321d6aafd93916ba6c5655ad78e9ca}{Mat\_VarReadNext}( \hyperlink{struct__mat__t}{mat\_t} *mat )
02287 \{
02288     \textcolor{keywordtype}{long} fpos = 0;
02289     \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar = NULL;
02290 
02291     \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} != \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
02292         \textcolor{keywordflow}{if} ( feof((FILE *)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp}) )
02293             \textcolor{keywordflow}{return} NULL;
02294         \textcolor{comment}{/* Read position so we can reset the file position if an error occurs */}
02295         fpos = ftell((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp});
02296         \textcolor{keywordflow}{if} ( fpos == -1L ) \{
02297             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't determine file position"});
02298             \textcolor{keywordflow}{return} NULL;
02299         \}
02300     \}
02301     matvar = \hyperlink{group___m_a_t_ga72dd99330507b17177e22f9ed3bea5e6}{Mat\_VarReadNextInfo}(mat);
02302     \textcolor{keywordflow}{if} ( matvar ) \{
02303         ReadData(mat,matvar);
02304     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} != \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
02305         (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},fpos,SEEK\_SET);
02306     \}
02307 
02308     \textcolor{keywordflow}{return} matvar;
02309 \}
02310 
02320 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02321}\hyperlink{group___m_a_t_ga1ae164415dfd98cdf48ad07033b6e0bb}{02321} \hyperlink{group___m_a_t_ga1ae164415dfd98cdf48ad07033b6e0bb}{Mat\_VarWriteInfo}(\hyperlink{struct__mat__t}{mat\_t} *mat, \hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar )
02322 \{
02323     \textcolor{keywordtype}{int} err = 0;
02324 
02325     \textcolor{keywordflow}{if} ( mat == NULL || matvar == NULL || mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp} == NULL )
02326         \textcolor{keywordflow}{return} -1;
02327     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5} )
02328         \hyperlink{mat5_8c_a80e4ba45ec110d05657f8f39ffd9ee27}{WriteInfo5}(mat,matvar);
02329     \textcolor{keywordflow}{else}
02330         err = 1;
02331 
02332     \textcolor{keywordflow}{return} err;
02333 \}
02334 
02348 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02349}\hyperlink{group___m_a_t_ga43179b930fb30c025a153a55a083a98a}{02349} \hyperlink{group___m_a_t_ga43179b930fb30c025a153a55a083a98a}{Mat\_VarWriteData}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar,\textcolor{keywordtype}{void} *data,
02350       \textcolor{keywordtype}{int} *start,\textcolor{keywordtype}{int} *stride,\textcolor{keywordtype}{int} *edge)
02351 \{
02352     \textcolor{keywordtype}{int} err = 0, k, N = 1;
02353 
02354     \textcolor{keywordflow}{if} ( mat == NULL || matvar == NULL )
02355         \textcolor{keywordflow}{return} -1;
02356 
02357     \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal} )
02358         (void)fseek((FILE*)mat->\hyperlink{struct__mat__t_a85f562e407ca9ad4d2a6e14f839432b7}{fp},matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->\hyperlink{structmatvar__internal_afd3bfaab126a160bd6855563e1ea0a7e}{datapos}+8,SEEK\_SET);
02359 
02360     \textcolor{keywordflow}{if} ( data == NULL ) \{
02361         err = -1;
02362     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( start == NULL && stride == NULL && edge == NULL ) \{
02363         \textcolor{keywordflow}{for} ( k = 0; k < matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank}; k++ )
02364             N *= matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[k];
02365         if ( matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression} == \hyperlink{group___m_a_t_gga768c318af97bd2567758ecb001ceb7f4a2280b97631ff5dd24dec55261dc587b6}{MAT\_COMPRESSION\_NONE} )
02366             \hyperlink{mat5_8c_a1bec2ccf2a3b48706edd32e63744d364}{WriteData}(mat,data,N,matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type});
02367 \textcolor{preprocessor}{#if 0}
02368         \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_aeef0466048621cb2c959ba7f6c774d06}{compression} == \hyperlink{group___m_a_t_gga768c318af97bd2567758ecb001ceb7f4a5181d2f71eab0f12f05ba65d4f13fb53}{MAT\_COMPRESSION\_ZLIB} ) \{
02369             WriteCompressedData(mat,matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z,data,N,matvar->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type});
02370             (void)deflateEnd(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z);
02371             free(matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z);
02372             matvar->\hyperlink{group___m_a_t_a6e97e3ed9f40c49322c18561c2a94e92}{internal}->z = NULL;
02373         \}
02374 \textcolor{preprocessor}{#endif}
02375     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( start == NULL || stride == NULL || edge == NULL ) \{
02376         err = 1;
02377     \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( matvar->\hyperlink{group___m_a_t_a84ba70c96ded13cc555fa75b768d9921}{rank} == 2 ) \{
02378         \textcolor{keywordflow}{if} ( stride[0]*(edge[0]-1)+start[0]+1 > matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[0] ) \{
02379             err = 1;
02380         \} \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( stride[1]*(edge[1]-1)+start[1]+1 > matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims}[1] ) \{
02381             err = 1;
02382         \} \textcolor{keywordflow}{else} \{
02383             \textcolor{keywordflow}{switch} ( matvar->\hyperlink{group___m_a_t_aff13035bf3265dd7d9425e5d40c839d4}{class\_type} ) \{
02384                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a5d70e0862e5bdb7bd86bf7ba5948f307}{MAT\_C\_DOUBLE}:
02385                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a2825631e26a961cbe0f79db50a39cea2}{MAT\_C\_SINGLE}:
02386                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a1ea83bcde49b35477494412973f82409}{MAT\_C\_INT64}:
02387                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a86470e25c3763d9a24623f04326195dd}{MAT\_C\_UINT64}:
02388                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40adb44fc39694e3152ae5e69470a2fefe8}{MAT\_C\_INT32}:
02389                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a9a17a7edd45b19ef68197db81b27e816}{MAT\_C\_UINT32}:
02390                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a40370e9de516c5036a67a5865c071006}{MAT\_C\_INT16}:
02391                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a8bede21dbf6c1edc0bbccc1481bccae7}{MAT\_C\_UINT16}:
02392                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a984ff310f9e906100fcff95f704f43c5}{MAT\_C\_INT8}:
02393                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40a81270f8093cb4808e992c1d29d84d4e3}{MAT\_C\_UINT8}:
02394                     \hyperlink{mat5_8c_a04eba34668a0de871c4f245702f802f7}{WriteDataSlab2}(mat,data,matvar->\hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},matvar->
      \hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims},
02395                                    start,stride,edge);
02396                     \textcolor{keywordflow}{break};
02397                 \textcolor{keywordflow}{case} \hyperlink{group___m_a_t_ggad4d60ae7b709fc81bfd744fb4c857c40aacdec5834df0861130b393697646119c}{MAT\_C\_CHAR}:
02398                     \hyperlink{mat5_8c_a5afeaabef5e10f73a5805ce6de4acc8b}{WriteCharDataSlab2}(mat,data,matvar->
      \hyperlink{group___m_a_t_ab6aafe9bd77f0f077852593dec438144}{data\_type},matvar->\hyperlink{group___m_a_t_a8e01234e1c862ce3472bb37f5a09b92c}{dims},
02399                                    start,stride,edge);
02400                     \textcolor{keywordflow}{break};
02401                 \textcolor{keywordflow}{default}:
02402                     \textcolor{keywordflow}{break};
02403             \}
02404         \}
02405     \}
02406 
02407     \textcolor{keywordflow}{return} err;
02408 \}
02409 
02422 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02423}\hyperlink{group___m_a_t_ga4bd3eba12df415d8226e27c457fbbb0b}{02423} \hyperlink{group___m_a_t_ga4bd3eba12df415d8226e27c457fbbb0b}{Mat\_VarWrite}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar,\textcolor{keyword}{enum} 
      \hyperlink{group___m_a_t_ga768c318af97bd2567758ecb001ceb7f4}{matio\_compression} compress)
02424 \{
02425     \textcolor{keywordtype}{int} err;
02426 
02427     \textcolor{keywordflow}{if} ( NULL == mat || NULL == matvar )
02428         \textcolor{keywordflow}{return} -1;
02429 
02430     \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
02431         \textcolor{keywordtype}{size\_t} n = 0;
02432         (void)\hyperlink{group___m_a_t_ga7c0d94860d782366ab93d9b6b068eaea}{Mat\_GetDir}(mat, &n);
02433     \}
02434 
02435     \{
02436         \textcolor{comment}{/* Error if MAT variable already exists in MAT file */}
02437         \textcolor{keywordtype}{size\_t} i;
02438         \textcolor{keywordflow}{for} ( i = 0; i < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}; i++ ) \{
02439             \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i] &&
02440                 0 == strcmp(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i], matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name}) ) \{
02441                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Variable %s already exists."}, matvar->
      \hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
02442                 \textcolor{keywordflow}{return} 1;
02443             \}
02444         \}
02445     \}
02446 
02447     \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a31ade1f6989411dc0299007e2c7d33b2}{MAT\_FT\_MAT5} )
02448         err = \hyperlink{mat5_8c_a4d546a62c4b429d9b94fe873015e6a24}{Mat\_VarWrite5}(mat,matvar,compress);
02449     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} )
02450 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
02451         err = Mat\_VarWrite73(mat,matvar,compress);
02452 \textcolor{preprocessor}{#else}
02453         err = 1;
02454 \textcolor{preprocessor}{#endif}
02455     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a858b4f5da65548219b1c3ad47aa478d3}{MAT\_FT\_MAT4} )
02456         err = \hyperlink{mat4_8c_aa19d44f9375c3f316de3c288642b42c3}{Mat\_VarWrite4}(mat,matvar);
02457     \textcolor{keywordflow}{else}
02458         err = 2;
02459 
02460     \textcolor{keywordflow}{if} ( err == 0 ) \{
02461         \textcolor{comment}{/* Update directory */}
02462         \textcolor{keywordtype}{char} **dir;
02463         \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
02464             dir = malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*));
02465         \} \textcolor{keywordflow}{else} \{
02466             dir = realloc(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir},
02467             (mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} + 1)*(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*)));
02468         \}
02469         \textcolor{keywordflow}{if} ( NULL != dir ) \{
02470             mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = dir;
02471             \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} ) \{
02472                 mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}++] =
02473                     \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"}, matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
02474             \} \textcolor{keywordflow}{else} \{
02475                 mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}++] = NULL;
02476             \}
02477         \} \textcolor{keywordflow}{else} \{
02478             err = 3;
02479             \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the directory"});
02480         \}
02481     \}
02482 
02483     \textcolor{keywordflow}{return} err;
02484 \}
02485 
02500 \textcolor{keywordtype}{int}
\Hypertarget{mat_8c_source_l02501}\hyperlink{group___m_a_t_ga9402f3f2fbec82fdb66bf1479c689727}{02501} \hyperlink{group___m_a_t_ga9402f3f2fbec82fdb66bf1479c689727}{Mat\_VarWriteAppend}(\hyperlink{struct__mat__t}{mat\_t} *mat,\hyperlink{group___m_a_t_structmatvar__t}{matvar\_t} *matvar,\textcolor{keyword}{enum} 
      \hyperlink{group___m_a_t_ga768c318af97bd2567758ecb001ceb7f4}{matio\_compression} compress,\textcolor{keywordtype}{int} dim)
02502 \{
02503     \textcolor{keywordtype}{int} err, append = 0;
02504 
02505     \textcolor{keywordflow}{if} ( NULL == mat || NULL == matvar )
02506         \textcolor{keywordflow}{return} -1;
02507 
02508     \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
02509         \textcolor{keywordtype}{size\_t} n = 0;
02510         (void)\hyperlink{group___m_a_t_ga7c0d94860d782366ab93d9b6b068eaea}{Mat\_GetDir}(mat, &n);
02511     \}
02512 
02513     \{
02514         \textcolor{comment}{/* Check if MAT variable already exists in MAT file */}
02515         \textcolor{keywordtype}{size\_t} i;
02516         \textcolor{keywordflow}{for} ( i = 0; i < mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}; i++ ) \{
02517             \textcolor{keywordflow}{if} ( NULL != mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i] &&
02518                 0 == strcmp(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[i], matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name}) ) \{
02519                 append = 1;
02520                 \textcolor{keywordflow}{break};
02521             \}
02522         \}
02523     \}
02524 
02525     \textcolor{keywordflow}{if} ( mat->\hyperlink{struct__mat__t_a729c2bc0afc97485057a5af425635b1a}{version} == \hyperlink{group___m_a_t_ggad03442b8378999189d510e3745c702b7a765c5d1d5038947646260dc82483517e}{MAT\_FT\_MAT73} ) \{
02526 \textcolor{preprocessor}{#if defined(MAT73) && MAT73}
02527         err = Mat\_VarWriteAppend73(mat,matvar,compress,dim);
02528         \textcolor{keywordflow}{if} ( err == 0 && 0 == append ) \{
02529             \textcolor{comment}{/* Update directory */}
02530             \textcolor{keywordtype}{char} **dir;
02531             \textcolor{keywordflow}{if} ( NULL == mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} ) \{
02532                 dir = malloc(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*));
02533             \} \textcolor{keywordflow}{else} \{
02534                 dir = realloc(mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir},
02535                 (mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets} + 1)*(\textcolor{keyword}{sizeof}(\textcolor{keywordtype}{char}*)));
02536             \}
02537             \textcolor{keywordflow}{if} ( NULL != dir ) \{
02538                 mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir} = dir;
02539                 \textcolor{keywordflow}{if} ( NULL != matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name} ) \{
02540                     mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}++] =
02541                         \hyperlink{group__mat__util_ga291b08f933c75fb70e3736b669896ebd}{strdup\_printf}(\textcolor{stringliteral}{"%s"}, matvar->\hyperlink{group___m_a_t_a5d4b55b041e3b4fb50c04337f05ad909}{name});
02542                 \} \textcolor{keywordflow}{else} \{
02543                     mat->\hyperlink{struct__mat__t_a1bc6c604459d0787801d5e53d365684c}{dir}[mat->\hyperlink{struct__mat__t_af37d0ba323e65edb27ecd5a2f766a3a4}{num\_datasets}++] = NULL;
02544                 \}
02545             \} \textcolor{keywordflow}{else} \{
02546                 err = 3;
02547                 \hyperlink{group__mat__util_gaf51f2bfbb5580f575e4dd79757e2b80c}{Mat\_Critical}(\textcolor{stringliteral}{"Couldn't allocate memory for the directory"});
02548             \}
02549         \}
02550 \textcolor{preprocessor}{#else}
02551         err = 1;
02552 \textcolor{preprocessor}{#endif}
02553     \}
02554     \textcolor{keywordflow}{else}
02555         err = 2;
02556 
02557     \textcolor{keywordflow}{return} err;
02558 \}
\end{DoxyCode}
