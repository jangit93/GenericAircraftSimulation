\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/\+Eigen/src/\+Polynomials/\+Polynomial\+Solver.h}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source}\index{Polynomial\+Solver.\+h@{Polynomial\+Solver.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2010 Manuel Yguel <manuel.yguel@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_POLYNOMIAL\_SOLVER\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_POLYNOMIAL\_SOLVER\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00014 
00028 \textcolor{keyword}{template}< \textcolor{keyword}{typename} \_Scalar, \textcolor{keywordtype}{int} \_Deg >
00029 \textcolor{keyword}{class }PolynomialSolverBase
00030 \{
00031   \textcolor{keyword}{public}:
00032     EIGEN\_MAKE\_ALIGNED\_OPERATOR\_NEW\_IF\_VECTORIZABLE\_FIXED\_SIZE(\_Scalar,\_Deg==
      \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : \_Deg)
00033 
00034     \textcolor{keyword}{typedef} \_Scalar                             Scalar;
00035     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} NumTraits<Scalar>::Real    RealScalar;
00036     \textcolor{keyword}{typedef} std::complex<RealScalar>            RootType;
00037     \textcolor{keyword}{typedef} Matrix<RootType,\_Deg,1>             RootsType;
00038 
00039     \textcolor{keyword}{typedef} DenseIndex Index;
00040 
00041   \textcolor{keyword}{protected}:
00042     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
00043     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} setPolynomial( \textcolor{keyword}{const} OtherPolynomial& poly )\{
00044       m\_roots.\hyperlink{class_eigen_1_1_plain_object_base_a99d9054ee2d5a40c6e00ded0265e9cea}{resize}(poly.size()-1); \}
00045 
00046   \textcolor{keyword}{public}:
00047     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
00048     \textcolor{keyword}{inline} PolynomialSolverBase( \textcolor{keyword}{const} OtherPolynomial& poly )\{
00049       setPolynomial( poly() ); \}
00050 
00051     \textcolor{keyword}{inline} PolynomialSolverBase()\{\}
00052 
00053   \textcolor{keyword}{public}:
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00055}\hyperlink{class_eigen_1_1_polynomial_solver_base_a07bcd5339be5eacdf7e566d07d81bedb}{00055}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RootsType& \hyperlink{class_eigen_1_1_polynomial_solver_base_a07bcd5339be5eacdf7e566d07d81bedb}{roots}()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_roots; \}
00056 
00057   \textcolor{keyword}{public}:
00068     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Stl\_back\_insertion\_sequence>
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00069}\hyperlink{class_eigen_1_1_polynomial_solver_base_a4ea3b29499623832a0ad7b2b3ab05597}{00069}     \textcolor{keyword}{inline} \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_polynomial_solver_base_a4ea3b29499623832a0ad7b2b3ab05597}{realRoots}( Stl\_back\_insertion\_sequence& bi\_seq,
00070         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00071 \textcolor{keyword}{    }\{
00072       \textcolor{keyword}{using} std::abs;
00073       bi\_seq.clear();
00074       \textcolor{keywordflow}{for}(Index i=0; i<m\_roots.size(); ++i )
00075       \{
00076         \textcolor{keywordflow}{if}( abs( m\_roots[i].imag() ) < absImaginaryThreshold )\{
00077           bi\_seq.push\_back( m\_roots[i].real() ); \}
00078       \}
00079     \}
00080 
00081   \textcolor{keyword}{protected}:
00082     \textcolor{keyword}{template}<\textcolor{keyword}{typename} squaredNormBinaryPredicate>
00083     \textcolor{keyword}{inline} \textcolor{keyword}{const} RootType& selectComplexRoot\_withRespectToNorm( squaredNormBinaryPredicate& pred )\textcolor{keyword}{ const}
00084 \textcolor{keyword}{    }\{
00085       Index res=0;
00086       RealScalar norm2 = numext::abs2( m\_roots[0] );
00087       \textcolor{keywordflow}{for}( Index i=1; i<m\_roots.size(); ++i )
00088       \{
00089         \textcolor{keyword}{const} RealScalar currNorm2 = numext::abs2( m\_roots[i] );
00090         \textcolor{keywordflow}{if}( pred( currNorm2, norm2 ) )\{
00091           res=i; norm2=currNorm2; \}
00092       \}
00093       \textcolor{keywordflow}{return} m\_roots[res];
00094     \}
00095 
00096   \textcolor{keyword}{public}:
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00100}\hyperlink{class_eigen_1_1_polynomial_solver_base_a0327769cc88877a79c7c838f03d78384}{00100}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RootType& \hyperlink{class_eigen_1_1_polynomial_solver_base_a0327769cc88877a79c7c838f03d78384}{greatestRoot}()\textcolor{keyword}{ const}
00101 \textcolor{keyword}{    }\{
00102       std::greater<Scalar> greater;
00103       \textcolor{keywordflow}{return} selectComplexRoot\_withRespectToNorm( greater );
00104     \}
00105 
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00109}\hyperlink{class_eigen_1_1_polynomial_solver_base_a64389d0acf586c772fb3d1db47a3f7ef}{00109}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RootType& \hyperlink{class_eigen_1_1_polynomial_solver_base_a64389d0acf586c772fb3d1db47a3f7ef}{smallestRoot}()\textcolor{keyword}{ const}
00110 \textcolor{keyword}{    }\{
00111       std::less<Scalar> less;
00112       \textcolor{keywordflow}{return} selectComplexRoot\_withRespectToNorm( less );
00113     \}
00114 
00115   \textcolor{keyword}{protected}:
00116     \textcolor{keyword}{template}<\textcolor{keyword}{typename} squaredRealPartBinaryPredicate>
00117     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& selectRealRoot\_withRespectToAbsRealPart(
00118         squaredRealPartBinaryPredicate& pred,
00119         \textcolor{keywordtype}{bool}& hasArealRoot,
00120         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00121 \textcolor{keyword}{    }\{
00122       \textcolor{keyword}{using} std::abs;
00123       hasArealRoot = \textcolor{keyword}{false};
00124       Index res=0;
00125       RealScalar abs2(0);
00126 
00127       \textcolor{keywordflow}{for}( Index i=0; i<m\_roots.size(); ++i )
00128       \{
00129         \textcolor{keywordflow}{if}( abs( m\_roots[i].imag() ) < absImaginaryThreshold )
00130         \{
00131           \textcolor{keywordflow}{if}( !hasArealRoot )
00132           \{
00133             hasArealRoot = \textcolor{keyword}{true};
00134             res = i;
00135             abs2 = m\_roots[i].real() * m\_roots[i].real();
00136           \}
00137           \textcolor{keywordflow}{else}
00138           \{
00139             \textcolor{keyword}{const} RealScalar currAbs2 = m\_roots[i].real() * m\_roots[i].real();
00140             \textcolor{keywordflow}{if}( pred( currAbs2, abs2 ) )
00141             \{
00142               abs2 = currAbs2;
00143               res = i;
00144             \}
00145           \}
00146         \}
00147         \textcolor{keywordflow}{else}
00148         \{
00149           \textcolor{keywordflow}{if}( abs( m\_roots[i].imag() ) < abs( m\_roots[res].imag() ) )\{
00150             res = i; \}
00151         \}
00152       \}
00153       \textcolor{keywordflow}{return} numext::real\_ref(m\_roots[res]);
00154     \}
00155 
00156 
00157     \textcolor{keyword}{template}<\textcolor{keyword}{typename} RealPartBinaryPredicate>
00158     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& selectRealRoot\_withRespectToRealPart(
00159         RealPartBinaryPredicate& pred,
00160         \textcolor{keywordtype}{bool}& hasArealRoot,
00161         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00162 \textcolor{keyword}{    }\{
00163       \textcolor{keyword}{using} std::abs;
00164       hasArealRoot = \textcolor{keyword}{false};
00165       Index res=0;
00166       RealScalar val(0);
00167 
00168       \textcolor{keywordflow}{for}( Index i=0; i<m\_roots.size(); ++i )
00169       \{
00170         \textcolor{keywordflow}{if}( abs( m\_roots[i].imag() ) < absImaginaryThreshold )
00171         \{
00172           \textcolor{keywordflow}{if}( !hasArealRoot )
00173           \{
00174             hasArealRoot = \textcolor{keyword}{true};
00175             res = i;
00176             val = m\_roots[i].real();
00177           \}
00178           \textcolor{keywordflow}{else}
00179           \{
00180             \textcolor{keyword}{const} RealScalar curr = m\_roots[i].real();
00181             \textcolor{keywordflow}{if}( pred( curr, val ) )
00182             \{
00183               val = curr;
00184               res = i;
00185             \}
00186           \}
00187         \}
00188         \textcolor{keywordflow}{else}
00189         \{
00190           \textcolor{keywordflow}{if}( abs( m\_roots[i].imag() ) < abs( m\_roots[res].imag() ) )\{
00191             res = i; \}
00192         \}
00193       \}
00194       \textcolor{keywordflow}{return} numext::real\_ref(m\_roots[res]);
00195     \}
00196 
00197   \textcolor{keyword}{public}:
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00212}\hyperlink{class_eigen_1_1_polynomial_solver_base_aa2f003d9662af8c776f1a1c12a9d4210}{00212}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& \hyperlink{class_eigen_1_1_polynomial_solver_base_aa2f003d9662af8c776f1a1c12a9d4210}{absGreatestRealRoot}(
00213         \textcolor{keywordtype}{bool}& hasArealRoot,
00214         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00215 \textcolor{keyword}{    }\{
00216       std::greater<Scalar> greater;
00217       \textcolor{keywordflow}{return} selectRealRoot\_withRespectToAbsRealPart( greater, hasArealRoot, absImaginaryThreshold );
00218     \}
00219 
00220 
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00235}\hyperlink{class_eigen_1_1_polynomial_solver_base_a9316eeb24076bcd4f60ea4d7f3e549eb}{00235}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& \hyperlink{class_eigen_1_1_polynomial_solver_base_a9316eeb24076bcd4f60ea4d7f3e549eb}{absSmallestRealRoot}(
00236         \textcolor{keywordtype}{bool}& hasArealRoot,
00237         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00238 \textcolor{keyword}{    }\{
00239       std::less<Scalar> less;
00240       \textcolor{keywordflow}{return} selectRealRoot\_withRespectToAbsRealPart( less, hasArealRoot, absImaginaryThreshold );
00241     \}
00242 
00243 
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00258}\hyperlink{class_eigen_1_1_polynomial_solver_base_a5094b7ccc49918b7c7ae9e2a8c49d4bd}{00258}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& \hyperlink{class_eigen_1_1_polynomial_solver_base_a5094b7ccc49918b7c7ae9e2a8c49d4bd}{greatestRealRoot}(
00259         \textcolor{keywordtype}{bool}& hasArealRoot,
00260         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00261 \textcolor{keyword}{    }\{
00262       std::greater<Scalar> greater;
00263       \textcolor{keywordflow}{return} selectRealRoot\_withRespectToRealPart( greater, hasArealRoot, absImaginaryThreshold );
00264     \}
00265 
00266 
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00281}\hyperlink{class_eigen_1_1_polynomial_solver_base_a24b054cdf82a8e9409bea47c3c05c756}{00281}     \textcolor{keyword}{inline} \textcolor{keyword}{const} RealScalar& \hyperlink{class_eigen_1_1_polynomial_solver_base_a24b054cdf82a8e9409bea47c3c05c756}{smallestRealRoot}(
00282         \textcolor{keywordtype}{bool}& hasArealRoot,
00283         \textcolor{keyword}{const} RealScalar& absImaginaryThreshold = 
      \hyperlink{group___core___module_struct_eigen_1_1_num_traits}{NumTraits<Scalar>::dummy\_precision}() )\textcolor{keyword}{ const}
00284 \textcolor{keyword}{    }\{
00285       std::less<Scalar> less;
00286       \textcolor{keywordflow}{return} selectRealRoot\_withRespectToRealPart( less, hasArealRoot, absImaginaryThreshold );
00287     \}
00288 
00289   \textcolor{keyword}{protected}:
00290     RootsType               m\_roots;
00291 \};
00292 
00293 \textcolor{preprocessor}{#define EIGEN\_POLYNOMIAL\_SOLVER\_BASE\_INHERITED\_TYPES( BASE )  \(\backslash\)}
00294 \textcolor{preprocessor}{  typedef typename BASE::Scalar                 Scalar;       \(\backslash\)}
00295 \textcolor{preprocessor}{  typedef typename BASE::RealScalar             RealScalar;   \(\backslash\)}
00296 \textcolor{preprocessor}{  typedef typename BASE::RootType               RootType;     \(\backslash\)}
00297 \textcolor{preprocessor}{  typedef typename BASE::RootsType              RootsType;}
00298 
00299 
00300 
00330 \textcolor{keyword}{template}< \textcolor{keyword}{typename} \_Scalar, \textcolor{keywordtype}{int} \_Deg >
00331 \textcolor{keyword}{class }\hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver} : \textcolor{keyword}{public} \hyperlink{class_eigen_1_1_polynomial_solver_base}{PolynomialSolverBase}<\_Scalar,\_Deg>
00332 \{
00333   \textcolor{keyword}{public}:
00334     EIGEN\_MAKE\_ALIGNED\_OPERATOR\_NEW\_IF\_VECTORIZABLE\_FIXED\_SIZE(\_Scalar,\_Deg==
      \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : \_Deg)
00335 
00336     \textcolor{keyword}{typedef} \hyperlink{class_eigen_1_1_polynomial_solver_base}{PolynomialSolverBase<\_Scalar,\_Deg>}    PS\_Base;
00337     EIGEN\_POLYNOMIAL\_SOLVER\_BASE\_INHERITED\_TYPES( PS\_Base )
00338 
00339     \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,\_Deg,\_Deg>}                 CompanionMatrixType;
00340     \textcolor{keyword}{typedef} \hyperlink{group___eigenvalues___module}{EigenSolver<CompanionMatrixType>}         EigenSolverType;
00341 
00342   \textcolor{keyword}{public}:
00344     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00345}\hyperlink{class_eigen_1_1_polynomial_solver_ac3ceae48528f3798d44c15a025cb03b8}{00345}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_polynomial_solver_ac3ceae48528f3798d44c15a025cb03b8}{compute}( \textcolor{keyword}{const} OtherPolynomial& poly )
00346     \{
00347       eigen\_assert( Scalar(0) != poly[poly.size()-1] );
00348       eigen\_assert( poly.size() > 1 );
00349       \textcolor{keywordflow}{if}(poly.size() >  2 )
00350       \{
00351         \hyperlink{class_eigen_1_1internal_1_1companion}{internal::companion<Scalar,\_Deg>} companion( poly );
00352         companion.\hyperlink{class_eigen_1_1internal_1_1companion_a7362d054f04f6d554fb6c8a279287000}{balance}();
00353         m\_eigenSolver.compute( companion.denseMatrix() );
00354         m\_roots = m\_eigenSolver.eigenvalues();
00355       \}
00356       \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(poly.size () == 2)
00357       \{
00358         m\_roots.resize(1);
00359         m\_roots[0] = -poly[0]/poly[1];
00360       \}
00361     \}
00362 
00363   \textcolor{keyword}{public}:
00364     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
00365     \textcolor{keyword}{inline} \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver}( \textcolor{keyword}{const} OtherPolynomial& poly )\{
00366       compute( poly ); \}
00367 
00368     \textcolor{keyword}{inline} \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver}()\{\}
00369 
00370   \textcolor{keyword}{protected}:
00371     \textcolor{keyword}{using}                   PS\_Base::m\_roots;
00372     EigenSolverType         m\_eigenSolver;
00373 \};
00374 
00375 
00376 \textcolor{keyword}{template}< \textcolor{keyword}{typename} \_Scalar >
00377 \textcolor{keyword}{class }\hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver}<\_Scalar,1> : \textcolor{keyword}{public} \hyperlink{class_eigen_1_1_polynomial_solver_base}{PolynomialSolverBase}<\_Scalar
      ,1>
00378 \{
00379   \textcolor{keyword}{public}:
00380     \textcolor{keyword}{typedef} \hyperlink{class_eigen_1_1_polynomial_solver_base}{PolynomialSolverBase<\_Scalar,1>}    
      \hyperlink{class_eigen_1_1_polynomial_solver_base}{PS\_Base};
00381     EIGEN\_POLYNOMIAL\_SOLVER\_BASE\_INHERITED\_TYPES( PS\_Base )
00382 
00383   \textcolor{keyword}{public}:
00385     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
\Hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2_eigen_2src_2_polynomials_2_polynomial_solver_8h_source_l00386}\hyperlink{class_eigen_1_1_polynomial_solver_3_01___scalar_00_011_01_4_ac10c32870abba4461d681506eaa63e18}{00386}     \textcolor{keywordtype}{void} \hyperlink{class_eigen_1_1_polynomial_solver_3_01___scalar_00_011_01_4_ac10c32870abba4461d681506eaa63e18}{compute}( \textcolor{keyword}{const} OtherPolynomial& poly )
00387     \{
00388       eigen\_assert( poly.size() == 2 );
00389       eigen\_assert( Scalar(0) != poly[1] );
00390       m\_roots[0] = -poly[0]/poly[1];
00391     \}
00392 
00393   \textcolor{keyword}{public}:
00394     \textcolor{keyword}{template}< \textcolor{keyword}{typename} OtherPolynomial >
00395     \textcolor{keyword}{inline} \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver}( \textcolor{keyword}{const} OtherPolynomial& poly )\{
00396       compute( poly ); \}
00397 
00398     \textcolor{keyword}{inline} \hyperlink{class_eigen_1_1_polynomial_solver}{PolynomialSolver}()\{\}
00399 
00400   \textcolor{keyword}{protected}:
00401     \textcolor{keyword}{using}                   PS\_Base::m\_roots;
00402 \};
00403 
00404 \} \textcolor{comment}{// end namespace Eigen}
00405 
00406 \textcolor{preprocessor}{#endif // EIGEN\_POLYNOMIAL\_SOLVER\_H}
\end{DoxyCode}
