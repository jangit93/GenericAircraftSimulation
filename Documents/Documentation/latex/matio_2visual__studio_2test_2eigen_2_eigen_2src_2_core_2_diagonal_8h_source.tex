\hypertarget{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_core_2_diagonal_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/\+Eigen/src/\+Core/\+Diagonal.h}
\label{matio_2visual__studio_2test_2eigen_2_eigen_2src_2_core_2_diagonal_8h_source}\index{Diagonal.\+h@{Diagonal.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2007-2009 Benoit Jacob <jacob.benoit.1@gmail.com>}
00005 \textcolor{comment}{// Copyright (C) 2009-2010 Gael Guennebaud <gael.guennebaud@inria.fr>}
00006 \textcolor{comment}{//}
00007 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00008 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00009 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00010 
00011 \textcolor{preprocessor}{#ifndef EIGEN\_DIAGONAL\_H}
00012 \textcolor{preprocessor}{#define EIGEN\_DIAGONAL\_H}
00013 
00014 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00015 
00035 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00036 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} DiagIndex>
00037 \textcolor{keyword}{struct }traits<Diagonal<MatrixType,DiagIndex> >
00038  : traits<MatrixType>
00039 \{
00040   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} ref\_selector<MatrixType>::type MatrixTypeNested;
00041   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} remove\_reference<MatrixTypeNested>::type \_MatrixTypeNested;
00042   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} MatrixType::StorageKind StorageKind;
00043   \textcolor{keyword}{enum} \{
00044     RowsAtCompileTime = (int(DiagIndex) == \hyperlink{namespace_eigen_a73c597189a4a99127175e8167c456fff}{DynamicIndex} || int(MatrixType::SizeAtCompileTime) =
      = \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}) ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}
00045                       : (EIGEN\_PLAIN\_ENUM\_MIN(MatrixType::RowsAtCompileTime - EIGEN\_PLAIN\_ENUM\_MAX(-
      DiagIndex, 0),
00046                                               MatrixType::ColsAtCompileTime - EIGEN\_PLAIN\_ENUM\_MAX( 
      DiagIndex, 0))),
00047     ColsAtCompileTime = 1,
00048     MaxRowsAtCompileTime = \textcolor{keywordtype}{int}(MatrixType::MaxSizeAtCompileTime) == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? 
      \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic}
00049                          : DiagIndex == \hyperlink{namespace_eigen_a73c597189a4a99127175e8167c456fff}{DynamicIndex} ? EIGEN\_SIZE\_MIN\_PREFER\_FIXED(
      MatrixType::MaxRowsAtCompileTime,
00050                                                                               
      MatrixType::MaxColsAtCompileTime)
00051                          : (EIGEN\_PLAIN\_ENUM\_MIN(MatrixType::MaxRowsAtCompileTime - EIGEN\_PLAIN\_ENUM\_MAX(-
      DiagIndex, 0),
00052                                                  MatrixType::MaxColsAtCompileTime - EIGEN\_PLAIN\_ENUM\_MAX( 
      DiagIndex, 0))),
00053     MaxColsAtCompileTime = 1,
00054     MaskLvalueBit = is\_lvalue<MatrixType>::value ? \hyperlink{group__flags_gae2c323957f20dfdc6cb8f44428eaec1a}{LvalueBit} : 0,
00055     Flags = (unsigned int)\_MatrixTypeNested::Flags & (\hyperlink{group__flags_gae4f56c2a60bbe4bd2e44c5b19cbe8762}{RowMajorBit} | MaskLvalueBit | 
      \hyperlink{group__flags_gabf1e9d0516a933445a4c307ad8f14915}{DirectAccessBit}) & ~\hyperlink{group__flags_gae4f56c2a60bbe4bd2e44c5b19cbe8762}{RowMajorBit}, \textcolor{comment}{// FIXME DirectAccessBit should not be handled
       by expressions}
00056     MatrixTypeOuterStride = outer\_stride\_at\_compile\_time<MatrixType>::ret,
00057     InnerStrideAtCompileTime = MatrixTypeOuterStride == \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} ? \hyperlink{namespace_eigen_ad81fa7195215a0ce30017dfac309f0b2}{Dynamic} : 
      MatrixTypeOuterStride+1,
00058     OuterStrideAtCompileTime = 0
00059   \};
00060 \};
00061 \}
00062 
00063 \textcolor{keyword}{template}<\textcolor{keyword}{typename} MatrixType, \textcolor{keywordtype}{int} \_DiagIndex> \textcolor{keyword}{class }Diagonal
00064    : \textcolor{keyword}{public} internal::dense\_xpr\_base< Diagonal<MatrixType,\_DiagIndex> >::type
00065 \{
00066   \textcolor{keyword}{public}:
00067 
00068     \textcolor{keyword}{enum} \{ DiagIndex = \_DiagIndex \};
00069     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::dense\_xpr\_base<Diagonal>::type Base;
00070     EIGEN\_DENSE\_PUBLIC\_INTERFACE(Diagonal)
00071 
00072     EIGEN\_DEVICE\_FUNC
00073     \textcolor{keyword}{explicit} \textcolor{keyword}{inline} Diagonal(MatrixType& matrix, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} a\_index = DiagIndex) : m\_matrix(matrix), 
      m\_index(a\_index) \{\}
00074 
00075     EIGEN\_INHERIT\_ASSIGNMENT\_OPERATORS(Diagonal)
00076 
00077     EIGEN\_DEVICE\_FUNC
00078     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows()\textcolor{keyword}{ const}
00079 \textcolor{keyword}{    }\{
00080       \textcolor{keywordflow}{return} m\_index.value()<0 ? numext::mini<Index>(m\_matrix.cols(),m\_matrix.rows()+m\_index.value())
00081                                : numext::mini<Index>(m\_matrix.rows(),m\_matrix.cols()-m\_index.value());
00082     \}
00083 
00084     EIGEN\_DEVICE\_FUNC
00085     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} 1; \}
00086 
00087     EIGEN\_DEVICE\_FUNC
00088     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} innerStride()\textcolor{keyword}{ const}
00089 \textcolor{keyword}{    }\{
00090       \textcolor{keywordflow}{return} m\_matrix.outerStride() + 1;
00091     \}
00092 
00093     EIGEN\_DEVICE\_FUNC
00094     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} outerStride()\textcolor{keyword}{ const}
00095 \textcolor{keyword}{    }\{
00096       \textcolor{keywordflow}{return} 0;
00097     \}
00098 
00099     \textcolor{keyword}{typedef} \textcolor{keyword}{typename} internal::conditional<
00100                        internal::is\_lvalue<MatrixType>::value,
00101                        Scalar,
00102                        \textcolor{keyword}{const} Scalar
00103                      >::type ScalarWithConstIfNotLvalue;
00104 
00105     EIGEN\_DEVICE\_FUNC
00106     \textcolor{keyword}{inline} ScalarWithConstIfNotLvalue* data() \{ \textcolor{keywordflow}{return} &(m\_matrix.coeffRef(rowOffset(), colOffset())); \}
00107     EIGEN\_DEVICE\_FUNC
00108     \textcolor{keyword}{inline} \textcolor{keyword}{const} Scalar* data()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} &(m\_matrix.coeffRef(rowOffset(), colOffset())); \}
00109 
00110     EIGEN\_DEVICE\_FUNC
00111     \textcolor{keyword}{inline} Scalar& coeffRef(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index})
00112     \{
00113       EIGEN\_STATIC\_ASSERT\_LVALUE(MatrixType)
00114       \textcolor{keywordflow}{return} m\_matrix.coeffRef(row+rowOffset(), row+colOffset());
00115     \}
00116 
00117     EIGEN\_DEVICE\_FUNC
00118     \textcolor{keyword}{inline} \textcolor{keyword}{const} Scalar& coeffRef(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index})\textcolor{keyword}{ const}
00119 \textcolor{keyword}{    }\{
00120       \textcolor{keywordflow}{return} m\_matrix.coeffRef(row+rowOffset(), row+colOffset());
00121     \}
00122 
00123     EIGEN\_DEVICE\_FUNC
00124     \textcolor{keyword}{inline} CoeffReturnType coeff(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} row, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index})\textcolor{keyword}{ const}
00125 \textcolor{keyword}{    }\{
00126       \textcolor{keywordflow}{return} m\_matrix.coeff(row+rowOffset(), row+colOffset());
00127     \}
00128 
00129     EIGEN\_DEVICE\_FUNC
00130     \textcolor{keyword}{inline} Scalar& coeffRef(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} idx)
00131     \{
00132       EIGEN\_STATIC\_ASSERT\_LVALUE(MatrixType)
00133       \textcolor{keywordflow}{return} m\_matrix.coeffRef(idx+rowOffset(), idx+colOffset());
00134     \}
00135 
00136     EIGEN\_DEVICE\_FUNC
00137     \textcolor{keyword}{inline} \textcolor{keyword}{const} Scalar& coeffRef(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} idx)\textcolor{keyword}{ const}
00138 \textcolor{keyword}{    }\{
00139       \textcolor{keywordflow}{return} m\_matrix.coeffRef(idx+rowOffset(), idx+colOffset());
00140     \}
00141 
00142     EIGEN\_DEVICE\_FUNC
00143     \textcolor{keyword}{inline} CoeffReturnType coeff(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} idx)\textcolor{keyword}{ const}
00144 \textcolor{keyword}{    }\{
00145       \textcolor{keywordflow}{return} m\_matrix.coeff(idx+rowOffset(), idx+colOffset());
00146     \}
00147 
00148     EIGEN\_DEVICE\_FUNC
00149     \textcolor{keyword}{inline} \textcolor{keyword}{const} \textcolor{keyword}{typename} internal::remove\_all<typename MatrixType::Nested>::type& 
00150     nestedExpression()\textcolor{keyword}{ const }
00151 \textcolor{keyword}{    }\{
00152       \textcolor{keywordflow}{return} m\_matrix;
00153     \}
00154 
00155     EIGEN\_DEVICE\_FUNC
00156     \textcolor{keyword}{inline} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} index()\textcolor{keyword}{ const}
00157 \textcolor{keyword}{    }\{
00158       \textcolor{keywordflow}{return} m\_index.value();
00159     \}
00160 
00161   \textcolor{keyword}{protected}:
00162     \textcolor{keyword}{typename} internal::ref\_selector<MatrixType>::non\_const\_type m\_matrix;
00163     \textcolor{keyword}{const} internal::variable\_if\_dynamicindex<Index, DiagIndex> m\_index;
00164 
00165   \textcolor{keyword}{private}:
00166     \textcolor{comment}{// some compilers may fail to optimize std::max etc in case of compile-time constants...}
00167     EIGEN\_DEVICE\_FUNC
00168     EIGEN\_STRONG\_INLINE \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} absDiagIndex()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_index.value()>0 ? m\_index.value() : -
      m\_index.value(); \}
00169     EIGEN\_DEVICE\_FUNC
00170     EIGEN\_STRONG\_INLINE \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rowOffset()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_index.value()>0 ? 0 : -m\_index.value(); \}
00171     EIGEN\_DEVICE\_FUNC
00172     EIGEN\_STRONG\_INLINE \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} colOffset()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} m\_index.value()>0 ? m\_index.value() : 0; \}
00173     \textcolor{comment}{// trigger a compile-time error if someone try to call packet}
00174     \textcolor{keyword}{template}<\textcolor{keywordtype}{int} LoadMode> \textcolor{keyword}{typename} MatrixType::PacketReturnType packet(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}) \textcolor{keyword}{const};
00175     \textcolor{keyword}{template}<\textcolor{keywordtype}{int} LoadMode> \textcolor{keyword}{typename} MatrixType::PacketReturnType packet(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index}) \textcolor{keyword}{const};
00176 \};
00177 
00186 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00187 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::DiagonalReturnType
00188 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}()
00189 \{
00190   \textcolor{keywordflow}{return} DiagonalReturnType(derived());
00191 \}
00192 
00194 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00195 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::ConstDiagonalReturnType
00196 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}()\textcolor{keyword}{ const}
00197 \textcolor{keyword}{}\{
00198   \textcolor{keywordflow}{return} ConstDiagonalReturnType(derived());
00199 \}
00200 
00212 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00213 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::DiagonalDynamicIndexReturnType
00214 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} index)
00215 \{
00216   \textcolor{keywordflow}{return} DiagonalDynamicIndexReturnType(derived(), index);
00217 \}
00218 
00220 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00221 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::ConstDiagonalDynamicIndexReturnType
00222 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} index)\textcolor{keyword}{ const}
00223 \textcolor{keyword}{}\{
00224   \textcolor{keywordflow}{return} ConstDiagonalDynamicIndexReturnType(derived(), index);
00225 \}
00226 
00238 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00239 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} Index\_>
00240 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::template DiagonalIndexReturnType<Index\_>::Type
00241 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}()
00242 \{
00243   \textcolor{keywordflow}{return} \textcolor{keyword}{typename} DiagonalIndexReturnType<Index\_>::Type(derived());
00244 \}
00245 
00247 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
00248 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} Index\_>
00249 \textcolor{keyword}{inline} \textcolor{keyword}{typename} MatrixBase<Derived>::template ConstDiagonalIndexReturnType<Index\_>::Type
00250 \hyperlink{group___core___module_ab5768147536273eb2dbdfa389cfd26a3}{MatrixBase<Derived>::diagonal}()\textcolor{keyword}{ const}
00251 \textcolor{keyword}{}\{
00252   \textcolor{keywordflow}{return} \textcolor{keyword}{typename} ConstDiagonalIndexReturnType<Index\_>::Type(derived());
00253 \}
00254 
00255 \} \textcolor{comment}{// end namespace Eigen}
00256 
00257 \textcolor{preprocessor}{#endif // EIGEN\_DIAGONAL\_H}
\end{DoxyCode}
