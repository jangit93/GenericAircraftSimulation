\hypertarget{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source}{}\section{eigen/\+Eigen/src/\+Sparse\+Core/\+Sparse\+Solver\+Base.h}
\label{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source}\index{Sparse\+Solver\+Base.\+h@{Sparse\+Solver\+Base.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_SPARSESOLVERBASE\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_SPARSESOLVERBASE\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{ 
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00021 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} Rhs, \textcolor{keyword}{typename} Dest>
00022 \textcolor{keyword}{typename} enable\_if<Rhs::ColsAtCompileTime!=1 && Dest::ColsAtCompileTime!=1>::type
00023 solve\_sparse\_through\_dense\_panels(\textcolor{keyword}{const} Decomposition &dec, \textcolor{keyword}{const} Rhs& rhs, Dest &dest)
00024 \{
00025   EIGEN\_STATIC\_ASSERT((Dest::Flags&\hyperlink{group__flags_gae4f56c2a60bbe4bd2e44c5b19cbe8762}{RowMajorBit})==0,THIS\_METHOD\_IS\_ONLY\_FOR\_COLUMN\_MAJOR\_MATRICES
      );
00026   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Dest::Scalar DestScalar;
00027   \textcolor{comment}{// we process the sparse rhs per block of NbColsAtOnce columns temporarily stored into a dense matrix.}
00028   \textcolor{keyword}{static} \textcolor{keyword}{const} \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} NbColsAtOnce = 4;
00029   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rhsCols = rhs.cols();
00030   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = rhs.rows();
00031   \textcolor{comment}{// the temporary matrices do not need more columns than NbColsAtOnce:}
00032   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} tmpCols = (std::min)(rhsCols, NbColsAtOnce); 
00033   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<DestScalar,Dynamic,Dynamic>} tmp(size,tmpCols);
00034   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<DestScalar,Dynamic,Dynamic>} tmpX(size,tmpCols);
00035   \textcolor{keywordflow}{for}(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} k=0; k<rhsCols; k+=NbColsAtOnce)
00036   \{
00037     \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} actualCols = std::min<Index>(rhsCols-k, NbColsAtOnce);
00038     tmp.leftCols(actualCols) = rhs.middleCols(k,actualCols);
00039     tmpX.leftCols(actualCols) = dec.solve(tmp.leftCols(actualCols));
00040     dest.middleCols(k,actualCols) = tmpX.leftCols(actualCols).sparseView();
00041   \}
00042 \}
00043 
00044 \textcolor{comment}{// Overload for vector as rhs}
00045 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Decomposition, \textcolor{keyword}{typename} Rhs, \textcolor{keyword}{typename} Dest>
00046 \textcolor{keyword}{typename} enable\_if<Rhs::ColsAtCompileTime==1 || Dest::ColsAtCompileTime==1>::type
00047 solve\_sparse\_through\_dense\_panels(\textcolor{keyword}{const} Decomposition &dec, \textcolor{keyword}{const} Rhs& rhs, Dest &dest)
00048 \{
00049   \textcolor{keyword}{typedef} \textcolor{keyword}{typename} Dest::Scalar DestScalar;
00050   \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} size = rhs.rows();
00051   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<DestScalar,Dynamic,1>} rhs\_dense(rhs);
00052   \hyperlink{group___core___module_class_eigen_1_1_matrix}{Eigen::Matrix<DestScalar,Dynamic,1>} dest\_dense(size);
00053   dest\_dense = dec.solve(rhs\_dense);
00054   dest = dest\_dense.sparseView();
00055 \}
00056 
00057 \} \textcolor{comment}{// end namespace internal}
00058 
00066 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Derived>
\Hypertarget{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source_l00067}\hyperlink{group___sparse_core___module}{00067} \textcolor{keyword}{class }\hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_solver_base}{SparseSolverBase} : \hyperlink{class_eigen_1_1internal_1_1noncopyable}{internal::noncopyable}
00068 \{
00069   \textcolor{keyword}{public}:
00070 
\Hypertarget{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source_l00072}\hyperlink{group___sparse_core___module_aacd99fa17db475e74d3834767f392f33}{00072}     \hyperlink{group___sparse_core___module_aacd99fa17db475e74d3834767f392f33}{SparseSolverBase}()
00073       : m\_isInitialized(false)
00074     \{\}
00075 
00076     ~\hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_solver_base}{SparseSolverBase}()
00077     \{\}
00078 
00079     Derived& derived() \{ \textcolor{keywordflow}{return} *\textcolor{keyword}{static\_cast<}Derived*\textcolor{keyword}{>}(\textcolor{keyword}{this}); \}
00080     \textcolor{keyword}{const} Derived& derived()\textcolor{keyword}{ const }\{ \textcolor{keywordflow}{return} *\textcolor{keyword}{static\_cast<}\textcolor{keyword}{const }Derived*\textcolor{keyword}{>}(\textcolor{keyword}{this}); \}
00081     
00086     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs>
00087     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<Derived, Rhs>}
\Hypertarget{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source_l00088}\hyperlink{group___sparse_core___module_a4a66e9498b06e3ec4ec36f06b26d4e8f}{00088}     \hyperlink{group___sparse_core___module_a4a66e9498b06e3ec4ec36f06b26d4e8f}{solve}(\textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_matrix_base}{MatrixBase<Rhs>}& b)\textcolor{keyword}{ const}
00089 \textcolor{keyword}{    }\{
00090       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Solver is not initialized."});
00091       eigen\_assert(derived().rows()==b.rows() && \textcolor{stringliteral}{"solve(): invalid number of rows of the right hand side
       matrix b"});
00092       \textcolor{keywordflow}{return} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<Derived, Rhs>}(derived(), b.derived());
00093     \}
00094     
00099     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs>
00100     \textcolor{keyword}{inline} \textcolor{keyword}{const} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<Derived, Rhs>}
\Hypertarget{eigen_2_eigen_2src_2_sparse_core_2_sparse_solver_base_8h_source_l00101}\hyperlink{group___sparse_core___module_a3a8d97173b6e2630f484589b3471cfc7}{00101}     \hyperlink{group___sparse_core___module_a3a8d97173b6e2630f484589b3471cfc7}{solve}(\textcolor{keyword}{const} \hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_matrix_base}{SparseMatrixBase<Rhs>}& b)\textcolor{keyword}{ const}
00102 \textcolor{keyword}{    }\{
00103       eigen\_assert(m\_isInitialized && \textcolor{stringliteral}{"Solver is not initialized."});
00104       eigen\_assert(derived().rows()==b.\hyperlink{group___sparse_core___module_a1944e9fa9ce7937bfc3a87b2cb94371f}{rows}() && \textcolor{stringliteral}{"solve(): invalid number of rows of the right hand
       side matrix b"});
00105       \textcolor{keywordflow}{return} \hyperlink{group___core___module_class_eigen_1_1_solve}{Solve<Derived, Rhs>}(derived(), b.derived());
00106     \}
00107     
00108 \textcolor{preprocessor}{    #ifndef EIGEN\_PARSED\_BY\_DOXYGEN}
00109 
00110     \textcolor{keyword}{template}<\textcolor{keyword}{typename} Rhs,\textcolor{keyword}{typename} Dest>
00111     \textcolor{keywordtype}{void} \_solve\_impl(\textcolor{keyword}{const} \hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_matrix_base}{SparseMatrixBase<Rhs>} &b, 
      \hyperlink{group___sparse_core___module_class_eigen_1_1_sparse_matrix_base}{SparseMatrixBase<Dest>} &dest)\textcolor{keyword}{ const}
00112 \textcolor{keyword}{    }\{
00113       internal::solve\_sparse\_through\_dense\_panels(derived(), b.derived(), dest.derived());
00114     \}
00115 \textcolor{preprocessor}{    #endif // EIGEN\_PARSED\_BY\_DOXYGEN}
00116 
00117   \textcolor{keyword}{protected}:
00118     
00119     \textcolor{keyword}{mutable} \textcolor{keywordtype}{bool} m\_isInitialized;
00120 \};
00121 
00122 \} \textcolor{comment}{// end namespace Eigen}
00123 
00124 \textcolor{preprocessor}{#endif // EIGEN\_SPARSESOLVERBASE\_H}
\end{DoxyCode}
