\hypertarget{matio_2visual__studio_2test_2eigen_2test_2product__mmtr_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/test/product\+\_\+mmtr.cpp}
\label{matio_2visual__studio_2test_2eigen_2test_2product__mmtr_8cpp_source}\index{product\+\_\+mmtr.\+cpp@{product\+\_\+mmtr.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2010-2017 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#define CHECK\_MMTR(DEST, TRI, OP) \{                   \(\backslash\)}
00013 \textcolor{preprocessor}{    ref3 = DEST;                                      \(\backslash\)}
00014 \textcolor{preprocessor}{    ref2 = ref1 = DEST;                               \(\backslash\)}
00015 \textcolor{preprocessor}{    DEST.template triangularView<TRI>() OP;           \(\backslash\)}
00016 \textcolor{preprocessor}{    ref1 OP;                                          \(\backslash\)}
00017 \textcolor{preprocessor}{    ref2.template triangularView<TRI>()               \(\backslash\)}
00018 \textcolor{preprocessor}{      = ref1.template triangularView<TRI>();          \(\backslash\)}
00019 \textcolor{preprocessor}{    VERIFY\_IS\_APPROX(DEST,ref2);                      \(\backslash\)}
00020 \textcolor{preprocessor}{    \(\backslash\)}
00021 \textcolor{preprocessor}{    DEST = ref3;                                      \(\backslash\)}
00022 \textcolor{preprocessor}{    ref3 = ref2;                                      \(\backslash\)}
00023 \textcolor{preprocessor}{    ref3.diagonal() = DEST.diagonal();                \(\backslash\)}
00024 \textcolor{preprocessor}{    DEST.template triangularView<TRI|ZeroDiag>() OP;  \(\backslash\)}
00025 \textcolor{preprocessor}{    VERIFY\_IS\_APPROX(DEST,ref3);                      \(\backslash\)}
00026 \textcolor{preprocessor}{  \}}
00027 
00028 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Scalar> \textcolor{keywordtype}{void} mmtr(\textcolor{keywordtype}{int} size)
00029 \{
00030   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,Dynamic,ColMajor>} MatrixColMaj;
00031   \textcolor{keyword}{typedef} \hyperlink{group___core___module_class_eigen_1_1_matrix}{Matrix<Scalar,Dynamic,Dynamic,RowMajor>} MatrixRowMaj;
00032 
00033   DenseIndex othersize = internal::random<DenseIndex>(1,200);
00034   
00035   MatrixColMaj matc = MatrixColMaj::Zero(size, size);
00036   MatrixRowMaj matr = MatrixRowMaj::Zero(size, size);
00037   MatrixColMaj ref1(size, size), ref2(size, size), ref3(size,size);
00038   
00039   MatrixColMaj soc(size,othersize); soc.setRandom();
00040   MatrixColMaj osc(othersize,size); osc.setRandom();
00041   MatrixRowMaj sor(size,othersize); sor.setRandom();
00042   MatrixRowMaj osr(othersize,size); osr.setRandom();
00043   MatrixColMaj sqc(size,size); sqc.setRandom();
00044   MatrixRowMaj sqr(size,size); sqr.setRandom();
00045   
00046   Scalar s = internal::random<Scalar>();
00047   
00048   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, = s*soc*sor.adjoint());
00049   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, = s*(soc*soc.adjoint()));
00050   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, = s*soc*soc.adjoint());
00051   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, = soc*(s*sor.adjoint()));
00052   
00053   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, += s*soc*soc.adjoint());
00054   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, += s*(soc*sor.transpose()));
00055   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, += s*sor*soc.adjoint());
00056   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, += soc*(s*soc.adjoint()));
00057   
00058   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, -= s*soc*soc.adjoint());
00059   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, -= s*(osc.transpose()*osc.conjugate()));
00060   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, -= s*soc*soc.adjoint());
00061   CHECK\_MMTR(matr, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, -= soc*(s*soc.adjoint()));
00062   
00063   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, -= s*sqr*sqc.template triangularView<Upper>());
00064   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, = s*sqc*sqr.template triangularView<Upper>());
00065   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, += s*sqr*sqc.template triangularView<Lower>());
00066   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, = s*sqc*sqc.template triangularView<Lower>());
00067   
00068   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, = (s*sqr).\textcolor{keyword}{template} triangularView<Upper>()*sqc);
00069   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, -= (s*sqc).\textcolor{keyword}{template} triangularView<Upper>()*sqc);
00070   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda891792b8ed394f7607ab16dd716f60e6}{Lower}, = (s*sqr).\textcolor{keyword}{template} triangularView<Lower>()*sqc);
00071   CHECK\_MMTR(matc, \hyperlink{group__enums_gga39e3366ff5554d731e7dc8bb642f83cda6bcb58be3b8b8ec84859ce0c5ac0aaec}{Upper}, += (s*sqc).\textcolor{keyword}{template} triangularView<Lower>()*sqc);
00072 
00073   \textcolor{comment}{// check aliasing}
00074   ref2 = ref1 = matc;
00075   ref1 = sqc.adjoint() * matc * sqc;
00076   ref2.template triangularView<Upper>() = ref1.template triangularView<Upper>();
00077   matc.template triangularView<Upper>() = sqc.adjoint() * matc * sqc;
00078   VERIFY\_IS\_APPROX(matc, ref2);
00079 
00080   ref2 = ref1 = matc;
00081   ref1 = sqc * matc * sqc.adjoint();
00082   ref2.template triangularView<Lower>() = ref1.template triangularView<Lower>();
00083   matc.template triangularView<Lower>() = sqc * matc * sqc.adjoint();
00084   VERIFY\_IS\_APPROX(matc, ref2);
00085 \}
00086 
00087 \textcolor{keywordtype}{void} test\_product\_mmtr()
00088 \{
00089   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} i = 0; i < g\_repeat ; i++)
00090   \{
00091     CALL\_SUBTEST\_1((mmtr<float>(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE))));
00092     CALL\_SUBTEST\_2((mmtr<double>(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE))));
00093     CALL\_SUBTEST\_3((mmtr<std::complex<float> >(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE/2))));
00094     CALL\_SUBTEST\_4((mmtr<std::complex<double> >(internal::random<int>(1,EIGEN\_TEST\_MAX\_SIZE/2))));
00095   \}
00096 \}
\end{DoxyCode}
