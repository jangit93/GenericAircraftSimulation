\hypertarget{matio_2visual__studio_2test_2eigen_2blas_2level2__impl_8h_source}{}\section{matio/visual\+\_\+studio/test/eigen/blas/level2\+\_\+impl.h}
\label{matio_2visual__studio_2test_2eigen_2blas_2level2__impl_8h_source}\index{level2\+\_\+impl.\+h@{level2\+\_\+impl.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2009-2010 Gael Guennebaud <gael.guennebaud@inria.fr>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "common.h"}
00011 
00012 \textcolor{keyword}{template}<\textcolor{keyword}{typename} Index, \textcolor{keyword}{typename} Scalar, \textcolor{keywordtype}{int} StorageOrder, \textcolor{keywordtype}{bool} ConjugateLhs, \textcolor{keywordtype}{bool} ConjugateRhs>
00013 \textcolor{keyword}{struct }\hyperlink{structgeneral__matrix__vector__product__wrapper}{general\_matrix\_vector\_product\_wrapper}
00014 \{
00015   \textcolor{keyword}{static} \textcolor{keywordtype}{void} run(\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rows, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} cols,\textcolor{keyword}{const} Scalar *lhs, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} lhsStride, \textcolor{keyword}{const} Scalar *
      rhs, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} rhsIncr, Scalar* res, \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} resIncr, Scalar alpha)
00016   \{
00017     \textcolor{keyword}{typedef} internal::const\_blas\_data\_mapper<Scalar,Index,StorageOrder> LhsMapper;
00018     \textcolor{keyword}{typedef} internal::const\_blas\_data\_mapper<Scalar,Index,RowMajor> RhsMapper;
00019     
00020     internal::general\_matrix\_vector\_product
00021         <\hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index},Scalar,LhsMapper,StorageOrder,ConjugateLhs,Scalar,RhsMapper,ConjugateRhs>::run(
00022         rows, cols, LhsMapper(lhs, lhsStride), RhsMapper(rhs, rhsIncr), res, resIncr, alpha);
00023   \}
00024 \};
00025 
00026 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(gemv)(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *opa, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *m, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *n, \textcolor{keyword}{const} RealScalar *palpha,
00027                           \textcolor{keyword}{const} RealScalar *pa, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *lda, \textcolor{keyword}{const} RealScalar *pb, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *incb, \textcolor{keyword}{
      const} RealScalar *pbeta, RealScalar *pc, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *incc)
00028 \{
00029   \textcolor{keyword}{typedef} void (*functype)(int, int, \textcolor{keyword}{const} Scalar *, int, \textcolor{keyword}{const} Scalar *, int , Scalar *, int, Scalar);
00030   \textcolor{keyword}{static} \textcolor{keyword}{const} functype \hyperlink{structfunc}{func}[4] = \{
00031     \textcolor{comment}{// array index: NOTR}
00032     (\hyperlink{structgeneral__matrix__vector__product__wrapper}{general\_matrix\_vector\_product\_wrapper<int,Scalar,ColMajor,false,false>::run}
      ),
00033     \textcolor{comment}{// array index: TR  }
00034     (\hyperlink{structgeneral__matrix__vector__product__wrapper}{general\_matrix\_vector\_product\_wrapper<int,Scalar,RowMajor,false,false>::run}
      ),
00035     \textcolor{comment}{// array index: ADJ }
00036     (\hyperlink{structgeneral__matrix__vector__product__wrapper}{general\_matrix\_vector\_product\_wrapper<int,Scalar,RowMajor,Conj ,false>::run}
      ),
00037     0
00038   \};
00039 
00040   \textcolor{keyword}{const} Scalar* a = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pa);
00041   \textcolor{keyword}{const} Scalar* b = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pb);
00042   Scalar* c = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pc);
00043   Scalar alpha  = *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(palpha);
00044   Scalar beta   = *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pbeta);
00045 
00046   \textcolor{comment}{// check arguments}
00047   \textcolor{keywordtype}{int} info = 0;
00048   \textcolor{keywordflow}{if}(OP(*opa)==INVALID)           info = 1;
00049   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*m<0)                   info = 2;
00050   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                   info = 3;
00051   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<std::max(1,*m))    info = 6;
00052   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incb==0)               info = 8;
00053   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incc==0)               info = 11;
00054   \textcolor{keywordflow}{if}(info)
00055     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"GEMV "},&info,6);
00056 
00057   \textcolor{keywordflow}{if}(*m==0 || *n==0 || (alpha==Scalar(0) && beta==Scalar(1)))
00058     \textcolor{keywordflow}{return} 0;
00059 
00060   \textcolor{keywordtype}{int} actual\_m = *m;
00061   \textcolor{keywordtype}{int} actual\_n = *n;
00062   \textcolor{keywordtype}{int} \hyperlink{structcode}{code} = OP(*opa);
00063   \textcolor{keywordflow}{if}(code!=NOTR)
00064     \hyperlink{endian_8c_a3ca5ecd34b04d6a243c054ac3a57f68d}{std::swap}(actual\_m,actual\_n);
00065 
00066   \textcolor{keyword}{const} Scalar* actual\_b = get\_compact\_vector(b,actual\_n,*incb);
00067   Scalar* actual\_c = get\_compact\_vector(c,actual\_m,*incc);
00068 
00069   \textcolor{keywordflow}{if}(beta!=Scalar(1))
00070   \{
00071     \textcolor{keywordflow}{if}(beta==Scalar(0)) make\_vector(actual\_c, actual\_m).setZero();
00072     \textcolor{keywordflow}{else}                make\_vector(actual\_c, actual\_m) *= beta;
00073   \}
00074 
00075   \textcolor{keywordflow}{if}(code>=4 || func[code]==0)
00076     \textcolor{keywordflow}{return} 0;
00077 
00078   func[code](actual\_m, actual\_n, a, *lda, actual\_b, 1, actual\_c, 1, alpha);
00079 
00080   \textcolor{keywordflow}{if}(actual\_b!=b) \textcolor{keyword}{delete}[] actual\_b;
00081   \textcolor{keywordflow}{if}(actual\_c!=c) \textcolor{keyword}{delete}[] copy\_back(actual\_c,c,actual\_m,*incc);
00082 
00083   \textcolor{keywordflow}{return} 1;
00084 \}
00085 
00086 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(trsv)(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *uplo, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *opa, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *diag, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *n, \textcolor{keyword}{const} 
      RealScalar *pa, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *lda, RealScalar *pb, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *incb)
00087 \{
00088   \textcolor{keyword}{typedef} void (*functype)(int, \textcolor{keyword}{const} Scalar *, int, Scalar *);
00089   \textcolor{keyword}{static} \textcolor{keyword}{const} functype func[16] = \{
00090     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (NUNIT << 3)}
00091     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       false,ColMajor>::run),
00092     \textcolor{comment}{// array index: TR    | (UP << 2) | (NUNIT << 3)}
00093     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       false,RowMajor>::run),
00094     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (NUNIT << 3)}
00095     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       Conj, RowMajor>::run),
00096     0,
00097     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (NUNIT << 3)}
00098     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       false,ColMajor>::run),
00099     \textcolor{comment}{// array index: TR    | (LO << 2) | (NUNIT << 3)}
00100     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       false,RowMajor>::run),
00101     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (NUNIT << 3)}
00102     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       Conj, RowMajor>::run),
00103     0,
00104     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (UNIT  << 3)}
00105     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,false,ColMajor>::run),
00106     \textcolor{comment}{// array index: TR    | (UP << 2) | (UNIT  << 3)}
00107     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,false,RowMajor>::run),
00108     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (UNIT  << 3)}
00109     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,Conj, RowMajor>::run),
00110     0,
00111     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (UNIT  << 3)}
00112     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,false,ColMajor>::run),
00113     \textcolor{comment}{// array index: TR    | (LO << 2) | (UNIT  << 3)}
00114     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,false,RowMajor>::run),
00115     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (UNIT  << 3)}
00116     (internal::triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,Conj, RowMajor>::run),
00117     0
00118   \};
00119 
00120   \textcolor{keyword}{const} Scalar* a = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pa);
00121   Scalar* b = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pb);
00122 
00123   \textcolor{keywordtype}{int} info = 0;
00124   \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                            info = 1;
00125   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*opa)==INVALID)                                          info = 2;
00126   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00127   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00128   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<std::max(1,*n))                                        info = 6;
00129   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incb==0)                                                   info = 8;
00130   \textcolor{keywordflow}{if}(info)
00131     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TRSV "},&info,6);
00132 
00133   Scalar* actual\_b = get\_compact\_vector(b,*n,*incb);
00134 
00135   \textcolor{keywordtype}{int} code = OP(*opa) | (UPLO(*uplo) << 2) | (DIAG(*diag) << 3);
00136   func[code](*n, a, *lda, actual\_b);
00137 
00138   \textcolor{keywordflow}{if}(actual\_b!=b) \textcolor{keyword}{delete}[] copy\_back(actual\_b,b,*n,*incb);
00139 
00140   \textcolor{keywordflow}{return} 0;
00141 \}
00142 
00143 
00144 
00145 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(trmv)(\textcolor{keyword}{const} \textcolor{keywordtype}{char} *uplo, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *opa, \textcolor{keyword}{const} \textcolor{keywordtype}{char} *diag, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *n, \textcolor{keyword}{const} 
      RealScalar *pa, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *lda, RealScalar *pb, \textcolor{keyword}{const} \textcolor{keywordtype}{int} *incb)
00146 \{
00147   \textcolor{keyword}{typedef} void (*functype)(int, int, \textcolor{keyword}{const} Scalar *, int, \textcolor{keyword}{const} Scalar *, int, Scalar *, int, \textcolor{keyword}{const} Scalar&
      );
00148   \textcolor{keyword}{static} \textcolor{keyword}{const} functype func[16] = \{
00149     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (NUNIT << 3)}
00150     (internal::triangular\_matrix\_vector\_product<int,Upper|0,       Scalar,false,Scalar,false,ColMajor>::run
      ),
00151     \textcolor{comment}{// array index: TR    | (UP << 2) | (NUNIT << 3)}
00152     (internal::triangular\_matrix\_vector\_product<int,Lower|0,       Scalar,false,Scalar,false,RowMajor>::run
      ),
00153     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (NUNIT << 3)}
00154     (internal::triangular\_matrix\_vector\_product<int,Lower|0,       Scalar,Conj, Scalar,false,RowMajor>::run
      ),
00155     0,
00156     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (NUNIT << 3)}
00157     (internal::triangular\_matrix\_vector\_product<int,Lower|0,       Scalar,false,Scalar,false,ColMajor>::run
      ),
00158     \textcolor{comment}{// array index: TR    | (LO << 2) | (NUNIT << 3)}
00159     (internal::triangular\_matrix\_vector\_product<int,Upper|0,       Scalar,false,Scalar,false,RowMajor>::run
      ),
00160     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (NUNIT << 3)}
00161     (internal::triangular\_matrix\_vector\_product<int,Upper|0,       Scalar,Conj, Scalar,false,RowMajor>::run
      ),
00162     0,
00163     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (UNIT  << 3)}
00164     (internal::triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,false,Scalar,false,ColMajor>::run
      ),
00165     \textcolor{comment}{// array index: TR    | (UP << 2) | (UNIT  << 3)}
00166     (internal::triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,false,Scalar,false,RowMajor>::run
      ),
00167     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (UNIT  << 3)}
00168     (internal::triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,Conj, Scalar,false,RowMajor>::run
      ),
00169     0,
00170     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (UNIT  << 3)}
00171     (internal::triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,false,Scalar,false,ColMajor>::run
      ),
00172     \textcolor{comment}{// array index: TR    | (LO << 2) | (UNIT  << 3)}
00173     (internal::triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,false,Scalar,false,RowMajor>::run
      ),
00174     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (UNIT  << 3)}
00175     (internal::triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,Conj, Scalar,false,RowMajor>::run
      ),
00176     0
00177   \};
00178 
00179   \textcolor{keyword}{const} Scalar* a = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pa);
00180   Scalar* b = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pb);
00181 
00182   \textcolor{keywordtype}{int} info = 0;
00183   \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                            info = 1;
00184   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*opa)==INVALID)                                          info = 2;
00185   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00186   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00187   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<std::max(1,*n))                                        info = 6;
00188   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incb==0)                                                   info = 8;
00189   \textcolor{keywordflow}{if}(info)
00190     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TRMV "},&info,6);
00191 
00192   \textcolor{keywordflow}{if}(*n==0)
00193     \textcolor{keywordflow}{return} 1;
00194 
00195   Scalar* actual\_b = get\_compact\_vector(b,*n,*incb);
00196   \hyperlink{group___core___module}{Matrix<Scalar,Dynamic,1>} res(*n);
00197   res.setZero();
00198 
00199   \textcolor{keywordtype}{int} code = OP(*opa) | (UPLO(*uplo) << 2) | (DIAG(*diag) << 3);
00200   \textcolor{keywordflow}{if}(code>=16 || func[code]==0)
00201     \textcolor{keywordflow}{return} 0;
00202 
00203   func[code](*n, *n, a, *lda, actual\_b, 1, res.data(), 1, Scalar(1));
00204 
00205   copy\_back(res.data(),b,*n,*incb);
00206   \textcolor{keywordflow}{if}(actual\_b!=b) \textcolor{keyword}{delete}[] actual\_b;
00207 
00208   \textcolor{keywordflow}{return} 1;
00209 \}
00210 
00218 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(gbmv)(\textcolor{keywordtype}{char} *trans, \textcolor{keywordtype}{int} *m, \textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{int} *kl, \textcolor{keywordtype}{int} *ku, RealScalar *palpha, RealScalar *pa
      , \textcolor{keywordtype}{int} *lda,
00219                           RealScalar *px, \textcolor{keywordtype}{int} *incx, RealScalar *pbeta, RealScalar *py, \textcolor{keywordtype}{int} *incy)
00220 \{
00221   \textcolor{keyword}{const} Scalar* a = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pa);
00222   \textcolor{keyword}{const} Scalar* x = \textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(px);
00223   Scalar* y = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(py);
00224   Scalar alpha = *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(palpha);
00225   Scalar beta = *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }Scalar*\textcolor{keyword}{>}(pbeta);
00226   \textcolor{keywordtype}{int} coeff\_rows = *kl+*ku+1;
00227 
00228   \textcolor{keywordtype}{int} info = 0;
00229        \textcolor{keywordflow}{if}(OP(*trans)==INVALID)                                        info = 1;
00230   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*m<0)                                                       info = 2;
00231   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 3;
00232   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*kl<0)                                                      info = 4;
00233   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*ku<0)                                                      info = 5;
00234   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<coeff\_rows)                                            info = 8;
00235   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incx==0)                                                   info = 10;
00236   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incy==0)                                                   info = 13;
00237   \textcolor{keywordflow}{if}(info)
00238     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"GBMV "},&info,6);
00239 
00240   \textcolor{keywordflow}{if}(*m==0 || *n==0 || (alpha==Scalar(0) && beta==Scalar(1)))
00241     \textcolor{keywordflow}{return} 0;
00242 
00243   \textcolor{keywordtype}{int} actual\_m = *m;
00244   \textcolor{keywordtype}{int} actual\_n = *n;
00245   \textcolor{keywordflow}{if}(OP(*trans)!=NOTR)
00246     \hyperlink{endian_8c_a3ca5ecd34b04d6a243c054ac3a57f68d}{std::swap}(actual\_m,actual\_n);
00247 
00248   \textcolor{keyword}{const} Scalar* actual\_x = get\_compact\_vector(x,actual\_n,*incx);
00249   Scalar* actual\_y = get\_compact\_vector(y,actual\_m,*incy);
00250 
00251   \textcolor{keywordflow}{if}(beta!=Scalar(1))
00252   \{
00253     \textcolor{keywordflow}{if}(beta==Scalar(0)) make\_vector(actual\_y, actual\_m).setZero();
00254     \textcolor{keywordflow}{else}                make\_vector(actual\_y, actual\_m) *= beta;
00255   \}
00256 
00257   \hyperlink{group___core___module_class_eigen_1_1_map}{ConstMatrixType} mat\_coeffs(a,coeff\_rows,*n,*lda);
00258 
00259   \textcolor{keywordtype}{int} nb = std::min(*n,(*m)+(*ku));
00260   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<nb; ++j)
00261   \{
00262     \textcolor{keywordtype}{int} start = std::max(0,j - *ku);
00263     \textcolor{keywordtype}{int} end = std::min((*m)-1,j + *kl);
00264     \textcolor{keywordtype}{int} len = end - start + 1;
00265     \textcolor{keywordtype}{int} offset = (*ku) - j + start;
00266     \textcolor{keywordflow}{if}(OP(*trans)==NOTR)
00267       make\_vector(actual\_y+start,len) += (alpha*actual\_x[j]) * mat\_coeffs.col(j).segment(offset,len);
00268     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*trans)==TR)
00269       actual\_y[j] += alpha * ( mat\_coeffs.col(j).segment(offset,len).transpose() * make\_vector(actual\_x+
      start,len) ).value();
00270     \textcolor{keywordflow}{else}
00271       actual\_y[j] += alpha * ( mat\_coeffs.col(j).segment(offset,len).adjoint()   * make\_vector(actual\_x+
      start,len) ).value();
00272   \}
00273 
00274   \textcolor{keywordflow}{if}(actual\_x!=x) \textcolor{keyword}{delete}[] actual\_x;
00275   \textcolor{keywordflow}{if}(actual\_y!=y) \textcolor{keyword}{delete}[] copy\_back(actual\_y,y,actual\_m,*incy);
00276 
00277   \textcolor{keywordflow}{return} 0;
00278 \}
00279 
00280 \textcolor{preprocessor}{#if 0}
00281 
00288 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(tbmv)(\textcolor{keywordtype}{char} *uplo, \textcolor{keywordtype}{char} *opa, \textcolor{keywordtype}{char} *diag, \textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{int} *k, RealScalar *pa, \textcolor{keywordtype}{int} *lda, 
      RealScalar *px, \textcolor{keywordtype}{int} *incx)
00289 \{
00290   Scalar* a = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pa);
00291   Scalar* x = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(px);
00292   \textcolor{keywordtype}{int} coeff\_rows = *k + 1;
00293 
00294   \textcolor{keywordtype}{int} info = 0;
00295        \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                       info = 1;
00296   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*opa)==INVALID)                                          info = 2;
00297   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00298   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00299   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*k<0)                                                       info = 5;
00300   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<coeff\_rows)                                            info = 7;
00301   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incx==0)                                                   info = 9;
00302   \textcolor{keywordflow}{if}(info)
00303     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TBMV "},&info,6);
00304 
00305   \textcolor{keywordflow}{if}(*n==0)
00306     \textcolor{keywordflow}{return} 0;
00307 
00308   \textcolor{keywordtype}{int} actual\_n = *n;
00309 
00310   Scalar* actual\_x = get\_compact\_vector(x,actual\_n,*incx);
00311 
00312   MatrixType mat\_coeffs(a,coeff\_rows,*n,*lda);
00313 
00314   \textcolor{keywordtype}{int} ku = UPLO(*uplo)==UPPER ? *k : 0;
00315   \textcolor{keywordtype}{int} kl = UPLO(*uplo)==LOWER ? *k : 0;
00316 
00317   \textcolor{keywordflow}{for}(\textcolor{keywordtype}{int} j=0; j<*n; ++j)
00318   \{
00319     \textcolor{keywordtype}{int} start = std::max(0,j - ku);
00320     \textcolor{keywordtype}{int} end = std::min((*m)-1,j + kl);
00321     \textcolor{keywordtype}{int} len = end - start + 1;
00322     \textcolor{keywordtype}{int} offset = (ku) - j + start;
00323 
00324     \textcolor{keywordflow}{if}(OP(*trans)==NOTR)
00325       make\_vector(actual\_y+start,len) += (alpha*actual\_x[j]) * mat\_coeffs.col(j).segment(offset,len);
00326     \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*trans)==TR)
00327       actual\_y[j] += alpha * ( mat\_coeffs.col(j).segment(offset,len).transpose() * make\_vector(actual\_x+
      start,len) ).value();
00328     \textcolor{keywordflow}{else}
00329       actual\_y[j] += alpha * ( mat\_coeffs.col(j).segment(offset,len).adjoint()   * make\_vector(actual\_x+
      start,len) ).value();
00330   \}
00331 
00332   \textcolor{keywordflow}{if}(actual\_x!=x) \textcolor{keyword}{delete}[] actual\_x;
00333   \textcolor{keywordflow}{if}(actual\_y!=y) \textcolor{keyword}{delete}[] copy\_back(actual\_y,y,actual\_m,*incy);
00334 
00335   \textcolor{keywordflow}{return} 0;
00336 \}
00337 \textcolor{preprocessor}{#endif}
00338 
00350 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(tbsv)(\textcolor{keywordtype}{char} *uplo, \textcolor{keywordtype}{char} *op, \textcolor{keywordtype}{char} *diag, \textcolor{keywordtype}{int} *n, \textcolor{keywordtype}{int} *k, RealScalar *pa, \textcolor{keywordtype}{int} *lda, 
      RealScalar *px, \textcolor{keywordtype}{int} *incx)
00351 \{
00352   \textcolor{keyword}{typedef} void (*functype)(int, int, \textcolor{keyword}{const} Scalar *, int, Scalar *);
00353   \textcolor{keyword}{static} \textcolor{keyword}{const} functype func[16] = \{
00354     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (NUNIT << 3)}
00355     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|0,       Scalar,false,Scalar,ColMajor>::run}
      ),
00356     \textcolor{comment}{// array index: TR    | (UP << 2) | (NUNIT << 3)}
00357     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|0,       Scalar,false,Scalar,RowMajor>::run}
      ),
00358     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (NUNIT << 3)}
00359     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|0,       Scalar,Conj, Scalar,RowMajor>::run}
      ),
00360     0,
00361     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (NUNIT << 3)}
00362     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|0,       Scalar,false,Scalar,ColMajor>::run}
      ),
00363     \textcolor{comment}{// array index: TR    | (LO << 2) | (NUNIT << 3)}
00364     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|0,       Scalar,false,Scalar,RowMajor>::run}
      ),
00365     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (NUNIT << 3)}
00366     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|0,       Scalar,Conj, Scalar,RowMajor>::run}
      ),
00367     0,
00368     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (UNIT  << 3)}
00369     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|UnitDiag,Scalar,false,Scalar,ColMajor>::run}
      ),
00370     \textcolor{comment}{// array index: TR    | (UP << 2) | (UNIT  << 3)}
00371     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|UnitDiag,Scalar,false,Scalar,RowMajor>::run}
      ),
00372     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (UNIT  << 3)}
00373     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|UnitDiag,Scalar,Conj, Scalar,RowMajor>::run}
      ),
00374     0,
00375     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (UNIT  << 3)}
00376     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Lower|UnitDiag,Scalar,false,Scalar,ColMajor>::run}
      ),
00377     \textcolor{comment}{// array index: TR    | (LO << 2) | (UNIT  << 3)}
00378     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|UnitDiag,Scalar,false,Scalar,RowMajor>::run}
      ),
00379     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (UNIT  << 3)}
00380     (
      \hyperlink{structinternal_1_1band__solve__triangular__selector}{internal::band\_solve\_triangular\_selector<int,Upper|UnitDiag,Scalar,Conj, Scalar,RowMajor>::run}
      ),
00381     0,
00382   \};
00383 
00384   Scalar* a = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pa);
00385   Scalar* x = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(px);
00386   \textcolor{keywordtype}{int} coeff\_rows = *k+1;
00387 
00388   \textcolor{keywordtype}{int} info = 0;
00389        \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                       info = 1;
00390   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*op)==INVALID)                                           info = 2;
00391   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00392   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00393   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*k<0)                                                       info = 5;
00394   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*lda<coeff\_rows)                                            info = 7;
00395   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incx==0)                                                   info = 9;
00396   \textcolor{keywordflow}{if}(info)
00397     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TBSV "},&info,6);
00398 
00399   \textcolor{keywordflow}{if}(*n==0 || (*k==0 && DIAG(*diag)==UNIT))
00400     \textcolor{keywordflow}{return} 0;
00401 
00402   \textcolor{keywordtype}{int} actual\_n = *n;
00403 
00404   Scalar* actual\_x = get\_compact\_vector(x,actual\_n,*incx);
00405 
00406   \textcolor{keywordtype}{int} code = OP(*op) | (UPLO(*uplo) << 2) | (DIAG(*diag) << 3);
00407   \textcolor{keywordflow}{if}(code>=16 || func[code]==0)
00408     \textcolor{keywordflow}{return} 0;
00409 
00410   func[code](*n, *k, a, *lda, actual\_x);
00411 
00412   \textcolor{keywordflow}{if}(actual\_x!=x) \textcolor{keyword}{delete}[] copy\_back(actual\_x,x,actual\_n,*incx);
00413 
00414   \textcolor{keywordflow}{return} 0;
00415 \}
00416 
00424 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(tpmv)(\textcolor{keywordtype}{char} *uplo, \textcolor{keywordtype}{char} *opa, \textcolor{keywordtype}{char} *diag, \textcolor{keywordtype}{int} *n, RealScalar *pap, RealScalar *px, \textcolor{keywordtype}{int} *
      incx)
00425 \{
00426   \textcolor{keyword}{typedef} void (*functype)(int, \textcolor{keyword}{const} Scalar*, \textcolor{keyword}{const} Scalar*, Scalar*, Scalar);
00427   \textcolor{keyword}{static} \textcolor{keyword}{const} functype func[16] = \{
00428     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (NUNIT << 3)}
00429     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Upper|0,      
       Scalar,false,Scalar,false,ColMajor>::run}
      ),
00430     \textcolor{comment}{// array index: TR    | (UP << 2) | (NUNIT << 3)}
00431     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Lower|0,      
       Scalar,false,Scalar,false,RowMajor>::run}
      ),
00432     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (NUNIT << 3)}
00433     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Lower|0,       Scalar,Conj,
       Scalar,false,RowMajor>::run}
      ),
00434     0,
00435     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (NUNIT << 3)}
00436     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Lower|0,      
       Scalar,false,Scalar,false,ColMajor>::run}
      ),
00437     \textcolor{comment}{// array index: TR    | (LO << 2) | (NUNIT << 3)}
00438     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Upper|0,      
       Scalar,false,Scalar,false,RowMajor>::run}
      ),
00439     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (NUNIT << 3)}
00440     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Upper|0,       Scalar,Conj,
       Scalar,false,RowMajor>::run}
      ),
00441     0,
00442     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (UNIT  << 3)}
00443     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{
      internal::packed\_triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,false,Scalar,false,ColMajor>::run}
      ),
00444     \textcolor{comment}{// array index: TR    | (UP << 2) | (UNIT  << 3)}
00445     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{
      internal::packed\_triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,false,Scalar,false,RowMajor>::run}
      ),
00446     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (UNIT  << 3)}
00447     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,Conj,
       Scalar,false,RowMajor>::run}
      ),
00448     0,
00449     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (UNIT  << 3)}
00450     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{
      internal::packed\_triangular\_matrix\_vector\_product<int,Lower|UnitDiag,Scalar,false,Scalar,false,ColMajor>::run}
      ),
00451     \textcolor{comment}{// array index: TR    | (LO << 2) | (UNIT  << 3)}
00452     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{
      internal::packed\_triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,false,Scalar,false,RowMajor>::run}
      ),
00453     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (UNIT  << 3)}
00454     (
      \hyperlink{structinternal_1_1packed__triangular__matrix__vector__product}{internal::packed\_triangular\_matrix\_vector\_product<int,Upper|UnitDiag,Scalar,Conj,
       Scalar,false,RowMajor>::run}
      ),
00455     0
00456   \};
00457 
00458   Scalar* ap = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pap);
00459   Scalar* x = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(px);
00460 
00461   \textcolor{keywordtype}{int} info = 0;
00462   \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                            info = 1;
00463   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*opa)==INVALID)                                          info = 2;
00464   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00465   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00466   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incx==0)                                                   info = 7;
00467   \textcolor{keywordflow}{if}(info)
00468     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TPMV "},&info,6);
00469 
00470   \textcolor{keywordflow}{if}(*n==0)
00471     \textcolor{keywordflow}{return} 1;
00472 
00473   Scalar* actual\_x = get\_compact\_vector(x,*n,*incx);
00474   \hyperlink{group___core___module}{Matrix<Scalar,Dynamic,1>} res(*n);
00475   res.setZero();
00476 
00477   \textcolor{keywordtype}{int} code = OP(*opa) | (UPLO(*uplo) << 2) | (DIAG(*diag) << 3);
00478   \textcolor{keywordflow}{if}(code>=16 || func[code]==0)
00479     \textcolor{keywordflow}{return} 0;
00480 
00481   func[code](*n, ap, actual\_x, res.data(), Scalar(1));
00482 
00483   copy\_back(res.data(),x,*n,*incx);
00484   \textcolor{keywordflow}{if}(actual\_x!=x) \textcolor{keyword}{delete}[] actual\_x;
00485 
00486   \textcolor{keywordflow}{return} 1;
00487 \}
00488 
00499 \textcolor{keywordtype}{int} EIGEN\_BLAS\_FUNC(tpsv)(\textcolor{keywordtype}{char} *uplo, \textcolor{keywordtype}{char} *opa, \textcolor{keywordtype}{char} *diag, \textcolor{keywordtype}{int} *n, RealScalar *pap, RealScalar *px, \textcolor{keywordtype}{int} *
      incx)
00500 \{
00501   \textcolor{keyword}{typedef} void (*functype)(int, \textcolor{keyword}{const} Scalar*, Scalar*);
00502   \textcolor{keyword}{static} \textcolor{keyword}{const} functype func[16] = \{
00503     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (NUNIT << 3)}
00504     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       false,ColMajor>::run}
      ),
00505     \textcolor{comment}{// array index: TR    | (UP << 2) | (NUNIT << 3)}
00506     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       false,RowMajor>::run}
      ),
00507     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (NUNIT << 3)}
00508     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       Conj, RowMajor>::run}
      ),
00509     0,
00510     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (NUNIT << 3)}
00511     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|0,       false,ColMajor>::run}
      ),
00512     \textcolor{comment}{// array index: TR    | (LO << 2) | (NUNIT << 3)}
00513     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       false,RowMajor>::run}
      ),
00514     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (NUNIT << 3)}
00515     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|0,       Conj, RowMajor>::run}
      ),
00516     0,
00517     \textcolor{comment}{// array index: NOTR  | (UP << 2) | (UNIT  << 3)}
00518     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,false,ColMajor>::run}
      ),
00519     \textcolor{comment}{// array index: TR    | (UP << 2) | (UNIT  << 3)}
00520     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,false,RowMajor>::run}
      ),
00521     \textcolor{comment}{// array index: ADJ   | (UP << 2) | (UNIT  << 3)}
00522     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,Conj, RowMajor>::run}
      ),
00523     0,
00524     \textcolor{comment}{// array index: NOTR  | (LO << 2) | (UNIT  << 3)}
00525     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Lower|UnitDiag,false,ColMajor>::run}
      ),
00526     \textcolor{comment}{// array index: TR    | (LO << 2) | (UNIT  << 3)}
00527     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,false,RowMajor>::run}
      ),
00528     \textcolor{comment}{// array index: ADJ   | (LO << 2) | (UNIT  << 3)}
00529     (
      \hyperlink{structinternal_1_1packed__triangular__solve__vector}{internal::packed\_triangular\_solve\_vector<Scalar,Scalar,int,OnTheLeft, Upper|UnitDiag,Conj, RowMajor>::run}
      ),
00530     0
00531   \};
00532 
00533   Scalar* ap = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(pap);
00534   Scalar* x = \textcolor{keyword}{reinterpret\_cast<}Scalar*\textcolor{keyword}{>}(px);
00535 
00536   \textcolor{keywordtype}{int} info = 0;
00537   \textcolor{keywordflow}{if}(UPLO(*uplo)==INVALID)                                            info = 1;
00538   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(OP(*opa)==INVALID)                                          info = 2;
00539   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(DIAG(*diag)==INVALID)                                       info = 3;
00540   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*n<0)                                                       info = 4;
00541   \textcolor{keywordflow}{else} \textcolor{keywordflow}{if}(*incx==0)                                                   info = 7;
00542   \textcolor{keywordflow}{if}(info)
00543     \textcolor{keywordflow}{return} xerbla\_(SCALAR\_SUFFIX\_UP\textcolor{stringliteral}{"TPSV "},&info,6);
00544 
00545   Scalar* actual\_x = get\_compact\_vector(x,*n,*incx);
00546 
00547   \textcolor{keywordtype}{int} code = OP(*opa) | (UPLO(*uplo) << 2) | (DIAG(*diag) << 3);
00548   func[code](*n, ap, actual\_x);
00549 
00550   \textcolor{keywordflow}{if}(actual\_x!=x) \textcolor{keyword}{delete}[] copy\_back(actual\_x,x,*n,*incx);
00551 
00552   \textcolor{keywordflow}{return} 1;
00553 \}
\end{DoxyCode}
