\hypertarget{eigen_2_eigen_2src_2_core_2arch_2_c_u_d_a_2_packet_math_8h_source}{}\section{eigen/\+Eigen/src/\+Core/arch/\+C\+U\+D\+A/\+Packet\+Math.h}
\label{eigen_2_eigen_2src_2_core_2arch_2_c_u_d_a_2_packet_math_8h_source}\index{Packet\+Math.\+h@{Packet\+Math.\+h}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#ifndef EIGEN\_PACKET\_MATH\_CUDA\_H}
00011 \textcolor{preprocessor}{#define EIGEN\_PACKET\_MATH\_CUDA\_H}
00012 
00013 \textcolor{keyword}{namespace }\hyperlink{namespace_eigen}{Eigen} \{
00014 
00015 \textcolor{keyword}{namespace }\hyperlink{namespaceinternal}{internal} \{
00016 
00017 \textcolor{comment}{// Make sure this is only available when targeting a GPU: we don't want to}
00018 \textcolor{comment}{// introduce conflicts between these packet\_traits definitions and the ones}
00019 \textcolor{comment}{// we'll use on the host side (SSE, AVX, ...)}
00020 \textcolor{preprocessor}{#if defined(\_\_CUDACC\_\_) && defined(EIGEN\_USE\_GPU)}
00021 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }is\_arithmetic<float4>  \{ \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \}; \};
00022 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }is\_arithmetic<double2> \{ \textcolor{keyword}{enum} \{ value = \textcolor{keyword}{true} \}; \};
00023 
00024 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }packet\_traits<float> : default\_packet\_traits
00025 \{
00026   \textcolor{keyword}{typedef} float4 type;
00027   \textcolor{keyword}{typedef} float4 half;
00028   \textcolor{keyword}{enum} \{
00029     Vectorizable = 1,
00030     AlignedOnScalar = 1,
00031     size=4,
00032     HasHalfPacket = 0,
00033 
00034     HasDiv  = 1,
00035     HasSin  = 0,
00036     HasCos  = 0,
00037     HasLog  = 1,
00038     HasExp  = 1,
00039     HasSqrt = 1,
00040     HasRsqrt = 1,
00041     HasLGamma = 1,
00042     HasDiGamma = 1,
00043     HasZeta = 1,
00044     HasPolygamma = 1,
00045     HasErf = 1,
00046     HasErfc = 1,
00047     HasIGamma = 1,
00048     HasIGammac = 1,
00049     HasBetaInc = 1,
00050 
00051     HasBlend = 0,
00052   \};
00053 \};
00054 
00055 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }packet\_traits<double> : default\_packet\_traits
00056 \{
00057   \textcolor{keyword}{typedef} double2 type;
00058   \textcolor{keyword}{typedef} double2 half;
00059   \textcolor{keyword}{enum} \{
00060     Vectorizable = 1,
00061     AlignedOnScalar = 1,
00062     size=2,
00063     HasHalfPacket = 0,
00064 
00065     HasDiv  = 1,
00066     HasLog  = 1,
00067     HasExp  = 1,
00068     HasSqrt = 1,
00069     HasRsqrt = 1,
00070     HasLGamma = 1,
00071     HasDiGamma = 1,
00072     HasZeta = 1,
00073     HasPolygamma = 1,
00074     HasErf = 1,
00075     HasErfc = 1,
00076     HasIGamma = 1,
00077     HasIGammac = 1,
00078     HasBetaInc = 1,
00079 
00080     HasBlend = 0,
00081   \};
00082 \};
00083 
00084 
00085 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }unpacket\_traits<float4>  \{ \textcolor{keyword}{typedef} \textcolor{keywordtype}{float}  type; \textcolor{keyword}{enum} \{size=4, alignment=
      \hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1af8e2bf74b04c02199f62c5e3c06dbfcc}{Aligned16}\}; \textcolor{keyword}{typedef} float4 half; \};
00086 \textcolor{keyword}{template}<> \textcolor{keyword}{struct }unpacket\_traits<double2> \{ \textcolor{keyword}{typedef} \textcolor{keywordtype}{double} type; \textcolor{keyword}{enum} \{size=2, alignment=
      \hyperlink{group__enums_gga45fe06e29902b7a2773de05ba27b47a1af8e2bf74b04c02199f62c5e3c06dbfcc}{Aligned16}\}; \textcolor{keyword}{typedef} double2 half; \};
00087 
00088 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pset1<float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}&  from) \{
00089   \textcolor{keywordflow}{return} make\_float4(from, from, from, from);
00090 \}
00091 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pset1<double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}& from) \{
00092   \textcolor{keywordflow}{return} make\_double2(from, from);
00093 \}
00094 
00095 
00096 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 plset<float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}& a) \{
00097   \textcolor{keywordflow}{return} make\_float4(a, a+1, a+2, a+3);
00098 \}
00099 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 plset<double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}& a) \{
00100   \textcolor{keywordflow}{return} make\_double2(a, a+1);
00101 \}
00102 
00103 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 padd<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00104   \textcolor{keywordflow}{return} make\_float4(a.x+b.x, a.y+b.y, a.z+b.z, a.w+b.w);
00105 \}
00106 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 padd<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00107   \textcolor{keywordflow}{return} make\_double2(a.x+b.x, a.y+b.y);
00108 \}
00109 
00110 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 psub<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00111   \textcolor{keywordflow}{return} make\_float4(a.x-b.x, a.y-b.y, a.z-b.z, a.w-b.w);
00112 \}
00113 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 psub<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00114   \textcolor{keywordflow}{return} make\_double2(a.x-b.x, a.y-b.y);
00115 \}
00116 
00117 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pnegate(\textcolor{keyword}{const} float4& a) \{
00118   \textcolor{keywordflow}{return} make\_float4(-a.x, -a.y, -a.z, -a.w);
00119 \}
00120 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pnegate(\textcolor{keyword}{const} double2& a) \{
00121   \textcolor{keywordflow}{return} make\_double2(-a.x, -a.y);
00122 \}
00123 
00124 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pconj(\textcolor{keyword}{const} float4& a) \{ \textcolor{keywordflow}{return} a; \}
00125 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pconj(\textcolor{keyword}{const} double2& a) \{ \textcolor{keywordflow}{return} a; \}
00126 
00127 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pmul<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00128   \textcolor{keywordflow}{return} make\_float4(a.x*b.x, a.y*b.y, a.z*b.z, a.w*b.w);
00129 \}
00130 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pmul<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00131   \textcolor{keywordflow}{return} make\_double2(a.x*b.x, a.y*b.y);
00132 \}
00133 
00134 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pdiv<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00135   \textcolor{keywordflow}{return} make\_float4(a.x/b.x, a.y/b.y, a.z/b.z, a.w/b.w);
00136 \}
00137 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pdiv<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00138   \textcolor{keywordflow}{return} make\_double2(a.x/b.x, a.y/b.y);
00139 \}
00140 
00141 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pmin<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00142   \textcolor{keywordflow}{return} make\_float4(fminf(a.x, b.x), fminf(a.y, b.y), fminf(a.z, b.z), fminf(a.w, b.w));
00143 \}
00144 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pmin<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00145   \textcolor{keywordflow}{return} make\_double2(fmin(a.x, b.x), fmin(a.y, b.y));
00146 \}
00147 
00148 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pmax<float4>(\textcolor{keyword}{const} float4& a, \textcolor{keyword}{const} float4& b) \{
00149   \textcolor{keywordflow}{return} make\_float4(fmaxf(a.x, b.x), fmaxf(a.y, b.y), fmaxf(a.z, b.z), fmaxf(a.w, b.w));
00150 \}
00151 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pmax<double2>(\textcolor{keyword}{const} double2& a, \textcolor{keyword}{const} double2& b) 
      \{
00152   \textcolor{keywordflow}{return} make\_double2(fmax(a.x, b.x), fmax(a.y, b.y));
00153 \}
00154 
00155 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 pload<float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00156   \textcolor{keywordflow}{return} *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }float4*\textcolor{keyword}{>}(from);
00157 \}
00158 
00159 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 pload<double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00160   \textcolor{keywordflow}{return} *\textcolor{keyword}{reinterpret\_cast<}\textcolor{keyword}{const }double2*\textcolor{keyword}{>}(from);
00161 \}
00162 
00163 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE float4 ploadu<float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00164   \textcolor{keywordflow}{return} make\_float4(from[0], from[1], from[2], from[3]);
00165 \}
00166 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE double2 ploadu<double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00167   \textcolor{keywordflow}{return} make\_double2(from[0], from[1]);
00168 \}
00169 
00170 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE float4 ploaddup<float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}*   from) \{
00171   \textcolor{keywordflow}{return} make\_float4(from[0], from[0], from[1], from[1]);
00172 \}
00173 \textcolor{keyword}{template}<> EIGEN\_STRONG\_INLINE double2 ploaddup<double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}*  from) \{
00174   \textcolor{keywordflow}{return} make\_double2(from[0], from[0]);
00175 \}
00176 
00177 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore<float>(\textcolor{keywordtype}{float}*   to, \textcolor{keyword}{const} float4& from) \{
00178   *\textcolor{keyword}{reinterpret\_cast<}float4*\textcolor{keyword}{>}(to) = from;
00179 \}
00180 
00181 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstore<double>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} double2& from) \{
00182   *\textcolor{keyword}{reinterpret\_cast<}double2*\textcolor{keyword}{>}(to) = from;
00183 \}
00184 
00185 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<float>(\textcolor{keywordtype}{float}*  to, \textcolor{keyword}{const} float4& from) \{
00186   to[0] = from.x;
00187   to[1] = from.y;
00188   to[2] = from.z;
00189   to[3] = from.w;
00190 \}
00191 
00192 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC EIGEN\_STRONG\_INLINE \textcolor{keywordtype}{void} pstoreu<double>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} double2& from) \{
00193   to[0] = from.x;
00194   to[1] = from.y;
00195 \}
00196 
00197 \textcolor{keyword}{template}<>
00198 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE float4 ploadt\_ro<float4, Aligned>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00199 \textcolor{preprocessor}{#if defined(\_\_CUDA\_ARCH\_\_) && \_\_CUDA\_ARCH\_\_ >= 350}
00200   \textcolor{keywordflow}{return} \_\_ldg((\textcolor{keyword}{const} float4*)from);
00201 \textcolor{preprocessor}{#else}
00202   \textcolor{keywordflow}{return} make\_float4(from[0], from[1], from[2], from[3]);
00203 \textcolor{preprocessor}{#endif}
00204 \}
00205 \textcolor{keyword}{template}<>
00206 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE double2 ploadt\_ro<double2, Aligned>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00207 \textcolor{preprocessor}{#if defined(\_\_CUDA\_ARCH\_\_) && \_\_CUDA\_ARCH\_\_ >= 350}
00208   \textcolor{keywordflow}{return} \_\_ldg((\textcolor{keyword}{const} double2*)from);
00209 \textcolor{preprocessor}{#else}
00210   \textcolor{keywordflow}{return} make\_double2(from[0], from[1]);
00211 \textcolor{preprocessor}{#endif}
00212 \}
00213 
00214 \textcolor{keyword}{template}<>
00215 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE float4 ploadt\_ro<float4, Unaligned>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from) \{
00216 \textcolor{preprocessor}{#if defined(\_\_CUDA\_ARCH\_\_) && \_\_CUDA\_ARCH\_\_ >= 350}
00217   \textcolor{keywordflow}{return} make\_float4(\_\_ldg(from+0), \_\_ldg(from+1), \_\_ldg(from+2), \_\_ldg(from+3));
00218 \textcolor{preprocessor}{#else}
00219   \textcolor{keywordflow}{return} make\_float4(from[0], from[1], from[2], from[3]);
00220 \textcolor{preprocessor}{#endif}
00221 \}
00222 \textcolor{keyword}{template}<>
00223 EIGEN\_DEVICE\_FUNC EIGEN\_ALWAYS\_INLINE double2 ploadt\_ro<double2, Unaligned>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from) \{
00224 \textcolor{preprocessor}{#if defined(\_\_CUDA\_ARCH\_\_) && \_\_CUDA\_ARCH\_\_ >= 350}
00225   \textcolor{keywordflow}{return} make\_double2(\_\_ldg(from+0), \_\_ldg(from+1));
00226 \textcolor{preprocessor}{#else}
00227   \textcolor{keywordflow}{return} make\_double2(from[0], from[1]);
00228 \textcolor{preprocessor}{#endif}
00229 \}
00230 
00231 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} float4 pgather<float, float4>(\textcolor{keyword}{const} \textcolor{keywordtype}{float}* from, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00232   \textcolor{keywordflow}{return} make\_float4(from[0*stride], from[1*stride], from[2*stride], from[3*stride]);
00233 \}
00234 
00235 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} double2 pgather<double, double2>(\textcolor{keyword}{const} \textcolor{keywordtype}{double}* from, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00236   \textcolor{keywordflow}{return} make\_double2(from[0*stride], from[1*stride]);
00237 \}
00238 
00239 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<float, float4>(\textcolor{keywordtype}{float}* to, \textcolor{keyword}{const} float4& from, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00240   to[stride*0] = from.x;
00241   to[stride*1] = from.y;
00242   to[stride*2] = from.z;
00243   to[stride*3] = from.w;
00244 \}
00245 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void} pscatter<double, double2>(\textcolor{keywordtype}{double}* to, \textcolor{keyword}{const} double2& from, 
      \hyperlink{namespace_eigen_a62e77e0933482dafde8fe197d9a2cfde}{Index} stride) \{
00246   to[stride*0] = from.x;
00247   to[stride*1] = from.y;
00248 \}
00249 
00250 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{float}  pfirst<float4>(\textcolor{keyword}{const} float4& a) \{
00251   \textcolor{keywordflow}{return} a.x;
00252 \}
00253 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{double} pfirst<double2>(\textcolor{keyword}{const} double2& a) \{
00254   \textcolor{keywordflow}{return} a.x;
00255 \}
00256 
00257 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{float}  predux<float4>(\textcolor{keyword}{const} float4& a) \{
00258   \textcolor{keywordflow}{return} a.x + a.y + a.z + a.w;
00259 \}
00260 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{double} predux<double2>(\textcolor{keyword}{const} double2& a) \{
00261   \textcolor{keywordflow}{return} a.x + a.y;
00262 \}
00263 
00264 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{float}  predux\_max<float4>(\textcolor{keyword}{const} float4& a) \{
00265   \textcolor{keywordflow}{return} fmaxf(fmaxf(a.x, a.y), fmaxf(a.z, a.w));
00266 \}
00267 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{double} predux\_max<double2>(\textcolor{keyword}{const} double2& a) \{
00268   \textcolor{keywordflow}{return} fmax(a.x, a.y);
00269 \}
00270 
00271 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{float}  predux\_min<float4>(\textcolor{keyword}{const} float4& a) \{
00272   \textcolor{keywordflow}{return} fminf(fminf(a.x, a.y), fminf(a.z, a.w));
00273 \}
00274 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{double} predux\_min<double2>(\textcolor{keyword}{const} double2& a) \{
00275   \textcolor{keywordflow}{return} fmin(a.x, a.y);
00276 \}
00277 
00278 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{float}  predux\_mul<float4>(\textcolor{keyword}{const} float4& a) \{
00279   \textcolor{keywordflow}{return} a.x * a.y * a.z * a.w;
00280 \}
00281 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{double} predux\_mul<double2>(\textcolor{keyword}{const} double2& a) \{
00282   \textcolor{keywordflow}{return} a.x * a.y;
00283 \}
00284 
00285 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} float4  pabs<float4>(\textcolor{keyword}{const} float4& a) \{
00286   \textcolor{keywordflow}{return} make\_float4(fabsf(a.x), fabsf(a.y), fabsf(a.z), fabsf(a.w));
00287 \}
00288 \textcolor{keyword}{template}<> EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} double2 pabs<double2>(\textcolor{keyword}{const} double2& a) \{
00289   \textcolor{keywordflow}{return} make\_double2(fabs(a.x), fabs(a.y));
00290 \}
00291 
00292 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}
00293 ptranspose(PacketBlock<float4,4>& kernel) \{
00294   \textcolor{keywordtype}{float} tmp = kernel.packet[0].y;
00295   kernel.packet[0].y = kernel.packet[1].x;
00296   kernel.packet[1].x = tmp;
00297 
00298   tmp = kernel.packet[0].z;
00299   kernel.packet[0].z = kernel.packet[2].x;
00300   kernel.packet[2].x = tmp;
00301 
00302   tmp = kernel.packet[0].w;
00303   kernel.packet[0].w = kernel.packet[3].x;
00304   kernel.packet[3].x = tmp;
00305 
00306   tmp = kernel.packet[1].z;
00307   kernel.packet[1].z = kernel.packet[2].y;
00308   kernel.packet[2].y = tmp;
00309 
00310   tmp = kernel.packet[1].w;
00311   kernel.packet[1].w = kernel.packet[3].y;
00312   kernel.packet[3].y = tmp;
00313 
00314   tmp = kernel.packet[2].w;
00315   kernel.packet[2].w = kernel.packet[3].z;
00316   kernel.packet[3].z = tmp;
00317 \}
00318 
00319 EIGEN\_DEVICE\_FUNC \textcolor{keyword}{inline} \textcolor{keywordtype}{void}
00320 ptranspose(PacketBlock<double2,2>& kernel) \{
00321   \textcolor{keywordtype}{double} tmp = kernel.packet[0].y;
00322   kernel.packet[0].y = kernel.packet[1].x;
00323   kernel.packet[1].x = tmp;
00324 \}
00325 
00326 \textcolor{preprocessor}{#endif}
00327 
00328 \} \textcolor{comment}{// end namespace internal}
00329 
00330 \} \textcolor{comment}{// end namespace Eigen}
00331 
00332 
00333 \textcolor{preprocessor}{#endif // EIGEN\_PACKET\_MATH\_CUDA\_H}
\end{DoxyCode}
