\hypertarget{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__striding_8cpp_source}{}\section{matio/visual\+\_\+studio/test/eigen/unsupported/test/cxx11\+\_\+tensor\+\_\+striding.cpp}
\label{matio_2visual__studio_2test_2eigen_2unsupported_2test_2cxx11__tensor__striding_8cpp_source}\index{cxx11\+\_\+tensor\+\_\+striding.\+cpp@{cxx11\+\_\+tensor\+\_\+striding.\+cpp}}

\begin{DoxyCode}
00001 \textcolor{comment}{// This file is part of Eigen, a lightweight C++ template library}
00002 \textcolor{comment}{// for linear algebra.}
00003 \textcolor{comment}{//}
00004 \textcolor{comment}{// Copyright (C) 2014 Benoit Steiner <benoit.steiner.goog@gmail.com>}
00005 \textcolor{comment}{//}
00006 \textcolor{comment}{// This Source Code Form is subject to the terms of the Mozilla}
00007 \textcolor{comment}{// Public License v. 2.0. If a copy of the MPL was not distributed}
00008 \textcolor{comment}{// with this file, You can obtain one at http://mozilla.org/MPL/2.0/.}
00009 
00010 \textcolor{preprocessor}{#include "main.h"}
00011 
00012 \textcolor{preprocessor}{#include <Eigen/CXX11/Tensor>}
00013 
00014 \textcolor{keyword}{using} \hyperlink{class_eigen_1_1_tensor}{Eigen::Tensor};
00015 
00016 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} DataLayout>
00017 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_simple\_striding()
00018 \{
00019   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} tensor(2,3,5,7);
00020   tensor.setRandom();
00021   array<ptrdiff\_t, 4> strides;
00022   strides[0] = 1;
00023   strides[1] = 1;
00024   strides[2] = 1;
00025   strides[3] = 1;
00026 
00027   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} no\_stride;
00028   no\_stride = tensor.stride(strides);
00029 
00030   VERIFY\_IS\_EQUAL(no\_stride.dimension(0), 2);
00031   VERIFY\_IS\_EQUAL(no\_stride.dimension(1), 3);
00032   VERIFY\_IS\_EQUAL(no\_stride.dimension(2), 5);
00033   VERIFY\_IS\_EQUAL(no\_stride.dimension(3), 7);
00034 
00035   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00036     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00037       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 5; ++k) \{
00038         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00039           VERIFY\_IS\_EQUAL(tensor(i,j,k,l), no\_stride(i,j,k,l));
00040         \}
00041       \}
00042     \}
00043   \}
00044 
00045   strides[0] = 2;
00046   strides[1] = 4;
00047   strides[2] = 2;
00048   strides[3] = 3;
00049   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} stride;
00050   stride = tensor.stride(strides);
00051 
00052   VERIFY\_IS\_EQUAL(stride.dimension(0), 1);
00053   VERIFY\_IS\_EQUAL(stride.dimension(1), 1);
00054   VERIFY\_IS\_EQUAL(stride.dimension(2), 3);
00055   VERIFY\_IS\_EQUAL(stride.dimension(3), 3);
00056 
00057   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 1; ++i) \{
00058     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 1; ++j) \{
00059       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 3; ++k) \{
00060         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 3; ++l) \{
00061           VERIFY\_IS\_EQUAL(tensor(2*i,4*j,2*k,3*l), stride(i,j,k,l));
00062         \}
00063       \}
00064     \}
00065   \}
00066 \}
00067 
00068 
00069 \textcolor{keyword}{template}<\textcolor{keywordtype}{int} DataLayout>
00070 \textcolor{keyword}{static} \textcolor{keywordtype}{void} test\_striding\_as\_lvalue()
00071 \{
00072   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} tensor(2,3,5,7);
00073   tensor.setRandom();
00074   array<ptrdiff\_t, 4> strides;
00075   strides[0] = 2;
00076   strides[1] = 4;
00077   strides[2] = 2;
00078   strides[3] = 3;
00079 
00080   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} result(3, 12, 10, 21);
00081   result.stride(strides) = tensor;
00082 
00083   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00084     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00085       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 5; ++k) \{
00086         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00087           VERIFY\_IS\_EQUAL(tensor(i,j,k,l), result(2*i,4*j,2*k,3*l));
00088         \}
00089       \}
00090     \}
00091   \}
00092 
00093   array<ptrdiff\_t, 4> no\_strides;
00094   no\_strides[0] = 1;
00095   no\_strides[1] = 1;
00096   no\_strides[2] = 1;
00097   no\_strides[3] = 1;
00098   \hyperlink{class_eigen_1_1_tensor}{Tensor<float, 4, DataLayout>} result2(3, 12, 10, 21);
00099   result2.stride(strides) = tensor.stride(no\_strides);
00100 
00101   \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < 2; ++i) \{
00102     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} j = 0; j < 3; ++j) \{
00103       \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} k = 0; k < 5; ++k) \{
00104         \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} l = 0; l < 7; ++l) \{
00105           VERIFY\_IS\_EQUAL(tensor(i,j,k,l), result2(2*i,4*j,2*k,3*l));
00106         \}
00107       \}
00108     \}
00109   \}
00110 \}
00111 
00112 
00113 \textcolor{keywordtype}{void} test\_cxx11\_tensor\_striding()
00114 \{
00115   CALL\_SUBTEST(test\_simple\_striding<ColMajor>());
00116   CALL\_SUBTEST(test\_simple\_striding<RowMajor>());
00117   CALL\_SUBTEST(test\_striding\_as\_lvalue<ColMajor>());
00118   CALL\_SUBTEST(test\_striding\_as\_lvalue<RowMajor>());
00119 \}
\end{DoxyCode}
